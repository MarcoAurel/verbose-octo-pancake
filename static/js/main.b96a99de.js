/*! For license information please see main.b96a99de.js.LICENSE.txt */
(()=>{"use strict";var e={43:(e,t,r)=>{e.exports=r(202)},153:(e,t,r)=>{var n=r(43),a=Symbol.for("react.element"),i=Symbol.for("react.fragment"),s=Object.prototype.hasOwnProperty,o=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,l={key:!0,ref:!0,__self:!0,__source:!0};function c(e,t,r){var n,i={},c=null,u=null;for(n in void 0!==r&&(c=""+r),void 0!==t.key&&(c=""+t.key),void 0!==t.ref&&(u=t.ref),t)s.call(t,n)&&!l.hasOwnProperty(n)&&(i[n]=t[n]);if(e&&e.defaultProps)for(n in t=e.defaultProps)void 0===i[n]&&(i[n]=t[n]);return{$$typeof:a,type:e,key:c,ref:u,props:i,_owner:o.current}}t.jsx=c,t.jsxs=c},202:(e,t)=>{var r=Symbol.for("react.element"),n=Symbol.for("react.portal"),a=Symbol.for("react.fragment"),i=Symbol.for("react.strict_mode"),s=Symbol.for("react.profiler"),o=Symbol.for("react.provider"),l=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),u=Symbol.for("react.suspense"),h=Symbol.for("react.memo"),f=Symbol.for("react.lazy"),d=Symbol.iterator;var p={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},m=Object.assign,g={};function v(e,t,r){this.props=e,this.context=t,this.refs=g,this.updater=r||p}function y(){}function b(e,t,r){this.props=e,this.context=t,this.refs=g,this.updater=r||p}v.prototype.isReactComponent={},v.prototype.setState=function(e,t){if("object"!==typeof e&&"function"!==typeof e&&null!=e)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")},v.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},y.prototype=v.prototype;var w=b.prototype=new y;w.constructor=b,m(w,v.prototype),w.isPureReactComponent=!0;var E=Array.isArray,T=Object.prototype.hasOwnProperty,_={current:null},S={key:!0,ref:!0,__self:!0,__source:!0};function k(e,t,n){var a,i={},s=null,o=null;if(null!=t)for(a in void 0!==t.ref&&(o=t.ref),void 0!==t.key&&(s=""+t.key),t)T.call(t,a)&&!S.hasOwnProperty(a)&&(i[a]=t[a]);var l=arguments.length-2;if(1===l)i.children=n;else if(1<l){for(var c=Array(l),u=0;u<l;u++)c[u]=arguments[u+2];i.children=c}if(e&&e.defaultProps)for(a in l=e.defaultProps)void 0===i[a]&&(i[a]=l[a]);return{$$typeof:r,type:e,key:s,ref:o,props:i,_owner:_.current}}function C(e){return"object"===typeof e&&null!==e&&e.$$typeof===r}var I=/\/+/g;function A(e,t){return"object"===typeof e&&null!==e&&null!=e.key?function(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,(function(e){return t[e]}))}(""+e.key):t.toString(36)}function R(e,t,a,i,s){var o=typeof e;"undefined"!==o&&"boolean"!==o||(e=null);var l=!1;if(null===e)l=!0;else switch(o){case"string":case"number":l=!0;break;case"object":switch(e.$$typeof){case r:case n:l=!0}}if(l)return s=s(l=e),e=""===i?"."+A(l,0):i,E(s)?(a="",null!=e&&(a=e.replace(I,"$&/")+"/"),R(s,t,a,"",(function(e){return e}))):null!=s&&(C(s)&&(s=function(e,t){return{$$typeof:r,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}(s,a+(!s.key||l&&l.key===s.key?"":(""+s.key).replace(I,"$&/")+"/")+e)),t.push(s)),1;if(l=0,i=""===i?".":i+":",E(e))for(var c=0;c<e.length;c++){var u=i+A(o=e[c],c);l+=R(o,t,a,u,s)}else if(u=function(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=d&&e[d]||e["@@iterator"])?e:null}(e),"function"===typeof u)for(e=u.call(e),c=0;!(o=e.next()).done;)l+=R(o=o.value,t,a,u=i+A(o,c++),s);else if("object"===o)throw t=String(e),Error("Objects are not valid as a React child (found: "+("[object Object]"===t?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return l}function N(e,t,r){if(null==e)return e;var n=[],a=0;return R(e,n,"","",(function(e){return t.call(r,e,a++)})),n}function O(e){if(-1===e._status){var t=e._result;(t=t()).then((function(t){0!==e._status&&-1!==e._status||(e._status=1,e._result=t)}),(function(t){0!==e._status&&-1!==e._status||(e._status=2,e._result=t)})),-1===e._status&&(e._status=0,e._result=t)}if(1===e._status)return e._result.default;throw e._result}var x={current:null},P={transition:null},D={ReactCurrentDispatcher:x,ReactCurrentBatchConfig:P,ReactCurrentOwner:_};function L(){throw Error("act(...) is not supported in production builds of React.")}t.Children={map:N,forEach:function(e,t,r){N(e,(function(){t.apply(this,arguments)}),r)},count:function(e){var t=0;return N(e,(function(){t++})),t},toArray:function(e){return N(e,(function(e){return e}))||[]},only:function(e){if(!C(e))throw Error("React.Children.only expected to receive a single React element child.");return e}},t.Component=v,t.Fragment=a,t.Profiler=s,t.PureComponent=b,t.StrictMode=i,t.Suspense=u,t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=D,t.act=L,t.cloneElement=function(e,t,n){if(null===e||void 0===e)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var a=m({},e.props),i=e.key,s=e.ref,o=e._owner;if(null!=t){if(void 0!==t.ref&&(s=t.ref,o=_.current),void 0!==t.key&&(i=""+t.key),e.type&&e.type.defaultProps)var l=e.type.defaultProps;for(c in t)T.call(t,c)&&!S.hasOwnProperty(c)&&(a[c]=void 0===t[c]&&void 0!==l?l[c]:t[c])}var c=arguments.length-2;if(1===c)a.children=n;else if(1<c){l=Array(c);for(var u=0;u<c;u++)l[u]=arguments[u+2];a.children=l}return{$$typeof:r,type:e.type,key:i,ref:s,props:a,_owner:o}},t.createContext=function(e){return(e={$$typeof:l,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null}).Provider={$$typeof:o,_context:e},e.Consumer=e},t.createElement=k,t.createFactory=function(e){var t=k.bind(null,e);return t.type=e,t},t.createRef=function(){return{current:null}},t.forwardRef=function(e){return{$$typeof:c,render:e}},t.isValidElement=C,t.lazy=function(e){return{$$typeof:f,_payload:{_status:-1,_result:e},_init:O}},t.memo=function(e,t){return{$$typeof:h,type:e,compare:void 0===t?null:t}},t.startTransition=function(e){var t=P.transition;P.transition={};try{e()}finally{P.transition=t}},t.unstable_act=L,t.useCallback=function(e,t){return x.current.useCallback(e,t)},t.useContext=function(e){return x.current.useContext(e)},t.useDebugValue=function(){},t.useDeferredValue=function(e){return x.current.useDeferredValue(e)},t.useEffect=function(e,t){return x.current.useEffect(e,t)},t.useId=function(){return x.current.useId()},t.useImperativeHandle=function(e,t,r){return x.current.useImperativeHandle(e,t,r)},t.useInsertionEffect=function(e,t){return x.current.useInsertionEffect(e,t)},t.useLayoutEffect=function(e,t){return x.current.useLayoutEffect(e,t)},t.useMemo=function(e,t){return x.current.useMemo(e,t)},t.useReducer=function(e,t,r){return x.current.useReducer(e,t,r)},t.useRef=function(e){return x.current.useRef(e)},t.useState=function(e){return x.current.useState(e)},t.useSyncExternalStore=function(e,t,r){return x.current.useSyncExternalStore(e,t,r)},t.useTransition=function(){return x.current.useTransition()},t.version="18.3.1"},234:(e,t)=>{function r(e,t){var r=e.length;e.push(t);e:for(;0<r;){var n=r-1>>>1,a=e[n];if(!(0<i(a,t)))break e;e[n]=t,e[r]=a,r=n}}function n(e){return 0===e.length?null:e[0]}function a(e){if(0===e.length)return null;var t=e[0],r=e.pop();if(r!==t){e[0]=r;e:for(var n=0,a=e.length,s=a>>>1;n<s;){var o=2*(n+1)-1,l=e[o],c=o+1,u=e[c];if(0>i(l,r))c<a&&0>i(u,l)?(e[n]=u,e[c]=r,n=c):(e[n]=l,e[o]=r,n=o);else{if(!(c<a&&0>i(u,r)))break e;e[n]=u,e[c]=r,n=c}}}return t}function i(e,t){var r=e.sortIndex-t.sortIndex;return 0!==r?r:e.id-t.id}if("object"===typeof performance&&"function"===typeof performance.now){var s=performance;t.unstable_now=function(){return s.now()}}else{var o=Date,l=o.now();t.unstable_now=function(){return o.now()-l}}var c=[],u=[],h=1,f=null,d=3,p=!1,m=!1,g=!1,v="function"===typeof setTimeout?setTimeout:null,y="function"===typeof clearTimeout?clearTimeout:null,b="undefined"!==typeof setImmediate?setImmediate:null;function w(e){for(var t=n(u);null!==t;){if(null===t.callback)a(u);else{if(!(t.startTime<=e))break;a(u),t.sortIndex=t.expirationTime,r(c,t)}t=n(u)}}function E(e){if(g=!1,w(e),!m)if(null!==n(c))m=!0,P(T);else{var t=n(u);null!==t&&D(E,t.startTime-e)}}function T(e,r){m=!1,g&&(g=!1,y(C),C=-1),p=!0;var i=d;try{for(w(r),f=n(c);null!==f&&(!(f.expirationTime>r)||e&&!R());){var s=f.callback;if("function"===typeof s){f.callback=null,d=f.priorityLevel;var o=s(f.expirationTime<=r);r=t.unstable_now(),"function"===typeof o?f.callback=o:f===n(c)&&a(c),w(r)}else a(c);f=n(c)}if(null!==f)var l=!0;else{var h=n(u);null!==h&&D(E,h.startTime-r),l=!1}return l}finally{f=null,d=i,p=!1}}"undefined"!==typeof navigator&&void 0!==navigator.scheduling&&void 0!==navigator.scheduling.isInputPending&&navigator.scheduling.isInputPending.bind(navigator.scheduling);var _,S=!1,k=null,C=-1,I=5,A=-1;function R(){return!(t.unstable_now()-A<I)}function N(){if(null!==k){var e=t.unstable_now();A=e;var r=!0;try{r=k(!0,e)}finally{r?_():(S=!1,k=null)}}else S=!1}if("function"===typeof b)_=function(){b(N)};else if("undefined"!==typeof MessageChannel){var O=new MessageChannel,x=O.port2;O.port1.onmessage=N,_=function(){x.postMessage(null)}}else _=function(){v(N,0)};function P(e){k=e,S||(S=!0,_())}function D(e,r){C=v((function(){e(t.unstable_now())}),r)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(e){e.callback=null},t.unstable_continueExecution=function(){m||p||(m=!0,P(T))},t.unstable_forceFrameRate=function(e){0>e||125<e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):I=0<e?Math.floor(1e3/e):5},t.unstable_getCurrentPriorityLevel=function(){return d},t.unstable_getFirstCallbackNode=function(){return n(c)},t.unstable_next=function(e){switch(d){case 1:case 2:case 3:var t=3;break;default:t=d}var r=d;d=t;try{return e()}finally{d=r}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var r=d;d=e;try{return t()}finally{d=r}},t.unstable_scheduleCallback=function(e,a,i){var s=t.unstable_now();switch("object"===typeof i&&null!==i?i="number"===typeof(i=i.delay)&&0<i?s+i:s:i=s,e){case 1:var o=-1;break;case 2:o=250;break;case 5:o=1073741823;break;case 4:o=1e4;break;default:o=5e3}return e={id:h++,callback:a,priorityLevel:e,startTime:i,expirationTime:o=i+o,sortIndex:-1},i>s?(e.sortIndex=i,r(u,e),null===n(c)&&e===n(u)&&(g?(y(C),C=-1):g=!0,D(E,i-s))):(e.sortIndex=o,r(c,e),m||p||(m=!0,P(T))),e},t.unstable_shouldYield=R,t.unstable_wrapCallback=function(e){var t=d;return function(){var r=d;d=t;try{return e.apply(this,arguments)}finally{d=r}}}},391:(e,t,r)=>{var n=r(950);t.H=n.createRoot,n.hydrateRoot},579:(e,t,r)=>{e.exports=r(153)},730:(e,t,r)=>{var n=r(43),a=r(853);function i(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,r=1;r<arguments.length;r++)t+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var s=new Set,o={};function l(e,t){c(e,t),c(e+"Capture",t)}function c(e,t){for(o[e]=t,e=0;e<t.length;e++)s.add(t[e])}var u=!("undefined"===typeof window||"undefined"===typeof window.document||"undefined"===typeof window.document.createElement),h=Object.prototype.hasOwnProperty,f=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,d={},p={};function m(e,t,r,n,a,i,s){this.acceptsBooleans=2===t||3===t||4===t,this.attributeName=n,this.attributeNamespace=a,this.mustUseProperty=r,this.propertyName=e,this.type=t,this.sanitizeURL=i,this.removeEmptyString=s}var g={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach((function(e){g[e]=new m(e,0,!1,e,null,!1,!1)})),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach((function(e){var t=e[0];g[t]=new m(t,1,!1,e[1],null,!1,!1)})),["contentEditable","draggable","spellCheck","value"].forEach((function(e){g[e]=new m(e,2,!1,e.toLowerCase(),null,!1,!1)})),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach((function(e){g[e]=new m(e,2,!1,e,null,!1,!1)})),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach((function(e){g[e]=new m(e,3,!1,e.toLowerCase(),null,!1,!1)})),["checked","multiple","muted","selected"].forEach((function(e){g[e]=new m(e,3,!0,e,null,!1,!1)})),["capture","download"].forEach((function(e){g[e]=new m(e,4,!1,e,null,!1,!1)})),["cols","rows","size","span"].forEach((function(e){g[e]=new m(e,6,!1,e,null,!1,!1)})),["rowSpan","start"].forEach((function(e){g[e]=new m(e,5,!1,e.toLowerCase(),null,!1,!1)}));var v=/[\-:]([a-z])/g;function y(e){return e[1].toUpperCase()}function b(e,t,r,n){var a=g.hasOwnProperty(t)?g[t]:null;(null!==a?0!==a.type:n||!(2<t.length)||"o"!==t[0]&&"O"!==t[0]||"n"!==t[1]&&"N"!==t[1])&&(function(e,t,r,n){if(null===t||"undefined"===typeof t||function(e,t,r,n){if(null!==r&&0===r.type)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return!n&&(null!==r?!r.acceptsBooleans:"data-"!==(e=e.toLowerCase().slice(0,5))&&"aria-"!==e);default:return!1}}(e,t,r,n))return!0;if(n)return!1;if(null!==r)switch(r.type){case 3:return!t;case 4:return!1===t;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}(t,r,a,n)&&(r=null),n||null===a?function(e){return!!h.call(p,e)||!h.call(d,e)&&(f.test(e)?p[e]=!0:(d[e]=!0,!1))}(t)&&(null===r?e.removeAttribute(t):e.setAttribute(t,""+r)):a.mustUseProperty?e[a.propertyName]=null===r?3!==a.type&&"":r:(t=a.attributeName,n=a.attributeNamespace,null===r?e.removeAttribute(t):(r=3===(a=a.type)||4===a&&!0===r?"":""+r,n?e.setAttributeNS(n,t,r):e.setAttribute(t,r))))}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach((function(e){var t=e.replace(v,y);g[t]=new m(t,1,!1,e,null,!1,!1)})),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach((function(e){var t=e.replace(v,y);g[t]=new m(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)})),["xml:base","xml:lang","xml:space"].forEach((function(e){var t=e.replace(v,y);g[t]=new m(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)})),["tabIndex","crossOrigin"].forEach((function(e){g[e]=new m(e,1,!1,e.toLowerCase(),null,!1,!1)})),g.xlinkHref=new m("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach((function(e){g[e]=new m(e,1,!1,e.toLowerCase(),null,!0,!0)}));var w=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,E=Symbol.for("react.element"),T=Symbol.for("react.portal"),_=Symbol.for("react.fragment"),S=Symbol.for("react.strict_mode"),k=Symbol.for("react.profiler"),C=Symbol.for("react.provider"),I=Symbol.for("react.context"),A=Symbol.for("react.forward_ref"),R=Symbol.for("react.suspense"),N=Symbol.for("react.suspense_list"),O=Symbol.for("react.memo"),x=Symbol.for("react.lazy");Symbol.for("react.scope"),Symbol.for("react.debug_trace_mode");var P=Symbol.for("react.offscreen");Symbol.for("react.legacy_hidden"),Symbol.for("react.cache"),Symbol.for("react.tracing_marker");var D=Symbol.iterator;function L(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=D&&e[D]||e["@@iterator"])?e:null}var M,F=Object.assign;function U(e){if(void 0===M)try{throw Error()}catch(r){var t=r.stack.trim().match(/\n( *(at )?)/);M=t&&t[1]||""}return"\n"+M+e}var V=!1;function B(e,t){if(!e||V)return"";V=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),"object"===typeof Reflect&&Reflect.construct){try{Reflect.construct(t,[])}catch(c){var n=c}Reflect.construct(e,[],t)}else{try{t.call()}catch(c){n=c}e.call(t.prototype)}else{try{throw Error()}catch(c){n=c}e()}}catch(c){if(c&&n&&"string"===typeof c.stack){for(var a=c.stack.split("\n"),i=n.stack.split("\n"),s=a.length-1,o=i.length-1;1<=s&&0<=o&&a[s]!==i[o];)o--;for(;1<=s&&0<=o;s--,o--)if(a[s]!==i[o]){if(1!==s||1!==o)do{if(s--,0>--o||a[s]!==i[o]){var l="\n"+a[s].replace(" at new "," at ");return e.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",e.displayName)),l}}while(1<=s&&0<=o);break}}}finally{V=!1,Error.prepareStackTrace=r}return(e=e?e.displayName||e.name:"")?U(e):""}function z(e){switch(e.tag){case 5:return U(e.type);case 16:return U("Lazy");case 13:return U("Suspense");case 19:return U("SuspenseList");case 0:case 2:case 15:return e=B(e.type,!1);case 11:return e=B(e.type.render,!1);case 1:return e=B(e.type,!0);default:return""}}function j(e){if(null==e)return null;if("function"===typeof e)return e.displayName||e.name||null;if("string"===typeof e)return e;switch(e){case _:return"Fragment";case T:return"Portal";case k:return"Profiler";case S:return"StrictMode";case R:return"Suspense";case N:return"SuspenseList"}if("object"===typeof e)switch(e.$$typeof){case I:return(e.displayName||"Context")+".Consumer";case C:return(e._context.displayName||"Context")+".Provider";case A:var t=e.render;return(e=e.displayName)||(e=""!==(e=t.displayName||t.name||"")?"ForwardRef("+e+")":"ForwardRef"),e;case O:return null!==(t=e.displayName||null)?t:j(e.type)||"Memo";case x:t=e._payload,e=e._init;try{return j(e(t))}catch(r){}}return null}function H(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=(e=t.render).displayName||e.name||"",t.displayName||(""!==e?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return j(t);case 8:return t===S?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if("function"===typeof t)return t.displayName||t.name||null;if("string"===typeof t)return t}return null}function $(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":case"object":return e;default:return""}}function W(e){var t=e.type;return(e=e.nodeName)&&"input"===e.toLowerCase()&&("checkbox"===t||"radio"===t)}function G(e){e._valueTracker||(e._valueTracker=function(e){var t=W(e)?"checked":"value",r=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),n=""+e[t];if(!e.hasOwnProperty(t)&&"undefined"!==typeof r&&"function"===typeof r.get&&"function"===typeof r.set){var a=r.get,i=r.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return a.call(this)},set:function(e){n=""+e,i.call(this,e)}}),Object.defineProperty(e,t,{enumerable:r.enumerable}),{getValue:function(){return n},setValue:function(e){n=""+e},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}(e))}function K(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var r=t.getValue(),n="";return e&&(n=W(e)?e.checked?"true":"false":e.value),(e=n)!==r&&(t.setValue(e),!0)}function q(e){if("undefined"===typeof(e=e||("undefined"!==typeof document?document:void 0)))return null;try{return e.activeElement||e.body}catch(Br){return e.body}}function X(e,t){var r=t.checked;return F({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:null!=r?r:e._wrapperState.initialChecked})}function Y(e,t){var r=null==t.defaultValue?"":t.defaultValue,n=null!=t.checked?t.checked:t.defaultChecked;r=$(null!=t.value?t.value:r),e._wrapperState={initialChecked:n,initialValue:r,controlled:"checkbox"===t.type||"radio"===t.type?null!=t.checked:null!=t.value}}function Q(e,t){null!=(t=t.checked)&&b(e,"checked",t,!1)}function J(e,t){Q(e,t);var r=$(t.value),n=t.type;if(null!=r)"number"===n?(0===r&&""===e.value||e.value!=r)&&(e.value=""+r):e.value!==""+r&&(e.value=""+r);else if("submit"===n||"reset"===n)return void e.removeAttribute("value");t.hasOwnProperty("value")?ee(e,t.type,r):t.hasOwnProperty("defaultValue")&&ee(e,t.type,$(t.defaultValue)),null==t.checked&&null!=t.defaultChecked&&(e.defaultChecked=!!t.defaultChecked)}function Z(e,t,r){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var n=t.type;if(!("submit"!==n&&"reset"!==n||void 0!==t.value&&null!==t.value))return;t=""+e._wrapperState.initialValue,r||t===e.value||(e.value=t),e.defaultValue=t}""!==(r=e.name)&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,""!==r&&(e.name=r)}function ee(e,t,r){"number"===t&&q(e.ownerDocument)===e||(null==r?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+r&&(e.defaultValue=""+r))}var te=Array.isArray;function re(e,t,r,n){if(e=e.options,t){t={};for(var a=0;a<r.length;a++)t["$"+r[a]]=!0;for(r=0;r<e.length;r++)a=t.hasOwnProperty("$"+e[r].value),e[r].selected!==a&&(e[r].selected=a),a&&n&&(e[r].defaultSelected=!0)}else{for(r=""+$(r),t=null,a=0;a<e.length;a++){if(e[a].value===r)return e[a].selected=!0,void(n&&(e[a].defaultSelected=!0));null!==t||e[a].disabled||(t=e[a])}null!==t&&(t.selected=!0)}}function ne(e,t){if(null!=t.dangerouslySetInnerHTML)throw Error(i(91));return F({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function ae(e,t){var r=t.value;if(null==r){if(r=t.children,t=t.defaultValue,null!=r){if(null!=t)throw Error(i(92));if(te(r)){if(1<r.length)throw Error(i(93));r=r[0]}t=r}null==t&&(t=""),r=t}e._wrapperState={initialValue:$(r)}}function ie(e,t){var r=$(t.value),n=$(t.defaultValue);null!=r&&((r=""+r)!==e.value&&(e.value=r),null==t.defaultValue&&e.defaultValue!==r&&(e.defaultValue=r)),null!=n&&(e.defaultValue=""+n)}function se(e){var t=e.textContent;t===e._wrapperState.initialValue&&""!==t&&null!==t&&(e.value=t)}function oe(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function le(e,t){return null==e||"http://www.w3.org/1999/xhtml"===e?oe(t):"http://www.w3.org/2000/svg"===e&&"foreignObject"===t?"http://www.w3.org/1999/xhtml":e}var ce,ue,he=(ue=function(e,t){if("http://www.w3.org/2000/svg"!==e.namespaceURI||"innerHTML"in e)e.innerHTML=t;else{for((ce=ce||document.createElement("div")).innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=ce.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}},"undefined"!==typeof MSApp&&MSApp.execUnsafeLocalFunction?function(e,t,r,n){MSApp.execUnsafeLocalFunction((function(){return ue(e,t)}))}:ue);function fe(e,t){if(t){var r=e.firstChild;if(r&&r===e.lastChild&&3===r.nodeType)return void(r.nodeValue=t)}e.textContent=t}var de={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},pe=["Webkit","ms","Moz","O"];function me(e,t,r){return null==t||"boolean"===typeof t||""===t?"":r||"number"!==typeof t||0===t||de.hasOwnProperty(e)&&de[e]?(""+t).trim():t+"px"}function ge(e,t){for(var r in e=e.style,t)if(t.hasOwnProperty(r)){var n=0===r.indexOf("--"),a=me(r,t[r],n);"float"===r&&(r="cssFloat"),n?e.setProperty(r,a):e[r]=a}}Object.keys(de).forEach((function(e){pe.forEach((function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),de[t]=de[e]}))}));var ve=F({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function ye(e,t){if(t){if(ve[e]&&(null!=t.children||null!=t.dangerouslySetInnerHTML))throw Error(i(137,e));if(null!=t.dangerouslySetInnerHTML){if(null!=t.children)throw Error(i(60));if("object"!==typeof t.dangerouslySetInnerHTML||!("__html"in t.dangerouslySetInnerHTML))throw Error(i(61))}if(null!=t.style&&"object"!==typeof t.style)throw Error(i(62))}}function be(e,t){if(-1===e.indexOf("-"))return"string"===typeof t.is;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var we=null;function Ee(e){return(e=e.target||e.srcElement||window).correspondingUseElement&&(e=e.correspondingUseElement),3===e.nodeType?e.parentNode:e}var Te=null,_e=null,Se=null;function ke(e){if(e=Ea(e)){if("function"!==typeof Te)throw Error(i(280));var t=e.stateNode;t&&(t=_a(t),Te(e.stateNode,e.type,t))}}function Ce(e){_e?Se?Se.push(e):Se=[e]:_e=e}function Ie(){if(_e){var e=_e,t=Se;if(Se=_e=null,ke(e),t)for(e=0;e<t.length;e++)ke(t[e])}}function Ae(e,t){return e(t)}function Re(){}var Ne=!1;function Oe(e,t,r){if(Ne)return e(t,r);Ne=!0;try{return Ae(e,t,r)}finally{Ne=!1,(null!==_e||null!==Se)&&(Re(),Ie())}}function xe(e,t){var r=e.stateNode;if(null===r)return null;var n=_a(r);if(null===n)return null;r=n[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(n=!("button"===(e=e.type)||"input"===e||"select"===e||"textarea"===e)),e=!n;break e;default:e=!1}if(e)return null;if(r&&"function"!==typeof r)throw Error(i(231,t,typeof r));return r}var Pe=!1;if(u)try{var De={};Object.defineProperty(De,"passive",{get:function(){Pe=!0}}),window.addEventListener("test",De,De),window.removeEventListener("test",De,De)}catch(ue){Pe=!1}function Le(e,t,r,n,a,i,s,o,l){var c=Array.prototype.slice.call(arguments,3);try{t.apply(r,c)}catch(u){this.onError(u)}}var Me=!1,Fe=null,Ue=!1,Ve=null,Be={onError:function(e){Me=!0,Fe=e}};function ze(e,t,r,n,a,i,s,o,l){Me=!1,Fe=null,Le.apply(Be,arguments)}function je(e){var t=e,r=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do{0!==(4098&(t=e).flags)&&(r=t.return),e=t.return}while(e)}return 3===t.tag?r:null}function He(e){if(13===e.tag){var t=e.memoizedState;if(null===t&&(null!==(e=e.alternate)&&(t=e.memoizedState)),null!==t)return t.dehydrated}return null}function $e(e){if(je(e)!==e)throw Error(i(188))}function We(e){return e=function(e){var t=e.alternate;if(!t){if(null===(t=je(e)))throw Error(i(188));return t!==e?null:e}for(var r=e,n=t;;){var a=r.return;if(null===a)break;var s=a.alternate;if(null===s){if(null!==(n=a.return)){r=n;continue}break}if(a.child===s.child){for(s=a.child;s;){if(s===r)return $e(a),e;if(s===n)return $e(a),t;s=s.sibling}throw Error(i(188))}if(r.return!==n.return)r=a,n=s;else{for(var o=!1,l=a.child;l;){if(l===r){o=!0,r=a,n=s;break}if(l===n){o=!0,n=a,r=s;break}l=l.sibling}if(!o){for(l=s.child;l;){if(l===r){o=!0,r=s,n=a;break}if(l===n){o=!0,n=s,r=a;break}l=l.sibling}if(!o)throw Error(i(189))}}if(r.alternate!==n)throw Error(i(190))}if(3!==r.tag)throw Error(i(188));return r.stateNode.current===r?e:t}(e),null!==e?Ge(e):null}function Ge(e){if(5===e.tag||6===e.tag)return e;for(e=e.child;null!==e;){var t=Ge(e);if(null!==t)return t;e=e.sibling}return null}var Ke=a.unstable_scheduleCallback,qe=a.unstable_cancelCallback,Xe=a.unstable_shouldYield,Ye=a.unstable_requestPaint,Qe=a.unstable_now,Je=a.unstable_getCurrentPriorityLevel,Ze=a.unstable_ImmediatePriority,et=a.unstable_UserBlockingPriority,tt=a.unstable_NormalPriority,rt=a.unstable_LowPriority,nt=a.unstable_IdlePriority,at=null,it=null;var st=Math.clz32?Math.clz32:function(e){return e>>>=0,0===e?32:31-(ot(e)/lt|0)|0},ot=Math.log,lt=Math.LN2;var ct=64,ut=4194304;function ht(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return 4194240&e;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return 130023424&e;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function ft(e,t){var r=e.pendingLanes;if(0===r)return 0;var n=0,a=e.suspendedLanes,i=e.pingedLanes,s=268435455&r;if(0!==s){var o=s&~a;0!==o?n=ht(o):0!==(i&=s)&&(n=ht(i))}else 0!==(s=r&~a)?n=ht(s):0!==i&&(n=ht(i));if(0===n)return 0;if(0!==t&&t!==n&&0===(t&a)&&((a=n&-n)>=(i=t&-t)||16===a&&0!==(4194240&i)))return t;if(0!==(4&n)&&(n|=16&r),0!==(t=e.entangledLanes))for(e=e.entanglements,t&=n;0<t;)a=1<<(r=31-st(t)),n|=e[r],t&=~a;return n}function dt(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;default:return-1}}function pt(e){return 0!==(e=-1073741825&e.pendingLanes)?e:1073741824&e?1073741824:0}function mt(){var e=ct;return 0===(4194240&(ct<<=1))&&(ct=64),e}function gt(e){for(var t=[],r=0;31>r;r++)t.push(e);return t}function vt(e,t,r){e.pendingLanes|=t,536870912!==t&&(e.suspendedLanes=0,e.pingedLanes=0),(e=e.eventTimes)[t=31-st(t)]=r}function yt(e,t){var r=e.entangledLanes|=t;for(e=e.entanglements;r;){var n=31-st(r),a=1<<n;a&t|e[n]&t&&(e[n]|=t),r&=~a}}var bt=0;function wt(e){return 1<(e&=-e)?4<e?0!==(268435455&e)?16:536870912:4:1}var Et,Tt,_t,St,kt,Ct=!1,It=[],At=null,Rt=null,Nt=null,Ot=new Map,xt=new Map,Pt=[],Dt="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Lt(e,t){switch(e){case"focusin":case"focusout":At=null;break;case"dragenter":case"dragleave":Rt=null;break;case"mouseover":case"mouseout":Nt=null;break;case"pointerover":case"pointerout":Ot.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":xt.delete(t.pointerId)}}function Mt(e,t,r,n,a,i){return null===e||e.nativeEvent!==i?(e={blockedOn:t,domEventName:r,eventSystemFlags:n,nativeEvent:i,targetContainers:[a]},null!==t&&(null!==(t=Ea(t))&&Tt(t)),e):(e.eventSystemFlags|=n,t=e.targetContainers,null!==a&&-1===t.indexOf(a)&&t.push(a),e)}function Ft(e){var t=wa(e.target);if(null!==t){var r=je(t);if(null!==r)if(13===(t=r.tag)){if(null!==(t=He(r)))return e.blockedOn=t,void kt(e.priority,(function(){_t(r)}))}else if(3===t&&r.stateNode.current.memoizedState.isDehydrated)return void(e.blockedOn=3===r.tag?r.stateNode.containerInfo:null)}e.blockedOn=null}function Ut(e){if(null!==e.blockedOn)return!1;for(var t=e.targetContainers;0<t.length;){var r=Xt(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(null!==r)return null!==(t=Ea(r))&&Tt(t),e.blockedOn=r,!1;var n=new(r=e.nativeEvent).constructor(r.type,r);we=n,r.target.dispatchEvent(n),we=null,t.shift()}return!0}function Vt(e,t,r){Ut(e)&&r.delete(t)}function Bt(){Ct=!1,null!==At&&Ut(At)&&(At=null),null!==Rt&&Ut(Rt)&&(Rt=null),null!==Nt&&Ut(Nt)&&(Nt=null),Ot.forEach(Vt),xt.forEach(Vt)}function zt(e,t){e.blockedOn===t&&(e.blockedOn=null,Ct||(Ct=!0,a.unstable_scheduleCallback(a.unstable_NormalPriority,Bt)))}function jt(e){function t(t){return zt(t,e)}if(0<It.length){zt(It[0],e);for(var r=1;r<It.length;r++){var n=It[r];n.blockedOn===e&&(n.blockedOn=null)}}for(null!==At&&zt(At,e),null!==Rt&&zt(Rt,e),null!==Nt&&zt(Nt,e),Ot.forEach(t),xt.forEach(t),r=0;r<Pt.length;r++)(n=Pt[r]).blockedOn===e&&(n.blockedOn=null);for(;0<Pt.length&&null===(r=Pt[0]).blockedOn;)Ft(r),null===r.blockedOn&&Pt.shift()}var Ht=w.ReactCurrentBatchConfig,$t=!0;function Wt(e,t,r,n){var a=bt,i=Ht.transition;Ht.transition=null;try{bt=1,Kt(e,t,r,n)}finally{bt=a,Ht.transition=i}}function Gt(e,t,r,n){var a=bt,i=Ht.transition;Ht.transition=null;try{bt=4,Kt(e,t,r,n)}finally{bt=a,Ht.transition=i}}function Kt(e,t,r,n){if($t){var a=Xt(e,t,r,n);if(null===a)Gn(e,t,n,qt,r),Lt(e,n);else if(function(e,t,r,n,a){switch(t){case"focusin":return At=Mt(At,e,t,r,n,a),!0;case"dragenter":return Rt=Mt(Rt,e,t,r,n,a),!0;case"mouseover":return Nt=Mt(Nt,e,t,r,n,a),!0;case"pointerover":var i=a.pointerId;return Ot.set(i,Mt(Ot.get(i)||null,e,t,r,n,a)),!0;case"gotpointercapture":return i=a.pointerId,xt.set(i,Mt(xt.get(i)||null,e,t,r,n,a)),!0}return!1}(a,e,t,r,n))n.stopPropagation();else if(Lt(e,n),4&t&&-1<Dt.indexOf(e)){for(;null!==a;){var i=Ea(a);if(null!==i&&Et(i),null===(i=Xt(e,t,r,n))&&Gn(e,t,n,qt,r),i===a)break;a=i}null!==a&&n.stopPropagation()}else Gn(e,t,n,null,r)}}var qt=null;function Xt(e,t,r,n){if(qt=null,null!==(e=wa(e=Ee(n))))if(null===(t=je(e)))e=null;else if(13===(r=t.tag)){if(null!==(e=He(t)))return e;e=null}else if(3===r){if(t.stateNode.current.memoizedState.isDehydrated)return 3===t.tag?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return qt=e,null}function Yt(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Je()){case Ze:return 1;case et:return 4;case tt:case rt:return 16;case nt:return 536870912;default:return 16}default:return 16}}var Qt=null,Jt=null,Zt=null;function er(){if(Zt)return Zt;var e,t,r=Jt,n=r.length,a="value"in Qt?Qt.value:Qt.textContent,i=a.length;for(e=0;e<n&&r[e]===a[e];e++);var s=n-e;for(t=1;t<=s&&r[n-t]===a[i-t];t++);return Zt=a.slice(e,1<t?1-t:void 0)}function tr(e){var t=e.keyCode;return"charCode"in e?0===(e=e.charCode)&&13===t&&(e=13):e=t,10===e&&(e=13),32<=e||13===e?e:0}function rr(){return!0}function nr(){return!1}function ar(e){function t(t,r,n,a,i){for(var s in this._reactName=t,this._targetInst=n,this.type=r,this.nativeEvent=a,this.target=i,this.currentTarget=null,e)e.hasOwnProperty(s)&&(t=e[s],this[s]=t?t(a):a[s]);return this.isDefaultPrevented=(null!=a.defaultPrevented?a.defaultPrevented:!1===a.returnValue)?rr:nr,this.isPropagationStopped=nr,this}return F(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var e=this.nativeEvent;e&&(e.preventDefault?e.preventDefault():"unknown"!==typeof e.returnValue&&(e.returnValue=!1),this.isDefaultPrevented=rr)},stopPropagation:function(){var e=this.nativeEvent;e&&(e.stopPropagation?e.stopPropagation():"unknown"!==typeof e.cancelBubble&&(e.cancelBubble=!0),this.isPropagationStopped=rr)},persist:function(){},isPersistent:rr}),t}var ir,sr,or,lr={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},cr=ar(lr),ur=F({},lr,{view:0,detail:0}),hr=ar(ur),fr=F({},ur,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Sr,button:0,buttons:0,relatedTarget:function(e){return void 0===e.relatedTarget?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==or&&(or&&"mousemove"===e.type?(ir=e.screenX-or.screenX,sr=e.screenY-or.screenY):sr=ir=0,or=e),ir)},movementY:function(e){return"movementY"in e?e.movementY:sr}}),dr=ar(fr),pr=ar(F({},fr,{dataTransfer:0})),mr=ar(F({},ur,{relatedTarget:0})),gr=ar(F({},lr,{animationName:0,elapsedTime:0,pseudoElement:0})),vr=F({},lr,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),yr=ar(vr),br=ar(F({},lr,{data:0})),wr={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Er={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Tr={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function _r(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):!!(e=Tr[e])&&!!t[e]}function Sr(){return _r}var kr=F({},ur,{key:function(e){if(e.key){var t=wr[e.key]||e.key;if("Unidentified"!==t)return t}return"keypress"===e.type?13===(e=tr(e))?"Enter":String.fromCharCode(e):"keydown"===e.type||"keyup"===e.type?Er[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Sr,charCode:function(e){return"keypress"===e.type?tr(e):0},keyCode:function(e){return"keydown"===e.type||"keyup"===e.type?e.keyCode:0},which:function(e){return"keypress"===e.type?tr(e):"keydown"===e.type||"keyup"===e.type?e.keyCode:0}}),Cr=ar(kr),Ir=ar(F({},fr,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0})),Ar=ar(F({},ur,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Sr})),Rr=ar(F({},lr,{propertyName:0,elapsedTime:0,pseudoElement:0})),Nr=F({},fr,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),Or=ar(Nr),xr=[9,13,27,32],Pr=u&&"CompositionEvent"in window,Dr=null;u&&"documentMode"in document&&(Dr=document.documentMode);var Lr=u&&"TextEvent"in window&&!Dr,Mr=u&&(!Pr||Dr&&8<Dr&&11>=Dr),Fr=String.fromCharCode(32),Ur=!1;function Vr(e,t){switch(e){case"keyup":return-1!==xr.indexOf(t.keyCode);case"keydown":return 229!==t.keyCode;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function zr(e){return"object"===typeof(e=e.detail)&&"data"in e?e.data:null}var jr=!1;var Hr={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function $r(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return"input"===t?!!Hr[e.type]:"textarea"===t}function Wr(e,t,r,n){Ce(n),0<(t=qn(t,"onChange")).length&&(r=new cr("onChange","change",null,r,n),e.push({event:r,listeners:t}))}var Gr=null,Kr=null;function qr(e){Bn(e,0)}function Xr(e){if(K(Ta(e)))return e}function Yr(e,t){if("change"===e)return t}var Qr=!1;if(u){var Jr;if(u){var Zr="oninput"in document;if(!Zr){var en=document.createElement("div");en.setAttribute("oninput","return;"),Zr="function"===typeof en.oninput}Jr=Zr}else Jr=!1;Qr=Jr&&(!document.documentMode||9<document.documentMode)}function tn(){Gr&&(Gr.detachEvent("onpropertychange",rn),Kr=Gr=null)}function rn(e){if("value"===e.propertyName&&Xr(Kr)){var t=[];Wr(t,Kr,e,Ee(e)),Oe(qr,t)}}function nn(e,t,r){"focusin"===e?(tn(),Kr=r,(Gr=t).attachEvent("onpropertychange",rn)):"focusout"===e&&tn()}function an(e){if("selectionchange"===e||"keyup"===e||"keydown"===e)return Xr(Kr)}function sn(e,t){if("click"===e)return Xr(t)}function on(e,t){if("input"===e||"change"===e)return Xr(t)}var ln="function"===typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e===1/t)||e!==e&&t!==t};function cn(e,t){if(ln(e,t))return!0;if("object"!==typeof e||null===e||"object"!==typeof t||null===t)return!1;var r=Object.keys(e),n=Object.keys(t);if(r.length!==n.length)return!1;for(n=0;n<r.length;n++){var a=r[n];if(!h.call(t,a)||!ln(e[a],t[a]))return!1}return!0}function un(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function hn(e,t){var r,n=un(e);for(e=0;n;){if(3===n.nodeType){if(r=e+n.textContent.length,e<=t&&r>=t)return{node:n,offset:t-e};e=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=un(n)}}function fn(e,t){return!(!e||!t)&&(e===t||(!e||3!==e.nodeType)&&(t&&3===t.nodeType?fn(e,t.parentNode):"contains"in e?e.contains(t):!!e.compareDocumentPosition&&!!(16&e.compareDocumentPosition(t))))}function dn(){for(var e=window,t=q();t instanceof e.HTMLIFrameElement;){try{var r="string"===typeof t.contentWindow.location.href}catch(n){r=!1}if(!r)break;t=q((e=t.contentWindow).document)}return t}function pn(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&("input"===t&&("text"===e.type||"search"===e.type||"tel"===e.type||"url"===e.type||"password"===e.type)||"textarea"===t||"true"===e.contentEditable)}function mn(e){var t=dn(),r=e.focusedElem,n=e.selectionRange;if(t!==r&&r&&r.ownerDocument&&fn(r.ownerDocument.documentElement,r)){if(null!==n&&pn(r))if(t=n.start,void 0===(e=n.end)&&(e=t),"selectionStart"in r)r.selectionStart=t,r.selectionEnd=Math.min(e,r.value.length);else if((e=(t=r.ownerDocument||document)&&t.defaultView||window).getSelection){e=e.getSelection();var a=r.textContent.length,i=Math.min(n.start,a);n=void 0===n.end?i:Math.min(n.end,a),!e.extend&&i>n&&(a=n,n=i,i=a),a=hn(r,i);var s=hn(r,n);a&&s&&(1!==e.rangeCount||e.anchorNode!==a.node||e.anchorOffset!==a.offset||e.focusNode!==s.node||e.focusOffset!==s.offset)&&((t=t.createRange()).setStart(a.node,a.offset),e.removeAllRanges(),i>n?(e.addRange(t),e.extend(s.node,s.offset)):(t.setEnd(s.node,s.offset),e.addRange(t)))}for(t=[],e=r;e=e.parentNode;)1===e.nodeType&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for("function"===typeof r.focus&&r.focus(),r=0;r<t.length;r++)(e=t[r]).element.scrollLeft=e.left,e.element.scrollTop=e.top}}var gn=u&&"documentMode"in document&&11>=document.documentMode,vn=null,bn=null,wn=null,En=!1;function Tn(e,t,r){var n=r.window===r?r.document:9===r.nodeType?r:r.ownerDocument;En||null==vn||vn!==q(n)||("selectionStart"in(n=vn)&&pn(n)?n={start:n.selectionStart,end:n.selectionEnd}:n={anchorNode:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset},wn&&cn(wn,n)||(wn=n,0<(n=qn(bn,"onSelect")).length&&(t=new cr("onSelect","select",null,t,r),e.push({event:t,listeners:n}),t.target=vn)))}function _n(e,t){var r={};return r[e.toLowerCase()]=t.toLowerCase(),r["Webkit"+e]="webkit"+t,r["Moz"+e]="moz"+t,r}var Sn={animationend:_n("Animation","AnimationEnd"),animationiteration:_n("Animation","AnimationIteration"),animationstart:_n("Animation","AnimationStart"),transitionend:_n("Transition","TransitionEnd")},kn={},Cn={};function In(e){if(kn[e])return kn[e];if(!Sn[e])return e;var t,r=Sn[e];for(t in r)if(r.hasOwnProperty(t)&&t in Cn)return kn[e]=r[t];return e}u&&(Cn=document.createElement("div").style,"AnimationEvent"in window||(delete Sn.animationend.animation,delete Sn.animationiteration.animation,delete Sn.animationstart.animation),"TransitionEvent"in window||delete Sn.transitionend.transition);var An=In("animationend"),Rn=In("animationiteration"),Nn=In("animationstart"),On=In("transitionend"),xn=new Map,Pn="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Dn(e,t){xn.set(e,t),l(t,[e])}for(var Ln=0;Ln<Pn.length;Ln++){var Mn=Pn[Ln];Dn(Mn.toLowerCase(),"on"+(Mn[0].toUpperCase()+Mn.slice(1)))}Dn(An,"onAnimationEnd"),Dn(Rn,"onAnimationIteration"),Dn(Nn,"onAnimationStart"),Dn("dblclick","onDoubleClick"),Dn("focusin","onFocus"),Dn("focusout","onBlur"),Dn(On,"onTransitionEnd"),c("onMouseEnter",["mouseout","mouseover"]),c("onMouseLeave",["mouseout","mouseover"]),c("onPointerEnter",["pointerout","pointerover"]),c("onPointerLeave",["pointerout","pointerover"]),l("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),l("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),l("onBeforeInput",["compositionend","keypress","textInput","paste"]),l("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Fn="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Un=new Set("cancel close invalid load scroll toggle".split(" ").concat(Fn));function Vn(e,t,r){var n=e.type||"unknown-event";e.currentTarget=r,function(e,t,r,n,a,s,o,l,c){if(ze.apply(this,arguments),Me){if(!Me)throw Error(i(198));var u=Fe;Me=!1,Fe=null,Ue||(Ue=!0,Ve=u)}}(n,t,void 0,e),e.currentTarget=null}function Bn(e,t){t=0!==(4&t);for(var r=0;r<e.length;r++){var n=e[r],a=n.event;n=n.listeners;e:{var i=void 0;if(t)for(var s=n.length-1;0<=s;s--){var o=n[s],l=o.instance,c=o.currentTarget;if(o=o.listener,l!==i&&a.isPropagationStopped())break e;Vn(a,o,c),i=l}else for(s=0;s<n.length;s++){if(l=(o=n[s]).instance,c=o.currentTarget,o=o.listener,l!==i&&a.isPropagationStopped())break e;Vn(a,o,c),i=l}}}if(Ue)throw e=Ve,Ue=!1,Ve=null,e}function zn(e,t){var r=t[va];void 0===r&&(r=t[va]=new Set);var n=e+"__bubble";r.has(n)||(Wn(t,e,2,!1),r.add(n))}function jn(e,t,r){var n=0;t&&(n|=4),Wn(r,e,n,t)}var Hn="_reactListening"+Math.random().toString(36).slice(2);function $n(e){if(!e[Hn]){e[Hn]=!0,s.forEach((function(t){"selectionchange"!==t&&(Un.has(t)||jn(t,!1,e),jn(t,!0,e))}));var t=9===e.nodeType?e:e.ownerDocument;null===t||t[Hn]||(t[Hn]=!0,jn("selectionchange",!1,t))}}function Wn(e,t,r,n){switch(Yt(t)){case 1:var a=Wt;break;case 4:a=Gt;break;default:a=Kt}r=a.bind(null,t,r,e),a=void 0,!Pe||"touchstart"!==t&&"touchmove"!==t&&"wheel"!==t||(a=!0),n?void 0!==a?e.addEventListener(t,r,{capture:!0,passive:a}):e.addEventListener(t,r,!0):void 0!==a?e.addEventListener(t,r,{passive:a}):e.addEventListener(t,r,!1)}function Gn(e,t,r,n,a){var i=n;if(0===(1&t)&&0===(2&t)&&null!==n)e:for(;;){if(null===n)return;var s=n.tag;if(3===s||4===s){var o=n.stateNode.containerInfo;if(o===a||8===o.nodeType&&o.parentNode===a)break;if(4===s)for(s=n.return;null!==s;){var l=s.tag;if((3===l||4===l)&&((l=s.stateNode.containerInfo)===a||8===l.nodeType&&l.parentNode===a))return;s=s.return}for(;null!==o;){if(null===(s=wa(o)))return;if(5===(l=s.tag)||6===l){n=i=s;continue e}o=o.parentNode}}n=n.return}Oe((function(){var n=i,a=Ee(r),s=[];e:{var o=xn.get(e);if(void 0!==o){var l=cr,c=e;switch(e){case"keypress":if(0===tr(r))break e;case"keydown":case"keyup":l=Cr;break;case"focusin":c="focus",l=mr;break;case"focusout":c="blur",l=mr;break;case"beforeblur":case"afterblur":l=mr;break;case"click":if(2===r.button)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":l=dr;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":l=pr;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":l=Ar;break;case An:case Rn:case Nn:l=gr;break;case On:l=Rr;break;case"scroll":l=hr;break;case"wheel":l=Or;break;case"copy":case"cut":case"paste":l=yr;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":l=Ir}var u=0!==(4&t),h=!u&&"scroll"===e,f=u?null!==o?o+"Capture":null:o;u=[];for(var d,p=n;null!==p;){var m=(d=p).stateNode;if(5===d.tag&&null!==m&&(d=m,null!==f&&(null!=(m=xe(p,f))&&u.push(Kn(p,m,d)))),h)break;p=p.return}0<u.length&&(o=new l(o,c,null,r,a),s.push({event:o,listeners:u}))}}if(0===(7&t)){if(l="mouseout"===e||"pointerout"===e,(!(o="mouseover"===e||"pointerover"===e)||r===we||!(c=r.relatedTarget||r.fromElement)||!wa(c)&&!c[ga])&&(l||o)&&(o=a.window===a?a:(o=a.ownerDocument)?o.defaultView||o.parentWindow:window,l?(l=n,null!==(c=(c=r.relatedTarget||r.toElement)?wa(c):null)&&(c!==(h=je(c))||5!==c.tag&&6!==c.tag)&&(c=null)):(l=null,c=n),l!==c)){if(u=dr,m="onMouseLeave",f="onMouseEnter",p="mouse","pointerout"!==e&&"pointerover"!==e||(u=Ir,m="onPointerLeave",f="onPointerEnter",p="pointer"),h=null==l?o:Ta(l),d=null==c?o:Ta(c),(o=new u(m,p+"leave",l,r,a)).target=h,o.relatedTarget=d,m=null,wa(a)===n&&((u=new u(f,p+"enter",c,r,a)).target=d,u.relatedTarget=h,m=u),h=m,l&&c)e:{for(f=c,p=0,d=u=l;d;d=Xn(d))p++;for(d=0,m=f;m;m=Xn(m))d++;for(;0<p-d;)u=Xn(u),p--;for(;0<d-p;)f=Xn(f),d--;for(;p--;){if(u===f||null!==f&&u===f.alternate)break e;u=Xn(u),f=Xn(f)}u=null}else u=null;null!==l&&Yn(s,o,l,u,!1),null!==c&&null!==h&&Yn(s,h,c,u,!0)}if("select"===(l=(o=n?Ta(n):window).nodeName&&o.nodeName.toLowerCase())||"input"===l&&"file"===o.type)var g=Yr;else if($r(o))if(Qr)g=on;else{g=an;var v=nn}else(l=o.nodeName)&&"input"===l.toLowerCase()&&("checkbox"===o.type||"radio"===o.type)&&(g=sn);switch(g&&(g=g(e,n))?Wr(s,g,r,a):(v&&v(e,o,n),"focusout"===e&&(v=o._wrapperState)&&v.controlled&&"number"===o.type&&ee(o,"number",o.value)),v=n?Ta(n):window,e){case"focusin":($r(v)||"true"===v.contentEditable)&&(vn=v,bn=n,wn=null);break;case"focusout":wn=bn=vn=null;break;case"mousedown":En=!0;break;case"contextmenu":case"mouseup":case"dragend":En=!1,Tn(s,r,a);break;case"selectionchange":if(gn)break;case"keydown":case"keyup":Tn(s,r,a)}var y;if(Pr)e:{switch(e){case"compositionstart":var b="onCompositionStart";break e;case"compositionend":b="onCompositionEnd";break e;case"compositionupdate":b="onCompositionUpdate";break e}b=void 0}else jr?Vr(e,r)&&(b="onCompositionEnd"):"keydown"===e&&229===r.keyCode&&(b="onCompositionStart");b&&(Mr&&"ko"!==r.locale&&(jr||"onCompositionStart"!==b?"onCompositionEnd"===b&&jr&&(y=er()):(Jt="value"in(Qt=a)?Qt.value:Qt.textContent,jr=!0)),0<(v=qn(n,b)).length&&(b=new br(b,e,null,r,a),s.push({event:b,listeners:v}),y?b.data=y:null!==(y=zr(r))&&(b.data=y))),(y=Lr?function(e,t){switch(e){case"compositionend":return zr(t);case"keypress":return 32!==t.which?null:(Ur=!0,Fr);case"textInput":return(e=t.data)===Fr&&Ur?null:e;default:return null}}(e,r):function(e,t){if(jr)return"compositionend"===e||!Pr&&Vr(e,t)?(e=er(),Zt=Jt=Qt=null,jr=!1,e):null;switch(e){case"paste":default:return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Mr&&"ko"!==t.locale?null:t.data}}(e,r))&&(0<(n=qn(n,"onBeforeInput")).length&&(a=new br("onBeforeInput","beforeinput",null,r,a),s.push({event:a,listeners:n}),a.data=y))}Bn(s,t)}))}function Kn(e,t,r){return{instance:e,listener:t,currentTarget:r}}function qn(e,t){for(var r=t+"Capture",n=[];null!==e;){var a=e,i=a.stateNode;5===a.tag&&null!==i&&(a=i,null!=(i=xe(e,r))&&n.unshift(Kn(e,i,a)),null!=(i=xe(e,t))&&n.push(Kn(e,i,a))),e=e.return}return n}function Xn(e){if(null===e)return null;do{e=e.return}while(e&&5!==e.tag);return e||null}function Yn(e,t,r,n,a){for(var i=t._reactName,s=[];null!==r&&r!==n;){var o=r,l=o.alternate,c=o.stateNode;if(null!==l&&l===n)break;5===o.tag&&null!==c&&(o=c,a?null!=(l=xe(r,i))&&s.unshift(Kn(r,l,o)):a||null!=(l=xe(r,i))&&s.push(Kn(r,l,o))),r=r.return}0!==s.length&&e.push({event:t,listeners:s})}var Qn=/\r\n?/g,Jn=/\u0000|\uFFFD/g;function Zn(e){return("string"===typeof e?e:""+e).replace(Qn,"\n").replace(Jn,"")}function ea(e,t,r){if(t=Zn(t),Zn(e)!==t&&r)throw Error(i(425))}function ta(){}var ra=null,na=null;function aa(e,t){return"textarea"===e||"noscript"===e||"string"===typeof t.children||"number"===typeof t.children||"object"===typeof t.dangerouslySetInnerHTML&&null!==t.dangerouslySetInnerHTML&&null!=t.dangerouslySetInnerHTML.__html}var ia="function"===typeof setTimeout?setTimeout:void 0,sa="function"===typeof clearTimeout?clearTimeout:void 0,oa="function"===typeof Promise?Promise:void 0,la="function"===typeof queueMicrotask?queueMicrotask:"undefined"!==typeof oa?function(e){return oa.resolve(null).then(e).catch(ca)}:ia;function ca(e){setTimeout((function(){throw e}))}function ua(e,t){var r=t,n=0;do{var a=r.nextSibling;if(e.removeChild(r),a&&8===a.nodeType)if("/$"===(r=a.data)){if(0===n)return e.removeChild(a),void jt(t);n--}else"$"!==r&&"$?"!==r&&"$!"!==r||n++;r=a}while(r);jt(t)}function ha(e){for(;null!=e;e=e.nextSibling){var t=e.nodeType;if(1===t||3===t)break;if(8===t){if("$"===(t=e.data)||"$!"===t||"$?"===t)break;if("/$"===t)return null}}return e}function fa(e){e=e.previousSibling;for(var t=0;e;){if(8===e.nodeType){var r=e.data;if("$"===r||"$!"===r||"$?"===r){if(0===t)return e;t--}else"/$"===r&&t++}e=e.previousSibling}return null}var da=Math.random().toString(36).slice(2),pa="__reactFiber$"+da,ma="__reactProps$"+da,ga="__reactContainer$"+da,va="__reactEvents$"+da,ya="__reactListeners$"+da,ba="__reactHandles$"+da;function wa(e){var t=e[pa];if(t)return t;for(var r=e.parentNode;r;){if(t=r[ga]||r[pa]){if(r=t.alternate,null!==t.child||null!==r&&null!==r.child)for(e=fa(e);null!==e;){if(r=e[pa])return r;e=fa(e)}return t}r=(e=r).parentNode}return null}function Ea(e){return!(e=e[pa]||e[ga])||5!==e.tag&&6!==e.tag&&13!==e.tag&&3!==e.tag?null:e}function Ta(e){if(5===e.tag||6===e.tag)return e.stateNode;throw Error(i(33))}function _a(e){return e[ma]||null}var Sa=[],ka=-1;function Ca(e){return{current:e}}function Ia(e){0>ka||(e.current=Sa[ka],Sa[ka]=null,ka--)}function Aa(e,t){ka++,Sa[ka]=e.current,e.current=t}var Ra={},Na=Ca(Ra),Oa=Ca(!1),xa=Ra;function Pa(e,t){var r=e.type.contextTypes;if(!r)return Ra;var n=e.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===t)return n.__reactInternalMemoizedMaskedChildContext;var a,i={};for(a in r)i[a]=t[a];return n&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=i),i}function Da(e){return null!==(e=e.childContextTypes)&&void 0!==e}function La(){Ia(Oa),Ia(Na)}function Ma(e,t,r){if(Na.current!==Ra)throw Error(i(168));Aa(Na,t),Aa(Oa,r)}function Fa(e,t,r){var n=e.stateNode;if(t=t.childContextTypes,"function"!==typeof n.getChildContext)return r;for(var a in n=n.getChildContext())if(!(a in t))throw Error(i(108,H(e)||"Unknown",a));return F({},r,n)}function Ua(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Ra,xa=Na.current,Aa(Na,e),Aa(Oa,Oa.current),!0}function Va(e,t,r){var n=e.stateNode;if(!n)throw Error(i(169));r?(e=Fa(e,t,xa),n.__reactInternalMemoizedMergedChildContext=e,Ia(Oa),Ia(Na),Aa(Na,e)):Ia(Oa),Aa(Oa,r)}var Ba=null,za=!1,ja=!1;function Ha(e){null===Ba?Ba=[e]:Ba.push(e)}function $a(){if(!ja&&null!==Ba){ja=!0;var e=0,t=bt;try{var r=Ba;for(bt=1;e<r.length;e++){var n=r[e];do{n=n(!0)}while(null!==n)}Ba=null,za=!1}catch(a){throw null!==Ba&&(Ba=Ba.slice(e+1)),Ke(Ze,$a),a}finally{bt=t,ja=!1}}return null}var Wa=[],Ga=0,Ka=null,qa=0,Xa=[],Ya=0,Qa=null,Ja=1,Za="";function ei(e,t){Wa[Ga++]=qa,Wa[Ga++]=Ka,Ka=e,qa=t}function ti(e,t,r){Xa[Ya++]=Ja,Xa[Ya++]=Za,Xa[Ya++]=Qa,Qa=e;var n=Ja;e=Za;var a=32-st(n)-1;n&=~(1<<a),r+=1;var i=32-st(t)+a;if(30<i){var s=a-a%5;i=(n&(1<<s)-1).toString(32),n>>=s,a-=s,Ja=1<<32-st(t)+a|r<<a|n,Za=i+e}else Ja=1<<i|r<<a|n,Za=e}function ri(e){null!==e.return&&(ei(e,1),ti(e,1,0))}function ni(e){for(;e===Ka;)Ka=Wa[--Ga],Wa[Ga]=null,qa=Wa[--Ga],Wa[Ga]=null;for(;e===Qa;)Qa=Xa[--Ya],Xa[Ya]=null,Za=Xa[--Ya],Xa[Ya]=null,Ja=Xa[--Ya],Xa[Ya]=null}var ai=null,ii=null,si=!1,oi=null;function li(e,t){var r=Pc(5,null,null,0);r.elementType="DELETED",r.stateNode=t,r.return=e,null===(t=e.deletions)?(e.deletions=[r],e.flags|=16):t.push(r)}function ci(e,t){switch(e.tag){case 5:var r=e.type;return null!==(t=1!==t.nodeType||r.toLowerCase()!==t.nodeName.toLowerCase()?null:t)&&(e.stateNode=t,ai=e,ii=ha(t.firstChild),!0);case 6:return null!==(t=""===e.pendingProps||3!==t.nodeType?null:t)&&(e.stateNode=t,ai=e,ii=null,!0);case 13:return null!==(t=8!==t.nodeType?null:t)&&(r=null!==Qa?{id:Ja,overflow:Za}:null,e.memoizedState={dehydrated:t,treeContext:r,retryLane:1073741824},(r=Pc(18,null,null,0)).stateNode=t,r.return=e,e.child=r,ai=e,ii=null,!0);default:return!1}}function ui(e){return 0!==(1&e.mode)&&0===(128&e.flags)}function hi(e){if(si){var t=ii;if(t){var r=t;if(!ci(e,t)){if(ui(e))throw Error(i(418));t=ha(r.nextSibling);var n=ai;t&&ci(e,t)?li(n,r):(e.flags=-4097&e.flags|2,si=!1,ai=e)}}else{if(ui(e))throw Error(i(418));e.flags=-4097&e.flags|2,si=!1,ai=e}}}function fi(e){for(e=e.return;null!==e&&5!==e.tag&&3!==e.tag&&13!==e.tag;)e=e.return;ai=e}function di(e){if(e!==ai)return!1;if(!si)return fi(e),si=!0,!1;var t;if((t=3!==e.tag)&&!(t=5!==e.tag)&&(t="head"!==(t=e.type)&&"body"!==t&&!aa(e.type,e.memoizedProps)),t&&(t=ii)){if(ui(e))throw pi(),Error(i(418));for(;t;)li(e,t),t=ha(t.nextSibling)}if(fi(e),13===e.tag){if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error(i(317));e:{for(e=e.nextSibling,t=0;e;){if(8===e.nodeType){var r=e.data;if("/$"===r){if(0===t){ii=ha(e.nextSibling);break e}t--}else"$"!==r&&"$!"!==r&&"$?"!==r||t++}e=e.nextSibling}ii=null}}else ii=ai?ha(e.stateNode.nextSibling):null;return!0}function pi(){for(var e=ii;e;)e=ha(e.nextSibling)}function mi(){ii=ai=null,si=!1}function gi(e){null===oi?oi=[e]:oi.push(e)}var vi=w.ReactCurrentBatchConfig;function yi(e,t,r){if(null!==(e=r.ref)&&"function"!==typeof e&&"object"!==typeof e){if(r._owner){if(r=r._owner){if(1!==r.tag)throw Error(i(309));var n=r.stateNode}if(!n)throw Error(i(147,e));var a=n,s=""+e;return null!==t&&null!==t.ref&&"function"===typeof t.ref&&t.ref._stringRef===s?t.ref:(t=function(e){var t=a.refs;null===e?delete t[s]:t[s]=e},t._stringRef=s,t)}if("string"!==typeof e)throw Error(i(284));if(!r._owner)throw Error(i(290,e))}return e}function bi(e,t){throw e=Object.prototype.toString.call(t),Error(i(31,"[object Object]"===e?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function wi(e){return(0,e._init)(e._payload)}function Ei(e){function t(t,r){if(e){var n=t.deletions;null===n?(t.deletions=[r],t.flags|=16):n.push(r)}}function r(r,n){if(!e)return null;for(;null!==n;)t(r,n),n=n.sibling;return null}function n(e,t){for(e=new Map;null!==t;)null!==t.key?e.set(t.key,t):e.set(t.index,t),t=t.sibling;return e}function a(e,t){return(e=Lc(e,t)).index=0,e.sibling=null,e}function s(t,r,n){return t.index=n,e?null!==(n=t.alternate)?(n=n.index)<r?(t.flags|=2,r):n:(t.flags|=2,r):(t.flags|=1048576,r)}function o(t){return e&&null===t.alternate&&(t.flags|=2),t}function l(e,t,r,n){return null===t||6!==t.tag?((t=Vc(r,e.mode,n)).return=e,t):((t=a(t,r)).return=e,t)}function c(e,t,r,n){var i=r.type;return i===_?h(e,t,r.props.children,n,r.key):null!==t&&(t.elementType===i||"object"===typeof i&&null!==i&&i.$$typeof===x&&wi(i)===t.type)?((n=a(t,r.props)).ref=yi(e,t,r),n.return=e,n):((n=Mc(r.type,r.key,r.props,null,e.mode,n)).ref=yi(e,t,r),n.return=e,n)}function u(e,t,r,n){return null===t||4!==t.tag||t.stateNode.containerInfo!==r.containerInfo||t.stateNode.implementation!==r.implementation?((t=Bc(r,e.mode,n)).return=e,t):((t=a(t,r.children||[])).return=e,t)}function h(e,t,r,n,i){return null===t||7!==t.tag?((t=Fc(r,e.mode,n,i)).return=e,t):((t=a(t,r)).return=e,t)}function f(e,t,r){if("string"===typeof t&&""!==t||"number"===typeof t)return(t=Vc(""+t,e.mode,r)).return=e,t;if("object"===typeof t&&null!==t){switch(t.$$typeof){case E:return(r=Mc(t.type,t.key,t.props,null,e.mode,r)).ref=yi(e,null,t),r.return=e,r;case T:return(t=Bc(t,e.mode,r)).return=e,t;case x:return f(e,(0,t._init)(t._payload),r)}if(te(t)||L(t))return(t=Fc(t,e.mode,r,null)).return=e,t;bi(e,t)}return null}function d(e,t,r,n){var a=null!==t?t.key:null;if("string"===typeof r&&""!==r||"number"===typeof r)return null!==a?null:l(e,t,""+r,n);if("object"===typeof r&&null!==r){switch(r.$$typeof){case E:return r.key===a?c(e,t,r,n):null;case T:return r.key===a?u(e,t,r,n):null;case x:return d(e,t,(a=r._init)(r._payload),n)}if(te(r)||L(r))return null!==a?null:h(e,t,r,n,null);bi(e,r)}return null}function p(e,t,r,n,a){if("string"===typeof n&&""!==n||"number"===typeof n)return l(t,e=e.get(r)||null,""+n,a);if("object"===typeof n&&null!==n){switch(n.$$typeof){case E:return c(t,e=e.get(null===n.key?r:n.key)||null,n,a);case T:return u(t,e=e.get(null===n.key?r:n.key)||null,n,a);case x:return p(e,t,r,(0,n._init)(n._payload),a)}if(te(n)||L(n))return h(t,e=e.get(r)||null,n,a,null);bi(t,n)}return null}function m(a,i,o,l){for(var c=null,u=null,h=i,m=i=0,g=null;null!==h&&m<o.length;m++){h.index>m?(g=h,h=null):g=h.sibling;var v=d(a,h,o[m],l);if(null===v){null===h&&(h=g);break}e&&h&&null===v.alternate&&t(a,h),i=s(v,i,m),null===u?c=v:u.sibling=v,u=v,h=g}if(m===o.length)return r(a,h),si&&ei(a,m),c;if(null===h){for(;m<o.length;m++)null!==(h=f(a,o[m],l))&&(i=s(h,i,m),null===u?c=h:u.sibling=h,u=h);return si&&ei(a,m),c}for(h=n(a,h);m<o.length;m++)null!==(g=p(h,a,m,o[m],l))&&(e&&null!==g.alternate&&h.delete(null===g.key?m:g.key),i=s(g,i,m),null===u?c=g:u.sibling=g,u=g);return e&&h.forEach((function(e){return t(a,e)})),si&&ei(a,m),c}function g(a,o,l,c){var u=L(l);if("function"!==typeof u)throw Error(i(150));if(null==(l=u.call(l)))throw Error(i(151));for(var h=u=null,m=o,g=o=0,v=null,y=l.next();null!==m&&!y.done;g++,y=l.next()){m.index>g?(v=m,m=null):v=m.sibling;var b=d(a,m,y.value,c);if(null===b){null===m&&(m=v);break}e&&m&&null===b.alternate&&t(a,m),o=s(b,o,g),null===h?u=b:h.sibling=b,h=b,m=v}if(y.done)return r(a,m),si&&ei(a,g),u;if(null===m){for(;!y.done;g++,y=l.next())null!==(y=f(a,y.value,c))&&(o=s(y,o,g),null===h?u=y:h.sibling=y,h=y);return si&&ei(a,g),u}for(m=n(a,m);!y.done;g++,y=l.next())null!==(y=p(m,a,g,y.value,c))&&(e&&null!==y.alternate&&m.delete(null===y.key?g:y.key),o=s(y,o,g),null===h?u=y:h.sibling=y,h=y);return e&&m.forEach((function(e){return t(a,e)})),si&&ei(a,g),u}return function e(n,i,s,l){if("object"===typeof s&&null!==s&&s.type===_&&null===s.key&&(s=s.props.children),"object"===typeof s&&null!==s){switch(s.$$typeof){case E:e:{for(var c=s.key,u=i;null!==u;){if(u.key===c){if((c=s.type)===_){if(7===u.tag){r(n,u.sibling),(i=a(u,s.props.children)).return=n,n=i;break e}}else if(u.elementType===c||"object"===typeof c&&null!==c&&c.$$typeof===x&&wi(c)===u.type){r(n,u.sibling),(i=a(u,s.props)).ref=yi(n,u,s),i.return=n,n=i;break e}r(n,u);break}t(n,u),u=u.sibling}s.type===_?((i=Fc(s.props.children,n.mode,l,s.key)).return=n,n=i):((l=Mc(s.type,s.key,s.props,null,n.mode,l)).ref=yi(n,i,s),l.return=n,n=l)}return o(n);case T:e:{for(u=s.key;null!==i;){if(i.key===u){if(4===i.tag&&i.stateNode.containerInfo===s.containerInfo&&i.stateNode.implementation===s.implementation){r(n,i.sibling),(i=a(i,s.children||[])).return=n,n=i;break e}r(n,i);break}t(n,i),i=i.sibling}(i=Bc(s,n.mode,l)).return=n,n=i}return o(n);case x:return e(n,i,(u=s._init)(s._payload),l)}if(te(s))return m(n,i,s,l);if(L(s))return g(n,i,s,l);bi(n,s)}return"string"===typeof s&&""!==s||"number"===typeof s?(s=""+s,null!==i&&6===i.tag?(r(n,i.sibling),(i=a(i,s)).return=n,n=i):(r(n,i),(i=Vc(s,n.mode,l)).return=n,n=i),o(n)):r(n,i)}}var Ti=Ei(!0),_i=Ei(!1),Si=Ca(null),ki=null,Ci=null,Ii=null;function Ai(){Ii=Ci=ki=null}function Ri(e){var t=Si.current;Ia(Si),e._currentValue=t}function Ni(e,t,r){for(;null!==e;){var n=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,null!==n&&(n.childLanes|=t)):null!==n&&(n.childLanes&t)!==t&&(n.childLanes|=t),e===r)break;e=e.return}}function Oi(e,t){ki=e,Ii=Ci=null,null!==(e=e.dependencies)&&null!==e.firstContext&&(0!==(e.lanes&t)&&(Eo=!0),e.firstContext=null)}function xi(e){var t=e._currentValue;if(Ii!==e)if(e={context:e,memoizedValue:t,next:null},null===Ci){if(null===ki)throw Error(i(308));Ci=e,ki.dependencies={lanes:0,firstContext:e}}else Ci=Ci.next=e;return t}var Pi=null;function Di(e){null===Pi?Pi=[e]:Pi.push(e)}function Li(e,t,r,n){var a=t.interleaved;return null===a?(r.next=r,Di(t)):(r.next=a.next,a.next=r),t.interleaved=r,Mi(e,n)}function Mi(e,t){e.lanes|=t;var r=e.alternate;for(null!==r&&(r.lanes|=t),r=e,e=e.return;null!==e;)e.childLanes|=t,null!==(r=e.alternate)&&(r.childLanes|=t),r=e,e=e.return;return 3===r.tag?r.stateNode:null}var Fi=!1;function Ui(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Vi(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Bi(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function zi(e,t,r){var n=e.updateQueue;if(null===n)return null;if(n=n.shared,0!==(2&Nl)){var a=n.pending;return null===a?t.next=t:(t.next=a.next,a.next=t),n.pending=t,Mi(e,r)}return null===(a=n.interleaved)?(t.next=t,Di(n)):(t.next=a.next,a.next=t),n.interleaved=t,Mi(e,r)}function ji(e,t,r){if(null!==(t=t.updateQueue)&&(t=t.shared,0!==(4194240&r))){var n=t.lanes;r|=n&=e.pendingLanes,t.lanes=r,yt(e,r)}}function Hi(e,t){var r=e.updateQueue,n=e.alternate;if(null!==n&&r===(n=n.updateQueue)){var a=null,i=null;if(null!==(r=r.firstBaseUpdate)){do{var s={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};null===i?a=i=s:i=i.next=s,r=r.next}while(null!==r);null===i?a=i=t:i=i.next=t}else a=i=t;return r={baseState:n.baseState,firstBaseUpdate:a,lastBaseUpdate:i,shared:n.shared,effects:n.effects},void(e.updateQueue=r)}null===(e=r.lastBaseUpdate)?r.firstBaseUpdate=t:e.next=t,r.lastBaseUpdate=t}function $i(e,t,r,n){var a=e.updateQueue;Fi=!1;var i=a.firstBaseUpdate,s=a.lastBaseUpdate,o=a.shared.pending;if(null!==o){a.shared.pending=null;var l=o,c=l.next;l.next=null,null===s?i=c:s.next=c,s=l;var u=e.alternate;null!==u&&((o=(u=u.updateQueue).lastBaseUpdate)!==s&&(null===o?u.firstBaseUpdate=c:o.next=c,u.lastBaseUpdate=l))}if(null!==i){var h=a.baseState;for(s=0,u=c=l=null,o=i;;){var f=o.lane,d=o.eventTime;if((n&f)===f){null!==u&&(u=u.next={eventTime:d,lane:0,tag:o.tag,payload:o.payload,callback:o.callback,next:null});e:{var p=e,m=o;switch(f=t,d=r,m.tag){case 1:if("function"===typeof(p=m.payload)){h=p.call(d,h,f);break e}h=p;break e;case 3:p.flags=-65537&p.flags|128;case 0:if(null===(f="function"===typeof(p=m.payload)?p.call(d,h,f):p)||void 0===f)break e;h=F({},h,f);break e;case 2:Fi=!0}}null!==o.callback&&0!==o.lane&&(e.flags|=64,null===(f=a.effects)?a.effects=[o]:f.push(o))}else d={eventTime:d,lane:f,tag:o.tag,payload:o.payload,callback:o.callback,next:null},null===u?(c=u=d,l=h):u=u.next=d,s|=f;if(null===(o=o.next)){if(null===(o=a.shared.pending))break;o=(f=o).next,f.next=null,a.lastBaseUpdate=f,a.shared.pending=null}}if(null===u&&(l=h),a.baseState=l,a.firstBaseUpdate=c,a.lastBaseUpdate=u,null!==(t=a.shared.interleaved)){a=t;do{s|=a.lane,a=a.next}while(a!==t)}else null===i&&(a.shared.lanes=0);Ul|=s,e.lanes=s,e.memoizedState=h}}function Wi(e,t,r){if(e=t.effects,t.effects=null,null!==e)for(t=0;t<e.length;t++){var n=e[t],a=n.callback;if(null!==a){if(n.callback=null,n=r,"function"!==typeof a)throw Error(i(191,a));a.call(n)}}}var Gi={},Ki=Ca(Gi),qi=Ca(Gi),Xi=Ca(Gi);function Yi(e){if(e===Gi)throw Error(i(174));return e}function Qi(e,t){switch(Aa(Xi,t),Aa(qi,e),Aa(Ki,Gi),e=t.nodeType){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:le(null,"");break;default:t=le(t=(e=8===e?t.parentNode:t).namespaceURI||null,e=e.tagName)}Ia(Ki),Aa(Ki,t)}function Ji(){Ia(Ki),Ia(qi),Ia(Xi)}function Zi(e){Yi(Xi.current);var t=Yi(Ki.current),r=le(t,e.type);t!==r&&(Aa(qi,e),Aa(Ki,r))}function es(e){qi.current===e&&(Ia(Ki),Ia(qi))}var ts=Ca(0);function rs(e){for(var t=e;null!==t;){if(13===t.tag){var r=t.memoizedState;if(null!==r&&(null===(r=r.dehydrated)||"$?"===r.data||"$!"===r.data))return t}else if(19===t.tag&&void 0!==t.memoizedProps.revealOrder){if(0!==(128&t.flags))return t}else if(null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var ns=[];function as(){for(var e=0;e<ns.length;e++)ns[e]._workInProgressVersionPrimary=null;ns.length=0}var is=w.ReactCurrentDispatcher,ss=w.ReactCurrentBatchConfig,os=0,ls=null,cs=null,us=null,hs=!1,fs=!1,ds=0,ps=0;function ms(){throw Error(i(321))}function gs(e,t){if(null===t)return!1;for(var r=0;r<t.length&&r<e.length;r++)if(!ln(e[r],t[r]))return!1;return!0}function vs(e,t,r,n,a,s){if(os=s,ls=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,is.current=null===e||null===e.memoizedState?eo:to,e=r(n,a),fs){s=0;do{if(fs=!1,ds=0,25<=s)throw Error(i(301));s+=1,us=cs=null,t.updateQueue=null,is.current=ro,e=r(n,a)}while(fs)}if(is.current=Zs,t=null!==cs&&null!==cs.next,os=0,us=cs=ls=null,hs=!1,t)throw Error(i(300));return e}function ys(){var e=0!==ds;return ds=0,e}function bs(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===us?ls.memoizedState=us=e:us=us.next=e,us}function ws(){if(null===cs){var e=ls.alternate;e=null!==e?e.memoizedState:null}else e=cs.next;var t=null===us?ls.memoizedState:us.next;if(null!==t)us=t,cs=e;else{if(null===e)throw Error(i(310));e={memoizedState:(cs=e).memoizedState,baseState:cs.baseState,baseQueue:cs.baseQueue,queue:cs.queue,next:null},null===us?ls.memoizedState=us=e:us=us.next=e}return us}function Es(e,t){return"function"===typeof t?t(e):t}function Ts(e){var t=ws(),r=t.queue;if(null===r)throw Error(i(311));r.lastRenderedReducer=e;var n=cs,a=n.baseQueue,s=r.pending;if(null!==s){if(null!==a){var o=a.next;a.next=s.next,s.next=o}n.baseQueue=a=s,r.pending=null}if(null!==a){s=a.next,n=n.baseState;var l=o=null,c=null,u=s;do{var h=u.lane;if((os&h)===h)null!==c&&(c=c.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),n=u.hasEagerState?u.eagerState:e(n,u.action);else{var f={lane:h,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};null===c?(l=c=f,o=n):c=c.next=f,ls.lanes|=h,Ul|=h}u=u.next}while(null!==u&&u!==s);null===c?o=n:c.next=l,ln(n,t.memoizedState)||(Eo=!0),t.memoizedState=n,t.baseState=o,t.baseQueue=c,r.lastRenderedState=n}if(null!==(e=r.interleaved)){a=e;do{s=a.lane,ls.lanes|=s,Ul|=s,a=a.next}while(a!==e)}else null===a&&(r.lanes=0);return[t.memoizedState,r.dispatch]}function _s(e){var t=ws(),r=t.queue;if(null===r)throw Error(i(311));r.lastRenderedReducer=e;var n=r.dispatch,a=r.pending,s=t.memoizedState;if(null!==a){r.pending=null;var o=a=a.next;do{s=e(s,o.action),o=o.next}while(o!==a);ln(s,t.memoizedState)||(Eo=!0),t.memoizedState=s,null===t.baseQueue&&(t.baseState=s),r.lastRenderedState=s}return[s,n]}function Ss(){}function ks(e,t){var r=ls,n=ws(),a=t(),s=!ln(n.memoizedState,a);if(s&&(n.memoizedState=a,Eo=!0),n=n.queue,Fs(As.bind(null,r,n,e),[e]),n.getSnapshot!==t||s||null!==us&&1&us.memoizedState.tag){if(r.flags|=2048,xs(9,Is.bind(null,r,n,a,t),void 0,null),null===Ol)throw Error(i(349));0!==(30&os)||Cs(r,t,a)}return a}function Cs(e,t,r){e.flags|=16384,e={getSnapshot:t,value:r},null===(t=ls.updateQueue)?(t={lastEffect:null,stores:null},ls.updateQueue=t,t.stores=[e]):null===(r=t.stores)?t.stores=[e]:r.push(e)}function Is(e,t,r,n){t.value=r,t.getSnapshot=n,Rs(t)&&Ns(e)}function As(e,t,r){return r((function(){Rs(t)&&Ns(e)}))}function Rs(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!ln(e,r)}catch(n){return!0}}function Ns(e){var t=Mi(e,1);null!==t&&ac(t,e,1,-1)}function Os(e){var t=bs();return"function"===typeof e&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Es,lastRenderedState:e},t.queue=e,e=e.dispatch=Xs.bind(null,ls,e),[t.memoizedState,e]}function xs(e,t,r,n){return e={tag:e,create:t,destroy:r,deps:n,next:null},null===(t=ls.updateQueue)?(t={lastEffect:null,stores:null},ls.updateQueue=t,t.lastEffect=e.next=e):null===(r=t.lastEffect)?t.lastEffect=e.next=e:(n=r.next,r.next=e,e.next=n,t.lastEffect=e),e}function Ps(){return ws().memoizedState}function Ds(e,t,r,n){var a=bs();ls.flags|=e,a.memoizedState=xs(1|t,r,void 0,void 0===n?null:n)}function Ls(e,t,r,n){var a=ws();n=void 0===n?null:n;var i=void 0;if(null!==cs){var s=cs.memoizedState;if(i=s.destroy,null!==n&&gs(n,s.deps))return void(a.memoizedState=xs(t,r,i,n))}ls.flags|=e,a.memoizedState=xs(1|t,r,i,n)}function Ms(e,t){return Ds(8390656,8,e,t)}function Fs(e,t){return Ls(2048,8,e,t)}function Us(e,t){return Ls(4,2,e,t)}function Vs(e,t){return Ls(4,4,e,t)}function Bs(e,t){return"function"===typeof t?(e=e(),t(e),function(){t(null)}):null!==t&&void 0!==t?(e=e(),t.current=e,function(){t.current=null}):void 0}function zs(e,t,r){return r=null!==r&&void 0!==r?r.concat([e]):null,Ls(4,4,Bs.bind(null,t,e),r)}function js(){}function Hs(e,t){var r=ws();t=void 0===t?null:t;var n=r.memoizedState;return null!==n&&null!==t&&gs(t,n[1])?n[0]:(r.memoizedState=[e,t],e)}function $s(e,t){var r=ws();t=void 0===t?null:t;var n=r.memoizedState;return null!==n&&null!==t&&gs(t,n[1])?n[0]:(e=e(),r.memoizedState=[e,t],e)}function Ws(e,t,r){return 0===(21&os)?(e.baseState&&(e.baseState=!1,Eo=!0),e.memoizedState=r):(ln(r,t)||(r=mt(),ls.lanes|=r,Ul|=r,e.baseState=!0),t)}function Gs(e,t){var r=bt;bt=0!==r&&4>r?r:4,e(!0);var n=ss.transition;ss.transition={};try{e(!1),t()}finally{bt=r,ss.transition=n}}function Ks(){return ws().memoizedState}function qs(e,t,r){var n=nc(e);if(r={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null},Ys(e))Qs(t,r);else if(null!==(r=Li(e,t,r,n))){ac(r,e,n,rc()),Js(r,t,n)}}function Xs(e,t,r){var n=nc(e),a={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null};if(Ys(e))Qs(t,a);else{var i=e.alternate;if(0===e.lanes&&(null===i||0===i.lanes)&&null!==(i=t.lastRenderedReducer))try{var s=t.lastRenderedState,o=i(s,r);if(a.hasEagerState=!0,a.eagerState=o,ln(o,s)){var l=t.interleaved;return null===l?(a.next=a,Di(t)):(a.next=l.next,l.next=a),void(t.interleaved=a)}}catch(c){}null!==(r=Li(e,t,a,n))&&(ac(r,e,n,a=rc()),Js(r,t,n))}}function Ys(e){var t=e.alternate;return e===ls||null!==t&&t===ls}function Qs(e,t){fs=hs=!0;var r=e.pending;null===r?t.next=t:(t.next=r.next,r.next=t),e.pending=t}function Js(e,t,r){if(0!==(4194240&r)){var n=t.lanes;r|=n&=e.pendingLanes,t.lanes=r,yt(e,r)}}var Zs={readContext:xi,useCallback:ms,useContext:ms,useEffect:ms,useImperativeHandle:ms,useInsertionEffect:ms,useLayoutEffect:ms,useMemo:ms,useReducer:ms,useRef:ms,useState:ms,useDebugValue:ms,useDeferredValue:ms,useTransition:ms,useMutableSource:ms,useSyncExternalStore:ms,useId:ms,unstable_isNewReconciler:!1},eo={readContext:xi,useCallback:function(e,t){return bs().memoizedState=[e,void 0===t?null:t],e},useContext:xi,useEffect:Ms,useImperativeHandle:function(e,t,r){return r=null!==r&&void 0!==r?r.concat([e]):null,Ds(4194308,4,Bs.bind(null,t,e),r)},useLayoutEffect:function(e,t){return Ds(4194308,4,e,t)},useInsertionEffect:function(e,t){return Ds(4,2,e,t)},useMemo:function(e,t){var r=bs();return t=void 0===t?null:t,e=e(),r.memoizedState=[e,t],e},useReducer:function(e,t,r){var n=bs();return t=void 0!==r?r(t):t,n.memoizedState=n.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},n.queue=e,e=e.dispatch=qs.bind(null,ls,e),[n.memoizedState,e]},useRef:function(e){return e={current:e},bs().memoizedState=e},useState:Os,useDebugValue:js,useDeferredValue:function(e){return bs().memoizedState=e},useTransition:function(){var e=Os(!1),t=e[0];return e=Gs.bind(null,e[1]),bs().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,r){var n=ls,a=bs();if(si){if(void 0===r)throw Error(i(407));r=r()}else{if(r=t(),null===Ol)throw Error(i(349));0!==(30&os)||Cs(n,t,r)}a.memoizedState=r;var s={value:r,getSnapshot:t};return a.queue=s,Ms(As.bind(null,n,s,e),[e]),n.flags|=2048,xs(9,Is.bind(null,n,s,r,t),void 0,null),r},useId:function(){var e=bs(),t=Ol.identifierPrefix;if(si){var r=Za;t=":"+t+"R"+(r=(Ja&~(1<<32-st(Ja)-1)).toString(32)+r),0<(r=ds++)&&(t+="H"+r.toString(32)),t+=":"}else t=":"+t+"r"+(r=ps++).toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},to={readContext:xi,useCallback:Hs,useContext:xi,useEffect:Fs,useImperativeHandle:zs,useInsertionEffect:Us,useLayoutEffect:Vs,useMemo:$s,useReducer:Ts,useRef:Ps,useState:function(){return Ts(Es)},useDebugValue:js,useDeferredValue:function(e){return Ws(ws(),cs.memoizedState,e)},useTransition:function(){return[Ts(Es)[0],ws().memoizedState]},useMutableSource:Ss,useSyncExternalStore:ks,useId:Ks,unstable_isNewReconciler:!1},ro={readContext:xi,useCallback:Hs,useContext:xi,useEffect:Fs,useImperativeHandle:zs,useInsertionEffect:Us,useLayoutEffect:Vs,useMemo:$s,useReducer:_s,useRef:Ps,useState:function(){return _s(Es)},useDebugValue:js,useDeferredValue:function(e){var t=ws();return null===cs?t.memoizedState=e:Ws(t,cs.memoizedState,e)},useTransition:function(){return[_s(Es)[0],ws().memoizedState]},useMutableSource:Ss,useSyncExternalStore:ks,useId:Ks,unstable_isNewReconciler:!1};function no(e,t){if(e&&e.defaultProps){for(var r in t=F({},t),e=e.defaultProps)void 0===t[r]&&(t[r]=e[r]);return t}return t}function ao(e,t,r,n){r=null===(r=r(n,t=e.memoizedState))||void 0===r?t:F({},t,r),e.memoizedState=r,0===e.lanes&&(e.updateQueue.baseState=r)}var io={isMounted:function(e){return!!(e=e._reactInternals)&&je(e)===e},enqueueSetState:function(e,t,r){e=e._reactInternals;var n=rc(),a=nc(e),i=Bi(n,a);i.payload=t,void 0!==r&&null!==r&&(i.callback=r),null!==(t=zi(e,i,a))&&(ac(t,e,a,n),ji(t,e,a))},enqueueReplaceState:function(e,t,r){e=e._reactInternals;var n=rc(),a=nc(e),i=Bi(n,a);i.tag=1,i.payload=t,void 0!==r&&null!==r&&(i.callback=r),null!==(t=zi(e,i,a))&&(ac(t,e,a,n),ji(t,e,a))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var r=rc(),n=nc(e),a=Bi(r,n);a.tag=2,void 0!==t&&null!==t&&(a.callback=t),null!==(t=zi(e,a,n))&&(ac(t,e,n,r),ji(t,e,n))}};function so(e,t,r,n,a,i,s){return"function"===typeof(e=e.stateNode).shouldComponentUpdate?e.shouldComponentUpdate(n,i,s):!t.prototype||!t.prototype.isPureReactComponent||(!cn(r,n)||!cn(a,i))}function oo(e,t,r){var n=!1,a=Ra,i=t.contextType;return"object"===typeof i&&null!==i?i=xi(i):(a=Da(t)?xa:Na.current,i=(n=null!==(n=t.contextTypes)&&void 0!==n)?Pa(e,a):Ra),t=new t(r,i),e.memoizedState=null!==t.state&&void 0!==t.state?t.state:null,t.updater=io,e.stateNode=t,t._reactInternals=e,n&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=a,e.__reactInternalMemoizedMaskedChildContext=i),t}function lo(e,t,r,n){e=t.state,"function"===typeof t.componentWillReceiveProps&&t.componentWillReceiveProps(r,n),"function"===typeof t.UNSAFE_componentWillReceiveProps&&t.UNSAFE_componentWillReceiveProps(r,n),t.state!==e&&io.enqueueReplaceState(t,t.state,null)}function co(e,t,r,n){var a=e.stateNode;a.props=r,a.state=e.memoizedState,a.refs={},Ui(e);var i=t.contextType;"object"===typeof i&&null!==i?a.context=xi(i):(i=Da(t)?xa:Na.current,a.context=Pa(e,i)),a.state=e.memoizedState,"function"===typeof(i=t.getDerivedStateFromProps)&&(ao(e,t,i,r),a.state=e.memoizedState),"function"===typeof t.getDerivedStateFromProps||"function"===typeof a.getSnapshotBeforeUpdate||"function"!==typeof a.UNSAFE_componentWillMount&&"function"!==typeof a.componentWillMount||(t=a.state,"function"===typeof a.componentWillMount&&a.componentWillMount(),"function"===typeof a.UNSAFE_componentWillMount&&a.UNSAFE_componentWillMount(),t!==a.state&&io.enqueueReplaceState(a,a.state,null),$i(e,r,a,n),a.state=e.memoizedState),"function"===typeof a.componentDidMount&&(e.flags|=4194308)}function uo(e,t){try{var r="",n=t;do{r+=z(n),n=n.return}while(n);var a=r}catch(i){a="\nError generating stack: "+i.message+"\n"+i.stack}return{value:e,source:t,stack:a,digest:null}}function ho(e,t,r){return{value:e,source:null,stack:null!=r?r:null,digest:null!=t?t:null}}function fo(e,t){try{console.error(t.value)}catch(r){setTimeout((function(){throw r}))}}var po="function"===typeof WeakMap?WeakMap:Map;function mo(e,t,r){(r=Bi(-1,r)).tag=3,r.payload={element:null};var n=t.value;return r.callback=function(){Gl||(Gl=!0,Kl=n),fo(0,t)},r}function go(e,t,r){(r=Bi(-1,r)).tag=3;var n=e.type.getDerivedStateFromError;if("function"===typeof n){var a=t.value;r.payload=function(){return n(a)},r.callback=function(){fo(0,t)}}var i=e.stateNode;return null!==i&&"function"===typeof i.componentDidCatch&&(r.callback=function(){fo(0,t),"function"!==typeof n&&(null===ql?ql=new Set([this]):ql.add(this));var e=t.stack;this.componentDidCatch(t.value,{componentStack:null!==e?e:""})}),r}function vo(e,t,r){var n=e.pingCache;if(null===n){n=e.pingCache=new po;var a=new Set;n.set(t,a)}else void 0===(a=n.get(t))&&(a=new Set,n.set(t,a));a.has(r)||(a.add(r),e=Ic.bind(null,e,t,r),t.then(e,e))}function yo(e){do{var t;if((t=13===e.tag)&&(t=null===(t=e.memoizedState)||null!==t.dehydrated),t)return e;e=e.return}while(null!==e);return null}function bo(e,t,r,n,a){return 0===(1&e.mode)?(e===t?e.flags|=65536:(e.flags|=128,r.flags|=131072,r.flags&=-52805,1===r.tag&&(null===r.alternate?r.tag=17:((t=Bi(-1,1)).tag=2,zi(r,t,1))),r.lanes|=1),e):(e.flags|=65536,e.lanes=a,e)}var wo=w.ReactCurrentOwner,Eo=!1;function To(e,t,r,n){t.child=null===e?_i(t,null,r,n):Ti(t,e.child,r,n)}function _o(e,t,r,n,a){r=r.render;var i=t.ref;return Oi(t,a),n=vs(e,t,r,n,i,a),r=ys(),null===e||Eo?(si&&r&&ri(t),t.flags|=1,To(e,t,n,a),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~a,Go(e,t,a))}function So(e,t,r,n,a){if(null===e){var i=r.type;return"function"!==typeof i||Dc(i)||void 0!==i.defaultProps||null!==r.compare||void 0!==r.defaultProps?((e=Mc(r.type,null,n,t,t.mode,a)).ref=t.ref,e.return=t,t.child=e):(t.tag=15,t.type=i,ko(e,t,i,n,a))}if(i=e.child,0===(e.lanes&a)){var s=i.memoizedProps;if((r=null!==(r=r.compare)?r:cn)(s,n)&&e.ref===t.ref)return Go(e,t,a)}return t.flags|=1,(e=Lc(i,n)).ref=t.ref,e.return=t,t.child=e}function ko(e,t,r,n,a){if(null!==e){var i=e.memoizedProps;if(cn(i,n)&&e.ref===t.ref){if(Eo=!1,t.pendingProps=n=i,0===(e.lanes&a))return t.lanes=e.lanes,Go(e,t,a);0!==(131072&e.flags)&&(Eo=!0)}}return Ao(e,t,r,n,a)}function Co(e,t,r){var n=t.pendingProps,a=n.children,i=null!==e?e.memoizedState:null;if("hidden"===n.mode)if(0===(1&t.mode))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},Aa(Ll,Dl),Dl|=r;else{if(0===(1073741824&r))return e=null!==i?i.baseLanes|r:r,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,Aa(Ll,Dl),Dl|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=null!==i?i.baseLanes:r,Aa(Ll,Dl),Dl|=n}else null!==i?(n=i.baseLanes|r,t.memoizedState=null):n=r,Aa(Ll,Dl),Dl|=n;return To(e,t,a,r),t.child}function Io(e,t){var r=t.ref;(null===e&&null!==r||null!==e&&e.ref!==r)&&(t.flags|=512,t.flags|=2097152)}function Ao(e,t,r,n,a){var i=Da(r)?xa:Na.current;return i=Pa(t,i),Oi(t,a),r=vs(e,t,r,n,i,a),n=ys(),null===e||Eo?(si&&n&&ri(t),t.flags|=1,To(e,t,r,a),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~a,Go(e,t,a))}function Ro(e,t,r,n,a){if(Da(r)){var i=!0;Ua(t)}else i=!1;if(Oi(t,a),null===t.stateNode)Wo(e,t),oo(t,r,n),co(t,r,n,a),n=!0;else if(null===e){var s=t.stateNode,o=t.memoizedProps;s.props=o;var l=s.context,c=r.contextType;"object"===typeof c&&null!==c?c=xi(c):c=Pa(t,c=Da(r)?xa:Na.current);var u=r.getDerivedStateFromProps,h="function"===typeof u||"function"===typeof s.getSnapshotBeforeUpdate;h||"function"!==typeof s.UNSAFE_componentWillReceiveProps&&"function"!==typeof s.componentWillReceiveProps||(o!==n||l!==c)&&lo(t,s,n,c),Fi=!1;var f=t.memoizedState;s.state=f,$i(t,n,s,a),l=t.memoizedState,o!==n||f!==l||Oa.current||Fi?("function"===typeof u&&(ao(t,r,u,n),l=t.memoizedState),(o=Fi||so(t,r,o,n,f,l,c))?(h||"function"!==typeof s.UNSAFE_componentWillMount&&"function"!==typeof s.componentWillMount||("function"===typeof s.componentWillMount&&s.componentWillMount(),"function"===typeof s.UNSAFE_componentWillMount&&s.UNSAFE_componentWillMount()),"function"===typeof s.componentDidMount&&(t.flags|=4194308)):("function"===typeof s.componentDidMount&&(t.flags|=4194308),t.memoizedProps=n,t.memoizedState=l),s.props=n,s.state=l,s.context=c,n=o):("function"===typeof s.componentDidMount&&(t.flags|=4194308),n=!1)}else{s=t.stateNode,Vi(e,t),o=t.memoizedProps,c=t.type===t.elementType?o:no(t.type,o),s.props=c,h=t.pendingProps,f=s.context,"object"===typeof(l=r.contextType)&&null!==l?l=xi(l):l=Pa(t,l=Da(r)?xa:Na.current);var d=r.getDerivedStateFromProps;(u="function"===typeof d||"function"===typeof s.getSnapshotBeforeUpdate)||"function"!==typeof s.UNSAFE_componentWillReceiveProps&&"function"!==typeof s.componentWillReceiveProps||(o!==h||f!==l)&&lo(t,s,n,l),Fi=!1,f=t.memoizedState,s.state=f,$i(t,n,s,a);var p=t.memoizedState;o!==h||f!==p||Oa.current||Fi?("function"===typeof d&&(ao(t,r,d,n),p=t.memoizedState),(c=Fi||so(t,r,c,n,f,p,l)||!1)?(u||"function"!==typeof s.UNSAFE_componentWillUpdate&&"function"!==typeof s.componentWillUpdate||("function"===typeof s.componentWillUpdate&&s.componentWillUpdate(n,p,l),"function"===typeof s.UNSAFE_componentWillUpdate&&s.UNSAFE_componentWillUpdate(n,p,l)),"function"===typeof s.componentDidUpdate&&(t.flags|=4),"function"===typeof s.getSnapshotBeforeUpdate&&(t.flags|=1024)):("function"!==typeof s.componentDidUpdate||o===e.memoizedProps&&f===e.memoizedState||(t.flags|=4),"function"!==typeof s.getSnapshotBeforeUpdate||o===e.memoizedProps&&f===e.memoizedState||(t.flags|=1024),t.memoizedProps=n,t.memoizedState=p),s.props=n,s.state=p,s.context=l,n=c):("function"!==typeof s.componentDidUpdate||o===e.memoizedProps&&f===e.memoizedState||(t.flags|=4),"function"!==typeof s.getSnapshotBeforeUpdate||o===e.memoizedProps&&f===e.memoizedState||(t.flags|=1024),n=!1)}return No(e,t,r,n,i,a)}function No(e,t,r,n,a,i){Io(e,t);var s=0!==(128&t.flags);if(!n&&!s)return a&&Va(t,r,!1),Go(e,t,i);n=t.stateNode,wo.current=t;var o=s&&"function"!==typeof r.getDerivedStateFromError?null:n.render();return t.flags|=1,null!==e&&s?(t.child=Ti(t,e.child,null,i),t.child=Ti(t,null,o,i)):To(e,t,o,i),t.memoizedState=n.state,a&&Va(t,r,!0),t.child}function Oo(e){var t=e.stateNode;t.pendingContext?Ma(0,t.pendingContext,t.pendingContext!==t.context):t.context&&Ma(0,t.context,!1),Qi(e,t.containerInfo)}function xo(e,t,r,n,a){return mi(),gi(a),t.flags|=256,To(e,t,r,n),t.child}var Po,Do,Lo,Mo,Fo={dehydrated:null,treeContext:null,retryLane:0};function Uo(e){return{baseLanes:e,cachePool:null,transitions:null}}function Vo(e,t,r){var n,a=t.pendingProps,s=ts.current,o=!1,l=0!==(128&t.flags);if((n=l)||(n=(null===e||null!==e.memoizedState)&&0!==(2&s)),n?(o=!0,t.flags&=-129):null!==e&&null===e.memoizedState||(s|=1),Aa(ts,1&s),null===e)return hi(t),null!==(e=t.memoizedState)&&null!==(e=e.dehydrated)?(0===(1&t.mode)?t.lanes=1:"$!"===e.data?t.lanes=8:t.lanes=1073741824,null):(l=a.children,e=a.fallback,o?(a=t.mode,o=t.child,l={mode:"hidden",children:l},0===(1&a)&&null!==o?(o.childLanes=0,o.pendingProps=l):o=Uc(l,a,0,null),e=Fc(e,a,r,null),o.return=t,e.return=t,o.sibling=e,t.child=o,t.child.memoizedState=Uo(r),t.memoizedState=Fo,e):Bo(t,l));if(null!==(s=e.memoizedState)&&null!==(n=s.dehydrated))return function(e,t,r,n,a,s,o){if(r)return 256&t.flags?(t.flags&=-257,zo(e,t,o,n=ho(Error(i(422))))):null!==t.memoizedState?(t.child=e.child,t.flags|=128,null):(s=n.fallback,a=t.mode,n=Uc({mode:"visible",children:n.children},a,0,null),(s=Fc(s,a,o,null)).flags|=2,n.return=t,s.return=t,n.sibling=s,t.child=n,0!==(1&t.mode)&&Ti(t,e.child,null,o),t.child.memoizedState=Uo(o),t.memoizedState=Fo,s);if(0===(1&t.mode))return zo(e,t,o,null);if("$!"===a.data){if(n=a.nextSibling&&a.nextSibling.dataset)var l=n.dgst;return n=l,zo(e,t,o,n=ho(s=Error(i(419)),n,void 0))}if(l=0!==(o&e.childLanes),Eo||l){if(null!==(n=Ol)){switch(o&-o){case 4:a=2;break;case 16:a=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:a=32;break;case 536870912:a=268435456;break;default:a=0}0!==(a=0!==(a&(n.suspendedLanes|o))?0:a)&&a!==s.retryLane&&(s.retryLane=a,Mi(e,a),ac(n,e,a,-1))}return vc(),zo(e,t,o,n=ho(Error(i(421))))}return"$?"===a.data?(t.flags|=128,t.child=e.child,t=Rc.bind(null,e),a._reactRetry=t,null):(e=s.treeContext,ii=ha(a.nextSibling),ai=t,si=!0,oi=null,null!==e&&(Xa[Ya++]=Ja,Xa[Ya++]=Za,Xa[Ya++]=Qa,Ja=e.id,Za=e.overflow,Qa=t),t=Bo(t,n.children),t.flags|=4096,t)}(e,t,l,a,n,s,r);if(o){o=a.fallback,l=t.mode,n=(s=e.child).sibling;var c={mode:"hidden",children:a.children};return 0===(1&l)&&t.child!==s?((a=t.child).childLanes=0,a.pendingProps=c,t.deletions=null):(a=Lc(s,c)).subtreeFlags=14680064&s.subtreeFlags,null!==n?o=Lc(n,o):(o=Fc(o,l,r,null)).flags|=2,o.return=t,a.return=t,a.sibling=o,t.child=a,a=o,o=t.child,l=null===(l=e.child.memoizedState)?Uo(r):{baseLanes:l.baseLanes|r,cachePool:null,transitions:l.transitions},o.memoizedState=l,o.childLanes=e.childLanes&~r,t.memoizedState=Fo,a}return e=(o=e.child).sibling,a=Lc(o,{mode:"visible",children:a.children}),0===(1&t.mode)&&(a.lanes=r),a.return=t,a.sibling=null,null!==e&&(null===(r=t.deletions)?(t.deletions=[e],t.flags|=16):r.push(e)),t.child=a,t.memoizedState=null,a}function Bo(e,t){return(t=Uc({mode:"visible",children:t},e.mode,0,null)).return=e,e.child=t}function zo(e,t,r,n){return null!==n&&gi(n),Ti(t,e.child,null,r),(e=Bo(t,t.pendingProps.children)).flags|=2,t.memoizedState=null,e}function jo(e,t,r){e.lanes|=t;var n=e.alternate;null!==n&&(n.lanes|=t),Ni(e.return,t,r)}function Ho(e,t,r,n,a){var i=e.memoizedState;null===i?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:n,tail:r,tailMode:a}:(i.isBackwards=t,i.rendering=null,i.renderingStartTime=0,i.last=n,i.tail=r,i.tailMode=a)}function $o(e,t,r){var n=t.pendingProps,a=n.revealOrder,i=n.tail;if(To(e,t,n.children,r),0!==(2&(n=ts.current)))n=1&n|2,t.flags|=128;else{if(null!==e&&0!==(128&e.flags))e:for(e=t.child;null!==e;){if(13===e.tag)null!==e.memoizedState&&jo(e,r,t);else if(19===e.tag)jo(e,r,t);else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;null===e.sibling;){if(null===e.return||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}n&=1}if(Aa(ts,n),0===(1&t.mode))t.memoizedState=null;else switch(a){case"forwards":for(r=t.child,a=null;null!==r;)null!==(e=r.alternate)&&null===rs(e)&&(a=r),r=r.sibling;null===(r=a)?(a=t.child,t.child=null):(a=r.sibling,r.sibling=null),Ho(t,!1,a,r,i);break;case"backwards":for(r=null,a=t.child,t.child=null;null!==a;){if(null!==(e=a.alternate)&&null===rs(e)){t.child=a;break}e=a.sibling,a.sibling=r,r=a,a=e}Ho(t,!0,r,null,i);break;case"together":Ho(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Wo(e,t){0===(1&t.mode)&&null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2)}function Go(e,t,r){if(null!==e&&(t.dependencies=e.dependencies),Ul|=t.lanes,0===(r&t.childLanes))return null;if(null!==e&&t.child!==e.child)throw Error(i(153));if(null!==t.child){for(r=Lc(e=t.child,e.pendingProps),t.child=r,r.return=t;null!==e.sibling;)e=e.sibling,(r=r.sibling=Lc(e,e.pendingProps)).return=t;r.sibling=null}return t.child}function Ko(e,t){if(!si)switch(e.tailMode){case"hidden":t=e.tail;for(var r=null;null!==t;)null!==t.alternate&&(r=t),t=t.sibling;null===r?e.tail=null:r.sibling=null;break;case"collapsed":r=e.tail;for(var n=null;null!==r;)null!==r.alternate&&(n=r),r=r.sibling;null===n?t||null===e.tail?e.tail=null:e.tail.sibling=null:n.sibling=null}}function qo(e){var t=null!==e.alternate&&e.alternate.child===e.child,r=0,n=0;if(t)for(var a=e.child;null!==a;)r|=a.lanes|a.childLanes,n|=14680064&a.subtreeFlags,n|=14680064&a.flags,a.return=e,a=a.sibling;else for(a=e.child;null!==a;)r|=a.lanes|a.childLanes,n|=a.subtreeFlags,n|=a.flags,a.return=e,a=a.sibling;return e.subtreeFlags|=n,e.childLanes=r,t}function Xo(e,t,r){var n=t.pendingProps;switch(ni(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return qo(t),null;case 1:case 17:return Da(t.type)&&La(),qo(t),null;case 3:return n=t.stateNode,Ji(),Ia(Oa),Ia(Na),as(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),null!==e&&null!==e.child||(di(t)?t.flags|=4:null===e||e.memoizedState.isDehydrated&&0===(256&t.flags)||(t.flags|=1024,null!==oi&&(lc(oi),oi=null))),Do(e,t),qo(t),null;case 5:es(t);var a=Yi(Xi.current);if(r=t.type,null!==e&&null!=t.stateNode)Lo(e,t,r,n,a),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!n){if(null===t.stateNode)throw Error(i(166));return qo(t),null}if(e=Yi(Ki.current),di(t)){n=t.stateNode,r=t.type;var s=t.memoizedProps;switch(n[pa]=t,n[ma]=s,e=0!==(1&t.mode),r){case"dialog":zn("cancel",n),zn("close",n);break;case"iframe":case"object":case"embed":zn("load",n);break;case"video":case"audio":for(a=0;a<Fn.length;a++)zn(Fn[a],n);break;case"source":zn("error",n);break;case"img":case"image":case"link":zn("error",n),zn("load",n);break;case"details":zn("toggle",n);break;case"input":Y(n,s),zn("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!s.multiple},zn("invalid",n);break;case"textarea":ae(n,s),zn("invalid",n)}for(var l in ye(r,s),a=null,s)if(s.hasOwnProperty(l)){var c=s[l];"children"===l?"string"===typeof c?n.textContent!==c&&(!0!==s.suppressHydrationWarning&&ea(n.textContent,c,e),a=["children",c]):"number"===typeof c&&n.textContent!==""+c&&(!0!==s.suppressHydrationWarning&&ea(n.textContent,c,e),a=["children",""+c]):o.hasOwnProperty(l)&&null!=c&&"onScroll"===l&&zn("scroll",n)}switch(r){case"input":G(n),Z(n,s,!0);break;case"textarea":G(n),se(n);break;case"select":case"option":break;default:"function"===typeof s.onClick&&(n.onclick=ta)}n=a,t.updateQueue=n,null!==n&&(t.flags|=4)}else{l=9===a.nodeType?a:a.ownerDocument,"http://www.w3.org/1999/xhtml"===e&&(e=oe(r)),"http://www.w3.org/1999/xhtml"===e?"script"===r?((e=l.createElement("div")).innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):"string"===typeof n.is?e=l.createElement(r,{is:n.is}):(e=l.createElement(r),"select"===r&&(l=e,n.multiple?l.multiple=!0:n.size&&(l.size=n.size))):e=l.createElementNS(e,r),e[pa]=t,e[ma]=n,Po(e,t,!1,!1),t.stateNode=e;e:{switch(l=be(r,n),r){case"dialog":zn("cancel",e),zn("close",e),a=n;break;case"iframe":case"object":case"embed":zn("load",e),a=n;break;case"video":case"audio":for(a=0;a<Fn.length;a++)zn(Fn[a],e);a=n;break;case"source":zn("error",e),a=n;break;case"img":case"image":case"link":zn("error",e),zn("load",e),a=n;break;case"details":zn("toggle",e),a=n;break;case"input":Y(e,n),a=X(e,n),zn("invalid",e);break;case"option":default:a=n;break;case"select":e._wrapperState={wasMultiple:!!n.multiple},a=F({},n,{value:void 0}),zn("invalid",e);break;case"textarea":ae(e,n),a=ne(e,n),zn("invalid",e)}for(s in ye(r,a),c=a)if(c.hasOwnProperty(s)){var u=c[s];"style"===s?ge(e,u):"dangerouslySetInnerHTML"===s?null!=(u=u?u.__html:void 0)&&he(e,u):"children"===s?"string"===typeof u?("textarea"!==r||""!==u)&&fe(e,u):"number"===typeof u&&fe(e,""+u):"suppressContentEditableWarning"!==s&&"suppressHydrationWarning"!==s&&"autoFocus"!==s&&(o.hasOwnProperty(s)?null!=u&&"onScroll"===s&&zn("scroll",e):null!=u&&b(e,s,u,l))}switch(r){case"input":G(e),Z(e,n,!1);break;case"textarea":G(e),se(e);break;case"option":null!=n.value&&e.setAttribute("value",""+$(n.value));break;case"select":e.multiple=!!n.multiple,null!=(s=n.value)?re(e,!!n.multiple,s,!1):null!=n.defaultValue&&re(e,!!n.multiple,n.defaultValue,!0);break;default:"function"===typeof a.onClick&&(e.onclick=ta)}switch(r){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(t.flags|=4)}null!==t.ref&&(t.flags|=512,t.flags|=2097152)}return qo(t),null;case 6:if(e&&null!=t.stateNode)Mo(e,t,e.memoizedProps,n);else{if("string"!==typeof n&&null===t.stateNode)throw Error(i(166));if(r=Yi(Xi.current),Yi(Ki.current),di(t)){if(n=t.stateNode,r=t.memoizedProps,n[pa]=t,(s=n.nodeValue!==r)&&null!==(e=ai))switch(e.tag){case 3:ea(n.nodeValue,r,0!==(1&e.mode));break;case 5:!0!==e.memoizedProps.suppressHydrationWarning&&ea(n.nodeValue,r,0!==(1&e.mode))}s&&(t.flags|=4)}else(n=(9===r.nodeType?r:r.ownerDocument).createTextNode(n))[pa]=t,t.stateNode=n}return qo(t),null;case 13:if(Ia(ts),n=t.memoizedState,null===e||null!==e.memoizedState&&null!==e.memoizedState.dehydrated){if(si&&null!==ii&&0!==(1&t.mode)&&0===(128&t.flags))pi(),mi(),t.flags|=98560,s=!1;else if(s=di(t),null!==n&&null!==n.dehydrated){if(null===e){if(!s)throw Error(i(318));if(!(s=null!==(s=t.memoizedState)?s.dehydrated:null))throw Error(i(317));s[pa]=t}else mi(),0===(128&t.flags)&&(t.memoizedState=null),t.flags|=4;qo(t),s=!1}else null!==oi&&(lc(oi),oi=null),s=!0;if(!s)return 65536&t.flags?t:null}return 0!==(128&t.flags)?(t.lanes=r,t):((n=null!==n)!==(null!==e&&null!==e.memoizedState)&&n&&(t.child.flags|=8192,0!==(1&t.mode)&&(null===e||0!==(1&ts.current)?0===Ml&&(Ml=3):vc())),null!==t.updateQueue&&(t.flags|=4),qo(t),null);case 4:return Ji(),Do(e,t),null===e&&$n(t.stateNode.containerInfo),qo(t),null;case 10:return Ri(t.type._context),qo(t),null;case 19:if(Ia(ts),null===(s=t.memoizedState))return qo(t),null;if(n=0!==(128&t.flags),null===(l=s.rendering))if(n)Ko(s,!1);else{if(0!==Ml||null!==e&&0!==(128&e.flags))for(e=t.child;null!==e;){if(null!==(l=rs(e))){for(t.flags|=128,Ko(s,!1),null!==(n=l.updateQueue)&&(t.updateQueue=n,t.flags|=4),t.subtreeFlags=0,n=r,r=t.child;null!==r;)e=n,(s=r).flags&=14680066,null===(l=s.alternate)?(s.childLanes=0,s.lanes=e,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=l.childLanes,s.lanes=l.lanes,s.child=l.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=l.memoizedProps,s.memoizedState=l.memoizedState,s.updateQueue=l.updateQueue,s.type=l.type,e=l.dependencies,s.dependencies=null===e?null:{lanes:e.lanes,firstContext:e.firstContext}),r=r.sibling;return Aa(ts,1&ts.current|2),t.child}e=e.sibling}null!==s.tail&&Qe()>$l&&(t.flags|=128,n=!0,Ko(s,!1),t.lanes=4194304)}else{if(!n)if(null!==(e=rs(l))){if(t.flags|=128,n=!0,null!==(r=e.updateQueue)&&(t.updateQueue=r,t.flags|=4),Ko(s,!0),null===s.tail&&"hidden"===s.tailMode&&!l.alternate&&!si)return qo(t),null}else 2*Qe()-s.renderingStartTime>$l&&1073741824!==r&&(t.flags|=128,n=!0,Ko(s,!1),t.lanes=4194304);s.isBackwards?(l.sibling=t.child,t.child=l):(null!==(r=s.last)?r.sibling=l:t.child=l,s.last=l)}return null!==s.tail?(t=s.tail,s.rendering=t,s.tail=t.sibling,s.renderingStartTime=Qe(),t.sibling=null,r=ts.current,Aa(ts,n?1&r|2:1&r),t):(qo(t),null);case 22:case 23:return dc(),n=null!==t.memoizedState,null!==e&&null!==e.memoizedState!==n&&(t.flags|=8192),n&&0!==(1&t.mode)?0!==(1073741824&Dl)&&(qo(t),6&t.subtreeFlags&&(t.flags|=8192)):qo(t),null;case 24:case 25:return null}throw Error(i(156,t.tag))}function Yo(e,t){switch(ni(t),t.tag){case 1:return Da(t.type)&&La(),65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 3:return Ji(),Ia(Oa),Ia(Na),as(),0!==(65536&(e=t.flags))&&0===(128&e)?(t.flags=-65537&e|128,t):null;case 5:return es(t),null;case 13:if(Ia(ts),null!==(e=t.memoizedState)&&null!==e.dehydrated){if(null===t.alternate)throw Error(i(340));mi()}return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 19:return Ia(ts),null;case 4:return Ji(),null;case 10:return Ri(t.type._context),null;case 22:case 23:return dc(),null;default:return null}}Po=function(e,t){for(var r=t.child;null!==r;){if(5===r.tag||6===r.tag)e.appendChild(r.stateNode);else if(4!==r.tag&&null!==r.child){r.child.return=r,r=r.child;continue}if(r===t)break;for(;null===r.sibling;){if(null===r.return||r.return===t)return;r=r.return}r.sibling.return=r.return,r=r.sibling}},Do=function(){},Lo=function(e,t,r,n){var a=e.memoizedProps;if(a!==n){e=t.stateNode,Yi(Ki.current);var i,s=null;switch(r){case"input":a=X(e,a),n=X(e,n),s=[];break;case"select":a=F({},a,{value:void 0}),n=F({},n,{value:void 0}),s=[];break;case"textarea":a=ne(e,a),n=ne(e,n),s=[];break;default:"function"!==typeof a.onClick&&"function"===typeof n.onClick&&(e.onclick=ta)}for(u in ye(r,n),r=null,a)if(!n.hasOwnProperty(u)&&a.hasOwnProperty(u)&&null!=a[u])if("style"===u){var l=a[u];for(i in l)l.hasOwnProperty(i)&&(r||(r={}),r[i]="")}else"dangerouslySetInnerHTML"!==u&&"children"!==u&&"suppressContentEditableWarning"!==u&&"suppressHydrationWarning"!==u&&"autoFocus"!==u&&(o.hasOwnProperty(u)?s||(s=[]):(s=s||[]).push(u,null));for(u in n){var c=n[u];if(l=null!=a?a[u]:void 0,n.hasOwnProperty(u)&&c!==l&&(null!=c||null!=l))if("style"===u)if(l){for(i in l)!l.hasOwnProperty(i)||c&&c.hasOwnProperty(i)||(r||(r={}),r[i]="");for(i in c)c.hasOwnProperty(i)&&l[i]!==c[i]&&(r||(r={}),r[i]=c[i])}else r||(s||(s=[]),s.push(u,r)),r=c;else"dangerouslySetInnerHTML"===u?(c=c?c.__html:void 0,l=l?l.__html:void 0,null!=c&&l!==c&&(s=s||[]).push(u,c)):"children"===u?"string"!==typeof c&&"number"!==typeof c||(s=s||[]).push(u,""+c):"suppressContentEditableWarning"!==u&&"suppressHydrationWarning"!==u&&(o.hasOwnProperty(u)?(null!=c&&"onScroll"===u&&zn("scroll",e),s||l===c||(s=[])):(s=s||[]).push(u,c))}r&&(s=s||[]).push("style",r);var u=s;(t.updateQueue=u)&&(t.flags|=4)}},Mo=function(e,t,r,n){r!==n&&(t.flags|=4)};var Qo=!1,Jo=!1,Zo="function"===typeof WeakSet?WeakSet:Set,el=null;function tl(e,t){var r=e.ref;if(null!==r)if("function"===typeof r)try{r(null)}catch(n){Cc(e,t,n)}else r.current=null}function rl(e,t,r){try{r()}catch(n){Cc(e,t,n)}}var nl=!1;function al(e,t,r){var n=t.updateQueue;if(null!==(n=null!==n?n.lastEffect:null)){var a=n=n.next;do{if((a.tag&e)===e){var i=a.destroy;a.destroy=void 0,void 0!==i&&rl(t,r,i)}a=a.next}while(a!==n)}}function il(e,t){if(null!==(t=null!==(t=t.updateQueue)?t.lastEffect:null)){var r=t=t.next;do{if((r.tag&e)===e){var n=r.create;r.destroy=n()}r=r.next}while(r!==t)}}function sl(e){var t=e.ref;if(null!==t){var r=e.stateNode;e.tag,e=r,"function"===typeof t?t(e):t.current=e}}function ol(e){var t=e.alternate;null!==t&&(e.alternate=null,ol(t)),e.child=null,e.deletions=null,e.sibling=null,5===e.tag&&(null!==(t=e.stateNode)&&(delete t[pa],delete t[ma],delete t[va],delete t[ya],delete t[ba])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function ll(e){return 5===e.tag||3===e.tag||4===e.tag}function cl(e){e:for(;;){for(;null===e.sibling;){if(null===e.return||ll(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;5!==e.tag&&6!==e.tag&&18!==e.tag;){if(2&e.flags)continue e;if(null===e.child||4===e.tag)continue e;e.child.return=e,e=e.child}if(!(2&e.flags))return e.stateNode}}function ul(e,t,r){var n=e.tag;if(5===n||6===n)e=e.stateNode,t?8===r.nodeType?r.parentNode.insertBefore(e,t):r.insertBefore(e,t):(8===r.nodeType?(t=r.parentNode).insertBefore(e,r):(t=r).appendChild(e),null!==(r=r._reactRootContainer)&&void 0!==r||null!==t.onclick||(t.onclick=ta));else if(4!==n&&null!==(e=e.child))for(ul(e,t,r),e=e.sibling;null!==e;)ul(e,t,r),e=e.sibling}function hl(e,t,r){var n=e.tag;if(5===n||6===n)e=e.stateNode,t?r.insertBefore(e,t):r.appendChild(e);else if(4!==n&&null!==(e=e.child))for(hl(e,t,r),e=e.sibling;null!==e;)hl(e,t,r),e=e.sibling}var fl=null,dl=!1;function pl(e,t,r){for(r=r.child;null!==r;)ml(e,t,r),r=r.sibling}function ml(e,t,r){if(it&&"function"===typeof it.onCommitFiberUnmount)try{it.onCommitFiberUnmount(at,r)}catch(o){}switch(r.tag){case 5:Jo||tl(r,t);case 6:var n=fl,a=dl;fl=null,pl(e,t,r),dl=a,null!==(fl=n)&&(dl?(e=fl,r=r.stateNode,8===e.nodeType?e.parentNode.removeChild(r):e.removeChild(r)):fl.removeChild(r.stateNode));break;case 18:null!==fl&&(dl?(e=fl,r=r.stateNode,8===e.nodeType?ua(e.parentNode,r):1===e.nodeType&&ua(e,r),jt(e)):ua(fl,r.stateNode));break;case 4:n=fl,a=dl,fl=r.stateNode.containerInfo,dl=!0,pl(e,t,r),fl=n,dl=a;break;case 0:case 11:case 14:case 15:if(!Jo&&(null!==(n=r.updateQueue)&&null!==(n=n.lastEffect))){a=n=n.next;do{var i=a,s=i.destroy;i=i.tag,void 0!==s&&(0!==(2&i)||0!==(4&i))&&rl(r,t,s),a=a.next}while(a!==n)}pl(e,t,r);break;case 1:if(!Jo&&(tl(r,t),"function"===typeof(n=r.stateNode).componentWillUnmount))try{n.props=r.memoizedProps,n.state=r.memoizedState,n.componentWillUnmount()}catch(o){Cc(r,t,o)}pl(e,t,r);break;case 21:pl(e,t,r);break;case 22:1&r.mode?(Jo=(n=Jo)||null!==r.memoizedState,pl(e,t,r),Jo=n):pl(e,t,r);break;default:pl(e,t,r)}}function gl(e){var t=e.updateQueue;if(null!==t){e.updateQueue=null;var r=e.stateNode;null===r&&(r=e.stateNode=new Zo),t.forEach((function(t){var n=Nc.bind(null,e,t);r.has(t)||(r.add(t),t.then(n,n))}))}}function vl(e,t){var r=t.deletions;if(null!==r)for(var n=0;n<r.length;n++){var a=r[n];try{var s=e,o=t,l=o;e:for(;null!==l;){switch(l.tag){case 5:fl=l.stateNode,dl=!1;break e;case 3:case 4:fl=l.stateNode.containerInfo,dl=!0;break e}l=l.return}if(null===fl)throw Error(i(160));ml(s,o,a),fl=null,dl=!1;var c=a.alternate;null!==c&&(c.return=null),a.return=null}catch(u){Cc(a,t,u)}}if(12854&t.subtreeFlags)for(t=t.child;null!==t;)yl(t,e),t=t.sibling}function yl(e,t){var r=e.alternate,n=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(vl(t,e),bl(e),4&n){try{al(3,e,e.return),il(3,e)}catch(g){Cc(e,e.return,g)}try{al(5,e,e.return)}catch(g){Cc(e,e.return,g)}}break;case 1:vl(t,e),bl(e),512&n&&null!==r&&tl(r,r.return);break;case 5:if(vl(t,e),bl(e),512&n&&null!==r&&tl(r,r.return),32&e.flags){var a=e.stateNode;try{fe(a,"")}catch(g){Cc(e,e.return,g)}}if(4&n&&null!=(a=e.stateNode)){var s=e.memoizedProps,o=null!==r?r.memoizedProps:s,l=e.type,c=e.updateQueue;if(e.updateQueue=null,null!==c)try{"input"===l&&"radio"===s.type&&null!=s.name&&Q(a,s),be(l,o);var u=be(l,s);for(o=0;o<c.length;o+=2){var h=c[o],f=c[o+1];"style"===h?ge(a,f):"dangerouslySetInnerHTML"===h?he(a,f):"children"===h?fe(a,f):b(a,h,f,u)}switch(l){case"input":J(a,s);break;case"textarea":ie(a,s);break;case"select":var d=a._wrapperState.wasMultiple;a._wrapperState.wasMultiple=!!s.multiple;var p=s.value;null!=p?re(a,!!s.multiple,p,!1):d!==!!s.multiple&&(null!=s.defaultValue?re(a,!!s.multiple,s.defaultValue,!0):re(a,!!s.multiple,s.multiple?[]:"",!1))}a[ma]=s}catch(g){Cc(e,e.return,g)}}break;case 6:if(vl(t,e),bl(e),4&n){if(null===e.stateNode)throw Error(i(162));a=e.stateNode,s=e.memoizedProps;try{a.nodeValue=s}catch(g){Cc(e,e.return,g)}}break;case 3:if(vl(t,e),bl(e),4&n&&null!==r&&r.memoizedState.isDehydrated)try{jt(t.containerInfo)}catch(g){Cc(e,e.return,g)}break;case 4:default:vl(t,e),bl(e);break;case 13:vl(t,e),bl(e),8192&(a=e.child).flags&&(s=null!==a.memoizedState,a.stateNode.isHidden=s,!s||null!==a.alternate&&null!==a.alternate.memoizedState||(Hl=Qe())),4&n&&gl(e);break;case 22:if(h=null!==r&&null!==r.memoizedState,1&e.mode?(Jo=(u=Jo)||h,vl(t,e),Jo=u):vl(t,e),bl(e),8192&n){if(u=null!==e.memoizedState,(e.stateNode.isHidden=u)&&!h&&0!==(1&e.mode))for(el=e,h=e.child;null!==h;){for(f=el=h;null!==el;){switch(p=(d=el).child,d.tag){case 0:case 11:case 14:case 15:al(4,d,d.return);break;case 1:tl(d,d.return);var m=d.stateNode;if("function"===typeof m.componentWillUnmount){n=d,r=d.return;try{t=n,m.props=t.memoizedProps,m.state=t.memoizedState,m.componentWillUnmount()}catch(g){Cc(n,r,g)}}break;case 5:tl(d,d.return);break;case 22:if(null!==d.memoizedState){_l(f);continue}}null!==p?(p.return=d,el=p):_l(f)}h=h.sibling}e:for(h=null,f=e;;){if(5===f.tag){if(null===h){h=f;try{a=f.stateNode,u?"function"===typeof(s=a.style).setProperty?s.setProperty("display","none","important"):s.display="none":(l=f.stateNode,o=void 0!==(c=f.memoizedProps.style)&&null!==c&&c.hasOwnProperty("display")?c.display:null,l.style.display=me("display",o))}catch(g){Cc(e,e.return,g)}}}else if(6===f.tag){if(null===h)try{f.stateNode.nodeValue=u?"":f.memoizedProps}catch(g){Cc(e,e.return,g)}}else if((22!==f.tag&&23!==f.tag||null===f.memoizedState||f===e)&&null!==f.child){f.child.return=f,f=f.child;continue}if(f===e)break e;for(;null===f.sibling;){if(null===f.return||f.return===e)break e;h===f&&(h=null),f=f.return}h===f&&(h=null),f.sibling.return=f.return,f=f.sibling}}break;case 19:vl(t,e),bl(e),4&n&&gl(e);case 21:}}function bl(e){var t=e.flags;if(2&t){try{e:{for(var r=e.return;null!==r;){if(ll(r)){var n=r;break e}r=r.return}throw Error(i(160))}switch(n.tag){case 5:var a=n.stateNode;32&n.flags&&(fe(a,""),n.flags&=-33),hl(e,cl(e),a);break;case 3:case 4:var s=n.stateNode.containerInfo;ul(e,cl(e),s);break;default:throw Error(i(161))}}catch(o){Cc(e,e.return,o)}e.flags&=-3}4096&t&&(e.flags&=-4097)}function wl(e,t,r){el=e,El(e,t,r)}function El(e,t,r){for(var n=0!==(1&e.mode);null!==el;){var a=el,i=a.child;if(22===a.tag&&n){var s=null!==a.memoizedState||Qo;if(!s){var o=a.alternate,l=null!==o&&null!==o.memoizedState||Jo;o=Qo;var c=Jo;if(Qo=s,(Jo=l)&&!c)for(el=a;null!==el;)l=(s=el).child,22===s.tag&&null!==s.memoizedState?Sl(a):null!==l?(l.return=s,el=l):Sl(a);for(;null!==i;)el=i,El(i,t,r),i=i.sibling;el=a,Qo=o,Jo=c}Tl(e)}else 0!==(8772&a.subtreeFlags)&&null!==i?(i.return=a,el=i):Tl(e)}}function Tl(e){for(;null!==el;){var t=el;if(0!==(8772&t.flags)){var r=t.alternate;try{if(0!==(8772&t.flags))switch(t.tag){case 0:case 11:case 15:Jo||il(5,t);break;case 1:var n=t.stateNode;if(4&t.flags&&!Jo)if(null===r)n.componentDidMount();else{var a=t.elementType===t.type?r.memoizedProps:no(t.type,r.memoizedProps);n.componentDidUpdate(a,r.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var s=t.updateQueue;null!==s&&Wi(t,s,n);break;case 3:var o=t.updateQueue;if(null!==o){if(r=null,null!==t.child)switch(t.child.tag){case 5:case 1:r=t.child.stateNode}Wi(t,o,r)}break;case 5:var l=t.stateNode;if(null===r&&4&t.flags){r=l;var c=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&r.focus();break;case"img":c.src&&(r.src=c.src)}}break;case 6:case 4:case 12:case 19:case 17:case 21:case 22:case 23:case 25:break;case 13:if(null===t.memoizedState){var u=t.alternate;if(null!==u){var h=u.memoizedState;if(null!==h){var f=h.dehydrated;null!==f&&jt(f)}}}break;default:throw Error(i(163))}Jo||512&t.flags&&sl(t)}catch(d){Cc(t,t.return,d)}}if(t===e){el=null;break}if(null!==(r=t.sibling)){r.return=t.return,el=r;break}el=t.return}}function _l(e){for(;null!==el;){var t=el;if(t===e){el=null;break}var r=t.sibling;if(null!==r){r.return=t.return,el=r;break}el=t.return}}function Sl(e){for(;null!==el;){var t=el;try{switch(t.tag){case 0:case 11:case 15:var r=t.return;try{il(4,t)}catch(l){Cc(t,r,l)}break;case 1:var n=t.stateNode;if("function"===typeof n.componentDidMount){var a=t.return;try{n.componentDidMount()}catch(l){Cc(t,a,l)}}var i=t.return;try{sl(t)}catch(l){Cc(t,i,l)}break;case 5:var s=t.return;try{sl(t)}catch(l){Cc(t,s,l)}}}catch(l){Cc(t,t.return,l)}if(t===e){el=null;break}var o=t.sibling;if(null!==o){o.return=t.return,el=o;break}el=t.return}}var kl,Cl=Math.ceil,Il=w.ReactCurrentDispatcher,Al=w.ReactCurrentOwner,Rl=w.ReactCurrentBatchConfig,Nl=0,Ol=null,xl=null,Pl=0,Dl=0,Ll=Ca(0),Ml=0,Fl=null,Ul=0,Vl=0,Bl=0,zl=null,jl=null,Hl=0,$l=1/0,Wl=null,Gl=!1,Kl=null,ql=null,Xl=!1,Yl=null,Ql=0,Jl=0,Zl=null,ec=-1,tc=0;function rc(){return 0!==(6&Nl)?Qe():-1!==ec?ec:ec=Qe()}function nc(e){return 0===(1&e.mode)?1:0!==(2&Nl)&&0!==Pl?Pl&-Pl:null!==vi.transition?(0===tc&&(tc=mt()),tc):0!==(e=bt)?e:e=void 0===(e=window.event)?16:Yt(e.type)}function ac(e,t,r,n){if(50<Jl)throw Jl=0,Zl=null,Error(i(185));vt(e,r,n),0!==(2&Nl)&&e===Ol||(e===Ol&&(0===(2&Nl)&&(Vl|=r),4===Ml&&cc(e,Pl)),ic(e,n),1===r&&0===Nl&&0===(1&t.mode)&&($l=Qe()+500,za&&$a()))}function ic(e,t){var r=e.callbackNode;!function(e,t){for(var r=e.suspendedLanes,n=e.pingedLanes,a=e.expirationTimes,i=e.pendingLanes;0<i;){var s=31-st(i),o=1<<s,l=a[s];-1===l?0!==(o&r)&&0===(o&n)||(a[s]=dt(o,t)):l<=t&&(e.expiredLanes|=o),i&=~o}}(e,t);var n=ft(e,e===Ol?Pl:0);if(0===n)null!==r&&qe(r),e.callbackNode=null,e.callbackPriority=0;else if(t=n&-n,e.callbackPriority!==t){if(null!=r&&qe(r),1===t)0===e.tag?function(e){za=!0,Ha(e)}(uc.bind(null,e)):Ha(uc.bind(null,e)),la((function(){0===(6&Nl)&&$a()})),r=null;else{switch(wt(n)){case 1:r=Ze;break;case 4:r=et;break;case 16:default:r=tt;break;case 536870912:r=nt}r=Oc(r,sc.bind(null,e))}e.callbackPriority=t,e.callbackNode=r}}function sc(e,t){if(ec=-1,tc=0,0!==(6&Nl))throw Error(i(327));var r=e.callbackNode;if(Sc()&&e.callbackNode!==r)return null;var n=ft(e,e===Ol?Pl:0);if(0===n)return null;if(0!==(30&n)||0!==(n&e.expiredLanes)||t)t=yc(e,n);else{t=n;var a=Nl;Nl|=2;var s=gc();for(Ol===e&&Pl===t||(Wl=null,$l=Qe()+500,pc(e,t));;)try{wc();break}catch(l){mc(e,l)}Ai(),Il.current=s,Nl=a,null!==xl?t=0:(Ol=null,Pl=0,t=Ml)}if(0!==t){if(2===t&&(0!==(a=pt(e))&&(n=a,t=oc(e,a))),1===t)throw r=Fl,pc(e,0),cc(e,n),ic(e,Qe()),r;if(6===t)cc(e,n);else{if(a=e.current.alternate,0===(30&n)&&!function(e){for(var t=e;;){if(16384&t.flags){var r=t.updateQueue;if(null!==r&&null!==(r=r.stores))for(var n=0;n<r.length;n++){var a=r[n],i=a.getSnapshot;a=a.value;try{if(!ln(i(),a))return!1}catch(o){return!1}}}if(r=t.child,16384&t.subtreeFlags&&null!==r)r.return=t,t=r;else{if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}(a)&&(2===(t=yc(e,n))&&(0!==(s=pt(e))&&(n=s,t=oc(e,s))),1===t))throw r=Fl,pc(e,0),cc(e,n),ic(e,Qe()),r;switch(e.finishedWork=a,e.finishedLanes=n,t){case 0:case 1:throw Error(i(345));case 2:case 5:_c(e,jl,Wl);break;case 3:if(cc(e,n),(130023424&n)===n&&10<(t=Hl+500-Qe())){if(0!==ft(e,0))break;if(((a=e.suspendedLanes)&n)!==n){rc(),e.pingedLanes|=e.suspendedLanes&a;break}e.timeoutHandle=ia(_c.bind(null,e,jl,Wl),t);break}_c(e,jl,Wl);break;case 4:if(cc(e,n),(4194240&n)===n)break;for(t=e.eventTimes,a=-1;0<n;){var o=31-st(n);s=1<<o,(o=t[o])>a&&(a=o),n&=~s}if(n=a,10<(n=(120>(n=Qe()-n)?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*Cl(n/1960))-n)){e.timeoutHandle=ia(_c.bind(null,e,jl,Wl),n);break}_c(e,jl,Wl);break;default:throw Error(i(329))}}}return ic(e,Qe()),e.callbackNode===r?sc.bind(null,e):null}function oc(e,t){var r=zl;return e.current.memoizedState.isDehydrated&&(pc(e,t).flags|=256),2!==(e=yc(e,t))&&(t=jl,jl=r,null!==t&&lc(t)),e}function lc(e){null===jl?jl=e:jl.push.apply(jl,e)}function cc(e,t){for(t&=~Bl,t&=~Vl,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var r=31-st(t),n=1<<r;e[r]=-1,t&=~n}}function uc(e){if(0!==(6&Nl))throw Error(i(327));Sc();var t=ft(e,0);if(0===(1&t))return ic(e,Qe()),null;var r=yc(e,t);if(0!==e.tag&&2===r){var n=pt(e);0!==n&&(t=n,r=oc(e,n))}if(1===r)throw r=Fl,pc(e,0),cc(e,t),ic(e,Qe()),r;if(6===r)throw Error(i(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,_c(e,jl,Wl),ic(e,Qe()),null}function hc(e,t){var r=Nl;Nl|=1;try{return e(t)}finally{0===(Nl=r)&&($l=Qe()+500,za&&$a())}}function fc(e){null!==Yl&&0===Yl.tag&&0===(6&Nl)&&Sc();var t=Nl;Nl|=1;var r=Rl.transition,n=bt;try{if(Rl.transition=null,bt=1,e)return e()}finally{bt=n,Rl.transition=r,0===(6&(Nl=t))&&$a()}}function dc(){Dl=Ll.current,Ia(Ll)}function pc(e,t){e.finishedWork=null,e.finishedLanes=0;var r=e.timeoutHandle;if(-1!==r&&(e.timeoutHandle=-1,sa(r)),null!==xl)for(r=xl.return;null!==r;){var n=r;switch(ni(n),n.tag){case 1:null!==(n=n.type.childContextTypes)&&void 0!==n&&La();break;case 3:Ji(),Ia(Oa),Ia(Na),as();break;case 5:es(n);break;case 4:Ji();break;case 13:case 19:Ia(ts);break;case 10:Ri(n.type._context);break;case 22:case 23:dc()}r=r.return}if(Ol=e,xl=e=Lc(e.current,null),Pl=Dl=t,Ml=0,Fl=null,Bl=Vl=Ul=0,jl=zl=null,null!==Pi){for(t=0;t<Pi.length;t++)if(null!==(n=(r=Pi[t]).interleaved)){r.interleaved=null;var a=n.next,i=r.pending;if(null!==i){var s=i.next;i.next=a,n.next=s}r.pending=n}Pi=null}return e}function mc(e,t){for(;;){var r=xl;try{if(Ai(),is.current=Zs,hs){for(var n=ls.memoizedState;null!==n;){var a=n.queue;null!==a&&(a.pending=null),n=n.next}hs=!1}if(os=0,us=cs=ls=null,fs=!1,ds=0,Al.current=null,null===r||null===r.return){Ml=1,Fl=t,xl=null;break}e:{var s=e,o=r.return,l=r,c=t;if(t=Pl,l.flags|=32768,null!==c&&"object"===typeof c&&"function"===typeof c.then){var u=c,h=l,f=h.tag;if(0===(1&h.mode)&&(0===f||11===f||15===f)){var d=h.alternate;d?(h.updateQueue=d.updateQueue,h.memoizedState=d.memoizedState,h.lanes=d.lanes):(h.updateQueue=null,h.memoizedState=null)}var p=yo(o);if(null!==p){p.flags&=-257,bo(p,o,l,0,t),1&p.mode&&vo(s,u,t),c=u;var m=(t=p).updateQueue;if(null===m){var g=new Set;g.add(c),t.updateQueue=g}else m.add(c);break e}if(0===(1&t)){vo(s,u,t),vc();break e}c=Error(i(426))}else if(si&&1&l.mode){var v=yo(o);if(null!==v){0===(65536&v.flags)&&(v.flags|=256),bo(v,o,l,0,t),gi(uo(c,l));break e}}s=c=uo(c,l),4!==Ml&&(Ml=2),null===zl?zl=[s]:zl.push(s),s=o;do{switch(s.tag){case 3:s.flags|=65536,t&=-t,s.lanes|=t,Hi(s,mo(0,c,t));break e;case 1:l=c;var y=s.type,b=s.stateNode;if(0===(128&s.flags)&&("function"===typeof y.getDerivedStateFromError||null!==b&&"function"===typeof b.componentDidCatch&&(null===ql||!ql.has(b)))){s.flags|=65536,t&=-t,s.lanes|=t,Hi(s,go(s,l,t));break e}}s=s.return}while(null!==s)}Tc(r)}catch(w){t=w,xl===r&&null!==r&&(xl=r=r.return);continue}break}}function gc(){var e=Il.current;return Il.current=Zs,null===e?Zs:e}function vc(){0!==Ml&&3!==Ml&&2!==Ml||(Ml=4),null===Ol||0===(268435455&Ul)&&0===(268435455&Vl)||cc(Ol,Pl)}function yc(e,t){var r=Nl;Nl|=2;var n=gc();for(Ol===e&&Pl===t||(Wl=null,pc(e,t));;)try{bc();break}catch(a){mc(e,a)}if(Ai(),Nl=r,Il.current=n,null!==xl)throw Error(i(261));return Ol=null,Pl=0,Ml}function bc(){for(;null!==xl;)Ec(xl)}function wc(){for(;null!==xl&&!Xe();)Ec(xl)}function Ec(e){var t=kl(e.alternate,e,Dl);e.memoizedProps=e.pendingProps,null===t?Tc(e):xl=t,Al.current=null}function Tc(e){var t=e;do{var r=t.alternate;if(e=t.return,0===(32768&t.flags)){if(null!==(r=Xo(r,t,Dl)))return void(xl=r)}else{if(null!==(r=Yo(r,t)))return r.flags&=32767,void(xl=r);if(null===e)return Ml=6,void(xl=null);e.flags|=32768,e.subtreeFlags=0,e.deletions=null}if(null!==(t=t.sibling))return void(xl=t);xl=t=e}while(null!==t);0===Ml&&(Ml=5)}function _c(e,t,r){var n=bt,a=Rl.transition;try{Rl.transition=null,bt=1,function(e,t,r,n){do{Sc()}while(null!==Yl);if(0!==(6&Nl))throw Error(i(327));r=e.finishedWork;var a=e.finishedLanes;if(null===r)return null;if(e.finishedWork=null,e.finishedLanes=0,r===e.current)throw Error(i(177));e.callbackNode=null,e.callbackPriority=0;var s=r.lanes|r.childLanes;if(function(e,t){var r=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var n=e.eventTimes;for(e=e.expirationTimes;0<r;){var a=31-st(r),i=1<<a;t[a]=0,n[a]=-1,e[a]=-1,r&=~i}}(e,s),e===Ol&&(xl=Ol=null,Pl=0),0===(2064&r.subtreeFlags)&&0===(2064&r.flags)||Xl||(Xl=!0,Oc(tt,(function(){return Sc(),null}))),s=0!==(15990&r.flags),0!==(15990&r.subtreeFlags)||s){s=Rl.transition,Rl.transition=null;var o=bt;bt=1;var l=Nl;Nl|=4,Al.current=null,function(e,t){if(ra=$t,pn(e=dn())){if("selectionStart"in e)var r={start:e.selectionStart,end:e.selectionEnd};else e:{var n=(r=(r=e.ownerDocument)&&r.defaultView||window).getSelection&&r.getSelection();if(n&&0!==n.rangeCount){r=n.anchorNode;var a=n.anchorOffset,s=n.focusNode;n=n.focusOffset;try{r.nodeType,s.nodeType}catch(yn){r=null;break e}var o=0,l=-1,c=-1,u=0,h=0,f=e,d=null;t:for(;;){for(var p;f!==r||0!==a&&3!==f.nodeType||(l=o+a),f!==s||0!==n&&3!==f.nodeType||(c=o+n),3===f.nodeType&&(o+=f.nodeValue.length),null!==(p=f.firstChild);)d=f,f=p;for(;;){if(f===e)break t;if(d===r&&++u===a&&(l=o),d===s&&++h===n&&(c=o),null!==(p=f.nextSibling))break;d=(f=d).parentNode}f=p}r=-1===l||-1===c?null:{start:l,end:c}}else r=null}r=r||{start:0,end:0}}else r=null;for(na={focusedElem:e,selectionRange:r},$t=!1,el=t;null!==el;)if(e=(t=el).child,0!==(1028&t.subtreeFlags)&&null!==e)e.return=t,el=e;else for(;null!==el;){t=el;try{var m=t.alternate;if(0!==(1024&t.flags))switch(t.tag){case 0:case 11:case 15:case 5:case 6:case 4:case 17:break;case 1:if(null!==m){var g=m.memoizedProps,v=m.memoizedState,y=t.stateNode,b=y.getSnapshotBeforeUpdate(t.elementType===t.type?g:no(t.type,g),v);y.__reactInternalSnapshotBeforeUpdate=b}break;case 3:var w=t.stateNode.containerInfo;1===w.nodeType?w.textContent="":9===w.nodeType&&w.documentElement&&w.removeChild(w.documentElement);break;default:throw Error(i(163))}}catch(yn){Cc(t,t.return,yn)}if(null!==(e=t.sibling)){e.return=t.return,el=e;break}el=t.return}m=nl,nl=!1}(e,r),yl(r,e),mn(na),$t=!!ra,na=ra=null,e.current=r,wl(r,e,a),Ye(),Nl=l,bt=o,Rl.transition=s}else e.current=r;if(Xl&&(Xl=!1,Yl=e,Ql=a),s=e.pendingLanes,0===s&&(ql=null),function(e){if(it&&"function"===typeof it.onCommitFiberRoot)try{it.onCommitFiberRoot(at,e,void 0,128===(128&e.current.flags))}catch(t){}}(r.stateNode),ic(e,Qe()),null!==t)for(n=e.onRecoverableError,r=0;r<t.length;r++)a=t[r],n(a.value,{componentStack:a.stack,digest:a.digest});if(Gl)throw Gl=!1,e=Kl,Kl=null,e;0!==(1&Ql)&&0!==e.tag&&Sc(),s=e.pendingLanes,0!==(1&s)?e===Zl?Jl++:(Jl=0,Zl=e):Jl=0,$a()}(e,t,r,n)}finally{Rl.transition=a,bt=n}return null}function Sc(){if(null!==Yl){var e=wt(Ql),t=Rl.transition,r=bt;try{if(Rl.transition=null,bt=16>e?16:e,null===Yl)var n=!1;else{if(e=Yl,Yl=null,Ql=0,0!==(6&Nl))throw Error(i(331));var a=Nl;for(Nl|=4,el=e.current;null!==el;){var s=el,o=s.child;if(0!==(16&el.flags)){var l=s.deletions;if(null!==l){for(var c=0;c<l.length;c++){var u=l[c];for(el=u;null!==el;){var h=el;switch(h.tag){case 0:case 11:case 15:al(8,h,s)}var f=h.child;if(null!==f)f.return=h,el=f;else for(;null!==el;){var d=(h=el).sibling,p=h.return;if(ol(h),h===u){el=null;break}if(null!==d){d.return=p,el=d;break}el=p}}}var m=s.alternate;if(null!==m){var g=m.child;if(null!==g){m.child=null;do{var v=g.sibling;g.sibling=null,g=v}while(null!==g)}}el=s}}if(0!==(2064&s.subtreeFlags)&&null!==o)o.return=s,el=o;else e:for(;null!==el;){if(0!==(2048&(s=el).flags))switch(s.tag){case 0:case 11:case 15:al(9,s,s.return)}var y=s.sibling;if(null!==y){y.return=s.return,el=y;break e}el=s.return}}var b=e.current;for(el=b;null!==el;){var w=(o=el).child;if(0!==(2064&o.subtreeFlags)&&null!==w)w.return=o,el=w;else e:for(o=b;null!==el;){if(0!==(2048&(l=el).flags))try{switch(l.tag){case 0:case 11:case 15:il(9,l)}}catch(T){Cc(l,l.return,T)}if(l===o){el=null;break e}var E=l.sibling;if(null!==E){E.return=l.return,el=E;break e}el=l.return}}if(Nl=a,$a(),it&&"function"===typeof it.onPostCommitFiberRoot)try{it.onPostCommitFiberRoot(at,e)}catch(T){}n=!0}return n}finally{bt=r,Rl.transition=t}}return!1}function kc(e,t,r){e=zi(e,t=mo(0,t=uo(r,t),1),1),t=rc(),null!==e&&(vt(e,1,t),ic(e,t))}function Cc(e,t,r){if(3===e.tag)kc(e,e,r);else for(;null!==t;){if(3===t.tag){kc(t,e,r);break}if(1===t.tag){var n=t.stateNode;if("function"===typeof t.type.getDerivedStateFromError||"function"===typeof n.componentDidCatch&&(null===ql||!ql.has(n))){t=zi(t,e=go(t,e=uo(r,e),1),1),e=rc(),null!==t&&(vt(t,1,e),ic(t,e));break}}t=t.return}}function Ic(e,t,r){var n=e.pingCache;null!==n&&n.delete(t),t=rc(),e.pingedLanes|=e.suspendedLanes&r,Ol===e&&(Pl&r)===r&&(4===Ml||3===Ml&&(130023424&Pl)===Pl&&500>Qe()-Hl?pc(e,0):Bl|=r),ic(e,t)}function Ac(e,t){0===t&&(0===(1&e.mode)?t=1:(t=ut,0===(130023424&(ut<<=1))&&(ut=4194304)));var r=rc();null!==(e=Mi(e,t))&&(vt(e,t,r),ic(e,r))}function Rc(e){var t=e.memoizedState,r=0;null!==t&&(r=t.retryLane),Ac(e,r)}function Nc(e,t){var r=0;switch(e.tag){case 13:var n=e.stateNode,a=e.memoizedState;null!==a&&(r=a.retryLane);break;case 19:n=e.stateNode;break;default:throw Error(i(314))}null!==n&&n.delete(t),Ac(e,r)}function Oc(e,t){return Ke(e,t)}function xc(e,t,r,n){this.tag=e,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Pc(e,t,r,n){return new xc(e,t,r,n)}function Dc(e){return!(!(e=e.prototype)||!e.isReactComponent)}function Lc(e,t){var r=e.alternate;return null===r?((r=Pc(e.tag,t,e.key,e.mode)).elementType=e.elementType,r.type=e.type,r.stateNode=e.stateNode,r.alternate=e,e.alternate=r):(r.pendingProps=t,r.type=e.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=14680064&e.flags,r.childLanes=e.childLanes,r.lanes=e.lanes,r.child=e.child,r.memoizedProps=e.memoizedProps,r.memoizedState=e.memoizedState,r.updateQueue=e.updateQueue,t=e.dependencies,r.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext},r.sibling=e.sibling,r.index=e.index,r.ref=e.ref,r}function Mc(e,t,r,n,a,s){var o=2;if(n=e,"function"===typeof e)Dc(e)&&(o=1);else if("string"===typeof e)o=5;else e:switch(e){case _:return Fc(r.children,a,s,t);case S:o=8,a|=8;break;case k:return(e=Pc(12,r,t,2|a)).elementType=k,e.lanes=s,e;case R:return(e=Pc(13,r,t,a)).elementType=R,e.lanes=s,e;case N:return(e=Pc(19,r,t,a)).elementType=N,e.lanes=s,e;case P:return Uc(r,a,s,t);default:if("object"===typeof e&&null!==e)switch(e.$$typeof){case C:o=10;break e;case I:o=9;break e;case A:o=11;break e;case O:o=14;break e;case x:o=16,n=null;break e}throw Error(i(130,null==e?e:typeof e,""))}return(t=Pc(o,r,t,a)).elementType=e,t.type=n,t.lanes=s,t}function Fc(e,t,r,n){return(e=Pc(7,e,n,t)).lanes=r,e}function Uc(e,t,r,n){return(e=Pc(22,e,n,t)).elementType=P,e.lanes=r,e.stateNode={isHidden:!1},e}function Vc(e,t,r){return(e=Pc(6,e,null,t)).lanes=r,e}function Bc(e,t,r){return(t=Pc(4,null!==e.children?e.children:[],e.key,t)).lanes=r,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function zc(e,t,r,n,a){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=gt(0),this.expirationTimes=gt(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=gt(0),this.identifierPrefix=n,this.onRecoverableError=a,this.mutableSourceEagerHydrationData=null}function jc(e,t,r,n,a,i,s,o,l){return e=new zc(e,t,r,o,l),1===t?(t=1,!0===i&&(t|=8)):t=0,i=Pc(3,null,null,t),e.current=i,i.stateNode=e,i.memoizedState={element:n,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},Ui(i),e}function Hc(e){if(!e)return Ra;e:{if(je(e=e._reactInternals)!==e||1!==e.tag)throw Error(i(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Da(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(null!==t);throw Error(i(171))}if(1===e.tag){var r=e.type;if(Da(r))return Fa(e,r,t)}return t}function $c(e,t,r,n,a,i,s,o,l){return(e=jc(r,n,!0,e,0,i,0,o,l)).context=Hc(null),r=e.current,(i=Bi(n=rc(),a=nc(r))).callback=void 0!==t&&null!==t?t:null,zi(r,i,a),e.current.lanes=a,vt(e,a,n),ic(e,n),e}function Wc(e,t,r,n){var a=t.current,i=rc(),s=nc(a);return r=Hc(r),null===t.context?t.context=r:t.pendingContext=r,(t=Bi(i,s)).payload={element:e},null!==(n=void 0===n?null:n)&&(t.callback=n),null!==(e=zi(a,t,s))&&(ac(e,a,s,i),ji(e,a,s)),s}function Gc(e){return(e=e.current).child?(e.child.tag,e.child.stateNode):null}function Kc(e,t){if(null!==(e=e.memoizedState)&&null!==e.dehydrated){var r=e.retryLane;e.retryLane=0!==r&&r<t?r:t}}function qc(e,t){Kc(e,t),(e=e.alternate)&&Kc(e,t)}kl=function(e,t,r){if(null!==e)if(e.memoizedProps!==t.pendingProps||Oa.current)Eo=!0;else{if(0===(e.lanes&r)&&0===(128&t.flags))return Eo=!1,function(e,t,r){switch(t.tag){case 3:Oo(t),mi();break;case 5:Zi(t);break;case 1:Da(t.type)&&Ua(t);break;case 4:Qi(t,t.stateNode.containerInfo);break;case 10:var n=t.type._context,a=t.memoizedProps.value;Aa(Si,n._currentValue),n._currentValue=a;break;case 13:if(null!==(n=t.memoizedState))return null!==n.dehydrated?(Aa(ts,1&ts.current),t.flags|=128,null):0!==(r&t.child.childLanes)?Vo(e,t,r):(Aa(ts,1&ts.current),null!==(e=Go(e,t,r))?e.sibling:null);Aa(ts,1&ts.current);break;case 19:if(n=0!==(r&t.childLanes),0!==(128&e.flags)){if(n)return $o(e,t,r);t.flags|=128}if(null!==(a=t.memoizedState)&&(a.rendering=null,a.tail=null,a.lastEffect=null),Aa(ts,ts.current),n)break;return null;case 22:case 23:return t.lanes=0,Co(e,t,r)}return Go(e,t,r)}(e,t,r);Eo=0!==(131072&e.flags)}else Eo=!1,si&&0!==(1048576&t.flags)&&ti(t,qa,t.index);switch(t.lanes=0,t.tag){case 2:var n=t.type;Wo(e,t),e=t.pendingProps;var a=Pa(t,Na.current);Oi(t,r),a=vs(null,t,n,e,a,r);var s=ys();return t.flags|=1,"object"===typeof a&&null!==a&&"function"===typeof a.render&&void 0===a.$$typeof?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Da(n)?(s=!0,Ua(t)):s=!1,t.memoizedState=null!==a.state&&void 0!==a.state?a.state:null,Ui(t),a.updater=io,t.stateNode=a,a._reactInternals=t,co(t,n,e,r),t=No(null,t,n,!0,s,r)):(t.tag=0,si&&s&&ri(t),To(null,t,a,r),t=t.child),t;case 16:n=t.elementType;e:{switch(Wo(e,t),e=t.pendingProps,n=(a=n._init)(n._payload),t.type=n,a=t.tag=function(e){if("function"===typeof e)return Dc(e)?1:0;if(void 0!==e&&null!==e){if((e=e.$$typeof)===A)return 11;if(e===O)return 14}return 2}(n),e=no(n,e),a){case 0:t=Ao(null,t,n,e,r);break e;case 1:t=Ro(null,t,n,e,r);break e;case 11:t=_o(null,t,n,e,r);break e;case 14:t=So(null,t,n,no(n.type,e),r);break e}throw Error(i(306,n,""))}return t;case 0:return n=t.type,a=t.pendingProps,Ao(e,t,n,a=t.elementType===n?a:no(n,a),r);case 1:return n=t.type,a=t.pendingProps,Ro(e,t,n,a=t.elementType===n?a:no(n,a),r);case 3:e:{if(Oo(t),null===e)throw Error(i(387));n=t.pendingProps,a=(s=t.memoizedState).element,Vi(e,t),$i(t,n,null,r);var o=t.memoizedState;if(n=o.element,s.isDehydrated){if(s={element:n,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},t.updateQueue.baseState=s,t.memoizedState=s,256&t.flags){t=xo(e,t,n,r,a=uo(Error(i(423)),t));break e}if(n!==a){t=xo(e,t,n,r,a=uo(Error(i(424)),t));break e}for(ii=ha(t.stateNode.containerInfo.firstChild),ai=t,si=!0,oi=null,r=_i(t,null,n,r),t.child=r;r;)r.flags=-3&r.flags|4096,r=r.sibling}else{if(mi(),n===a){t=Go(e,t,r);break e}To(e,t,n,r)}t=t.child}return t;case 5:return Zi(t),null===e&&hi(t),n=t.type,a=t.pendingProps,s=null!==e?e.memoizedProps:null,o=a.children,aa(n,a)?o=null:null!==s&&aa(n,s)&&(t.flags|=32),Io(e,t),To(e,t,o,r),t.child;case 6:return null===e&&hi(t),null;case 13:return Vo(e,t,r);case 4:return Qi(t,t.stateNode.containerInfo),n=t.pendingProps,null===e?t.child=Ti(t,null,n,r):To(e,t,n,r),t.child;case 11:return n=t.type,a=t.pendingProps,_o(e,t,n,a=t.elementType===n?a:no(n,a),r);case 7:return To(e,t,t.pendingProps,r),t.child;case 8:case 12:return To(e,t,t.pendingProps.children,r),t.child;case 10:e:{if(n=t.type._context,a=t.pendingProps,s=t.memoizedProps,o=a.value,Aa(Si,n._currentValue),n._currentValue=o,null!==s)if(ln(s.value,o)){if(s.children===a.children&&!Oa.current){t=Go(e,t,r);break e}}else for(null!==(s=t.child)&&(s.return=t);null!==s;){var l=s.dependencies;if(null!==l){o=s.child;for(var c=l.firstContext;null!==c;){if(c.context===n){if(1===s.tag){(c=Bi(-1,r&-r)).tag=2;var u=s.updateQueue;if(null!==u){var h=(u=u.shared).pending;null===h?c.next=c:(c.next=h.next,h.next=c),u.pending=c}}s.lanes|=r,null!==(c=s.alternate)&&(c.lanes|=r),Ni(s.return,r,t),l.lanes|=r;break}c=c.next}}else if(10===s.tag)o=s.type===t.type?null:s.child;else if(18===s.tag){if(null===(o=s.return))throw Error(i(341));o.lanes|=r,null!==(l=o.alternate)&&(l.lanes|=r),Ni(o,r,t),o=s.sibling}else o=s.child;if(null!==o)o.return=s;else for(o=s;null!==o;){if(o===t){o=null;break}if(null!==(s=o.sibling)){s.return=o.return,o=s;break}o=o.return}s=o}To(e,t,a.children,r),t=t.child}return t;case 9:return a=t.type,n=t.pendingProps.children,Oi(t,r),n=n(a=xi(a)),t.flags|=1,To(e,t,n,r),t.child;case 14:return a=no(n=t.type,t.pendingProps),So(e,t,n,a=no(n.type,a),r);case 15:return ko(e,t,t.type,t.pendingProps,r);case 17:return n=t.type,a=t.pendingProps,a=t.elementType===n?a:no(n,a),Wo(e,t),t.tag=1,Da(n)?(e=!0,Ua(t)):e=!1,Oi(t,r),oo(t,n,a),co(t,n,a,r),No(null,t,n,!0,e,r);case 19:return $o(e,t,r);case 22:return Co(e,t,r)}throw Error(i(156,t.tag))};var Xc="function"===typeof reportError?reportError:function(e){console.error(e)};function Yc(e){this._internalRoot=e}function Qc(e){this._internalRoot=e}function Jc(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType)}function Zc(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType&&(8!==e.nodeType||" react-mount-point-unstable "!==e.nodeValue))}function eu(){}function tu(e,t,r,n,a){var i=r._reactRootContainer;if(i){var s=i;if("function"===typeof a){var o=a;a=function(){var e=Gc(s);o.call(e)}}Wc(t,s,e,a)}else s=function(e,t,r,n,a){if(a){if("function"===typeof n){var i=n;n=function(){var e=Gc(s);i.call(e)}}var s=$c(t,n,e,0,null,!1,0,"",eu);return e._reactRootContainer=s,e[ga]=s.current,$n(8===e.nodeType?e.parentNode:e),fc(),s}for(;a=e.lastChild;)e.removeChild(a);if("function"===typeof n){var o=n;n=function(){var e=Gc(l);o.call(e)}}var l=jc(e,0,!1,null,0,!1,0,"",eu);return e._reactRootContainer=l,e[ga]=l.current,$n(8===e.nodeType?e.parentNode:e),fc((function(){Wc(t,l,r,n)})),l}(r,t,e,a,n);return Gc(s)}Qc.prototype.render=Yc.prototype.render=function(e){var t=this._internalRoot;if(null===t)throw Error(i(409));Wc(e,t,null,null)},Qc.prototype.unmount=Yc.prototype.unmount=function(){var e=this._internalRoot;if(null!==e){this._internalRoot=null;var t=e.containerInfo;fc((function(){Wc(null,e,null,null)})),t[ga]=null}},Qc.prototype.unstable_scheduleHydration=function(e){if(e){var t=St();e={blockedOn:null,target:e,priority:t};for(var r=0;r<Pt.length&&0!==t&&t<Pt[r].priority;r++);Pt.splice(r,0,e),0===r&&Ft(e)}},Et=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var r=ht(t.pendingLanes);0!==r&&(yt(t,1|r),ic(t,Qe()),0===(6&Nl)&&($l=Qe()+500,$a()))}break;case 13:fc((function(){var t=Mi(e,1);if(null!==t){var r=rc();ac(t,e,1,r)}})),qc(e,1)}},Tt=function(e){if(13===e.tag){var t=Mi(e,134217728);if(null!==t)ac(t,e,134217728,rc());qc(e,134217728)}},_t=function(e){if(13===e.tag){var t=nc(e),r=Mi(e,t);if(null!==r)ac(r,e,t,rc());qc(e,t)}},St=function(){return bt},kt=function(e,t){var r=bt;try{return bt=e,t()}finally{bt=r}},Te=function(e,t,r){switch(t){case"input":if(J(e,r),t=r.name,"radio"===r.type&&null!=t){for(r=e;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<r.length;t++){var n=r[t];if(n!==e&&n.form===e.form){var a=_a(n);if(!a)throw Error(i(90));K(n),J(n,a)}}}break;case"textarea":ie(e,r);break;case"select":null!=(t=r.value)&&re(e,!!r.multiple,t,!1)}},Ae=hc,Re=fc;var ru={usingClientEntryPoint:!1,Events:[Ea,Ta,_a,Ce,Ie,hc]},nu={findFiberByHostInstance:wa,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},au={bundleType:nu.bundleType,version:nu.version,rendererPackageName:nu.rendererPackageName,rendererConfig:nu.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:w.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return null===(e=We(e))?null:e.stateNode},findFiberByHostInstance:nu.findFiberByHostInstance||function(){return null},findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__){var iu=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!iu.isDisabled&&iu.supportsFiber)try{at=iu.inject(au),it=iu}catch(ue){}}t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=ru,t.createPortal=function(e,t){var r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!Jc(t))throw Error(i(200));return function(e,t,r){var n=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:T,key:null==n?null:""+n,children:e,containerInfo:t,implementation:r}}(e,t,null,r)},t.createRoot=function(e,t){if(!Jc(e))throw Error(i(299));var r=!1,n="",a=Xc;return null!==t&&void 0!==t&&(!0===t.unstable_strictMode&&(r=!0),void 0!==t.identifierPrefix&&(n=t.identifierPrefix),void 0!==t.onRecoverableError&&(a=t.onRecoverableError)),t=jc(e,1,!1,null,0,r,0,n,a),e[ga]=t.current,$n(8===e.nodeType?e.parentNode:e),new Yc(t)},t.findDOMNode=function(e){if(null==e)return null;if(1===e.nodeType)return e;var t=e._reactInternals;if(void 0===t){if("function"===typeof e.render)throw Error(i(188));throw e=Object.keys(e).join(","),Error(i(268,e))}return e=null===(e=We(t))?null:e.stateNode},t.flushSync=function(e){return fc(e)},t.hydrate=function(e,t,r){if(!Zc(t))throw Error(i(200));return tu(null,e,t,!0,r)},t.hydrateRoot=function(e,t,r){if(!Jc(e))throw Error(i(405));var n=null!=r&&r.hydratedSources||null,a=!1,s="",o=Xc;if(null!==r&&void 0!==r&&(!0===r.unstable_strictMode&&(a=!0),void 0!==r.identifierPrefix&&(s=r.identifierPrefix),void 0!==r.onRecoverableError&&(o=r.onRecoverableError)),t=$c(t,null,e,1,null!=r?r:null,a,0,s,o),e[ga]=t.current,$n(e),n)for(e=0;e<n.length;e++)a=(a=(r=n[e])._getVersion)(r._source),null==t.mutableSourceEagerHydrationData?t.mutableSourceEagerHydrationData=[r,a]:t.mutableSourceEagerHydrationData.push(r,a);return new Qc(t)},t.render=function(e,t,r){if(!Zc(t))throw Error(i(200));return tu(null,e,t,!1,r)},t.unmountComponentAtNode=function(e){if(!Zc(e))throw Error(i(40));return!!e._reactRootContainer&&(fc((function(){tu(null,null,e,!1,(function(){e._reactRootContainer=null,e[ga]=null}))})),!0)},t.unstable_batchedUpdates=hc,t.unstable_renderSubtreeIntoContainer=function(e,t,r,n){if(!Zc(r))throw Error(i(200));if(null==e||void 0===e._reactInternals)throw Error(i(38));return tu(e,t,r,!1,n)},t.version="18.3.1-next-f1338f8080-20240426"},853:(e,t,r)=>{e.exports=r(234)},950:(e,t,r)=>{!function e(){if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}(),e.exports=r(730)}},t={};function r(n){var a=t[n];if(void 0!==a)return a.exports;var i=t[n]={exports:{}};return e[n](i,i.exports,r),i.exports}(()=>{var e,t=Object.getPrototypeOf?e=>Object.getPrototypeOf(e):e=>e.__proto__;r.t=function(n,a){if(1&a&&(n=this(n)),8&a)return n;if("object"===typeof n&&n){if(4&a&&n.__esModule)return n;if(16&a&&"function"===typeof n.then)return n}var i=Object.create(null);r.r(i);var s={};e=e||[null,t({}),t([]),t(t)];for(var o=2&a&&n;"object"==typeof o&&!~e.indexOf(o);o=t(o))Object.getOwnPropertyNames(o).forEach((e=>s[e]=()=>n[e]));return s.default=()=>n,r.d(i,s),i}})(),r.d=(e,t)=>{for(var n in t)r.o(t,n)&&!r.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},r.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}(),r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r.r=e=>{"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var n,a=r(43),i=r.t(a,2),s=r(391),o=r(950),l=r.t(o,2);function c(){return c=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},c.apply(this,arguments)}!function(e){e.Pop="POP",e.Push="PUSH",e.Replace="REPLACE"}(n||(n={}));const u="popstate";function h(e,t){if(!1===e||null===e||"undefined"===typeof e)throw new Error(t)}function f(e,t){if(!e){"undefined"!==typeof console&&console.warn(t);try{throw new Error(t)}catch(r){}}}function d(e,t){return{usr:e.state,key:e.key,idx:t}}function p(e,t,r,n){return void 0===r&&(r=null),c({pathname:"string"===typeof e?e:e.pathname,search:"",hash:""},"string"===typeof t?g(t):t,{state:r,key:t&&t.key||n||Math.random().toString(36).substr(2,8)})}function m(e){let{pathname:t="/",search:r="",hash:n=""}=e;return r&&"?"!==r&&(t+="?"===r.charAt(0)?r:"?"+r),n&&"#"!==n&&(t+="#"===n.charAt(0)?n:"#"+n),t}function g(e){let t={};if(e){let r=e.indexOf("#");r>=0&&(t.hash=e.substr(r),e=e.substr(0,r));let n=e.indexOf("?");n>=0&&(t.search=e.substr(n),e=e.substr(0,n)),e&&(t.pathname=e)}return t}function v(e,t,r,a){void 0===a&&(a={});let{window:i=document.defaultView,v5Compat:s=!1}=a,o=i.history,l=n.Pop,f=null,g=v();function v(){return(o.state||{idx:null}).idx}function y(){l=n.Pop;let e=v(),t=null==e?null:e-g;g=e,f&&f({action:l,location:w.location,delta:t})}function b(e){let t="null"!==i.location.origin?i.location.origin:i.location.href,r="string"===typeof e?e:m(e);return r=r.replace(/ $/,"%20"),h(t,"No window.location.(origin|href) available to create URL for href: "+r),new URL(r,t)}null==g&&(g=0,o.replaceState(c({},o.state,{idx:g}),""));let w={get action(){return l},get location(){return e(i,o)},listen(e){if(f)throw new Error("A history only accepts one active listener");return i.addEventListener(u,y),f=e,()=>{i.removeEventListener(u,y),f=null}},createHref:e=>t(i,e),createURL:b,encodeLocation(e){let t=b(e);return{pathname:t.pathname,search:t.search,hash:t.hash}},push:function(e,t){l=n.Push;let a=p(w.location,e,t);r&&r(a,e),g=v()+1;let c=d(a,g),u=w.createHref(a);try{o.pushState(c,"",u)}catch(h){if(h instanceof DOMException&&"DataCloneError"===h.name)throw h;i.location.assign(u)}s&&f&&f({action:l,location:w.location,delta:1})},replace:function(e,t){l=n.Replace;let a=p(w.location,e,t);r&&r(a,e),g=v();let i=d(a,g),c=w.createHref(a);o.replaceState(i,"",c),s&&f&&f({action:l,location:w.location,delta:0})},go:e=>o.go(e)};return w}var y;!function(e){e.data="data",e.deferred="deferred",e.redirect="redirect",e.error="error"}(y||(y={}));new Set(["lazy","caseSensitive","path","id","index","children"]);function b(e,t,r){return void 0===r&&(r="/"),w(e,t,r,!1)}function w(e,t,r,n){let a=D(("string"===typeof t?g(t):t).pathname||"/",r);if(null==a)return null;let i=E(e);!function(e){e.sort(((e,t)=>e.score!==t.score?t.score-e.score:function(e,t){let r=e.length===t.length&&e.slice(0,-1).every(((e,r)=>e===t[r]));return r?e[e.length-1]-t[t.length-1]:0}(e.routesMeta.map((e=>e.childrenIndex)),t.routesMeta.map((e=>e.childrenIndex)))))}(i);let s=null;for(let o=0;null==s&&o<i.length;++o){let e=P(a);s=O(i[o],e,n)}return s}function E(e,t,r,n){void 0===t&&(t=[]),void 0===r&&(r=[]),void 0===n&&(n="");let a=(e,a,i)=>{let s={relativePath:void 0===i?e.path||"":i,caseSensitive:!0===e.caseSensitive,childrenIndex:a,route:e};s.relativePath.startsWith("/")&&(h(s.relativePath.startsWith(n),'Absolute route path "'+s.relativePath+'" nested under path "'+n+'" is not valid. An absolute child route path must start with the combined path of all its parent routes.'),s.relativePath=s.relativePath.slice(n.length));let o=V([n,s.relativePath]),l=r.concat(s);e.children&&e.children.length>0&&(h(!0!==e.index,'Index routes must not have child routes. Please remove all child routes from route path "'+o+'".'),E(e.children,t,l,o)),(null!=e.path||e.index)&&t.push({path:o,score:N(o,e.index),routesMeta:l})};return e.forEach(((e,t)=>{var r;if(""!==e.path&&null!=(r=e.path)&&r.includes("?"))for(let n of T(e.path))a(e,t,n);else a(e,t)})),t}function T(e){let t=e.split("/");if(0===t.length)return[];let[r,...n]=t,a=r.endsWith("?"),i=r.replace(/\?$/,"");if(0===n.length)return a?[i,""]:[i];let s=T(n.join("/")),o=[];return o.push(...s.map((e=>""===e?i:[i,e].join("/")))),a&&o.push(...s),o.map((t=>e.startsWith("/")&&""===t?"/":t))}const _=/^:[\w-]+$/,S=3,k=2,C=1,I=10,A=-2,R=e=>"*"===e;function N(e,t){let r=e.split("/"),n=r.length;return r.some(R)&&(n+=A),t&&(n+=k),r.filter((e=>!R(e))).reduce(((e,t)=>e+(_.test(t)?S:""===t?C:I)),n)}function O(e,t,r){void 0===r&&(r=!1);let{routesMeta:n}=e,a={},i="/",s=[];for(let o=0;o<n.length;++o){let e=n[o],l=o===n.length-1,c="/"===i?t:t.slice(i.length)||"/",u=x({path:e.relativePath,caseSensitive:e.caseSensitive,end:l},c),h=e.route;if(!u&&l&&r&&!n[n.length-1].route.index&&(u=x({path:e.relativePath,caseSensitive:e.caseSensitive,end:!1},c)),!u)return null;Object.assign(a,u.params),s.push({params:a,pathname:V([i,u.pathname]),pathnameBase:B(V([i,u.pathnameBase])),route:h}),"/"!==u.pathnameBase&&(i=V([i,u.pathnameBase]))}return s}function x(e,t){"string"===typeof e&&(e={path:e,caseSensitive:!1,end:!0});let[r,n]=function(e,t,r){void 0===t&&(t=!1);void 0===r&&(r=!0);f("*"===e||!e.endsWith("*")||e.endsWith("/*"),'Route path "'+e+'" will be treated as if it were "'+e.replace(/\*$/,"/*")+'" because the `*` character must always follow a `/` in the pattern. To get rid of this warning, please change the route path to "'+e.replace(/\*$/,"/*")+'".');let n=[],a="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,((e,t,r)=>(n.push({paramName:t,isOptional:null!=r}),r?"/?([^\\/]+)?":"/([^\\/]+)")));e.endsWith("*")?(n.push({paramName:"*"}),a+="*"===e||"/*"===e?"(.*)$":"(?:\\/(.+)|\\/*)$"):r?a+="\\/*$":""!==e&&"/"!==e&&(a+="(?:(?=\\/|$))");let i=new RegExp(a,t?void 0:"i");return[i,n]}(e.path,e.caseSensitive,e.end),a=t.match(r);if(!a)return null;let i=a[0],s=i.replace(/(.)\/+$/,"$1"),o=a.slice(1);return{params:n.reduce(((e,t,r)=>{let{paramName:n,isOptional:a}=t;if("*"===n){let e=o[r]||"";s=i.slice(0,i.length-e.length).replace(/(.)\/+$/,"$1")}const l=o[r];return e[n]=a&&!l?void 0:(l||"").replace(/%2F/g,"/"),e}),{}),pathname:i,pathnameBase:s,pattern:e}}function P(e){try{return e.split("/").map((e=>decodeURIComponent(e).replace(/\//g,"%2F"))).join("/")}catch(t){return f(!1,'The URL path "'+e+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent encoding ('+t+")."),e}}function D(e,t){if("/"===t)return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let r=t.endsWith("/")?t.length-1:t.length,n=e.charAt(r);return n&&"/"!==n?null:e.slice(r)||"/"}function L(e,t,r,n){return"Cannot include a '"+e+"' character in a manually specified `to."+t+"` field ["+JSON.stringify(n)+"].  Please separate it out to the `to."+r+'` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.'}function M(e){return e.filter(((e,t)=>0===t||e.route.path&&e.route.path.length>0))}function F(e,t){let r=M(e);return t?r.map(((e,t)=>t===r.length-1?e.pathname:e.pathnameBase)):r.map((e=>e.pathnameBase))}function U(e,t,r,n){let a;void 0===n&&(n=!1),"string"===typeof e?a=g(e):(a=c({},e),h(!a.pathname||!a.pathname.includes("?"),L("?","pathname","search",a)),h(!a.pathname||!a.pathname.includes("#"),L("#","pathname","hash",a)),h(!a.search||!a.search.includes("#"),L("#","search","hash",a)));let i,s=""===e||""===a.pathname,o=s?"/":a.pathname;if(null==o)i=r;else{let e=t.length-1;if(!n&&o.startsWith("..")){let t=o.split("/");for(;".."===t[0];)t.shift(),e-=1;a.pathname=t.join("/")}i=e>=0?t[e]:"/"}let l=function(e,t){void 0===t&&(t="/");let{pathname:r,search:n="",hash:a=""}="string"===typeof e?g(e):e,i=r?r.startsWith("/")?r:function(e,t){let r=t.replace(/\/+$/,"").split("/");return e.split("/").forEach((e=>{".."===e?r.length>1&&r.pop():"."!==e&&r.push(e)})),r.length>1?r.join("/"):"/"}(r,t):t;return{pathname:i,search:z(n),hash:j(a)}}(a,i),u=o&&"/"!==o&&o.endsWith("/"),f=(s||"."===o)&&r.endsWith("/");return l.pathname.endsWith("/")||!u&&!f||(l.pathname+="/"),l}const V=e=>e.join("/").replace(/\/\/+/g,"/"),B=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),z=e=>e&&"?"!==e?e.startsWith("?")?e:"?"+e:"",j=e=>e&&"#"!==e?e.startsWith("#")?e:"#"+e:"";Error;function H(e){return null!=e&&"number"===typeof e.status&&"string"===typeof e.statusText&&"boolean"===typeof e.internal&&"data"in e}const W=["post","put","patch","delete"],G=(new Set(W),["get",...W]);new Set(G),new Set([301,302,303,307,308]),new Set([307,308]);Symbol("deferred");function K(){return K=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},K.apply(this,arguments)}const q=a.createContext(null);const X=a.createContext(null);const Y=a.createContext(null);const Q=a.createContext(null);const J=a.createContext({outlet:null,matches:[],isDataRoute:!1});const Z=a.createContext(null);function ee(){return null!=a.useContext(Q)}function te(){return ee()||h(!1),a.useContext(Q).location}function re(e){a.useContext(Y).static||a.useLayoutEffect(e)}function ne(){let{isDataRoute:e}=a.useContext(J);return e?function(){let{router:e}=fe(ue.UseNavigateStable),t=pe(he.UseNavigateStable),r=a.useRef(!1);return re((()=>{r.current=!0})),a.useCallback((function(n,a){void 0===a&&(a={}),r.current&&("number"===typeof n?e.navigate(n):e.navigate(n,K({fromRouteId:t},a)))}),[e,t])}():function(){ee()||h(!1);let e=a.useContext(q),{basename:t,future:r,navigator:n}=a.useContext(Y),{matches:i}=a.useContext(J),{pathname:s}=te(),o=JSON.stringify(F(i,r.v7_relativeSplatPath)),l=a.useRef(!1);return re((()=>{l.current=!0})),a.useCallback((function(r,a){if(void 0===a&&(a={}),!l.current)return;if("number"===typeof r)return void n.go(r);let i=U(r,JSON.parse(o),s,"path"===a.relative);null==e&&"/"!==t&&(i.pathname="/"===i.pathname?t:V([t,i.pathname])),(a.replace?n.replace:n.push)(i,a.state,a)}),[t,n,o,s,e])}()}function ae(e,t,r,i){ee()||h(!1);let{navigator:s,static:o}=a.useContext(Y),{matches:l}=a.useContext(J),c=l[l.length-1],u=c?c.params:{},f=(c&&c.pathname,c?c.pathnameBase:"/");c&&c.route;let d,p=te();if(t){var m;let e="string"===typeof t?g(t):t;"/"===f||(null==(m=e.pathname)?void 0:m.startsWith(f))||h(!1),d=e}else d=p;let v=d.pathname||"/",y=v;if("/"!==f){let e=f.replace(/^\//,"").split("/");y="/"+v.replace(/^\//,"").split("/").slice(e.length).join("/")}let w=!o&&r&&r.matches&&r.matches.length>0?r.matches:b(e,{pathname:y});let E=ce(w&&w.map((e=>Object.assign({},e,{params:Object.assign({},u,e.params),pathname:V([f,s.encodeLocation?s.encodeLocation(e.pathname).pathname:e.pathname]),pathnameBase:"/"===e.pathnameBase?f:V([f,s.encodeLocation?s.encodeLocation(e.pathnameBase).pathname:e.pathnameBase])}))),l,r,i);return t&&E?a.createElement(Q.Provider,{value:{location:K({pathname:"/",search:"",hash:"",state:null,key:"default"},d),navigationType:n.Pop}},E):E}function ie(){let e=function(){var e;let t=a.useContext(Z),r=de(he.UseRouteError),n=pe(he.UseRouteError);if(void 0!==t)return t;return null==(e=r.errors)?void 0:e[n]}(),t=H(e)?e.status+" "+e.statusText:e instanceof Error?e.message:JSON.stringify(e),r=e instanceof Error?e.stack:null,n="rgba(200,200,200, 0.5)",i={padding:"0.5rem",backgroundColor:n};return a.createElement(a.Fragment,null,a.createElement("h2",null,"Unexpected Application Error!"),a.createElement("h3",{style:{fontStyle:"italic"}},t),r?a.createElement("pre",{style:i},r):null,null)}const se=a.createElement(ie,null);class oe extends a.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,t){return t.location!==e.location||"idle"!==t.revalidation&&"idle"===e.revalidation?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:void 0!==e.error?e.error:t.error,location:t.location,revalidation:e.revalidation||t.revalidation}}componentDidCatch(e,t){console.error("React Router caught the following error during render",e,t)}render(){return void 0!==this.state.error?a.createElement(J.Provider,{value:this.props.routeContext},a.createElement(Z.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function le(e){let{routeContext:t,match:r,children:n}=e,i=a.useContext(q);return i&&i.static&&i.staticContext&&(r.route.errorElement||r.route.ErrorBoundary)&&(i.staticContext._deepestRenderedBoundaryId=r.route.id),a.createElement(J.Provider,{value:t},n)}function ce(e,t,r,n){var i;if(void 0===t&&(t=[]),void 0===r&&(r=null),void 0===n&&(n=null),null==e){var s;if(!r)return null;if(r.errors)e=r.matches;else{if(!(null!=(s=n)&&s.v7_partialHydration&&0===t.length&&!r.initialized&&r.matches.length>0))return null;e=r.matches}}let o=e,l=null==(i=r)?void 0:i.errors;if(null!=l){let e=o.findIndex((e=>e.route.id&&void 0!==(null==l?void 0:l[e.route.id])));e>=0||h(!1),o=o.slice(0,Math.min(o.length,e+1))}let c=!1,u=-1;if(r&&n&&n.v7_partialHydration)for(let a=0;a<o.length;a++){let e=o[a];if((e.route.HydrateFallback||e.route.hydrateFallbackElement)&&(u=a),e.route.id){let{loaderData:t,errors:n}=r,a=e.route.loader&&void 0===t[e.route.id]&&(!n||void 0===n[e.route.id]);if(e.route.lazy||a){c=!0,o=u>=0?o.slice(0,u+1):[o[0]];break}}}return o.reduceRight(((e,n,i)=>{let s,h=!1,f=null,d=null;var p;r&&(s=l&&n.route.id?l[n.route.id]:void 0,f=n.route.errorElement||se,c&&(u<0&&0===i?(p="route-fallback",!1||me[p]||(me[p]=!0),h=!0,d=null):u===i&&(h=!0,d=n.route.hydrateFallbackElement||null)));let m=t.concat(o.slice(0,i+1)),g=()=>{let t;return t=s?f:h?d:n.route.Component?a.createElement(n.route.Component,null):n.route.element?n.route.element:e,a.createElement(le,{match:n,routeContext:{outlet:e,matches:m,isDataRoute:null!=r},children:t})};return r&&(n.route.ErrorBoundary||n.route.errorElement||0===i)?a.createElement(oe,{location:r.location,revalidation:r.revalidation,component:f,error:s,children:g(),routeContext:{outlet:null,matches:m,isDataRoute:!0}}):g()}),null)}var ue=function(e){return e.UseBlocker="useBlocker",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e}(ue||{}),he=function(e){return e.UseBlocker="useBlocker",e.UseLoaderData="useLoaderData",e.UseActionData="useActionData",e.UseRouteError="useRouteError",e.UseNavigation="useNavigation",e.UseRouteLoaderData="useRouteLoaderData",e.UseMatches="useMatches",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e.UseRouteId="useRouteId",e}(he||{});function fe(e){let t=a.useContext(q);return t||h(!1),t}function de(e){let t=a.useContext(X);return t||h(!1),t}function pe(e){let t=function(){let e=a.useContext(J);return e||h(!1),e}(),r=t.matches[t.matches.length-1];return r.route.id||h(!1),r.route.id}const me={};function ge(e,t){null==e||e.v7_startTransition,void 0===(null==e?void 0:e.v7_relativeSplatPath)&&(!t||t.v7_relativeSplatPath),t&&(t.v7_fetcherPersist,t.v7_normalizeFormMethod,t.v7_partialHydration,t.v7_skipActionErrorRevalidation)}i.startTransition;function ve(e){let{to:t,replace:r,state:n,relative:i}=e;ee()||h(!1);let{future:s,static:o}=a.useContext(Y),{matches:l}=a.useContext(J),{pathname:c}=te(),u=ne(),f=U(t,F(l,s.v7_relativeSplatPath),c,"path"===i),d=JSON.stringify(f);return a.useEffect((()=>u(JSON.parse(d),{replace:r,state:n,relative:i})),[u,d,i,r,n]),null}function ye(e){h(!1)}function be(e){let{basename:t="/",children:r=null,location:i,navigationType:s=n.Pop,navigator:o,static:l=!1,future:c}=e;ee()&&h(!1);let u=t.replace(/^\/*/,"/"),f=a.useMemo((()=>({basename:u,navigator:o,static:l,future:K({v7_relativeSplatPath:!1},c)})),[u,c,o,l]);"string"===typeof i&&(i=g(i));let{pathname:d="/",search:p="",hash:m="",state:v=null,key:y="default"}=i,b=a.useMemo((()=>{let e=D(d,u);return null==e?null:{location:{pathname:e,search:p,hash:m,state:v,key:y},navigationType:s}}),[u,d,p,m,v,y,s]);return null==b?null:a.createElement(Y.Provider,{value:f},a.createElement(Q.Provider,{children:r,value:b}))}function we(e){let{children:t,location:r}=e;return ae(Ee(t),r)}new Promise((()=>{}));a.Component;function Ee(e,t){void 0===t&&(t=[]);let r=[];return a.Children.forEach(e,((e,n)=>{if(!a.isValidElement(e))return;let i=[...t,n];if(e.type===a.Fragment)return void r.push.apply(r,Ee(e.props.children,i));e.type!==ye&&h(!1),e.props.index&&e.props.children&&h(!1);let s={id:e.props.id||i.join("-"),caseSensitive:e.props.caseSensitive,element:e.props.element,Component:e.props.Component,index:e.props.index,path:e.props.path,loader:e.props.loader,action:e.props.action,errorElement:e.props.errorElement,ErrorBoundary:e.props.ErrorBoundary,hasErrorBoundary:null!=e.props.ErrorBoundary||null!=e.props.errorElement,shouldRevalidate:e.props.shouldRevalidate,handle:e.props.handle,lazy:e.props.lazy};e.props.children&&(s.children=Ee(e.props.children,i)),r.push(s)})),r}new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);try{window.__reactRouterVersion="6"}catch(Ok){}new Map;const Te=i.startTransition;l.flushSync,i.useId;function _e(e){let{basename:t,children:r,future:n,window:i}=e,s=a.useRef();var o;null==s.current&&(s.current=(void 0===(o={window:i,v5Compat:!0})&&(o={}),v((function(e,t){let{pathname:r="/",search:n="",hash:a=""}=g(e.location.hash.substr(1));return r.startsWith("/")||r.startsWith(".")||(r="/"+r),p("",{pathname:r,search:n,hash:a},t.state&&t.state.usr||null,t.state&&t.state.key||"default")}),(function(e,t){let r=e.document.querySelector("base"),n="";if(r&&r.getAttribute("href")){let t=e.location.href,r=t.indexOf("#");n=-1===r?t:t.slice(0,r)}return n+"#"+("string"===typeof t?t:m(t))}),(function(e,t){f("/"===e.pathname.charAt(0),"relative pathnames are not supported in hash history.push("+JSON.stringify(t)+")")}),o)));let l=s.current,[c,u]=a.useState({action:l.action,location:l.location}),{v7_startTransition:h}=n||{},d=a.useCallback((e=>{h&&Te?Te((()=>u(e))):u(e)}),[u,h]);return a.useLayoutEffect((()=>l.listen(d)),[l,d]),a.useEffect((()=>ge(n)),[n]),a.createElement(be,{basename:t,children:r,location:c.location,navigationType:c.action,navigator:l,future:n})}"undefined"!==typeof window&&"undefined"!==typeof window.document&&window.document.createElement;var Se,ke;(function(e){e.UseScrollRestoration="useScrollRestoration",e.UseSubmit="useSubmit",e.UseSubmitFetcher="useSubmitFetcher",e.UseFetcher="useFetcher",e.useViewTransitionState="useViewTransitionState"})(Se||(Se={})),function(e){e.UseFetcher="useFetcher",e.UseFetchers="useFetchers",e.UseScrollRestoration="useScrollRestoration"}(ke||(ke={}));const Ce=function(e){const t=[];let r=0;for(let n=0;n<e.length;n++){let a=e.charCodeAt(n);a<128?t[r++]=a:a<2048?(t[r++]=a>>6|192,t[r++]=63&a|128):55296===(64512&a)&&n+1<e.length&&56320===(64512&e.charCodeAt(n+1))?(a=65536+((1023&a)<<10)+(1023&e.charCodeAt(++n)),t[r++]=a>>18|240,t[r++]=a>>12&63|128,t[r++]=a>>6&63|128,t[r++]=63&a|128):(t[r++]=a>>12|224,t[r++]=a>>6&63|128,t[r++]=63&a|128)}return t},Ie={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"===typeof atob,encodeByteArray(e,t){if(!Array.isArray(e))throw Error("encodeByteArray takes an array as a parameter");this.init_();const r=t?this.byteToCharMapWebSafe_:this.byteToCharMap_,n=[];for(let a=0;a<e.length;a+=3){const t=e[a],i=a+1<e.length,s=i?e[a+1]:0,o=a+2<e.length,l=o?e[a+2]:0,c=t>>2,u=(3&t)<<4|s>>4;let h=(15&s)<<2|l>>6,f=63&l;o||(f=64,i||(h=64)),n.push(r[c],r[u],r[h],r[f])}return n.join("")},encodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?btoa(e):this.encodeByteArray(Ce(e),t)},decodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?atob(e):function(e){const t=[];let r=0,n=0;for(;r<e.length;){const a=e[r++];if(a<128)t[n++]=String.fromCharCode(a);else if(a>191&&a<224){const i=e[r++];t[n++]=String.fromCharCode((31&a)<<6|63&i)}else if(a>239&&a<365){const i=((7&a)<<18|(63&e[r++])<<12|(63&e[r++])<<6|63&e[r++])-65536;t[n++]=String.fromCharCode(55296+(i>>10)),t[n++]=String.fromCharCode(56320+(1023&i))}else{const i=e[r++],s=e[r++];t[n++]=String.fromCharCode((15&a)<<12|(63&i)<<6|63&s)}}return t.join("")}(this.decodeStringToByteArray(e,t))},decodeStringToByteArray(e,t){this.init_();const r=t?this.charToByteMapWebSafe_:this.charToByteMap_,n=[];for(let a=0;a<e.length;){const t=r[e.charAt(a++)],i=a<e.length?r[e.charAt(a)]:0;++a;const s=a<e.length?r[e.charAt(a)]:64;++a;const o=a<e.length?r[e.charAt(a)]:64;if(++a,null==t||null==i||null==s||null==o)throw new Ae;const l=t<<2|i>>4;if(n.push(l),64!==s){const e=i<<4&240|s>>2;if(n.push(e),64!==o){const e=s<<6&192|o;n.push(e)}}}return n},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let e=0;e<this.ENCODED_VALS.length;e++)this.byteToCharMap_[e]=this.ENCODED_VALS.charAt(e),this.charToByteMap_[this.byteToCharMap_[e]]=e,this.byteToCharMapWebSafe_[e]=this.ENCODED_VALS_WEBSAFE.charAt(e),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[e]]=e,e>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(e)]=e,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(e)]=e)}}};class Ae extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const Re=function(e){return function(e){const t=Ce(e);return Ie.encodeByteArray(t,!0)}(e).replace(/\./g,"")},Ne=function(e){try{return Ie.decodeString(e,!0)}catch(Ok){console.error("base64Decode failed: ",Ok)}return null};const Oe=()=>function(){if("undefined"!==typeof self)return self;if("undefined"!==typeof window)return window;if("undefined"!==typeof r.g)return r.g;throw new Error("Unable to locate global object.")}().__FIREBASE_DEFAULTS__,xe=()=>{try{return Oe()||(()=>{if("undefined"===typeof process)return;const e={NODE_ENV:"production",PUBLIC_URL:"/verbose-octo-pancake",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.__FIREBASE_DEFAULTS__;return e?JSON.parse(e):void 0})()||(()=>{if("undefined"===typeof document)return;let e;try{e=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch(Ok){return}const t=e&&Ne(e[1]);return t&&JSON.parse(t)})()}catch(Ok){return void console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${Ok}`)}},Pe=e=>{var t,r;return null===(r=null===(t=xe())||void 0===t?void 0:t.emulatorHosts)||void 0===r?void 0:r[e]},De=()=>{var e;return null===(e=xe())||void 0===e?void 0:e.config},Le=e=>{var t;return null===(t=xe())||void 0===t?void 0:t[`_${e}`]};class Me{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}wrapCallback(e){return(t,r)=>{t?this.reject(t):this.resolve(r),"function"===typeof e&&(this.promise.catch((()=>{})),1===e.length?e(t):e(t,r))}}}function Fe(){return"undefined"!==typeof navigator&&"string"===typeof navigator.userAgent?navigator.userAgent:""}function Ue(){return!function(){var e;const t=null===(e=xe())||void 0===e?void 0:e.forceEnvironment;if("node"===t)return!0;if("browser"===t)return!1;try{return"[object process]"===Object.prototype.toString.call(r.g.process)}catch(Ok){return!1}}()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function Ve(){try{return"object"===typeof indexedDB}catch(Ok){return!1}}class Be extends Error{constructor(e,t,r){super(t),this.code=e,this.customData=r,this.name="FirebaseError",Object.setPrototypeOf(this,Be.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,ze.prototype.create)}}class ze{constructor(e,t,r){this.service=e,this.serviceName=t,this.errors=r}create(e){const t=(arguments.length<=1?void 0:arguments[1])||{},r=`${this.service}/${e}`,n=this.errors[e],a=n?function(e,t){return e.replace(je,((e,r)=>{const n=t[r];return null!=n?String(n):`<${r}?>`}))}(n,t):"Error",i=`${this.serviceName}: ${a} (${r}).`;return new Be(r,i,t)}}const je=/\{\$([^}]+)}/g;function He(e,t){if(e===t)return!0;const r=Object.keys(e),n=Object.keys(t);for(const a of r){if(!n.includes(a))return!1;const r=e[a],i=t[a];if($e(r)&&$e(i)){if(!He(r,i))return!1}else if(r!==i)return!1}for(const a of n)if(!r.includes(a))return!1;return!0}function $e(e){return null!==e&&"object"===typeof e}function We(e){const t=[];for(const[r,n]of Object.entries(e))Array.isArray(n)?n.forEach((e=>{t.push(encodeURIComponent(r)+"="+encodeURIComponent(e))})):t.push(encodeURIComponent(r)+"="+encodeURIComponent(n));return t.length?"&"+t.join("&"):""}function Ge(e){const t={};return e.replace(/^\?/,"").split("&").forEach((e=>{if(e){const[r,n]=e.split("=");t[decodeURIComponent(r)]=decodeURIComponent(n)}})),t}function Ke(e){const t=e.indexOf("?");if(!t)return"";const r=e.indexOf("#",t);return e.substring(t,r>0?r:void 0)}class qe{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then((()=>{e(this)})).catch((e=>{this.error(e)}))}next(e){this.forEachObserver((t=>{t.next(e)}))}error(e){this.forEachObserver((t=>{t.error(e)})),this.close(e)}complete(){this.forEachObserver((e=>{e.complete()})),this.close()}subscribe(e,t,r){let n;if(void 0===e&&void 0===t&&void 0===r)throw new Error("Missing Observer.");n=function(e,t){if("object"!==typeof e||null===e)return!1;for(const r of t)if(r in e&&"function"===typeof e[r])return!0;return!1}(e,["next","error","complete"])?e:{next:e,error:t,complete:r},void 0===n.next&&(n.next=Xe),void 0===n.error&&(n.error=Xe),void 0===n.complete&&(n.complete=Xe);const a=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then((()=>{try{this.finalError?n.error(this.finalError):n.complete()}catch(Ok){}})),this.observers.push(n),a}unsubscribeOne(e){void 0!==this.observers&&void 0!==this.observers[e]&&(delete this.observers[e],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then((()=>{if(void 0!==this.observers&&void 0!==this.observers[e])try{t(this.observers[e])}catch(Ok){"undefined"!==typeof console&&console.error&&console.error(Ok)}}))}close(e){this.finalized||(this.finalized=!0,void 0!==e&&(this.finalError=e),this.task.then((()=>{this.observers=void 0,this.onNoObservers=void 0})))}}function Xe(){}function Ye(e){return e&&e._delegate?e._delegate:e}class Qe{constructor(e,t,r){this.name=e,this.instanceFactory=t,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}const Je="[DEFAULT]";class Ze{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const e=new Me;if(this.instancesDeferred.set(t,e),this.isInitialized(t)||this.shouldAutoInitialize())try{const r=this.getOrInitializeService({instanceIdentifier:t});r&&e.resolve(r)}catch(Ok){}}return this.instancesDeferred.get(t).promise}getImmediate(e){var t;const r=this.normalizeInstanceIdentifier(null===e||void 0===e?void 0:e.identifier),n=null!==(t=null===e||void 0===e?void 0:e.optional)&&void 0!==t&&t;if(!this.isInitialized(r)&&!this.shouldAutoInitialize()){if(n)return null;throw Error(`Service ${this.name} is not available`)}try{return this.getOrInitializeService({instanceIdentifier:r})}catch(Ok){if(n)return null;throw Ok}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,this.shouldAutoInitialize()){if(function(e){return"EAGER"===e.instantiationMode}(e))try{this.getOrInitializeService({instanceIdentifier:Je})}catch(Ok){}for(const[e,t]of this.instancesDeferred.entries()){const r=this.normalizeInstanceIdentifier(e);try{const e=this.getOrInitializeService({instanceIdentifier:r});t.resolve(e)}catch(Ok){}}}}clearInstance(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Je;this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter((e=>"INTERNAL"in e)).map((e=>e.INTERNAL.delete())),...e.filter((e=>"_delete"in e)).map((e=>e._delete()))])}isComponentSet(){return null!=this.component}isInitialized(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Je;return this.instances.has(e)}getOptions(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Je;return this.instancesOptions.get(e)||{}}initialize(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{options:t={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const n=this.getOrInitializeService({instanceIdentifier:r,options:t});for(const[a,i]of this.instancesDeferred.entries()){r===this.normalizeInstanceIdentifier(a)&&i.resolve(n)}return n}onInit(e,t){var r;const n=this.normalizeInstanceIdentifier(t),a=null!==(r=this.onInitCallbacks.get(n))&&void 0!==r?r:new Set;a.add(e),this.onInitCallbacks.set(n,a);const i=this.instances.get(n);return i&&e(i,n),()=>{a.delete(e)}}invokeOnInitCallbacks(e,t){const r=this.onInitCallbacks.get(t);if(r)for(const a of r)try{a(e,t)}catch(n){}}getOrInitializeService(e){let{instanceIdentifier:t,options:r={}}=e,n=this.instances.get(t);if(!n&&this.component&&(n=this.component.instanceFactory(this.container,{instanceIdentifier:(a=t,a===Je?void 0:a),options:r}),this.instances.set(t,n),this.instancesOptions.set(t,r),this.invokeOnInitCallbacks(n,t),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,t,n)}catch(i){}var a;return n||null}normalizeInstanceIdentifier(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Je;return this.component?this.component.multipleInstances?e:Je:e}shouldAutoInitialize(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode}}class et{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new Ze(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}const tt=[];var rt;!function(e){e[e.DEBUG=0]="DEBUG",e[e.VERBOSE=1]="VERBOSE",e[e.INFO=2]="INFO",e[e.WARN=3]="WARN",e[e.ERROR=4]="ERROR",e[e.SILENT=5]="SILENT"}(rt||(rt={}));const nt={debug:rt.DEBUG,verbose:rt.VERBOSE,info:rt.INFO,warn:rt.WARN,error:rt.ERROR,silent:rt.SILENT},at=rt.INFO,it={[rt.DEBUG]:"log",[rt.VERBOSE]:"log",[rt.INFO]:"info",[rt.WARN]:"warn",[rt.ERROR]:"error"},st=function(e,t){if(t<e.logLevel)return;const r=(new Date).toISOString(),n=it[t];if(!n)throw new Error(`Attempted to log a message with an invalid logType (value: ${t})`);for(var a=arguments.length,i=new Array(a>2?a-2:0),s=2;s<a;s++)i[s-2]=arguments[s];console[n](`[${r}]  ${e.name}:`,...i)};class ot{constructor(e){this.name=e,this._logLevel=at,this._logHandler=st,this._userLogHandler=null,tt.push(this)}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in rt))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel="string"===typeof e?nt[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if("function"!==typeof e)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];this._userLogHandler&&this._userLogHandler(this,rt.DEBUG,...t),this._logHandler(this,rt.DEBUG,...t)}log(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];this._userLogHandler&&this._userLogHandler(this,rt.VERBOSE,...t),this._logHandler(this,rt.VERBOSE,...t)}info(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];this._userLogHandler&&this._userLogHandler(this,rt.INFO,...t),this._logHandler(this,rt.INFO,...t)}warn(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];this._userLogHandler&&this._userLogHandler(this,rt.WARN,...t),this._logHandler(this,rt.WARN,...t)}error(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];this._userLogHandler&&this._userLogHandler(this,rt.ERROR,...t),this._logHandler(this,rt.ERROR,...t)}}let lt,ct;const ut=new WeakMap,ht=new WeakMap,ft=new WeakMap,dt=new WeakMap,pt=new WeakMap;let mt={get(e,t,r){if(e instanceof IDBTransaction){if("done"===t)return ht.get(e);if("objectStoreNames"===t)return e.objectStoreNames||ft.get(e);if("store"===t)return r.objectStoreNames[1]?void 0:r.objectStore(r.objectStoreNames[0])}return yt(e[t])},set:(e,t,r)=>(e[t]=r,!0),has:(e,t)=>e instanceof IDBTransaction&&("done"===t||"store"===t)||t in e};function gt(e){return e!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?(ct||(ct=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])).includes(e)?function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return e.apply(bt(this),r),yt(ut.get(this))}:function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return yt(e.apply(bt(this),r))}:function(t){for(var r=arguments.length,n=new Array(r>1?r-1:0),a=1;a<r;a++)n[a-1]=arguments[a];const i=e.call(bt(this),t,...n);return ft.set(i,t.sort?t.sort():[t]),yt(i)}}function vt(e){return"function"===typeof e?gt(e):(e instanceof IDBTransaction&&function(e){if(ht.has(e))return;const t=new Promise(((t,r)=>{const n=()=>{e.removeEventListener("complete",a),e.removeEventListener("error",i),e.removeEventListener("abort",i)},a=()=>{t(),n()},i=()=>{r(e.error||new DOMException("AbortError","AbortError")),n()};e.addEventListener("complete",a),e.addEventListener("error",i),e.addEventListener("abort",i)}));ht.set(e,t)}(e),t=e,(lt||(lt=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])).some((e=>t instanceof e))?new Proxy(e,mt):e);var t}function yt(e){if(e instanceof IDBRequest)return function(e){const t=new Promise(((t,r)=>{const n=()=>{e.removeEventListener("success",a),e.removeEventListener("error",i)},a=()=>{t(yt(e.result)),n()},i=()=>{r(e.error),n()};e.addEventListener("success",a),e.addEventListener("error",i)}));return t.then((t=>{t instanceof IDBCursor&&ut.set(t,e)})).catch((()=>{})),pt.set(t,e),t}(e);if(dt.has(e))return dt.get(e);const t=vt(e);return t!==e&&(dt.set(e,t),pt.set(t,e)),t}const bt=e=>pt.get(e);const wt=["get","getKey","getAll","getAllKeys","count"],Et=["put","add","delete","clear"],Tt=new Map;function _t(e,t){if(!(e instanceof IDBDatabase)||t in e||"string"!==typeof t)return;if(Tt.get(t))return Tt.get(t);const r=t.replace(/FromIndex$/,""),n=t!==r,a=Et.includes(r);if(!(r in(n?IDBIndex:IDBObjectStore).prototype)||!a&&!wt.includes(r))return;const i=async function(e){const t=this.transaction(e,a?"readwrite":"readonly");let i=t.store;for(var s=arguments.length,o=new Array(s>1?s-1:0),l=1;l<s;l++)o[l-1]=arguments[l];return n&&(i=i.index(o.shift())),(await Promise.all([i[r](...o),a&&t.done]))[0]};return Tt.set(t,i),i}mt=(e=>({...e,get:(t,r,n)=>_t(t,r)||e.get(t,r,n),has:(t,r)=>!!_t(t,r)||e.has(t,r)}))(mt);class St{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map((e=>{if(function(e){const t=e.getComponent();return"VERSION"===(null===t||void 0===t?void 0:t.type)}(e)){const t=e.getImmediate();return`${t.library}/${t.version}`}return null})).filter((e=>e)).join(" ")}}const kt="@firebase/app",Ct="0.11.4",It=new ot("@firebase/app"),At="@firebase/app-compat",Rt="@firebase/analytics-compat",Nt="@firebase/analytics",Ot="@firebase/app-check-compat",xt="@firebase/app-check",Pt="@firebase/auth",Dt="@firebase/auth-compat",Lt="@firebase/database",Mt="@firebase/data-connect",Ft="@firebase/database-compat",Ut="@firebase/functions",Vt="@firebase/functions-compat",Bt="@firebase/installations",zt="@firebase/installations-compat",jt="@firebase/messaging",Ht="@firebase/messaging-compat",$t="@firebase/performance",Wt="@firebase/performance-compat",Gt="@firebase/remote-config",Kt="@firebase/remote-config-compat",qt="@firebase/storage",Xt="@firebase/storage-compat",Yt="@firebase/firestore",Qt="@firebase/vertexai",Jt="@firebase/firestore-compat",Zt="firebase",er="[DEFAULT]",tr={[kt]:"fire-core",[At]:"fire-core-compat",[Nt]:"fire-analytics",[Rt]:"fire-analytics-compat",[xt]:"fire-app-check",[Ot]:"fire-app-check-compat",[Pt]:"fire-auth",[Dt]:"fire-auth-compat",[Lt]:"fire-rtdb",[Mt]:"fire-data-connect",[Ft]:"fire-rtdb-compat",[Ut]:"fire-fn",[Vt]:"fire-fn-compat",[Bt]:"fire-iid",[zt]:"fire-iid-compat",[jt]:"fire-fcm",[Ht]:"fire-fcm-compat",[$t]:"fire-perf",[Wt]:"fire-perf-compat",[Gt]:"fire-rc",[Kt]:"fire-rc-compat",[qt]:"fire-gcs",[Xt]:"fire-gcs-compat",[Yt]:"fire-fst",[Jt]:"fire-fst-compat",[Qt]:"fire-vertex","fire-js":"fire-js",[Zt]:"fire-js-all"},rr=new Map,nr=new Map,ar=new Map;function ir(e,t){try{e.container.addComponent(t)}catch(Ok){It.debug(`Component ${t.name} failed to register with FirebaseApp ${e.name}`,Ok)}}function sr(e){const t=e.name;if(ar.has(t))return It.debug(`There were multiple attempts to register component ${t}.`),!1;ar.set(t,e);for(const r of rr.values())ir(r,e);for(const r of nr.values())ir(r,e);return!0}function or(e,t){const r=e.container.getProvider("heartbeat").getImmediate({optional:!0});return r&&r.triggerHeartbeat(),e.container.getProvider(t)}function lr(e){return null!==e&&void 0!==e&&void 0!==e.settings}const cr=new ze("app","Firebase",{"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."});class ur{constructor(e,t,r){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new Qe("app",(()=>this),"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw cr.create("app-deleted",{appName:this._name})}}const hr="11.6.0";function fr(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=e;if("object"!==typeof t){t={name:t}}const n=Object.assign({name:er,automaticDataCollectionEnabled:!1},t),a=n.name;if("string"!==typeof a||!a)throw cr.create("bad-app-name",{appName:String(a)});if(r||(r=De()),!r)throw cr.create("no-options");const i=rr.get(a);if(i){if(He(r,i.options)&&He(n,i.config))return i;throw cr.create("duplicate-app",{appName:a})}const s=new et(a);for(const l of ar.values())s.addComponent(l);const o=new ur(r,n,s);return rr.set(a,o),o}function dr(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:er;const t=rr.get(e);if(!t&&e===er&&De())return fr();if(!t)throw cr.create("no-app",{appName:e});return t}function pr(e,t,r){var n;let a=null!==(n=tr[e])&&void 0!==n?n:e;r&&(a+=`-${r}`);const i=a.match(/\s|\//),s=t.match(/\s|\//);if(i||s){const e=[`Unable to register library "${a}" with version "${t}":`];return i&&e.push(`library name "${a}" contains illegal characters (whitespace or "/")`),i&&s&&e.push("and"),s&&e.push(`version name "${t}" contains illegal characters (whitespace or "/")`),void It.warn(e.join(" "))}sr(new Qe(`${a}-version`,(()=>({library:a,version:t})),"VERSION"))}const mr="firebase-heartbeat-store";let gr=null;function vr(){return gr||(gr=function(e,t){let{blocked:r,upgrade:n,blocking:a,terminated:i}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const s=indexedDB.open(e,t),o=yt(s);return n&&s.addEventListener("upgradeneeded",(e=>{n(yt(s.result),e.oldVersion,e.newVersion,yt(s.transaction),e)})),r&&s.addEventListener("blocked",(e=>r(e.oldVersion,e.newVersion,e))),o.then((e=>{i&&e.addEventListener("close",(()=>i())),a&&e.addEventListener("versionchange",(e=>a(e.oldVersion,e.newVersion,e)))})).catch((()=>{})),o}("firebase-heartbeat-database",1,{upgrade:(e,t)=>{if(0===t)try{e.createObjectStore(mr)}catch(Ok){console.warn(Ok)}}}).catch((e=>{throw cr.create("idb-open",{originalErrorMessage:e.message})}))),gr}async function yr(e,t){try{const r=(await vr()).transaction(mr,"readwrite"),n=r.objectStore(mr);await n.put(t,br(e)),await r.done}catch(Ok){if(Ok instanceof Be)It.warn(Ok.message);else{const t=cr.create("idb-set",{originalErrorMessage:null===Ok||void 0===Ok?void 0:Ok.message});It.warn(t.message)}}}function br(e){return`${e.name}!${e.options.appId}`}class wr{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new Tr(t),this._heartbeatsCachePromise=this._storage.read().then((e=>(this._heartbeatsCache=e,e)))}async triggerHeartbeat(){var e,t;try{const r=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),n=Er();if(null==(null===(e=this._heartbeatsCache)||void 0===e?void 0:e.heartbeats)&&(this._heartbeatsCache=await this._heartbeatsCachePromise,null==(null===(t=this._heartbeatsCache)||void 0===t?void 0:t.heartbeats)))return;if(this._heartbeatsCache.lastSentHeartbeatDate===n||this._heartbeatsCache.heartbeats.some((e=>e.date===n)))return;if(this._heartbeatsCache.heartbeats.push({date:n,agent:r}),this._heartbeatsCache.heartbeats.length>30){const e=function(e){if(0===e.length)return-1;let t=0,r=e[0].date;for(let n=1;n<e.length;n++)e[n].date<r&&(r=e[n].date,t=n);return t}(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(e,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(Ok){It.warn(Ok)}}async getHeartbeatsHeader(){var e;try{if(null===this._heartbeatsCache&&await this._heartbeatsCachePromise,null==(null===(e=this._heartbeatsCache)||void 0===e?void 0:e.heartbeats)||0===this._heartbeatsCache.heartbeats.length)return"";const t=Er(),{heartbeatsToSend:r,unsentEntries:n}=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1024;const r=[];let n=e.slice();for(const a of e){const e=r.find((e=>e.agent===a.agent));if(e){if(e.dates.push(a.date),_r(r)>t){e.dates.pop();break}}else if(r.push({agent:a.agent,dates:[a.date]}),_r(r)>t){r.pop();break}n=n.slice(1)}return{heartbeatsToSend:r,unsentEntries:n}}(this._heartbeatsCache.heartbeats),a=Re(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=t,n.length>0?(this._heartbeatsCache.heartbeats=n,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),a}catch(Ok){return It.warn(Ok),""}}}function Er(){return(new Date).toISOString().substring(0,10)}class Tr{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return!!Ve()&&new Promise(((e,t)=>{try{let r=!0;const n="validate-browser-context-for-indexeddb-analytics-module",a=self.indexedDB.open(n);a.onsuccess=()=>{a.result.close(),r||self.indexedDB.deleteDatabase(n),e(!0)},a.onupgradeneeded=()=>{r=!1},a.onerror=()=>{var e;t((null===(e=a.error)||void 0===e?void 0:e.message)||"")}}catch(r){t(r)}})).then((()=>!0)).catch((()=>!1))}async read(){if(await this._canUseIndexedDBPromise){const e=await async function(e){try{const t=(await vr()).transaction(mr),r=await t.objectStore(mr).get(br(e));return await t.done,r}catch(Ok){if(Ok instanceof Be)It.warn(Ok.message);else{const t=cr.create("idb-get",{originalErrorMessage:null===Ok||void 0===Ok?void 0:Ok.message});It.warn(t.message)}}}(this.app);return(null===e||void 0===e?void 0:e.heartbeats)?e:{heartbeats:[]}}return{heartbeats:[]}}async overwrite(e){var t;if(await this._canUseIndexedDBPromise){const r=await this.read();return yr(this.app,{lastSentHeartbeatDate:null!==(t=e.lastSentHeartbeatDate)&&void 0!==t?t:r.lastSentHeartbeatDate,heartbeats:e.heartbeats})}}async add(e){var t;if(await this._canUseIndexedDBPromise){const r=await this.read();return yr(this.app,{lastSentHeartbeatDate:null!==(t=e.lastSentHeartbeatDate)&&void 0!==t?t:r.lastSentHeartbeatDate,heartbeats:[...r.heartbeats,...e.heartbeats]})}}}function _r(e){return Re(JSON.stringify({version:2,heartbeats:e})).length}var Sr;Sr="",sr(new Qe("platform-logger",(e=>new St(e)),"PRIVATE")),sr(new Qe("heartbeat",(e=>new wr(e)),"PRIVATE")),pr(kt,Ct,Sr),pr(kt,Ct,"esm2017"),pr("fire-js","");pr("firebase","11.6.0","app");var kr,Cr,Ir="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof window?window:"undefined"!==typeof global?global:"undefined"!==typeof self?self:{},Ar={};(function(){var e;function t(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}function r(e,t,r){r||(r=0);var n=Array(16);if("string"===typeof t)for(var a=0;16>a;++a)n[a]=t.charCodeAt(r++)|t.charCodeAt(r++)<<8|t.charCodeAt(r++)<<16|t.charCodeAt(r++)<<24;else for(a=0;16>a;++a)n[a]=t[r++]|t[r++]<<8|t[r++]<<16|t[r++]<<24;t=e.g[0],r=e.g[1],a=e.g[2];var i=e.g[3],s=t+(i^r&(a^i))+n[0]+3614090360&4294967295;s=(r=(a=(i=(t=(r=(a=(i=(t=(r=(a=(i=(t=(r=(a=(i=(t=(r=(a=(i=(t=(r=(a=(i=(t=(r=(a=(i=(t=(r=(a=(i=(t=(r=(a=(i=(t=(r=(a=(i=(t=(r=(a=(i=(t=(r=(a=(i=(t=(r=(a=(i=(t=(r=(a=(i=(t=(r=(a=(i=(t=r+(s<<7&4294967295|s>>>25))+((s=i+(a^t&(r^a))+n[1]+3905402710&4294967295)<<12&4294967295|s>>>20))+((s=a+(r^i&(t^r))+n[2]+606105819&4294967295)<<17&4294967295|s>>>15))+((s=r+(t^a&(i^t))+n[3]+3250441966&4294967295)<<22&4294967295|s>>>10))+((s=t+(i^r&(a^i))+n[4]+4118548399&4294967295)<<7&4294967295|s>>>25))+((s=i+(a^t&(r^a))+n[5]+1200080426&4294967295)<<12&4294967295|s>>>20))+((s=a+(r^i&(t^r))+n[6]+2821735955&4294967295)<<17&4294967295|s>>>15))+((s=r+(t^a&(i^t))+n[7]+4249261313&4294967295)<<22&4294967295|s>>>10))+((s=t+(i^r&(a^i))+n[8]+1770035416&4294967295)<<7&4294967295|s>>>25))+((s=i+(a^t&(r^a))+n[9]+2336552879&4294967295)<<12&4294967295|s>>>20))+((s=a+(r^i&(t^r))+n[10]+4294925233&4294967295)<<17&4294967295|s>>>15))+((s=r+(t^a&(i^t))+n[11]+2304563134&4294967295)<<22&4294967295|s>>>10))+((s=t+(i^r&(a^i))+n[12]+1804603682&4294967295)<<7&4294967295|s>>>25))+((s=i+(a^t&(r^a))+n[13]+4254626195&4294967295)<<12&4294967295|s>>>20))+((s=a+(r^i&(t^r))+n[14]+2792965006&4294967295)<<17&4294967295|s>>>15))+((s=r+(t^a&(i^t))+n[15]+1236535329&4294967295)<<22&4294967295|s>>>10))+((s=t+(a^i&(r^a))+n[1]+4129170786&4294967295)<<5&4294967295|s>>>27))+((s=i+(r^a&(t^r))+n[6]+3225465664&4294967295)<<9&4294967295|s>>>23))+((s=a+(t^r&(i^t))+n[11]+643717713&4294967295)<<14&4294967295|s>>>18))+((s=r+(i^t&(a^i))+n[0]+3921069994&4294967295)<<20&4294967295|s>>>12))+((s=t+(a^i&(r^a))+n[5]+3593408605&4294967295)<<5&4294967295|s>>>27))+((s=i+(r^a&(t^r))+n[10]+38016083&4294967295)<<9&4294967295|s>>>23))+((s=a+(t^r&(i^t))+n[15]+3634488961&4294967295)<<14&4294967295|s>>>18))+((s=r+(i^t&(a^i))+n[4]+3889429448&4294967295)<<20&4294967295|s>>>12))+((s=t+(a^i&(r^a))+n[9]+568446438&4294967295)<<5&4294967295|s>>>27))+((s=i+(r^a&(t^r))+n[14]+3275163606&4294967295)<<9&4294967295|s>>>23))+((s=a+(t^r&(i^t))+n[3]+4107603335&4294967295)<<14&4294967295|s>>>18))+((s=r+(i^t&(a^i))+n[8]+1163531501&4294967295)<<20&4294967295|s>>>12))+((s=t+(a^i&(r^a))+n[13]+2850285829&4294967295)<<5&4294967295|s>>>27))+((s=i+(r^a&(t^r))+n[2]+4243563512&4294967295)<<9&4294967295|s>>>23))+((s=a+(t^r&(i^t))+n[7]+1735328473&4294967295)<<14&4294967295|s>>>18))+((s=r+(i^t&(a^i))+n[12]+2368359562&4294967295)<<20&4294967295|s>>>12))+((s=t+(r^a^i)+n[5]+4294588738&4294967295)<<4&4294967295|s>>>28))+((s=i+(t^r^a)+n[8]+2272392833&4294967295)<<11&4294967295|s>>>21))+((s=a+(i^t^r)+n[11]+1839030562&4294967295)<<16&4294967295|s>>>16))+((s=r+(a^i^t)+n[14]+4259657740&4294967295)<<23&4294967295|s>>>9))+((s=t+(r^a^i)+n[1]+2763975236&4294967295)<<4&4294967295|s>>>28))+((s=i+(t^r^a)+n[4]+1272893353&4294967295)<<11&4294967295|s>>>21))+((s=a+(i^t^r)+n[7]+4139469664&4294967295)<<16&4294967295|s>>>16))+((s=r+(a^i^t)+n[10]+3200236656&4294967295)<<23&4294967295|s>>>9))+((s=t+(r^a^i)+n[13]+681279174&4294967295)<<4&4294967295|s>>>28))+((s=i+(t^r^a)+n[0]+3936430074&4294967295)<<11&4294967295|s>>>21))+((s=a+(i^t^r)+n[3]+3572445317&4294967295)<<16&4294967295|s>>>16))+((s=r+(a^i^t)+n[6]+76029189&4294967295)<<23&4294967295|s>>>9))+((s=t+(r^a^i)+n[9]+3654602809&4294967295)<<4&4294967295|s>>>28))+((s=i+(t^r^a)+n[12]+3873151461&4294967295)<<11&4294967295|s>>>21))+((s=a+(i^t^r)+n[15]+530742520&4294967295)<<16&4294967295|s>>>16))+((s=r+(a^i^t)+n[2]+3299628645&4294967295)<<23&4294967295|s>>>9))+((s=t+(a^(r|~i))+n[0]+4096336452&4294967295)<<6&4294967295|s>>>26))+((s=i+(r^(t|~a))+n[7]+1126891415&4294967295)<<10&4294967295|s>>>22))+((s=a+(t^(i|~r))+n[14]+2878612391&4294967295)<<15&4294967295|s>>>17))+((s=r+(i^(a|~t))+n[5]+4237533241&4294967295)<<21&4294967295|s>>>11))+((s=t+(a^(r|~i))+n[12]+1700485571&4294967295)<<6&4294967295|s>>>26))+((s=i+(r^(t|~a))+n[3]+2399980690&4294967295)<<10&4294967295|s>>>22))+((s=a+(t^(i|~r))+n[10]+4293915773&4294967295)<<15&4294967295|s>>>17))+((s=r+(i^(a|~t))+n[1]+2240044497&4294967295)<<21&4294967295|s>>>11))+((s=t+(a^(r|~i))+n[8]+1873313359&4294967295)<<6&4294967295|s>>>26))+((s=i+(r^(t|~a))+n[15]+4264355552&4294967295)<<10&4294967295|s>>>22))+((s=a+(t^(i|~r))+n[6]+2734768916&4294967295)<<15&4294967295|s>>>17))+((s=r+(i^(a|~t))+n[13]+1309151649&4294967295)<<21&4294967295|s>>>11))+((i=(t=r+((s=t+(a^(r|~i))+n[4]+4149444226&4294967295)<<6&4294967295|s>>>26))+((s=i+(r^(t|~a))+n[11]+3174756917&4294967295)<<10&4294967295|s>>>22))^((a=i+((s=a+(t^(i|~r))+n[2]+718787259&4294967295)<<15&4294967295|s>>>17))|~t))+n[9]+3951481745&4294967295,e.g[0]=e.g[0]+t&4294967295,e.g[1]=e.g[1]+(a+(s<<21&4294967295|s>>>11))&4294967295,e.g[2]=e.g[2]+a&4294967295,e.g[3]=e.g[3]+i&4294967295}function n(e,t){this.h=t;for(var r=[],n=!0,a=e.length-1;0<=a;a--){var i=0|e[a];n&&i==t||(r[a]=i,n=!1)}this.g=r}!function(e,t){function r(){}r.prototype=t.prototype,e.D=t.prototype,e.prototype=new r,e.prototype.constructor=e,e.C=function(e,r,n){for(var a=Array(arguments.length-2),i=2;i<arguments.length;i++)a[i-2]=arguments[i];return t.prototype[r].apply(e,a)}}(t,(function(){this.blockSize=-1})),t.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0},t.prototype.u=function(e,t){void 0===t&&(t=e.length);for(var n=t-this.blockSize,a=this.B,i=this.h,s=0;s<t;){if(0==i)for(;s<=n;)r(this,e,s),s+=this.blockSize;if("string"===typeof e){for(;s<t;)if(a[i++]=e.charCodeAt(s++),i==this.blockSize){r(this,a),i=0;break}}else for(;s<t;)if(a[i++]=e[s++],i==this.blockSize){r(this,a),i=0;break}}this.h=i,this.o+=t},t.prototype.v=function(){var e=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);e[0]=128;for(var t=1;t<e.length-8;++t)e[t]=0;var r=8*this.o;for(t=e.length-8;t<e.length;++t)e[t]=255&r,r/=256;for(this.u(e),e=Array(16),t=r=0;4>t;++t)for(var n=0;32>n;n+=8)e[r++]=this.g[t]>>>n&255;return e};var a={};function i(e){return-128<=e&&128>e?function(e,t){var r=a;return Object.prototype.hasOwnProperty.call(r,e)?r[e]:r[e]=t(e)}(e,(function(e){return new n([0|e],0>e?-1:0)})):new n([0|e],0>e?-1:0)}function s(e){if(isNaN(e)||!isFinite(e))return o;if(0>e)return f(s(-e));for(var t=[],r=1,a=0;e>=r;a++)t[a]=e/r|0,r*=4294967296;return new n(t,0)}var o=i(0),l=i(1),c=i(16777216);function u(e){if(0!=e.h)return!1;for(var t=0;t<e.g.length;t++)if(0!=e.g[t])return!1;return!0}function h(e){return-1==e.h}function f(e){for(var t=e.g.length,r=[],a=0;a<t;a++)r[a]=~e.g[a];return new n(r,~e.h).add(l)}function d(e,t){return e.add(f(t))}function p(e,t){for(;(65535&e[t])!=e[t];)e[t+1]+=e[t]>>>16,e[t]&=65535,t++}function m(e,t){this.g=e,this.h=t}function g(e,t){if(u(t))throw Error("division by zero");if(u(e))return new m(o,o);if(h(e))return t=g(f(e),t),new m(f(t.g),f(t.h));if(h(t))return t=g(e,f(t)),new m(f(t.g),t.h);if(30<e.g.length){if(h(e)||h(t))throw Error("slowDivide_ only works with positive integers.");for(var r=l,n=t;0>=n.l(e);)r=v(r),n=v(n);var a=y(r,1),i=y(n,1);for(n=y(n,2),r=y(r,2);!u(n);){var c=i.add(n);0>=c.l(e)&&(a=a.add(r),i=c),n=y(n,1),r=y(r,1)}return t=d(e,a.j(t)),new m(a,t)}for(a=o;0<=e.l(t);){for(r=Math.max(1,Math.floor(e.m()/t.m())),n=48>=(n=Math.ceil(Math.log(r)/Math.LN2))?1:Math.pow(2,n-48),c=(i=s(r)).j(t);h(c)||0<c.l(e);)c=(i=s(r-=n)).j(t);u(i)&&(i=l),a=a.add(i),e=d(e,c)}return new m(a,e)}function v(e){for(var t=e.g.length+1,r=[],a=0;a<t;a++)r[a]=e.i(a)<<1|e.i(a-1)>>>31;return new n(r,e.h)}function y(e,t){var r=t>>5;t%=32;for(var a=e.g.length-r,i=[],s=0;s<a;s++)i[s]=0<t?e.i(s+r)>>>t|e.i(s+r+1)<<32-t:e.i(s+r);return new n(i,e.h)}(e=n.prototype).m=function(){if(h(this))return-f(this).m();for(var e=0,t=1,r=0;r<this.g.length;r++){var n=this.i(r);e+=(0<=n?n:4294967296+n)*t,t*=4294967296}return e},e.toString=function(e){if(2>(e=e||10)||36<e)throw Error("radix out of range: "+e);if(u(this))return"0";if(h(this))return"-"+f(this).toString(e);for(var t=s(Math.pow(e,6)),r=this,n="";;){var a=g(r,t).g,i=((0<(r=d(r,a.j(t))).g.length?r.g[0]:r.h)>>>0).toString(e);if(u(r=a))return i+n;for(;6>i.length;)i="0"+i;n=i+n}},e.i=function(e){return 0>e?0:e<this.g.length?this.g[e]:this.h},e.l=function(e){return h(e=d(this,e))?-1:u(e)?0:1},e.abs=function(){return h(this)?f(this):this},e.add=function(e){for(var t=Math.max(this.g.length,e.g.length),r=[],a=0,i=0;i<=t;i++){var s=a+(65535&this.i(i))+(65535&e.i(i)),o=(s>>>16)+(this.i(i)>>>16)+(e.i(i)>>>16);a=o>>>16,s&=65535,o&=65535,r[i]=o<<16|s}return new n(r,-2147483648&r[r.length-1]?-1:0)},e.j=function(e){if(u(this)||u(e))return o;if(h(this))return h(e)?f(this).j(f(e)):f(f(this).j(e));if(h(e))return f(this.j(f(e)));if(0>this.l(c)&&0>e.l(c))return s(this.m()*e.m());for(var t=this.g.length+e.g.length,r=[],a=0;a<2*t;a++)r[a]=0;for(a=0;a<this.g.length;a++)for(var i=0;i<e.g.length;i++){var l=this.i(a)>>>16,d=65535&this.i(a),m=e.i(i)>>>16,g=65535&e.i(i);r[2*a+2*i]+=d*g,p(r,2*a+2*i),r[2*a+2*i+1]+=l*g,p(r,2*a+2*i+1),r[2*a+2*i+1]+=d*m,p(r,2*a+2*i+1),r[2*a+2*i+2]+=l*m,p(r,2*a+2*i+2)}for(a=0;a<t;a++)r[a]=r[2*a+1]<<16|r[2*a];for(a=t;a<2*t;a++)r[a]=0;return new n(r,0)},e.A=function(e){return g(this,e).h},e.and=function(e){for(var t=Math.max(this.g.length,e.g.length),r=[],a=0;a<t;a++)r[a]=this.i(a)&e.i(a);return new n(r,this.h&e.h)},e.or=function(e){for(var t=Math.max(this.g.length,e.g.length),r=[],a=0;a<t;a++)r[a]=this.i(a)|e.i(a);return new n(r,this.h|e.h)},e.xor=function(e){for(var t=Math.max(this.g.length,e.g.length),r=[],a=0;a<t;a++)r[a]=this.i(a)^e.i(a);return new n(r,this.h^e.h)},t.prototype.digest=t.prototype.v,t.prototype.reset=t.prototype.s,t.prototype.update=t.prototype.u,Cr=Ar.Md5=t,n.prototype.add=n.prototype.add,n.prototype.multiply=n.prototype.j,n.prototype.modulo=n.prototype.A,n.prototype.compare=n.prototype.l,n.prototype.toNumber=n.prototype.m,n.prototype.toString=n.prototype.toString,n.prototype.getBits=n.prototype.i,n.fromNumber=s,n.fromString=function e(t,r){if(0==t.length)throw Error("number format error: empty string");if(2>(r=r||10)||36<r)throw Error("radix out of range: "+r);if("-"==t.charAt(0))return f(e(t.substring(1),r));if(0<=t.indexOf("-"))throw Error('number format error: interior "-" character');for(var n=s(Math.pow(r,8)),a=o,i=0;i<t.length;i+=8){var l=Math.min(8,t.length-i),c=parseInt(t.substring(i,i+l),r);8>l?(l=s(Math.pow(r,l)),a=a.j(l).add(s(c))):a=(a=a.j(n)).add(s(c))}return a},kr=Ar.Integer=n}).apply("undefined"!==typeof Ir?Ir:"undefined"!==typeof self?self:"undefined"!==typeof window?window:{});var Rr,Nr,Or,xr,Pr,Dr,Lr,Mr,Fr="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof window?window:"undefined"!==typeof global?global:"undefined"!==typeof self?self:{},Ur={};(function(){var e,t="function"==typeof Object.defineProperties?Object.defineProperty:function(e,t,r){return e==Array.prototype||e==Object.prototype||(e[t]=r.value),e};var r=function(e){e=["object"==typeof globalThis&&globalThis,e,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof Fr&&Fr];for(var t=0;t<e.length;++t){var r=e[t];if(r&&r.Math==Math)return r}throw Error("Cannot find global object")}(this);!function(e,n){if(n)e:{var a=r;e=e.split(".");for(var i=0;i<e.length-1;i++){var s=e[i];if(!(s in a))break e;a=a[s]}(n=n(i=a[e=e[e.length-1]]))!=i&&null!=n&&t(a,e,{configurable:!0,writable:!0,value:n})}}("Array.prototype.values",(function(e){return e||function(){return function(e,t){e instanceof String&&(e+="");var r=0,n=!1,a={next:function(){if(!n&&r<e.length){var a=r++;return{value:t(a,e[a]),done:!1}}return n=!0,{done:!0,value:void 0}}};return a[Symbol.iterator]=function(){return a},a}(this,(function(e,t){return t}))}}));var n=n||{},a=this||self;function i(e){var t=typeof e;return"array"==(t="object"!=t?t:e?Array.isArray(e)?"array":t:"null")||"object"==t&&"number"==typeof e.length}function s(e){var t=typeof e;return"object"==t&&null!=e||"function"==t}function o(e,t,r){return e.call.apply(e.bind,arguments)}function l(e,t,r){if(!e)throw Error();if(2<arguments.length){var n=Array.prototype.slice.call(arguments,2);return function(){var r=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(r,n),e.apply(t,r)}}return function(){return e.apply(t,arguments)}}function c(e,t,r){return(c=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?o:l).apply(null,arguments)}function u(e,t){var r=Array.prototype.slice.call(arguments,1);return function(){var t=r.slice();return t.push.apply(t,arguments),e.apply(this,t)}}function h(e,t){function r(){}r.prototype=t.prototype,e.aa=t.prototype,e.prototype=new r,e.prototype.constructor=e,e.Qb=function(e,r,n){for(var a=Array(arguments.length-2),i=2;i<arguments.length;i++)a[i-2]=arguments[i];return t.prototype[r].apply(e,a)}}function f(e){const t=e.length;if(0<t){const r=Array(t);for(let n=0;n<t;n++)r[n]=e[n];return r}return[]}function d(e,t){for(let r=1;r<arguments.length;r++){const t=arguments[r];if(i(t)){const r=e.length||0,n=t.length||0;e.length=r+n;for(let a=0;a<n;a++)e[r+a]=t[a]}else e.push(t)}}function p(e){return/^[\s\xa0]*$/.test(e)}function m(){var e=a.navigator;return e&&(e=e.userAgent)?e:""}function g(e){return g[" "](e),e}g[" "]=function(){};var v=-1!=m().indexOf("Gecko")&&!(-1!=m().toLowerCase().indexOf("webkit")&&-1==m().indexOf("Edge"))&&!(-1!=m().indexOf("Trident")||-1!=m().indexOf("MSIE"))&&-1==m().indexOf("Edge");function y(e,t,r){for(const n in e)t.call(r,e[n],n,e)}function b(e){const t={};for(const r in e)t[r]=e[r];return t}const w="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function E(e,t){let r,n;for(let a=1;a<arguments.length;a++){for(r in n=arguments[a],n)e[r]=n[r];for(let t=0;t<w.length;t++)r=w[t],Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}}function T(e){var t=1;e=e.split(":");const r=[];for(;0<t&&e.length;)r.push(e.shift()),t--;return e.length&&r.push(e.join(":")),r}function _(e){a.setTimeout((()=>{throw e}),0)}function S(){var e=R;let t=null;return e.g&&(t=e.g,e.g=e.g.next,e.g||(e.h=null),t.next=null),t}var k=new class{constructor(e,t){this.i=e,this.j=t,this.h=0,this.g=null}get(){let e;return 0<this.h?(this.h--,e=this.g,this.g=e.next,e.next=null):e=this.i(),e}}((()=>new C),(e=>e.reset()));class C{constructor(){this.next=this.g=this.h=null}set(e,t){this.h=e,this.g=t,this.next=null}reset(){this.next=this.g=this.h=null}}let I,A=!1,R=new class{constructor(){this.h=this.g=null}add(e,t){const r=k.get();r.set(e,t),this.h?this.h.next=r:this.g=r,this.h=r}},N=()=>{const e=a.Promise.resolve(void 0);I=()=>{e.then(O)}};var O=()=>{for(var e;e=S();){try{e.h.call(e.g)}catch(r){_(r)}var t=k;t.j(e),100>t.h&&(t.h++,e.next=t.g,t.g=e)}A=!1};function x(){this.s=this.s,this.C=this.C}function P(e,t){this.type=e,this.g=this.target=t,this.defaultPrevented=!1}x.prototype.s=!1,x.prototype.ma=function(){this.s||(this.s=!0,this.N())},x.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()},P.prototype.h=function(){this.defaultPrevented=!0};var D=function(){if(!a.addEventListener||!Object.defineProperty)return!1;var e=!1,t=Object.defineProperty({},"passive",{get:function(){e=!0}});try{const e=()=>{};a.addEventListener("test",e,t),a.removeEventListener("test",e,t)}catch(r){}return e}();function L(e,t){if(P.call(this,e?e.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,e){var r=this.type=e.type,n=e.changedTouches&&e.changedTouches.length?e.changedTouches[0]:null;if(this.target=e.target||e.srcElement,this.g=t,t=e.relatedTarget){if(v){e:{try{g(t.nodeName);var a=!0;break e}catch(i){}a=!1}a||(t=null)}}else"mouseover"==r?t=e.fromElement:"mouseout"==r&&(t=e.toElement);this.relatedTarget=t,n?(this.clientX=void 0!==n.clientX?n.clientX:n.pageX,this.clientY=void 0!==n.clientY?n.clientY:n.pageY,this.screenX=n.screenX||0,this.screenY=n.screenY||0):(this.clientX=void 0!==e.clientX?e.clientX:e.pageX,this.clientY=void 0!==e.clientY?e.clientY:e.pageY,this.screenX=e.screenX||0,this.screenY=e.screenY||0),this.button=e.button,this.key=e.key||"",this.ctrlKey=e.ctrlKey,this.altKey=e.altKey,this.shiftKey=e.shiftKey,this.metaKey=e.metaKey,this.pointerId=e.pointerId||0,this.pointerType="string"===typeof e.pointerType?e.pointerType:M[e.pointerType]||"",this.state=e.state,this.i=e,e.defaultPrevented&&L.aa.h.call(this)}}h(L,P);var M={2:"touch",3:"pen",4:"mouse"};L.prototype.h=function(){L.aa.h.call(this);var e=this.i;e.preventDefault?e.preventDefault():e.returnValue=!1};var F="closure_listenable_"+(1e6*Math.random()|0),U=0;function V(e,t,r,n,a){this.listener=e,this.proxy=null,this.src=t,this.type=r,this.capture=!!n,this.ha=a,this.key=++U,this.da=this.fa=!1}function B(e){e.da=!0,e.listener=null,e.proxy=null,e.src=null,e.ha=null}function z(e){this.src=e,this.g={},this.h=0}function j(e,t){var r=t.type;if(r in e.g){var n,a=e.g[r],i=Array.prototype.indexOf.call(a,t,void 0);(n=0<=i)&&Array.prototype.splice.call(a,i,1),n&&(B(t),0==e.g[r].length&&(delete e.g[r],e.h--))}}function H(e,t,r,n){for(var a=0;a<e.length;++a){var i=e[a];if(!i.da&&i.listener==t&&i.capture==!!r&&i.ha==n)return a}return-1}z.prototype.add=function(e,t,r,n,a){var i=e.toString();(e=this.g[i])||(e=this.g[i]=[],this.h++);var s=H(e,t,n,a);return-1<s?(t=e[s],r||(t.fa=!1)):((t=new V(t,this.src,i,!!n,a)).fa=r,e.push(t)),t};var $="closure_lm_"+(1e6*Math.random()|0),W={};function G(e,t,r,n,a){if(n&&n.once)return q(e,t,r,n,a);if(Array.isArray(t)){for(var i=0;i<t.length;i++)G(e,t[i],r,n,a);return null}return r=te(r),e&&e[F]?e.K(t,r,s(n)?!!n.capture:!!n,a):K(e,t,r,!1,n,a)}function K(e,t,r,n,a,i){if(!t)throw Error("Invalid event type");var o=s(a)?!!a.capture:!!a,l=Z(e);if(l||(e[$]=l=new z(e)),(r=l.add(t,r,n,o,i)).proxy)return r;if(n=function(){function e(r){return t.call(e.src,e.listener,r)}const t=J;return e}(),r.proxy=n,n.src=e,n.listener=r,e.addEventListener)D||(a=o),void 0===a&&(a=!1),e.addEventListener(t.toString(),n,a);else if(e.attachEvent)e.attachEvent(Q(t.toString()),n);else{if(!e.addListener||!e.removeListener)throw Error("addEventListener and attachEvent are unavailable.");e.addListener(n)}return r}function q(e,t,r,n,a){if(Array.isArray(t)){for(var i=0;i<t.length;i++)q(e,t[i],r,n,a);return null}return r=te(r),e&&e[F]?e.L(t,r,s(n)?!!n.capture:!!n,a):K(e,t,r,!0,n,a)}function X(e,t,r,n,a){if(Array.isArray(t))for(var i=0;i<t.length;i++)X(e,t[i],r,n,a);else n=s(n)?!!n.capture:!!n,r=te(r),e&&e[F]?(e=e.i,(t=String(t).toString())in e.g&&(-1<(r=H(i=e.g[t],r,n,a))&&(B(i[r]),Array.prototype.splice.call(i,r,1),0==i.length&&(delete e.g[t],e.h--)))):e&&(e=Z(e))&&(t=e.g[t.toString()],e=-1,t&&(e=H(t,r,n,a)),(r=-1<e?t[e]:null)&&Y(r))}function Y(e){if("number"!==typeof e&&e&&!e.da){var t=e.src;if(t&&t[F])j(t.i,e);else{var r=e.type,n=e.proxy;t.removeEventListener?t.removeEventListener(r,n,e.capture):t.detachEvent?t.detachEvent(Q(r),n):t.addListener&&t.removeListener&&t.removeListener(n),(r=Z(t))?(j(r,e),0==r.h&&(r.src=null,t[$]=null)):B(e)}}}function Q(e){return e in W?W[e]:W[e]="on"+e}function J(e,t){if(e.da)e=!0;else{t=new L(t,this);var r=e.listener,n=e.ha||e.src;e.fa&&Y(e),e=r.call(n,t)}return e}function Z(e){return(e=e[$])instanceof z?e:null}var ee="__closure_events_fn_"+(1e9*Math.random()>>>0);function te(e){return"function"===typeof e?e:(e[ee]||(e[ee]=function(t){return e.handleEvent(t)}),e[ee])}function re(){x.call(this),this.i=new z(this),this.M=this,this.F=null}function ne(e,t){var r,n=e.F;if(n)for(r=[];n;n=n.F)r.push(n);if(e=e.M,n=t.type||t,"string"===typeof t)t=new P(t,e);else if(t instanceof P)t.target=t.target||e;else{var a=t;E(t=new P(n,e),a)}if(a=!0,r)for(var i=r.length-1;0<=i;i--){var s=t.g=r[i];a=ae(s,n,!0,t)&&a}if(a=ae(s=t.g=e,n,!0,t)&&a,a=ae(s,n,!1,t)&&a,r)for(i=0;i<r.length;i++)a=ae(s=t.g=r[i],n,!1,t)&&a}function ae(e,t,r,n){if(!(t=e.i.g[String(t)]))return!0;t=t.concat();for(var a=!0,i=0;i<t.length;++i){var s=t[i];if(s&&!s.da&&s.capture==r){var o=s.listener,l=s.ha||s.src;s.fa&&j(e.i,s),a=!1!==o.call(l,n)&&a}}return a&&!n.defaultPrevented}function ie(e,t,r){if("function"===typeof e)r&&(e=c(e,r));else{if(!e||"function"!=typeof e.handleEvent)throw Error("Invalid listener argument");e=c(e.handleEvent,e)}return 2147483647<Number(t)?-1:a.setTimeout(e,t||0)}function se(e){e.g=ie((()=>{e.g=null,e.i&&(e.i=!1,se(e))}),e.l);const t=e.h;e.h=null,e.m.apply(null,t)}h(re,x),re.prototype[F]=!0,re.prototype.removeEventListener=function(e,t,r,n){X(this,e,t,r,n)},re.prototype.N=function(){if(re.aa.N.call(this),this.i){var e,t=this.i;for(e in t.g){for(var r=t.g[e],n=0;n<r.length;n++)B(r[n]);delete t.g[e],t.h--}}this.F=null},re.prototype.K=function(e,t,r,n){return this.i.add(String(e),t,!1,r,n)},re.prototype.L=function(e,t,r,n){return this.i.add(String(e),t,!0,r,n)};class oe extends x{constructor(e,t){super(),this.m=e,this.l=t,this.h=null,this.i=!1,this.g=null}j(e){this.h=arguments,this.g?this.i=!0:se(this)}N(){super.N(),this.g&&(a.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function le(e){x.call(this),this.h=e,this.g={}}h(le,x);var ce=[];function ue(e){y(e.g,(function(e,t){this.g.hasOwnProperty(t)&&Y(e)}),e),e.g={}}le.prototype.N=function(){le.aa.N.call(this),ue(this)},le.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var he=a.JSON.stringify,fe=a.JSON.parse,de=class{stringify(e){return a.JSON.stringify(e,void 0)}parse(e){return a.JSON.parse(e,void 0)}};function pe(){}function me(e){return e.h||(e.h=e.i())}function ge(){}pe.prototype.h=null;var ve={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function ye(){P.call(this,"d")}function be(){P.call(this,"c")}h(ye,P),h(be,P);var we={},Ee=null;function Te(){return Ee=Ee||new re}function _e(e){P.call(this,we.La,e)}function Se(e){const t=Te();ne(t,new _e(t))}function ke(e,t){P.call(this,we.STAT_EVENT,e),this.stat=t}function Ce(e){const t=Te();ne(t,new ke(t,e))}function Ie(e,t){P.call(this,we.Ma,e),this.size=t}function Ae(e,t){if("function"!==typeof e)throw Error("Fn must not be null and must be a function");return a.setTimeout((function(){e()}),t)}function Re(){this.g=!0}function Ne(e,t,r,n){e.info((function(){return"XMLHTTP TEXT ("+t+"): "+function(e,t){if(!e.g)return t;if(!t)return null;try{var r=JSON.parse(t);if(r)for(e=0;e<r.length;e++)if(Array.isArray(r[e])){var n=r[e];if(!(2>n.length)){var a=n[1];if(Array.isArray(a)&&!(1>a.length)){var i=a[0];if("noop"!=i&&"stop"!=i&&"close"!=i)for(var s=1;s<a.length;s++)a[s]=""}}}return he(r)}catch(o){return t}}(e,r)+(n?" "+n:"")}))}we.La="serverreachability",h(_e,P),we.STAT_EVENT="statevent",h(ke,P),we.Ma="timingevent",h(Ie,P),Re.prototype.xa=function(){this.g=!1},Re.prototype.info=function(){};var Oe,xe={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},Pe={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"};function De(){}function Le(e,t,r,n){this.j=e,this.i=t,this.l=r,this.R=n||1,this.U=new le(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new Me}function Me(){this.i=null,this.g="",this.h=!1}h(De,pe),De.prototype.g=function(){return new XMLHttpRequest},De.prototype.i=function(){return{}},Oe=new De;var Fe={},Ue={};function Ve(e,t,r){e.L=1,e.v=ht(st(t)),e.m=r,e.P=!0,Be(e,null)}function Be(e,t){e.F=Date.now(),He(e),e.A=st(e.v);var r=e.A,n=e.R;Array.isArray(n)||(n=[String(n)]),kt(r.i,"t",n),e.C=0,r=e.j.J,e.h=new Me,e.g=fr(e.j,r?t:null,!e.m),0<e.O&&(e.M=new oe(c(e.Y,e,e.g),e.O)),t=e.U,r=e.g,n=e.ca;var a="readystatechange";Array.isArray(a)||(a&&(ce[0]=a.toString()),a=ce);for(var i=0;i<a.length;i++){var s=G(r,a[i],n||t.handleEvent,!1,t.h||t);if(!s)break;t.g[s.key]=s}t=e.H?b(e.H):{},e.m?(e.u||(e.u="POST"),t["Content-Type"]="application/x-www-form-urlencoded",e.g.ea(e.A,e.u,e.m,t)):(e.u="GET",e.g.ea(e.A,e.u,null,t)),Se(),function(e,t,r,n,a,i){e.info((function(){if(e.g)if(i)for(var s="",o=i.split("&"),l=0;l<o.length;l++){var c=o[l].split("=");if(1<c.length){var u=c[0];c=c[1];var h=u.split("_");s=2<=h.length&&"type"==h[1]?s+(u+"=")+c+"&":s+(u+"=redacted&")}}else s=null;else s=i;return"XMLHTTP REQ ("+n+") [attempt "+a+"]: "+t+"\n"+r+"\n"+s}))}(e.i,e.u,e.A,e.l,e.R,e.m)}function ze(e){return!!e.g&&("GET"==e.u&&2!=e.L&&e.j.Ca)}function je(e,t){var r=e.C,n=t.indexOf("\n",r);return-1==n?Ue:(r=Number(t.substring(r,n)),isNaN(r)?Fe:(n+=1)+r>t.length?Ue:(t=t.slice(n,n+r),e.C=n+r,t))}function He(e){e.S=Date.now()+e.I,$e(e,e.I)}function $e(e,t){if(null!=e.B)throw Error("WatchDog timer not null");e.B=Ae(c(e.ba,e),t)}function We(e){e.B&&(a.clearTimeout(e.B),e.B=null)}function Ge(e){0==e.j.G||e.J||or(e.j,e)}function Ke(e){We(e);var t=e.M;t&&"function"==typeof t.ma&&t.ma(),e.M=null,ue(e.U),e.g&&(t=e.g,e.g=null,t.abort(),t.ma())}function qe(e,t){try{var r=e.j;if(0!=r.G&&(r.g==e||Ze(r.h,e)))if(!e.K&&Ze(r.h,e)&&3==r.G){try{var n=r.Da.g.parse(t)}catch(u){n=null}if(Array.isArray(n)&&3==n.length){var a=n;if(0==a[0]){e:if(!r.u){if(r.g){if(!(r.g.F+3e3<e.F))break e;sr(r),Yt(r)}nr(r),Ce(18)}}else r.za=a[1],0<r.za-r.T&&37500>a[2]&&r.F&&0==r.v&&!r.C&&(r.C=Ae(c(r.Za,r),6e3));if(1>=Je(r.h)&&r.ca){try{r.ca()}catch(u){}r.ca=void 0}}else cr(r,11)}else if((e.K||r.g==e)&&sr(r),!p(t))for(a=r.Da.g.parse(t),t=0;t<a.length;t++){let c=a[t];if(r.T=c[0],c=c[1],2==r.G)if("c"==c[0]){r.K=c[1],r.ia=c[2];const t=c[3];null!=t&&(r.la=t,r.j.info("VER="+r.la));const a=c[4];null!=a&&(r.Aa=a,r.j.info("SVER="+r.Aa));const u=c[5];null!=u&&"number"===typeof u&&0<u&&(n=1.5*u,r.L=n,r.j.info("backChannelRequestTimeoutMs_="+n)),n=r;const h=e.g;if(h){const e=h.g?h.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(e){var i=n.h;i.g||-1==e.indexOf("spdy")&&-1==e.indexOf("quic")&&-1==e.indexOf("h2")||(i.j=i.l,i.g=new Set,i.h&&(et(i,i.h),i.h=null))}if(n.D){const e=h.g?h.g.getResponseHeader("X-HTTP-Session-Id"):null;e&&(n.ya=e,ut(n.I,n.D,e))}}r.G=3,r.l&&r.l.ua(),r.ba&&(r.R=Date.now()-e.F,r.j.info("Handshake RTT: "+r.R+"ms"));var s=e;if((n=r).qa=hr(n,n.J?n.ia:null,n.W),s.K){tt(n.h,s);var o=s,l=n.L;l&&(o.I=l),o.B&&(We(o),He(o)),n.g=s}else rr(n);0<r.i.length&&Jt(r)}else"stop"!=c[0]&&"close"!=c[0]||cr(r,7);else 3==r.G&&("stop"==c[0]||"close"==c[0]?"stop"==c[0]?cr(r,7):Xt(r):"noop"!=c[0]&&r.l&&r.l.ta(c),r.v=0)}Se()}catch(u){}}Le.prototype.ca=function(e){e=e.target;const t=this.M;t&&3==Wt(e)?t.j():this.Y(e)},Le.prototype.Y=function(e){try{if(e==this.g)e:{const f=Wt(this.g);var t=this.g.Ba();this.g.Z();if(!(3>f)&&(3!=f||this.g&&(this.h.h||this.g.oa()||Gt(this.g)))){this.J||4!=f||7==t||Se(),We(this);var r=this.g.Z();this.X=r;t:if(ze(this)){var n=Gt(this.g);e="";var i=n.length,s=4==Wt(this.g);if(!this.h.i){if("undefined"===typeof TextDecoder){Ke(this),Ge(this);var o="";break t}this.h.i=new a.TextDecoder}for(t=0;t<i;t++)this.h.h=!0,e+=this.h.i.decode(n[t],{stream:!(s&&t==i-1)});n.length=0,this.h.g+=e,this.C=0,o=this.h.g}else o=this.g.oa();if(this.o=200==r,function(e,t,r,n,a,i,s){e.info((function(){return"XMLHTTP RESP ("+n+") [ attempt "+a+"]: "+t+"\n"+r+"\n"+i+" "+s}))}(this.i,this.u,this.A,this.l,this.R,f,r),this.o){if(this.T&&!this.K){t:{if(this.g){var l,c=this.g;if((l=c.g?c.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!p(l)){var u=l;break t}}u=null}if(!(r=u)){this.o=!1,this.s=3,Ce(12),Ke(this),Ge(this);break e}Ne(this.i,this.l,r,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,qe(this,r)}if(this.P){let e;for(r=!0;!this.J&&this.C<o.length;){if(e=je(this,o),e==Ue){4==f&&(this.s=4,Ce(14),r=!1),Ne(this.i,this.l,null,"[Incomplete Response]");break}if(e==Fe){this.s=4,Ce(15),Ne(this.i,this.l,o,"[Invalid Chunk]"),r=!1;break}Ne(this.i,this.l,e,null),qe(this,e)}if(ze(this)&&0!=this.C&&(this.h.g=this.h.g.slice(this.C),this.C=0),4!=f||0!=o.length||this.h.h||(this.s=1,Ce(16),r=!1),this.o=this.o&&r,r){if(0<o.length&&!this.W){this.W=!0;var h=this.j;h.g==this&&h.ba&&!h.M&&(h.j.info("Great, no buffering proxy detected. Bytes received: "+o.length),ar(h),h.M=!0,Ce(11))}}else Ne(this.i,this.l,o,"[Invalid Chunked Response]"),Ke(this),Ge(this)}else Ne(this.i,this.l,o,null),qe(this,o);4==f&&Ke(this),this.o&&!this.J&&(4==f?or(this.j,this):(this.o=!1,He(this)))}else(function(e){const t={};e=(e.g&&2<=Wt(e)&&e.g.getAllResponseHeaders()||"").split("\r\n");for(let n=0;n<e.length;n++){if(p(e[n]))continue;var r=T(e[n]);const a=r[0];if("string"!==typeof(r=r[1]))continue;r=r.trim();const i=t[a]||[];t[a]=i,i.push(r)}!function(e,t){for(const r in e)t.call(void 0,e[r],r,e)}(t,(function(e){return e.join(", ")}))})(this.g),400==r&&0<o.indexOf("Unknown SID")?(this.s=3,Ce(12)):(this.s=0,Ce(13)),Ke(this),Ge(this)}}}catch(f){}},Le.prototype.cancel=function(){this.J=!0,Ke(this)},Le.prototype.ba=function(){this.B=null;const e=Date.now();0<=e-this.S?(function(e,t){e.info((function(){return"TIMEOUT: "+t}))}(this.i,this.A),2!=this.L&&(Se(),Ce(17)),Ke(this),this.s=2,Ge(this)):$e(this,this.S-e)};var Xe=class{constructor(e,t){this.g=e,this.map=t}};function Ye(e){this.l=e||10,a.PerformanceNavigationTiming?e=0<(e=a.performance.getEntriesByType("navigation")).length&&("hq"==e[0].nextHopProtocol||"h2"==e[0].nextHopProtocol):e=!!(a.chrome&&a.chrome.loadTimes&&a.chrome.loadTimes()&&a.chrome.loadTimes().wasFetchedViaSpdy),this.j=e?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function Qe(e){return!!e.h||!!e.g&&e.g.size>=e.j}function Je(e){return e.h?1:e.g?e.g.size:0}function Ze(e,t){return e.h?e.h==t:!!e.g&&e.g.has(t)}function et(e,t){e.g?e.g.add(t):e.h=t}function tt(e,t){e.h&&e.h==t?e.h=null:e.g&&e.g.has(t)&&e.g.delete(t)}function rt(e){if(null!=e.h)return e.i.concat(e.h.D);if(null!=e.g&&0!==e.g.size){let t=e.i;for(const r of e.g.values())t=t.concat(r.D);return t}return f(e.i)}function nt(e,t){if(e.forEach&&"function"==typeof e.forEach)e.forEach(t,void 0);else if(i(e)||"string"===typeof e)Array.prototype.forEach.call(e,t,void 0);else for(var r=function(e){if(e.na&&"function"==typeof e.na)return e.na();if(!e.V||"function"!=typeof e.V){if("undefined"!==typeof Map&&e instanceof Map)return Array.from(e.keys());if(!("undefined"!==typeof Set&&e instanceof Set)){if(i(e)||"string"===typeof e){var t=[];e=e.length;for(var r=0;r<e;r++)t.push(r);return t}t=[],r=0;for(const n in e)t[r++]=n;return t}}}(e),n=function(e){if(e.V&&"function"==typeof e.V)return e.V();if("undefined"!==typeof Map&&e instanceof Map||"undefined"!==typeof Set&&e instanceof Set)return Array.from(e.values());if("string"===typeof e)return e.split("");if(i(e)){for(var t=[],r=e.length,n=0;n<r;n++)t.push(e[n]);return t}for(n in t=[],r=0,e)t[r++]=e[n];return t}(e),a=n.length,s=0;s<a;s++)t.call(void 0,n[s],r&&r[s],e)}Ye.prototype.cancel=function(){if(this.i=rt(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&0!==this.g.size){for(const e of this.g.values())e.cancel();this.g.clear()}};var at=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function it(e){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,e instanceof it){this.h=e.h,ot(this,e.j),this.o=e.o,this.g=e.g,lt(this,e.s),this.l=e.l;var t=e.i,r=new Et;r.i=t.i,t.g&&(r.g=new Map(t.g),r.h=t.h),ct(this,r),this.m=e.m}else e&&(t=String(e).match(at))?(this.h=!1,ot(this,t[1]||"",!0),this.o=ft(t[2]||""),this.g=ft(t[3]||"",!0),lt(this,t[4]),this.l=ft(t[5]||"",!0),ct(this,t[6]||"",!0),this.m=ft(t[7]||"")):(this.h=!1,this.i=new Et(null,this.h))}function st(e){return new it(e)}function ot(e,t,r){e.j=r?ft(t,!0):t,e.j&&(e.j=e.j.replace(/:$/,""))}function lt(e,t){if(t){if(t=Number(t),isNaN(t)||0>t)throw Error("Bad port number "+t);e.s=t}else e.s=null}function ct(e,t,r){t instanceof Et?(e.i=t,function(e,t){t&&!e.j&&(Tt(e),e.i=null,e.g.forEach((function(e,t){var r=t.toLowerCase();t!=r&&(_t(this,t),kt(this,r,e))}),e)),e.j=t}(e.i,e.h)):(r||(t=dt(t,bt)),e.i=new Et(t,e.h))}function ut(e,t,r){e.i.set(t,r)}function ht(e){return ut(e,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),e}function ft(e,t){return e?t?decodeURI(e.replace(/%25/g,"%2525")):decodeURIComponent(e):""}function dt(e,t,r){return"string"===typeof e?(e=encodeURI(e).replace(t,pt),r&&(e=e.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),e):null}function pt(e){return"%"+((e=e.charCodeAt(0))>>4&15).toString(16)+(15&e).toString(16)}it.prototype.toString=function(){var e=[],t=this.j;t&&e.push(dt(t,gt,!0),":");var r=this.g;return(r||"file"==t)&&(e.push("//"),(t=this.o)&&e.push(dt(t,gt,!0),"@"),e.push(encodeURIComponent(String(r)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(r=this.s)&&e.push(":",String(r))),(r=this.l)&&(this.g&&"/"!=r.charAt(0)&&e.push("/"),e.push(dt(r,"/"==r.charAt(0)?yt:vt,!0))),(r=this.i.toString())&&e.push("?",r),(r=this.m)&&e.push("#",dt(r,wt)),e.join("")};var mt,gt=/[#\/\?@]/g,vt=/[#\?:]/g,yt=/[#\?]/g,bt=/[#\?@]/g,wt=/#/g;function Et(e,t){this.h=this.g=null,this.i=e||null,this.j=!!t}function Tt(e){e.g||(e.g=new Map,e.h=0,e.i&&function(e,t){if(e){e=e.split("&");for(var r=0;r<e.length;r++){var n=e[r].indexOf("="),a=null;if(0<=n){var i=e[r].substring(0,n);a=e[r].substring(n+1)}else i=e[r];t(i,a?decodeURIComponent(a.replace(/\+/g," ")):"")}}}(e.i,(function(t,r){e.add(decodeURIComponent(t.replace(/\+/g," ")),r)})))}function _t(e,t){Tt(e),t=Ct(e,t),e.g.has(t)&&(e.i=null,e.h-=e.g.get(t).length,e.g.delete(t))}function St(e,t){return Tt(e),t=Ct(e,t),e.g.has(t)}function kt(e,t,r){_t(e,t),0<r.length&&(e.i=null,e.g.set(Ct(e,t),f(r)),e.h+=r.length)}function Ct(e,t){return t=String(t),e.j&&(t=t.toLowerCase()),t}function It(e,t,r,n,a){try{a&&(a.onload=null,a.onerror=null,a.onabort=null,a.ontimeout=null),n(r)}catch(i){}}function At(){this.g=new de}function Rt(e,t,r){const n=r||"";try{nt(e,(function(e,r){let a=e;s(e)&&(a=he(e)),t.push(n+r+"="+encodeURIComponent(a))}))}catch(Ok){throw t.push(n+"type="+encodeURIComponent("_badmap")),Ok}}function Nt(e){this.l=e.Ub||null,this.j=e.eb||!1}function Ot(e,t){re.call(this),this.D=e,this.o=t,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}function xt(e){e.j.read().then(e.Pa.bind(e)).catch(e.ga.bind(e))}function Pt(e){e.readyState=4,e.l=null,e.j=null,e.v=null,Dt(e)}function Dt(e){e.onreadystatechange&&e.onreadystatechange.call(e)}function Lt(e){let t="";return y(e,(function(e,r){t+=r,t+=":",t+=e,t+="\r\n"})),t}function Mt(e,t,r){e:{for(n in r){var n=!1;break e}n=!0}n||(r=Lt(r),"string"===typeof e?null!=r&&encodeURIComponent(String(r)):ut(e,t,r))}function Ft(e){re.call(this),this.headers=new Map,this.o=e||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}(e=Et.prototype).add=function(e,t){Tt(this),this.i=null,e=Ct(this,e);var r=this.g.get(e);return r||this.g.set(e,r=[]),r.push(t),this.h+=1,this},e.forEach=function(e,t){Tt(this),this.g.forEach((function(r,n){r.forEach((function(r){e.call(t,r,n,this)}),this)}),this)},e.na=function(){Tt(this);const e=Array.from(this.g.values()),t=Array.from(this.g.keys()),r=[];for(let n=0;n<t.length;n++){const a=e[n];for(let e=0;e<a.length;e++)r.push(t[n])}return r},e.V=function(e){Tt(this);let t=[];if("string"===typeof e)St(this,e)&&(t=t.concat(this.g.get(Ct(this,e))));else{e=Array.from(this.g.values());for(let r=0;r<e.length;r++)t=t.concat(e[r])}return t},e.set=function(e,t){return Tt(this),this.i=null,St(this,e=Ct(this,e))&&(this.h-=this.g.get(e).length),this.g.set(e,[t]),this.h+=1,this},e.get=function(e,t){return e&&0<(e=this.V(e)).length?String(e[0]):t},e.toString=function(){if(this.i)return this.i;if(!this.g)return"";const e=[],t=Array.from(this.g.keys());for(var r=0;r<t.length;r++){var n=t[r];const i=encodeURIComponent(String(n)),s=this.V(n);for(n=0;n<s.length;n++){var a=i;""!==s[n]&&(a+="="+encodeURIComponent(String(s[n]))),e.push(a)}}return this.i=e.join("&")},h(Nt,pe),Nt.prototype.g=function(){return new Ot(this.l,this.j)},Nt.prototype.i=(mt={},function(){return mt}),h(Ot,re),(e=Ot.prototype).open=function(e,t){if(0!=this.readyState)throw this.abort(),Error("Error reopening a connection");this.B=e,this.A=t,this.readyState=1,Dt(this)},e.send=function(e){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");this.g=!0;const t={headers:this.u,method:this.B,credentials:this.m,cache:void 0};e&&(t.body=e),(this.D||a).fetch(new Request(this.A,t)).then(this.Sa.bind(this),this.ga.bind(this))},e.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch((()=>{})),1<=this.readyState&&this.g&&4!=this.readyState&&(this.g=!1,Pt(this)),this.readyState=0},e.Sa=function(e){if(this.g&&(this.l=e,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=e.headers,this.readyState=2,Dt(this)),this.g&&(this.readyState=3,Dt(this),this.g)))if("arraybuffer"===this.responseType)e.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if("undefined"!==typeof a.ReadableStream&&"body"in e){if(this.j=e.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;xt(this)}else e.text().then(this.Ra.bind(this),this.ga.bind(this))},e.Pa=function(e){if(this.g){if(this.o&&e.value)this.response.push(e.value);else if(!this.o){var t=e.value?e.value:new Uint8Array(0);(t=this.v.decode(t,{stream:!e.done}))&&(this.response=this.responseText+=t)}e.done?Pt(this):Dt(this),3==this.readyState&&xt(this)}},e.Ra=function(e){this.g&&(this.response=this.responseText=e,Pt(this))},e.Qa=function(e){this.g&&(this.response=e,Pt(this))},e.ga=function(){this.g&&Pt(this)},e.setRequestHeader=function(e,t){this.u.append(e,t)},e.getResponseHeader=function(e){return this.h&&this.h.get(e.toLowerCase())||""},e.getAllResponseHeaders=function(){if(!this.h)return"";const e=[],t=this.h.entries();for(var r=t.next();!r.done;)r=r.value,e.push(r[0]+": "+r[1]),r=t.next();return e.join("\r\n")},Object.defineProperty(Ot.prototype,"withCredentials",{get:function(){return"include"===this.m},set:function(e){this.m=e?"include":"same-origin"}}),h(Ft,re);var Ut=/^https?$/i,Vt=["POST","PUT"];function Bt(e,t){e.h=!1,e.g&&(e.j=!0,e.g.abort(),e.j=!1),e.l=t,e.m=5,zt(e),Ht(e)}function zt(e){e.A||(e.A=!0,ne(e,"complete"),ne(e,"error"))}function jt(e){if(e.h&&"undefined"!=typeof n&&(!e.v[1]||4!=Wt(e)||2!=e.Z()))if(e.u&&4==Wt(e))ie(e.Ea,0,e);else if(ne(e,"readystatechange"),4==Wt(e)){e.h=!1;try{const n=e.Z();e:switch(n){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var t=!0;break e;default:t=!1}var r;if(!(r=t)){var i;if(i=0===n){var s=String(e.D).match(at)[1]||null;!s&&a.self&&a.self.location&&(s=a.self.location.protocol.slice(0,-1)),i=!Ut.test(s?s.toLowerCase():"")}r=i}if(r)ne(e,"complete"),ne(e,"success");else{e.m=6;try{var o=2<Wt(e)?e.g.statusText:""}catch(l){o=""}e.l=o+" ["+e.Z()+"]",zt(e)}}finally{Ht(e)}}}function Ht(e,t){if(e.g){$t(e);const r=e.g,n=e.v[0]?()=>{}:null;e.g=null,e.v=null,t||ne(e,"ready");try{r.onreadystatechange=n}catch(Ok){}}}function $t(e){e.I&&(a.clearTimeout(e.I),e.I=null)}function Wt(e){return e.g?e.g.readyState:0}function Gt(e){try{if(!e.g)return null;if("response"in e.g)return e.g.response;switch(e.H){case"":case"text":return e.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in e.g)return e.g.mozResponseArrayBuffer}return null}catch(Br){return null}}function Kt(e,t,r){return r&&r.internalChannelParams&&r.internalChannelParams[e]||t}function qt(e){this.Aa=0,this.i=[],this.j=new Re,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=Kt("failFast",!1,e),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=Kt("baseRetryDelayMs",5e3,e),this.cb=Kt("retryDelaySeedMs",1e4,e),this.Wa=Kt("forwardChannelMaxRetries",2,e),this.wa=Kt("forwardChannelRequestTimeoutMs",2e4,e),this.pa=e&&e.xmlHttpFactory||void 0,this.Xa=e&&e.Tb||void 0,this.Ca=e&&e.useFetchStreams||!1,this.L=void 0,this.J=e&&e.supportsCrossDomainXhr||!1,this.K="",this.h=new Ye(e&&e.concurrentRequestLimit),this.Da=new At,this.P=e&&e.fastHandshake||!1,this.O=e&&e.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=e&&e.Rb||!1,e&&e.xa&&this.j.xa(),e&&e.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&e&&e.detectBufferingProxy||!1,this.ja=void 0,e&&e.longPollingTimeout&&0<e.longPollingTimeout&&(this.ja=e.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}function Xt(e){if(Qt(e),3==e.G){var t=e.U++,r=st(e.I);if(ut(r,"SID",e.K),ut(r,"RID",t),ut(r,"TYPE","terminate"),er(e,r),(t=new Le(e,e.j,t)).L=2,t.v=ht(st(r)),r=!1,a.navigator&&a.navigator.sendBeacon)try{r=a.navigator.sendBeacon(t.v.toString(),"")}catch(n){}!r&&a.Image&&((new Image).src=t.v,r=!0),r||(t.g=fr(t.j,null),t.g.ea(t.v)),t.F=Date.now(),He(t)}ur(e)}function Yt(e){e.g&&(ar(e),e.g.cancel(),e.g=null)}function Qt(e){Yt(e),e.u&&(a.clearTimeout(e.u),e.u=null),sr(e),e.h.cancel(),e.s&&("number"===typeof e.s&&a.clearTimeout(e.s),e.s=null)}function Jt(e){if(!Qe(e.h)&&!e.s){e.s=!0;var t=e.Ga;I||N(),A||(I(),A=!0),R.add(t,e),e.B=0}}function Zt(e,t){var r;r=t?t.l:e.U++;const n=st(e.I);ut(n,"SID",e.K),ut(n,"RID",r),ut(n,"AID",e.T),er(e,n),e.m&&e.o&&Mt(n,e.m,e.o),r=new Le(e,e.j,r,e.B+1),null===e.m&&(r.H=e.o),t&&(e.i=t.D.concat(e.i)),t=tr(e,r,1e3),r.I=Math.round(.5*e.wa)+Math.round(.5*e.wa*Math.random()),et(e.h,r),Ve(r,n,t)}function er(e,t){e.H&&y(e.H,(function(e,r){ut(t,r,e)})),e.l&&nt({},(function(e,r){ut(t,r,e)}))}function tr(e,t,r){r=Math.min(e.i.length,r);var n=e.l?c(e.l.Na,e.l,e):null;e:{var a=e.i;let t=-1;for(;;){const e=["count="+r];-1==t?0<r?(t=a[0].g,e.push("ofs="+t)):t=0:e.push("ofs="+t);let s=!0;for(let o=0;o<r;o++){let r=a[o].g;const l=a[o].map;if(r-=t,0>r)t=Math.max(0,a[o].g-100),s=!1;else try{Rt(l,e,"req"+r+"_")}catch(i){n&&n(l)}}if(s){n=e.join("&");break e}}}return e=e.i.splice(0,r),t.D=e,n}function rr(e){if(!e.g&&!e.u){e.Y=1;var t=e.Fa;I||N(),A||(I(),A=!0),R.add(t,e),e.v=0}}function nr(e){return!(e.g||e.u||3<=e.v)&&(e.Y++,e.u=Ae(c(e.Fa,e),lr(e,e.v)),e.v++,!0)}function ar(e){null!=e.A&&(a.clearTimeout(e.A),e.A=null)}function ir(e){e.g=new Le(e,e.j,"rpc",e.Y),null===e.m&&(e.g.H=e.o),e.g.O=0;var t=st(e.qa);ut(t,"RID","rpc"),ut(t,"SID",e.K),ut(t,"AID",e.T),ut(t,"CI",e.F?"0":"1"),!e.F&&e.ja&&ut(t,"TO",e.ja),ut(t,"TYPE","xmlhttp"),er(e,t),e.m&&e.o&&Mt(t,e.m,e.o),e.L&&(e.g.I=e.L);var r=e.g;e=e.ia,r.L=1,r.v=ht(st(t)),r.m=null,r.P=!0,Be(r,e)}function sr(e){null!=e.C&&(a.clearTimeout(e.C),e.C=null)}function or(e,t){var r=null;if(e.g==t){sr(e),ar(e),e.g=null;var n=2}else{if(!Ze(e.h,t))return;r=t.D,tt(e.h,t),n=1}if(0!=e.G)if(t.o)if(1==n){r=t.m?t.m.length:0,t=Date.now()-t.F;var a=e.B;ne(n=Te(),new Ie(n,r)),Jt(e)}else rr(e);else if(3==(a=t.s)||0==a&&0<t.X||!(1==n&&function(e,t){return!(Je(e.h)>=e.h.j-(e.s?1:0))&&(e.s?(e.i=t.D.concat(e.i),!0):!(1==e.G||2==e.G||e.B>=(e.Va?0:e.Wa))&&(e.s=Ae(c(e.Ga,e,t),lr(e,e.B)),e.B++,!0))}(e,t)||2==n&&nr(e)))switch(r&&0<r.length&&(t=e.h,t.i=t.i.concat(r)),a){case 1:cr(e,5);break;case 4:cr(e,10);break;case 3:cr(e,6);break;default:cr(e,2)}}function lr(e,t){let r=e.Ta+Math.floor(Math.random()*e.cb);return e.isActive()||(r*=2),r*t}function cr(e,t){if(e.j.info("Error code "+t),2==t){var r=c(e.fb,e),n=e.Xa;const t=!n;n=new it(n||"//www.google.com/images/cleardot.gif"),a.location&&"http"==a.location.protocol||ot(n,"https"),ht(n),t?function(e,t){const r=new Re;if(a.Image){const n=new Image;n.onload=u(It,r,"TestLoadImage: loaded",!0,t,n),n.onerror=u(It,r,"TestLoadImage: error",!1,t,n),n.onabort=u(It,r,"TestLoadImage: abort",!1,t,n),n.ontimeout=u(It,r,"TestLoadImage: timeout",!1,t,n),a.setTimeout((function(){n.ontimeout&&n.ontimeout()}),1e4),n.src=e}else t(!1)}(n.toString(),r):function(e,t){new Re;const r=new AbortController,n=setTimeout((()=>{r.abort(),It(0,0,!1,t)}),1e4);fetch(e,{signal:r.signal}).then((e=>{clearTimeout(n),e.ok?It(0,0,!0,t):It(0,0,!1,t)})).catch((()=>{clearTimeout(n),It(0,0,!1,t)}))}(n.toString(),r)}else Ce(2);e.G=0,e.l&&e.l.sa(t),ur(e),Qt(e)}function ur(e){if(e.G=0,e.ka=[],e.l){const t=rt(e.h);0==t.length&&0==e.i.length||(d(e.ka,t),d(e.ka,e.i),e.h.i.length=0,f(e.i),e.i.length=0),e.l.ra()}}function hr(e,t,r){var n=r instanceof it?st(r):new it(r);if(""!=n.g)t&&(n.g=t+"."+n.g),lt(n,n.s);else{var i=a.location;n=i.protocol,t=t?t+"."+i.hostname:i.hostname,i=+i.port;var s=new it(null);n&&ot(s,n),t&&(s.g=t),i&&lt(s,i),r&&(s.l=r),n=s}return r=e.D,t=e.ya,r&&t&&ut(n,r,t),ut(n,"VER",e.la),er(e,n),n}function fr(e,t,r){if(t&&!e.J)throw Error("Can't create secondary domain capable XhrIo object.");return(t=e.Ca&&!e.pa?new Ft(new Nt({eb:r})):new Ft(e.pa)).Ha(e.J),t}function dr(){}function pr(){}function mr(e,t){re.call(this),this.g=new qt(t),this.l=e,this.h=t&&t.messageUrlParams||null,e=t&&t.messageHeaders||null,t&&t.clientProtocolHeaderRequired&&(e?e["X-Client-Protocol"]="webchannel":e={"X-Client-Protocol":"webchannel"}),this.g.o=e,e=t&&t.initMessageHeaders||null,t&&t.messageContentType&&(e?e["X-WebChannel-Content-Type"]=t.messageContentType:e={"X-WebChannel-Content-Type":t.messageContentType}),t&&t.va&&(e?e["X-WebChannel-Client-Profile"]=t.va:e={"X-WebChannel-Client-Profile":t.va}),this.g.S=e,(e=t&&t.Sb)&&!p(e)&&(this.g.m=e),this.v=t&&t.supportsCrossDomainXhr||!1,this.u=t&&t.sendRawJson||!1,(t=t&&t.httpSessionIdParam)&&!p(t)&&(this.g.D=t,null!==(e=this.h)&&t in e&&(t in(e=this.h)&&delete e[t])),this.j=new yr(this)}function gr(e){ye.call(this),e.__headers__&&(this.headers=e.__headers__,this.statusCode=e.__status__,delete e.__headers__,delete e.__status__);var t=e.__sm__;if(t){e:{for(const r in t){e=r;break e}e=void 0}(this.i=e)&&(e=this.i,t=null!==t&&e in t?t[e]:void 0),this.data=t}else this.data=e}function vr(){be.call(this),this.status=1}function yr(e){this.g=e}(e=Ft.prototype).Ha=function(e){this.J=e},e.ea=function(e,t,r,n){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+e);t=t?t.toUpperCase():"GET",this.D=e,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():Oe.g(),this.v=this.o?me(this.o):me(Oe),this.g.onreadystatechange=c(this.Ea,this);try{this.B=!0,this.g.open(t,String(e),!0),this.B=!1}catch(s){return void Bt(this,s)}if(e=r||"",r=new Map(this.headers),n)if(Object.getPrototypeOf(n)===Object.prototype)for(var i in n)r.set(i,n[i]);else{if("function"!==typeof n.keys||"function"!==typeof n.get)throw Error("Unknown input type for opt_headers: "+String(n));for(const e of n.keys())r.set(e,n.get(e))}n=Array.from(r.keys()).find((e=>"content-type"==e.toLowerCase())),i=a.FormData&&e instanceof a.FormData,!(0<=Array.prototype.indexOf.call(Vt,t,void 0))||n||i||r.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[a,o]of r)this.g.setRequestHeader(a,o);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{$t(this),this.u=!0,this.g.send(e),this.u=!1}catch(s){Bt(this,s)}},e.abort=function(e){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=e||7,ne(this,"complete"),ne(this,"abort"),Ht(this))},e.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Ht(this,!0)),Ft.aa.N.call(this)},e.Ea=function(){this.s||(this.B||this.u||this.j?jt(this):this.bb())},e.bb=function(){jt(this)},e.isActive=function(){return!!this.g},e.Z=function(){try{return 2<Wt(this)?this.g.status:-1}catch(mt){return-1}},e.oa=function(){try{return this.g?this.g.responseText:""}catch(mt){return""}},e.Oa=function(e){if(this.g){var t=this.g.responseText;return e&&0==t.indexOf(e)&&(t=t.substring(e.length)),fe(t)}},e.Ba=function(){return this.m},e.Ka=function(){return"string"===typeof this.l?this.l:String(this.l)},(e=qt.prototype).la=8,e.G=1,e.connect=function(e,t,r,n){Ce(0),this.W=e,this.H=t||{},r&&void 0!==n&&(this.H.OSID=r,this.H.OAID=n),this.F=this.X,this.I=hr(this,null,this.W),Jt(this)},e.Ga=function(e){if(this.s)if(this.s=null,1==this.G){if(!e){this.U=Math.floor(1e5*Math.random()),e=this.U++;const a=new Le(this,this.j,e);let i=this.o;if(this.S&&(i?(i=b(i),E(i,this.S)):i=this.S),null!==this.m||this.O||(a.H=i,i=null),this.P)e:{for(var t=0,r=0;r<this.i.length;r++){var n=this.i[r];if(void 0===(n="__data__"in n.map&&"string"===typeof(n=n.map.__data__)?n.length:void 0))break;if(4096<(t+=n)){t=r;break e}if(4096===t||r===this.i.length-1){t=r+1;break e}}t=1e3}else t=1e3;t=tr(this,a,t),ut(r=st(this.I),"RID",e),ut(r,"CVER",22),this.D&&ut(r,"X-HTTP-Session-Id",this.D),er(this,r),i&&(this.O?t="headers="+encodeURIComponent(String(Lt(i)))+"&"+t:this.m&&Mt(r,this.m,i)),et(this.h,a),this.Ua&&ut(r,"TYPE","init"),this.P?(ut(r,"$req",t),ut(r,"SID","null"),a.T=!0,Ve(a,r,null)):Ve(a,r,t),this.G=2}}else 3==this.G&&(e?Zt(this,e):0==this.i.length||Qe(this.h)||Zt(this))},e.Fa=function(){if(this.u=null,ir(this),this.ba&&!(this.M||null==this.g||0>=this.R)){var e=2*this.R;this.j.info("BP detection timer enabled: "+e),this.A=Ae(c(this.ab,this),e)}},e.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,Ce(10),Yt(this),ir(this))},e.Za=function(){null!=this.C&&(this.C=null,Yt(this),nr(this),Ce(19))},e.fb=function(e){e?(this.j.info("Successfully pinged google.com"),Ce(2)):(this.j.info("Failed to ping google.com"),Ce(1))},e.isActive=function(){return!!this.l&&this.l.isActive(this)},(e=dr.prototype).ua=function(){},e.ta=function(){},e.sa=function(){},e.ra=function(){},e.isActive=function(){return!0},e.Na=function(){},pr.prototype.g=function(e,t){return new mr(e,t)},h(mr,re),mr.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},mr.prototype.close=function(){Xt(this.g)},mr.prototype.o=function(e){var t=this.g;if("string"===typeof e){var r={};r.__data__=e,e=r}else this.u&&((r={}).__data__=he(e),e=r);t.i.push(new Xe(t.Ya++,e)),3==t.G&&Jt(t)},mr.prototype.N=function(){this.g.l=null,delete this.j,Xt(this.g),delete this.g,mr.aa.N.call(this)},h(gr,ye),h(vr,be),h(yr,dr),yr.prototype.ua=function(){ne(this.g,"a")},yr.prototype.ta=function(e){ne(this.g,new gr(e))},yr.prototype.sa=function(e){ne(this.g,new vr)},yr.prototype.ra=function(){ne(this.g,"b")},pr.prototype.createWebChannel=pr.prototype.g,mr.prototype.send=mr.prototype.o,mr.prototype.open=mr.prototype.m,mr.prototype.close=mr.prototype.close,Mr=Ur.createWebChannelTransport=function(){return new pr},Lr=Ur.getStatEventTarget=function(){return Te()},Dr=Ur.Event=we,Pr=Ur.Stat={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},xe.NO_ERROR=0,xe.TIMEOUT=8,xe.HTTP_ERROR=6,xr=Ur.ErrorCode=xe,Pe.COMPLETE="complete",Or=Ur.EventType=Pe,ge.EventType=ve,ve.OPEN="a",ve.CLOSE="b",ve.ERROR="c",ve.MESSAGE="d",re.prototype.listen=re.prototype.K,Nr=Ur.WebChannel=ge,Ur.FetchXmlHttpFactory=Nt,Ft.prototype.listenOnce=Ft.prototype.L,Ft.prototype.getLastError=Ft.prototype.Ka,Ft.prototype.getLastErrorCode=Ft.prototype.Ba,Ft.prototype.getStatus=Ft.prototype.Z,Ft.prototype.getResponseJson=Ft.prototype.Oa,Ft.prototype.getResponseText=Ft.prototype.oa,Ft.prototype.send=Ft.prototype.ea,Ft.prototype.setWithCredentials=Ft.prototype.Ha,Rr=Ur.XhrIo=Ft}).apply("undefined"!==typeof Fr?Fr:"undefined"!==typeof self?self:"undefined"!==typeof window?window:{});const Vr="@firebase/firestore",Br="4.7.10";class zr{constructor(e){this.uid=e}isAuthenticated(){return null!=this.uid}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}zr.UNAUTHENTICATED=new zr(null),zr.GOOGLE_CREDENTIALS=new zr("google-credentials-uid"),zr.FIRST_PARTY=new zr("first-party-uid"),zr.MOCK_USER=new zr("mock-user");let jr="11.5.0";const Hr=new ot("@firebase/firestore");function $r(){return Hr.logLevel}function Wr(e){if(Hr.logLevel<=rt.DEBUG){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];const a=r.map(qr);Hr.debug(`Firestore (${jr}): ${e}`,...a)}}function Gr(e){if(Hr.logLevel<=rt.ERROR){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];const a=r.map(qr);Hr.error(`Firestore (${jr}): ${e}`,...a)}}function Kr(e){if(Hr.logLevel<=rt.WARN){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];const a=r.map(qr);Hr.warn(`Firestore (${jr}): ${e}`,...a)}}function qr(e){if("string"==typeof e)return e;try{return function(e){return JSON.stringify(e)}(e)}catch(t){return e}}function Xr(){const e=`FIRESTORE (${jr}) INTERNAL ASSERTION FAILED: `+(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Unexpected state");throw Gr(e),new Error(e)}function Yr(e,t){e||Xr()}function Qr(e,t){return e}const Jr={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Zr extends Be{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class en{constructor(){this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}}class tn{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class rn{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable((()=>t(zr.UNAUTHENTICATED)))}shutdown(){}}class nn{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable((()=>t(this.token.user)))}shutdown(){this.changeListener=null}}class an{constructor(e){this.t=e,this.currentUser=zr.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){Yr(void 0===this.o);let r=this.i;const n=e=>this.i!==r?(r=this.i,t(e)):Promise.resolve();let a=new en;this.o=()=>{this.i++,this.currentUser=this.u(),a.resolve(),a=new en,e.enqueueRetryable((()=>n(this.currentUser)))};const i=()=>{const t=a;e.enqueueRetryable((async()=>{await t.promise,await n(this.currentUser)}))},s=e=>{Wr("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=e,this.o&&(this.auth.addAuthTokenListener(this.o),i())};this.t.onInit((e=>s(e))),setTimeout((()=>{if(!this.auth){const e=this.t.getImmediate({optional:!0});e?s(e):(Wr("FirebaseAuthCredentialsProvider","Auth not yet detected"),a.resolve(),a=new en)}}),0),i()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then((t=>this.i!==e?(Wr("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):t?(Yr("string"==typeof t.accessToken),new tn(t.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return Yr(null===e||"string"==typeof e),new zr(e)}}class sn{constructor(e,t,r){this.l=e,this.h=t,this.P=r,this.type="FirstParty",this.user=zr.FIRST_PARTY,this.T=new Map}I(){return this.P?this.P():null}get headers(){this.T.set("X-Goog-AuthUser",this.l);const e=this.I();return e&&this.T.set("Authorization",e),this.h&&this.T.set("X-Goog-Iam-Authorization-Token",this.h),this.T}}class on{constructor(e,t,r){this.l=e,this.h=t,this.P=r}getToken(){return Promise.resolve(new sn(this.l,this.h,this.P))}start(e,t){e.enqueueRetryable((()=>t(zr.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class ln{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class cn{constructor(e,t){this.A=t,this.forceRefresh=!1,this.appCheck=null,this.R=null,this.V=null,lr(e)&&e.settings.appCheckToken&&(this.V=e.settings.appCheckToken)}start(e,t){Yr(void 0===this.o);const r=e=>{null!=e.error&&Wr("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${e.error.message}`);const r=e.token!==this.R;return this.R=e.token,Wr("FirebaseAppCheckTokenProvider",`Received ${r?"new":"existing"} token.`),r?t(e.token):Promise.resolve()};this.o=t=>{e.enqueueRetryable((()=>r(t)))};const n=e=>{Wr("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=e,this.o&&this.appCheck.addTokenListener(this.o)};this.A.onInit((e=>n(e))),setTimeout((()=>{if(!this.appCheck){const e=this.A.getImmediate({optional:!0});e?n(e):Wr("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){if(this.V)return Promise.resolve(new ln(this.V));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then((e=>e?(Yr("string"==typeof e.token),this.R=e.token,new ln(e.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}function un(e){const t="undefined"!=typeof self&&(self.crypto||self.msCrypto),r=new Uint8Array(e);if(t&&"function"==typeof t.getRandomValues)t.getRandomValues(r);else for(let n=0;n<e;n++)r[n]=Math.floor(256*Math.random());return r}function hn(){return new TextEncoder}class fn{static newId(){const e=62*Math.floor(256/62);let t="";for(;t.length<20;){const r=un(40);for(let n=0;n<r.length;++n)t.length<20&&r[n]<e&&(t+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".charAt(r[n]%62))}return t}}function dn(e,t){return e<t?-1:e>t?1:0}function pn(e,t){let r=0;for(;r<e.length&&r<t.length;){const n=e.codePointAt(r),a=t.codePointAt(r);if(n!==a){if(n<128&&a<128)return dn(n,a);{const i=hn(),s=gn(i.encode(mn(e,r)),i.encode(mn(t,r)));return 0!==s?s:dn(n,a)}}r+=n>65535?2:1}return dn(e.length,t.length)}function mn(e,t){return e.codePointAt(t)>65535?e.substring(t,t+2):e.substring(t,t+1)}function gn(e,t){for(let r=0;r<e.length&&r<t.length;++r)if(e[r]!==t[r])return dn(e[r],t[r]);return dn(e.length,t.length)}function vn(e,t,r){return e.length===t.length&&e.every(((e,n)=>r(e,t[n])))}const yn=-62135596800,bn=1e6;class wn{static now(){return wn.fromMillis(Date.now())}static fromDate(e){return wn.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),r=Math.floor((e-1e3*t)*bn);return new wn(t,r)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new Zr(Jr.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new Zr(Jr.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<yn)throw new Zr(Jr.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new Zr(Jr.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/bn}_compareTo(e){return this.seconds===e.seconds?dn(this.nanoseconds,e.nanoseconds):dn(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds-yn;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}class En{static fromTimestamp(e){return new En(e)}static min(){return new En(new wn(0,0))}static max(){return new En(new wn(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}const Tn="__name__";class _n{constructor(e,t,r){void 0===t?t=0:t>e.length&&Xr(),void 0===r?r=e.length-t:r>e.length-t&&Xr(),this.segments=e,this.offset=t,this.len=r}get length(){return this.len}isEqual(e){return 0===_n.comparator(this,e)}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof _n?e.forEach((e=>{t.push(e)})):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=void 0===e?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return 0===this.length}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,r=this.limit();t<r;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const r=Math.min(e.length,t.length);for(let n=0;n<r;n++){const r=_n.compareSegments(e.get(n),t.get(n));if(0!==r)return r}return dn(e.length,t.length)}static compareSegments(e,t){const r=_n.isNumericId(e),n=_n.isNumericId(t);return r&&!n?-1:!r&&n?1:r&&n?_n.extractNumericId(e).compare(_n.extractNumericId(t)):pn(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return kr.fromString(e.substring(4,e.length-2))}}class Sn extends _n{construct(e,t,r){return new Sn(e,t,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(){const e=[];for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];for(const a of r){if(a.indexOf("//")>=0)throw new Zr(Jr.INVALID_ARGUMENT,`Invalid segment (${a}). Paths must not contain // in them.`);e.push(...a.split("/").filter((e=>e.length>0)))}return new Sn(e)}static emptyPath(){return new Sn([])}}const kn=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Cn extends _n{construct(e,t,r){return new Cn(e,t,r)}static isValidIdentifier(e){return kn.test(e)}canonicalString(){return this.toArray().map((e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Cn.isValidIdentifier(e)||(e="`"+e+"`"),e))).join(".")}toString(){return this.canonicalString()}isKeyField(){return 1===this.length&&this.get(0)===Tn}static keyField(){return new Cn([Tn])}static fromServerFormat(e){const t=[];let r="",n=0;const a=()=>{if(0===r.length)throw new Zr(Jr.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(r),r=""};let i=!1;for(;n<e.length;){const t=e[n];if("\\"===t){if(n+1===e.length)throw new Zr(Jr.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const t=e[n+1];if("\\"!==t&&"."!==t&&"`"!==t)throw new Zr(Jr.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=t,n+=2}else"`"===t?(i=!i,n++):"."!==t||i?(r+=t,n++):(a(),n++)}if(a(),i)throw new Zr(Jr.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new Cn(t)}static emptyPath(){return new Cn([])}}class In{constructor(e){this.path=e}static fromPath(e){return new In(Sn.fromString(e))}static fromName(e){return new In(Sn.fromString(e).popFirst(5))}static empty(){return new In(Sn.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return null!==e&&0===Sn.comparator(this.path,e.path)}toString(){return this.path.toString()}static comparator(e,t){return Sn.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new In(new Sn(e.slice()))}}const An=-1;class Rn{constructor(e,t,r,n){this.indexId=e,this.collectionGroup=t,this.fields=r,this.indexState=n}}Rn.UNKNOWN_ID=-1;function Nn(e,t){const r=e.toTimestamp().seconds,n=e.toTimestamp().nanoseconds+1,a=En.fromTimestamp(1e9===n?new wn(r+1,0):new wn(r,n));return new xn(a,In.empty(),t)}function On(e){return new xn(e.readTime,e.key,An)}class xn{constructor(e,t,r){this.readTime=e,this.documentKey=t,this.largestBatchId=r}static min(){return new xn(En.min(),In.empty(),An)}static max(){return new xn(En.max(),In.empty(),An)}}function Pn(e,t){let r=e.readTime.compareTo(t.readTime);return 0!==r?r:(r=In.comparator(e.documentKey,t.documentKey),0!==r?r:dn(e.largestBatchId,t.largestBatchId))}const Dn="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class Ln{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((e=>e()))}}async function Mn(e){if(e.code!==Jr.FAILED_PRECONDITION||e.message!==Dn)throw e;Wr("LocalStore","Unexpectedly lost primary lease")}class Fn{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e((e=>{this.isDone=!0,this.result=e,this.nextCallback&&this.nextCallback(e)}),(e=>{this.isDone=!0,this.error=e,this.catchCallback&&this.catchCallback(e)}))}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&Xr(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new Fn(((r,n)=>{this.nextCallback=t=>{this.wrapSuccess(e,t).next(r,n)},this.catchCallback=e=>{this.wrapFailure(t,e).next(r,n)}}))}toPromise(){return new Promise(((e,t)=>{this.next(e,t)}))}wrapUserFunction(e){try{const t=e();return t instanceof Fn?t:Fn.resolve(t)}catch(e){return Fn.reject(e)}}wrapSuccess(e,t){return e?this.wrapUserFunction((()=>e(t))):Fn.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction((()=>e(t))):Fn.reject(t)}static resolve(e){return new Fn(((t,r)=>{t(e)}))}static reject(e){return new Fn(((t,r)=>{r(e)}))}static waitFor(e){return new Fn(((t,r)=>{let n=0,a=0,i=!1;e.forEach((e=>{++n,e.next((()=>{++a,i&&a===n&&t()}),(e=>r(e)))})),i=!0,a===n&&t()}))}static or(e){let t=Fn.resolve(!1);for(const r of e)t=t.next((e=>e?Fn.resolve(e):r()));return t}static forEach(e,t){const r=[];return e.forEach(((e,n)=>{r.push(t.call(this,e,n))})),this.waitFor(r)}static mapArray(e,t){return new Fn(((r,n)=>{const a=e.length,i=new Array(a);let s=0;for(let o=0;o<a;o++){const l=o;t(e[l]).next((e=>{i[l]=e,++s,s===a&&r(i)}),(e=>n(e)))}}))}static doWhile(e,t){return new Fn(((r,n)=>{const a=()=>{!0===e()?t().next((()=>{a()}),n):r()};a()}))}}function Un(e){const t=e.match(/Android ([\d.]+)/i),r=t?t[1].split(".").slice(0,2).join("."):"-1";return Number(r)}function Vn(e){return"IndexedDbTransactionError"===e.name}class Bn{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=e=>this.oe(e),this._e=e=>t.writeSequenceNumber(e))}oe(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this._e&&this._e(e),e}}Bn.ae=-1;const zn=-1;function jn(e){return null==e}function Hn(e){return 0===e&&1/e==-1/0}function $n(e){return"number"==typeof e&&Number.isInteger(e)&&!Hn(e)&&e<=Number.MAX_SAFE_INTEGER&&e>=Number.MIN_SAFE_INTEGER}const Wn="\x01";function Gn(e){let t="";for(let r=0;r<e.length;r++)t.length>0&&(t=qn(t)),t=Kn(e.get(r),t);return qn(t)}function Kn(e,t){let r=t;const n=e.length;for(let a=0;a<n;a++){const t=e.charAt(a);switch(t){case"\0":r+="\x01\x10";break;case Wn:r+="\x01\x11";break;default:r+=t}}return r}function qn(e){return e+Wn+"\x01"}const Xn="remoteDocuments",Yn="owner",Qn="mutationQueues",Jn="mutations";const Zn="documentMutations",ea="remoteDocumentsV14",ta="remoteDocumentGlobal",ra="targets",na="targetDocuments",aa="targetGlobal",ia="collectionParents",sa="clientMetadata",oa="bundles",la="namedQueries",ca="indexConfiguration",ua="indexState",ha="indexEntries",fa="documentOverlays",da="globals",pa=[Qn,Jn,Zn,Xn,ra,Yn,aa,na,sa,ta,ia,oa,la],ma=[Qn,Jn,Zn,ea,ra,Yn,aa,na,sa,ta,ia,oa,la,fa],ga=ma,va=[...ga,ca,ua,ha];function ya(e){let t=0;for(const r in e)Object.prototype.hasOwnProperty.call(e,r)&&t++;return t}function ba(e,t){for(const r in e)Object.prototype.hasOwnProperty.call(e,r)&&t(r,e[r])}function wa(e){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}class Ea{constructor(e,t){this.comparator=e,this.root=t||_a.EMPTY}insert(e,t){return new Ea(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,_a.BLACK,null,null))}remove(e){return new Ea(this.comparator,this.root.remove(e,this.comparator).copy(null,null,_a.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const r=this.comparator(e,t.key);if(0===r)return t.value;r<0?t=t.left:r>0&&(t=t.right)}return null}indexOf(e){let t=0,r=this.root;for(;!r.isEmpty();){const n=this.comparator(e,r.key);if(0===n)return t+r.left.size;n<0?r=r.left:(t+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal(((t,r)=>(e(t,r),!1)))}toString(){const e=[];return this.inorderTraversal(((t,r)=>(e.push(`${t}:${r}`),!1))),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Ta(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Ta(this.root,e,this.comparator,!1)}getReverseIterator(){return new Ta(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Ta(this.root,e,this.comparator,!0)}}class Ta{constructor(e,t,r,n){this.isReverse=n,this.nodeStack=[];let a=1;for(;!e.isEmpty();)if(a=t?r(e.key,t):1,t&&n&&(a*=-1),a<0)e=this.isReverse?e.left:e.right;else{if(0===a){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(0===this.nodeStack.length)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class _a{constructor(e,t,r,n,a){this.key=e,this.value=t,this.color=null!=r?r:_a.RED,this.left=null!=n?n:_a.EMPTY,this.right=null!=a?a:_a.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,r,n,a){return new _a(null!=e?e:this.key,null!=t?t:this.value,null!=r?r:this.color,null!=n?n:this.left,null!=a?a:this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,r){let n=this;const a=r(e,n.key);return n=a<0?n.copy(null,null,null,n.left.insert(e,t,r),null):0===a?n.copy(null,t,null,null,null):n.copy(null,null,null,null,n.right.insert(e,t,r)),n.fixUp()}removeMin(){if(this.left.isEmpty())return _a.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let r,n=this;if(t(e,n.key)<0)n.left.isEmpty()||n.left.isRed()||n.left.left.isRed()||(n=n.moveRedLeft()),n=n.copy(null,null,null,n.left.remove(e,t),null);else{if(n.left.isRed()&&(n=n.rotateRight()),n.right.isEmpty()||n.right.isRed()||n.right.left.isRed()||(n=n.moveRedRight()),0===t(e,n.key)){if(n.right.isEmpty())return _a.EMPTY;r=n.right.min(),n=n.copy(r.key,r.value,null,null,n.right.removeMin())}n=n.copy(null,null,null,null,n.right.remove(e,t))}return n.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,_a.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,_a.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw Xr();if(this.right.isRed())throw Xr();const e=this.left.check();if(e!==this.right.check())throw Xr();return e+(this.isRed()?0:1)}}_a.EMPTY=null,_a.RED=!0,_a.BLACK=!1,_a.EMPTY=new class{constructor(){this.size=0}get key(){throw Xr()}get value(){throw Xr()}get color(){throw Xr()}get left(){throw Xr()}get right(){throw Xr()}copy(e,t,r,n,a){return this}insert(e,t,r){return new _a(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class Sa{constructor(e){this.comparator=e,this.data=new Ea(this.comparator)}has(e){return null!==this.data.get(e)}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal(((t,r)=>(e(t),!1)))}forEachInRange(e,t){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const n=r.getNext();if(this.comparator(n.key,e[1])>=0)return;t(n.key)}}forEachWhile(e,t){let r;for(r=void 0!==t?this.data.getIteratorFrom(t):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new ka(this.data.getIterator())}getIteratorFrom(e){return new ka(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach((e=>{t=t.add(e)})),t}isEqual(e){if(!(e instanceof Sa))return!1;if(this.size!==e.size)return!1;const t=this.data.getIterator(),r=e.data.getIterator();for(;t.hasNext();){const e=t.getNext().key,n=r.getNext().key;if(0!==this.comparator(e,n))return!1}return!0}toArray(){const e=[];return this.forEach((t=>{e.push(t)})),e}toString(){const e=[];return this.forEach((t=>e.push(t))),"SortedSet("+e.toString()+")"}copy(e){const t=new Sa(this.comparator);return t.data=e,t}}class ka{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}class Ca{constructor(e){this.fields=e,e.sort(Cn.comparator)}static empty(){return new Ca([])}unionWith(e){let t=new Sa(Cn.comparator);for(const r of this.fields)t=t.add(r);for(const r of e)t=t.add(r);return new Ca(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return vn(this.fields,e.fields,((e,t)=>e.isEqual(t)))}}class Ia extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}class Aa{constructor(e){this.binaryString=e}static fromBase64String(e){const t=function(e){try{return atob(e)}catch(e){throw"undefined"!=typeof DOMException&&e instanceof DOMException?new Ia("Invalid base64 string: "+e):e}}(e);return new Aa(t)}static fromUint8Array(e){const t=function(e){let t="";for(let r=0;r<e.length;++r)t+=String.fromCharCode(e[r]);return t}(e);return new Aa(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return e=this.binaryString,btoa(e);var e}toUint8Array(){return function(e){const t=new Uint8Array(e.length);for(let r=0;r<e.length;r++)t[r]=e.charCodeAt(r);return t}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return dn(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Aa.EMPTY_BYTE_STRING=new Aa("");const Ra=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Na(e){if(Yr(!!e),"string"==typeof e){let t=0;const r=Ra.exec(e);if(Yr(!!r),r[1]){let e=r[1];e=(e+"000000000").substr(0,9),t=Number(e)}const n=new Date(e);return{seconds:Math.floor(n.getTime()/1e3),nanos:t}}return{seconds:Oa(e.seconds),nanos:Oa(e.nanos)}}function Oa(e){return"number"==typeof e?e:"string"==typeof e?Number(e):0}function xa(e){return"string"==typeof e?Aa.fromBase64String(e):Aa.fromUint8Array(e)}const Pa="server_timestamp",Da="__type__",La="__previous_value__",Ma="__local_write_time__";function Fa(e){var t,r;return(null===(r=((null===(t=null==e?void 0:e.mapValue)||void 0===t?void 0:t.fields)||{})[Da])||void 0===r?void 0:r.stringValue)===Pa}function Ua(e){const t=e.mapValue.fields[La];return Fa(t)?Ua(t):t}function Va(e){const t=Na(e.mapValue.fields[Ma].timestampValue);return new wn(t.seconds,t.nanos)}class Ba{constructor(e,t,r,n,a,i,s,o,l){this.databaseId=e,this.appId=t,this.persistenceKey=r,this.host=n,this.ssl=a,this.forceLongPolling=i,this.autoDetectLongPolling=s,this.longPollingOptions=o,this.useFetchStreams=l}}const za="(default)";class ja{constructor(e,t){this.projectId=e,this.database=t||za}static empty(){return new ja("","")}get isDefaultDatabase(){return this.database===za}isEqual(e){return e instanceof ja&&e.projectId===this.projectId&&e.database===this.database}}const Ha="__type__",$a="__max__",Wa={mapValue:{fields:{__type__:{stringValue:$a}}}},Ga="__vector__",Ka="value";function qa(e){return"nullValue"in e?0:"booleanValue"in e?1:"integerValue"in e||"doubleValue"in e?2:"timestampValue"in e?3:"stringValue"in e?5:"bytesValue"in e?6:"referenceValue"in e?7:"geoPointValue"in e?8:"arrayValue"in e?9:"mapValue"in e?Fa(e)?4:hi(e)?9007199254740991:ci(e)?10:11:Xr()}function Xa(e,t){if(e===t)return!0;const r=qa(e);if(r!==qa(t))return!1;switch(r){case 0:case 9007199254740991:return!0;case 1:return e.booleanValue===t.booleanValue;case 4:return Va(e).isEqual(Va(t));case 3:return function(e,t){if("string"==typeof e.timestampValue&&"string"==typeof t.timestampValue&&e.timestampValue.length===t.timestampValue.length)return e.timestampValue===t.timestampValue;const r=Na(e.timestampValue),n=Na(t.timestampValue);return r.seconds===n.seconds&&r.nanos===n.nanos}(e,t);case 5:return e.stringValue===t.stringValue;case 6:return function(e,t){return xa(e.bytesValue).isEqual(xa(t.bytesValue))}(e,t);case 7:return e.referenceValue===t.referenceValue;case 8:return function(e,t){return Oa(e.geoPointValue.latitude)===Oa(t.geoPointValue.latitude)&&Oa(e.geoPointValue.longitude)===Oa(t.geoPointValue.longitude)}(e,t);case 2:return function(e,t){if("integerValue"in e&&"integerValue"in t)return Oa(e.integerValue)===Oa(t.integerValue);if("doubleValue"in e&&"doubleValue"in t){const r=Oa(e.doubleValue),n=Oa(t.doubleValue);return r===n?Hn(r)===Hn(n):isNaN(r)&&isNaN(n)}return!1}(e,t);case 9:return vn(e.arrayValue.values||[],t.arrayValue.values||[],Xa);case 10:case 11:return function(e,t){const r=e.mapValue.fields||{},n=t.mapValue.fields||{};if(ya(r)!==ya(n))return!1;for(const a in r)if(r.hasOwnProperty(a)&&(void 0===n[a]||!Xa(r[a],n[a])))return!1;return!0}(e,t);default:return Xr()}}function Ya(e,t){return void 0!==(e.values||[]).find((e=>Xa(e,t)))}function Qa(e,t){if(e===t)return 0;const r=qa(e),n=qa(t);if(r!==n)return dn(r,n);switch(r){case 0:case 9007199254740991:return 0;case 1:return dn(e.booleanValue,t.booleanValue);case 2:return function(e,t){const r=Oa(e.integerValue||e.doubleValue),n=Oa(t.integerValue||t.doubleValue);return r<n?-1:r>n?1:r===n?0:isNaN(r)?isNaN(n)?0:-1:1}(e,t);case 3:return Ja(e.timestampValue,t.timestampValue);case 4:return Ja(Va(e),Va(t));case 5:return pn(e.stringValue,t.stringValue);case 6:return function(e,t){const r=xa(e),n=xa(t);return r.compareTo(n)}(e.bytesValue,t.bytesValue);case 7:return function(e,t){const r=e.split("/"),n=t.split("/");for(let a=0;a<r.length&&a<n.length;a++){const e=dn(r[a],n[a]);if(0!==e)return e}return dn(r.length,n.length)}(e.referenceValue,t.referenceValue);case 8:return function(e,t){const r=dn(Oa(e.latitude),Oa(t.latitude));return 0!==r?r:dn(Oa(e.longitude),Oa(t.longitude))}(e.geoPointValue,t.geoPointValue);case 9:return Za(e.arrayValue,t.arrayValue);case 10:return function(e,t){var r,n,a,i;const s=e.fields||{},o=t.fields||{},l=null===(r=s[Ka])||void 0===r?void 0:r.arrayValue,c=null===(n=o[Ka])||void 0===n?void 0:n.arrayValue,u=dn((null===(a=null==l?void 0:l.values)||void 0===a?void 0:a.length)||0,(null===(i=null==c?void 0:c.values)||void 0===i?void 0:i.length)||0);return 0!==u?u:Za(l,c)}(e.mapValue,t.mapValue);case 11:return function(e,t){if(e===Wa.mapValue&&t===Wa.mapValue)return 0;if(e===Wa.mapValue)return 1;if(t===Wa.mapValue)return-1;const r=e.fields||{},n=Object.keys(r),a=t.fields||{},i=Object.keys(a);n.sort(),i.sort();for(let s=0;s<n.length&&s<i.length;++s){const e=pn(n[s],i[s]);if(0!==e)return e;const t=Qa(r[n[s]],a[i[s]]);if(0!==t)return t}return dn(n.length,i.length)}(e.mapValue,t.mapValue);default:throw Xr()}}function Ja(e,t){if("string"==typeof e&&"string"==typeof t&&e.length===t.length)return dn(e,t);const r=Na(e),n=Na(t),a=dn(r.seconds,n.seconds);return 0!==a?a:dn(r.nanos,n.nanos)}function Za(e,t){const r=e.values||[],n=t.values||[];for(let a=0;a<r.length&&a<n.length;++a){const e=Qa(r[a],n[a]);if(e)return e}return dn(r.length,n.length)}function ei(e){return ti(e)}function ti(e){return"nullValue"in e?"null":"booleanValue"in e?""+e.booleanValue:"integerValue"in e?""+e.integerValue:"doubleValue"in e?""+e.doubleValue:"timestampValue"in e?function(e){const t=Na(e);return`time(${t.seconds},${t.nanos})`}(e.timestampValue):"stringValue"in e?e.stringValue:"bytesValue"in e?function(e){return xa(e).toBase64()}(e.bytesValue):"referenceValue"in e?function(e){return In.fromName(e).toString()}(e.referenceValue):"geoPointValue"in e?function(e){return`geo(${e.latitude},${e.longitude})`}(e.geoPointValue):"arrayValue"in e?function(e){let t="[",r=!0;for(const n of e.values||[])r?r=!1:t+=",",t+=ti(n);return t+"]"}(e.arrayValue):"mapValue"in e?function(e){const t=Object.keys(e.fields||{}).sort();let r="{",n=!0;for(const a of t)n?n=!1:r+=",",r+=`${a}:${ti(e.fields[a])}`;return r+"}"}(e.mapValue):Xr()}function ri(e){switch(qa(e)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const t=Ua(e);return t?16+ri(t):16;case 5:return 2*e.stringValue.length;case 6:return xa(e.bytesValue).approximateByteSize();case 7:return e.referenceValue.length;case 9:return function(e){return(e.values||[]).reduce(((e,t)=>e+ri(t)),0)}(e.arrayValue);case 10:case 11:return function(e){let t=0;return ba(e.fields,((e,r)=>{t+=e.length+ri(r)})),t}(e.mapValue);default:throw Xr()}}function ni(e,t){return{referenceValue:`projects/${e.projectId}/databases/${e.database}/documents/${t.path.canonicalString()}`}}function ai(e){return!!e&&"integerValue"in e}function ii(e){return!!e&&"arrayValue"in e}function si(e){return!!e&&"nullValue"in e}function oi(e){return!!e&&"doubleValue"in e&&isNaN(Number(e.doubleValue))}function li(e){return!!e&&"mapValue"in e}function ci(e){var t,r;return(null===(r=((null===(t=null==e?void 0:e.mapValue)||void 0===t?void 0:t.fields)||{})[Ha])||void 0===r?void 0:r.stringValue)===Ga}function ui(e){if(e.geoPointValue)return{geoPointValue:Object.assign({},e.geoPointValue)};if(e.timestampValue&&"object"==typeof e.timestampValue)return{timestampValue:Object.assign({},e.timestampValue)};if(e.mapValue){const t={mapValue:{fields:{}}};return ba(e.mapValue.fields,((e,r)=>t.mapValue.fields[e]=ui(r))),t}if(e.arrayValue){const t={arrayValue:{values:[]}};for(let r=0;r<(e.arrayValue.values||[]).length;++r)t.arrayValue.values[r]=ui(e.arrayValue.values[r]);return t}return Object.assign({},e)}function hi(e){return(((e.mapValue||{}).fields||{}).__type__||{}).stringValue===$a}class fi{constructor(e){this.value=e}static empty(){return new fi({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let r=0;r<e.length-1;++r)if(t=(t.mapValue.fields||{})[e.get(r)],!li(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=ui(t)}setAll(e){let t=Cn.emptyPath(),r={},n=[];e.forEach(((e,a)=>{if(!t.isImmediateParentOf(a)){const e=this.getFieldsMap(t);this.applyChanges(e,r,n),r={},n=[],t=a.popLast()}e?r[a.lastSegment()]=ui(e):n.push(a.lastSegment())}));const a=this.getFieldsMap(t);this.applyChanges(a,r,n)}delete(e){const t=this.field(e.popLast());li(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return Xa(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let r=0;r<e.length;++r){let n=t.mapValue.fields[e.get(r)];li(n)&&n.mapValue.fields||(n={mapValue:{fields:{}}},t.mapValue.fields[e.get(r)]=n),t=n}return t.mapValue.fields}applyChanges(e,t,r){ba(t,((t,r)=>e[t]=r));for(const n of r)delete e[n]}clone(){return new fi(ui(this.value))}}function di(e){const t=[];return ba(e.fields,((e,r)=>{const n=new Cn([e]);if(li(r)){const e=di(r.mapValue).fields;if(0===e.length)t.push(n);else for(const r of e)t.push(n.child(r))}else t.push(n)})),new Ca(t)}class pi{constructor(e,t,r,n,a,i,s){this.key=e,this.documentType=t,this.version=r,this.readTime=n,this.createTime=a,this.data=i,this.documentState=s}static newInvalidDocument(e){return new pi(e,0,En.min(),En.min(),En.min(),fi.empty(),0)}static newFoundDocument(e,t,r,n){return new pi(e,1,t,En.min(),r,n,0)}static newNoDocument(e,t){return new pi(e,2,t,En.min(),En.min(),fi.empty(),0)}static newUnknownDocument(e,t){return new pi(e,3,t,En.min(),En.min(),fi.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(En.min())||2!==this.documentType&&0!==this.documentType||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=fi.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=fi.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=En.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return 1===this.documentState}get hasCommittedMutations(){return 2===this.documentState}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return 0!==this.documentType}isFoundDocument(){return 1===this.documentType}isNoDocument(){return 2===this.documentType}isUnknownDocument(){return 3===this.documentType}isEqual(e){return e instanceof pi&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new pi(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class mi{constructor(e,t){this.position=e,this.inclusive=t}}function gi(e,t,r){let n=0;for(let a=0;a<e.position.length;a++){const i=t[a],s=e.position[a];if(n=i.field.isKeyField()?In.comparator(In.fromName(s.referenceValue),r.key):Qa(s,r.data.field(i.field)),"desc"===i.dir&&(n*=-1),0!==n)break}return n}function vi(e,t){if(null===e)return null===t;if(null===t)return!1;if(e.inclusive!==t.inclusive||e.position.length!==t.position.length)return!1;for(let r=0;r<e.position.length;r++)if(!Xa(e.position[r],t.position[r]))return!1;return!0}class yi{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"asc";this.field=e,this.dir=t}}function bi(e,t){return e.dir===t.dir&&e.field.isEqual(t.field)}class wi{}class Ei extends wi{constructor(e,t,r){super(),this.field=e,this.op=t,this.value=r}static create(e,t,r){return e.isKeyField()?"in"===t||"not-in"===t?this.createKeyFieldInFilter(e,t,r):new Ri(e,t,r):"array-contains"===t?new Pi(e,r):"in"===t?new Di(e,r):"not-in"===t?new Li(e,r):"array-contains-any"===t?new Mi(e,r):new Ei(e,t,r)}static createKeyFieldInFilter(e,t,r){return"in"===t?new Ni(e,r):new Oi(e,r)}matches(e){const t=e.data.field(this.field);return"!="===this.op?null!==t&&this.matchesComparison(Qa(t,this.value)):null!==t&&qa(this.value)===qa(t)&&this.matchesComparison(Qa(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return 0===e;case"!=":return 0!==e;case">":return e>0;case">=":return e>=0;default:return Xr()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Ti extends wi{constructor(e,t){super(),this.filters=e,this.op=t,this.ce=null}static create(e,t){return new Ti(e,t)}matches(e){return _i(this)?void 0===this.filters.find((t=>!t.matches(e))):void 0!==this.filters.find((t=>t.matches(e)))}getFlattenedFilters(){return null!==this.ce||(this.ce=this.filters.reduce(((e,t)=>e.concat(t.getFlattenedFilters())),[])),this.ce}getFilters(){return Object.assign([],this.filters)}}function _i(e){return"and"===e.op}function Si(e){return ki(e)&&_i(e)}function ki(e){for(const t of e.filters)if(t instanceof Ti)return!1;return!0}function Ci(e){if(e instanceof Ei)return e.field.canonicalString()+e.op.toString()+ei(e.value);if(Si(e))return e.filters.map((e=>Ci(e))).join(",");{const t=e.filters.map((e=>Ci(e))).join(",");return`${e.op}(${t})`}}function Ii(e,t){return e instanceof Ei?function(e,t){return t instanceof Ei&&e.op===t.op&&e.field.isEqual(t.field)&&Xa(e.value,t.value)}(e,t):e instanceof Ti?function(e,t){return t instanceof Ti&&e.op===t.op&&e.filters.length===t.filters.length&&e.filters.reduce(((e,r,n)=>e&&Ii(r,t.filters[n])),!0)}(e,t):void Xr()}function Ai(e){return e instanceof Ei?function(e){return`${e.field.canonicalString()} ${e.op} ${ei(e.value)}`}(e):e instanceof Ti?function(e){return e.op.toString()+" {"+e.getFilters().map(Ai).join(" ,")+"}"}(e):"Filter"}class Ri extends Ei{constructor(e,t,r){super(e,t,r),this.key=In.fromName(r.referenceValue)}matches(e){const t=In.comparator(e.key,this.key);return this.matchesComparison(t)}}class Ni extends Ei{constructor(e,t){super(e,"in",t),this.keys=xi("in",t)}matches(e){return this.keys.some((t=>t.isEqual(e.key)))}}class Oi extends Ei{constructor(e,t){super(e,"not-in",t),this.keys=xi("not-in",t)}matches(e){return!this.keys.some((t=>t.isEqual(e.key)))}}function xi(e,t){var r;return((null===(r=t.arrayValue)||void 0===r?void 0:r.values)||[]).map((e=>In.fromName(e.referenceValue)))}class Pi extends Ei{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return ii(t)&&Ya(t.arrayValue,this.value)}}class Di extends Ei{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return null!==t&&Ya(this.value.arrayValue,t)}}class Li extends Ei{constructor(e,t){super(e,"not-in",t)}matches(e){if(Ya(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return null!==t&&!Ya(this.value.arrayValue,t)}}class Mi extends Ei{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!ii(t)||!t.arrayValue.values)&&t.arrayValue.values.some((e=>Ya(this.value.arrayValue,e)))}}class Fi{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null;this.path=e,this.collectionGroup=t,this.orderBy=r,this.filters=n,this.limit=a,this.startAt=i,this.endAt=s,this.le=null}}function Ui(e){return new Fi(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,arguments.length>6&&void 0!==arguments[6]?arguments[6]:null)}function Vi(e){const t=Qr(e);if(null===t.le){let e=t.path.canonicalString();null!==t.collectionGroup&&(e+="|cg:"+t.collectionGroup),e+="|f:",e+=t.filters.map((e=>Ci(e))).join(","),e+="|ob:",e+=t.orderBy.map((e=>function(e){return e.field.canonicalString()+e.dir}(e))).join(","),jn(t.limit)||(e+="|l:",e+=t.limit),t.startAt&&(e+="|lb:",e+=t.startAt.inclusive?"b:":"a:",e+=t.startAt.position.map((e=>ei(e))).join(",")),t.endAt&&(e+="|ub:",e+=t.endAt.inclusive?"a:":"b:",e+=t.endAt.position.map((e=>ei(e))).join(",")),t.le=e}return t.le}function Bi(e,t){if(e.limit!==t.limit)return!1;if(e.orderBy.length!==t.orderBy.length)return!1;for(let r=0;r<e.orderBy.length;r++)if(!bi(e.orderBy[r],t.orderBy[r]))return!1;if(e.filters.length!==t.filters.length)return!1;for(let r=0;r<e.filters.length;r++)if(!Ii(e.filters[r],t.filters[r]))return!1;return e.collectionGroup===t.collectionGroup&&!!e.path.isEqual(t.path)&&!!vi(e.startAt,t.startAt)&&vi(e.endAt,t.endAt)}function zi(e){return In.isDocumentKey(e.path)&&null===e.collectionGroup&&0===e.filters.length}class ji{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"F",s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,o=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null;this.path=e,this.collectionGroup=t,this.explicitOrderBy=r,this.filters=n,this.limit=a,this.limitType=i,this.startAt=s,this.endAt=o,this.he=null,this.Pe=null,this.Te=null,this.startAt,this.endAt}}function Hi(e,t,r,n,a,i,s,o){return new ji(e,t,r,n,a,i,s,o)}function $i(e){return new ji(e)}function Wi(e){return 0===e.filters.length&&null===e.limit&&null==e.startAt&&null==e.endAt&&(0===e.explicitOrderBy.length||1===e.explicitOrderBy.length&&e.explicitOrderBy[0].field.isKeyField())}function Gi(e){return null!==e.collectionGroup}function Ki(e){const t=Qr(e);if(null===t.he){t.he=[];const e=new Set;for(const a of t.explicitOrderBy)t.he.push(a),e.add(a.field.canonicalString());const r=t.explicitOrderBy.length>0?t.explicitOrderBy[t.explicitOrderBy.length-1].dir:"asc",n=function(e){let t=new Sa(Cn.comparator);return e.filters.forEach((e=>{e.getFlattenedFilters().forEach((e=>{e.isInequality()&&(t=t.add(e.field))}))})),t}(t);n.forEach((n=>{e.has(n.canonicalString())||n.isKeyField()||t.he.push(new yi(n,r))})),e.has(Cn.keyField().canonicalString())||t.he.push(new yi(Cn.keyField(),r))}return t.he}function qi(e){const t=Qr(e);return t.Pe||(t.Pe=Xi(t,Ki(e))),t.Pe}function Xi(e,t){if("F"===e.limitType)return Ui(e.path,e.collectionGroup,t,e.filters,e.limit,e.startAt,e.endAt);{t=t.map((e=>{const t="desc"===e.dir?"asc":"desc";return new yi(e.field,t)}));const r=e.endAt?new mi(e.endAt.position,e.endAt.inclusive):null,n=e.startAt?new mi(e.startAt.position,e.startAt.inclusive):null;return Ui(e.path,e.collectionGroup,t,e.filters,e.limit,r,n)}}function Yi(e,t){const r=e.filters.concat([t]);return new ji(e.path,e.collectionGroup,e.explicitOrderBy.slice(),r,e.limit,e.limitType,e.startAt,e.endAt)}function Qi(e,t,r){return new ji(e.path,e.collectionGroup,e.explicitOrderBy.slice(),e.filters.slice(),t,r,e.startAt,e.endAt)}function Ji(e,t){return Bi(qi(e),qi(t))&&e.limitType===t.limitType}function Zi(e){return`${Vi(qi(e))}|lt:${e.limitType}`}function es(e){return`Query(target=${function(e){let t=e.path.canonicalString();return null!==e.collectionGroup&&(t+=" collectionGroup="+e.collectionGroup),e.filters.length>0&&(t+=`, filters: [${e.filters.map((e=>Ai(e))).join(", ")}]`),jn(e.limit)||(t+=", limit: "+e.limit),e.orderBy.length>0&&(t+=`, orderBy: [${e.orderBy.map((e=>function(e){return`${e.field.canonicalString()} (${e.dir})`}(e))).join(", ")}]`),e.startAt&&(t+=", startAt: ",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map((e=>ei(e))).join(",")),e.endAt&&(t+=", endAt: ",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map((e=>ei(e))).join(",")),`Target(${t})`}(qi(e))}; limitType=${e.limitType})`}function ts(e,t){return t.isFoundDocument()&&function(e,t){const r=t.key.path;return null!==e.collectionGroup?t.key.hasCollectionId(e.collectionGroup)&&e.path.isPrefixOf(r):In.isDocumentKey(e.path)?e.path.isEqual(r):e.path.isImmediateParentOf(r)}(e,t)&&function(e,t){for(const r of Ki(e))if(!r.field.isKeyField()&&null===t.data.field(r.field))return!1;return!0}(e,t)&&function(e,t){for(const r of e.filters)if(!r.matches(t))return!1;return!0}(e,t)&&function(e,t){return!(e.startAt&&!function(e,t,r){const n=gi(e,t,r);return e.inclusive?n<=0:n<0}(e.startAt,Ki(e),t))&&!(e.endAt&&!function(e,t,r){const n=gi(e,t,r);return e.inclusive?n>=0:n>0}(e.endAt,Ki(e),t))}(e,t)}function rs(e){return e.collectionGroup||(e.path.length%2==1?e.path.lastSegment():e.path.get(e.path.length-2))}function ns(e){return(t,r)=>{let n=!1;for(const a of Ki(e)){const e=as(a,t,r);if(0!==e)return e;n=n||a.field.isKeyField()}return 0}}function as(e,t,r){const n=e.field.isKeyField()?In.comparator(t.key,r.key):function(e,t,r){const n=t.data.field(e),a=r.data.field(e);return null!==n&&null!==a?Qa(n,a):Xr()}(e.field,t,r);switch(e.dir){case"asc":return n;case"desc":return-1*n;default:return Xr()}}class is{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),r=this.inner[t];if(void 0!==r)for(const[n,a]of r)if(this.equalsFn(n,e))return a}has(e){return void 0!==this.get(e)}set(e,t){const r=this.mapKeyFn(e),n=this.inner[r];if(void 0===n)return this.inner[r]=[[e,t]],void this.innerSize++;for(let a=0;a<n.length;a++)if(this.equalsFn(n[a][0],e))return void(n[a]=[e,t]);n.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),r=this.inner[t];if(void 0===r)return!1;for(let n=0;n<r.length;n++)if(this.equalsFn(r[n][0],e))return 1===r.length?delete this.inner[t]:r.splice(n,1),this.innerSize--,!0;return!1}forEach(e){ba(this.inner,((t,r)=>{for(const[n,a]of r)e(n,a)}))}isEmpty(){return wa(this.inner)}size(){return this.innerSize}}const ss=new Ea(In.comparator);function os(){return ss}const ls=new Ea(In.comparator);function cs(){let e=ls;for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];for(const a of r)e=e.insert(a.key,a);return e}function us(e){let t=ls;return e.forEach(((e,r)=>t=t.insert(e,r.overlayedDocument))),t}function hs(){return ds()}function fs(){return ds()}function ds(){return new is((e=>e.toString()),((e,t)=>e.isEqual(t)))}const ps=new Ea(In.comparator),ms=new Sa(In.comparator);function gs(){let e=ms;for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];for(const a of r)e=e.add(a);return e}const vs=new Sa(dn);function ys(){return vs}function bs(e,t){if(e.useProto3Json){if(isNaN(t))return{doubleValue:"NaN"};if(t===1/0)return{doubleValue:"Infinity"};if(t===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Hn(t)?"-0":t}}function ws(e){return{integerValue:""+e}}function Es(e,t){return $n(t)?ws(t):bs(e,t)}class Ts{constructor(){this._=void 0}}function _s(e,t,r){return e instanceof Cs?function(e,t){const r={fields:{[Da]:{stringValue:Pa},[Ma]:{timestampValue:{seconds:e.seconds,nanos:e.nanoseconds}}}};return t&&Fa(t)&&(t=Ua(t)),t&&(r.fields[La]=t),{mapValue:r}}(r,t):e instanceof Is?As(e,t):e instanceof Rs?Ns(e,t):function(e,t){const r=ks(e,t),n=xs(r)+xs(e.Ie);return ai(r)&&ai(e.Ie)?ws(n):bs(e.serializer,n)}(e,t)}function Ss(e,t,r){return e instanceof Is?As(e,t):e instanceof Rs?Ns(e,t):r}function ks(e,t){return e instanceof Os?function(e){return ai(e)||function(e){return!!e&&"doubleValue"in e}(e)}(t)?t:{integerValue:0}:null}class Cs extends Ts{}class Is extends Ts{constructor(e){super(),this.elements=e}}function As(e,t){const r=Ps(t);for(const n of e.elements)r.some((e=>Xa(e,n)))||r.push(n);return{arrayValue:{values:r}}}class Rs extends Ts{constructor(e){super(),this.elements=e}}function Ns(e,t){let r=Ps(t);for(const n of e.elements)r=r.filter((e=>!Xa(e,n)));return{arrayValue:{values:r}}}class Os extends Ts{constructor(e,t){super(),this.serializer=e,this.Ie=t}}function xs(e){return Oa(e.integerValue||e.doubleValue)}function Ps(e){return ii(e)&&e.arrayValue.values?e.arrayValue.values.slice():[]}class Ds{constructor(e,t){this.version=e,this.transformResults=t}}class Ls{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new Ls}static exists(e){return new Ls(void 0,e)}static updateTime(e){return new Ls(e)}get isNone(){return void 0===this.updateTime&&void 0===this.exists}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Ms(e,t){return void 0!==e.updateTime?t.isFoundDocument()&&t.version.isEqual(e.updateTime):void 0===e.exists||e.exists===t.isFoundDocument()}class Fs{}function Us(e,t){if(!e.hasLocalMutations||t&&0===t.fields.length)return null;if(null===t)return e.isNoDocument()?new qs(e.key,Ls.none()):new Hs(e.key,e.data,Ls.none());{const r=e.data,n=fi.empty();let a=new Sa(Cn.comparator);for(let e of t.fields)if(!a.has(e)){let t=r.field(e);null===t&&e.length>1&&(e=e.popLast(),t=r.field(e)),null===t?n.delete(e):n.set(e,t),a=a.add(e)}return new $s(e.key,n,new Ca(a.toArray()),Ls.none())}}function Vs(e,t,r){e instanceof Hs?function(e,t,r){const n=e.value.clone(),a=Gs(e.fieldTransforms,t,r.transformResults);n.setAll(a),t.convertToFoundDocument(r.version,n).setHasCommittedMutations()}(e,t,r):e instanceof $s?function(e,t,r){if(!Ms(e.precondition,t))return void t.convertToUnknownDocument(r.version);const n=Gs(e.fieldTransforms,t,r.transformResults),a=t.data;a.setAll(Ws(e)),a.setAll(n),t.convertToFoundDocument(r.version,a).setHasCommittedMutations()}(e,t,r):function(e,t,r){t.convertToNoDocument(r.version).setHasCommittedMutations()}(0,t,r)}function Bs(e,t,r,n){return e instanceof Hs?function(e,t,r,n){if(!Ms(e.precondition,t))return r;const a=e.value.clone(),i=Ks(e.fieldTransforms,n,t);return a.setAll(i),t.convertToFoundDocument(t.version,a).setHasLocalMutations(),null}(e,t,r,n):e instanceof $s?function(e,t,r,n){if(!Ms(e.precondition,t))return r;const a=Ks(e.fieldTransforms,n,t),i=t.data;return i.setAll(Ws(e)),i.setAll(a),t.convertToFoundDocument(t.version,i).setHasLocalMutations(),null===r?null:r.unionWith(e.fieldMask.fields).unionWith(e.fieldTransforms.map((e=>e.field)))}(e,t,r,n):function(e,t,r){return Ms(e.precondition,t)?(t.convertToNoDocument(t.version).setHasLocalMutations(),null):r}(e,t,r)}function zs(e,t){let r=null;for(const n of e.fieldTransforms){const e=t.data.field(n.field),a=ks(n.transform,e||null);null!=a&&(null===r&&(r=fi.empty()),r.set(n.field,a))}return r||null}function js(e,t){return e.type===t.type&&!!e.key.isEqual(t.key)&&!!e.precondition.isEqual(t.precondition)&&!!function(e,t){return void 0===e&&void 0===t||!(!e||!t)&&vn(e,t,((e,t)=>function(e,t){return e.field.isEqual(t.field)&&function(e,t){return e instanceof Is&&t instanceof Is||e instanceof Rs&&t instanceof Rs?vn(e.elements,t.elements,Xa):e instanceof Os&&t instanceof Os?Xa(e.Ie,t.Ie):e instanceof Cs&&t instanceof Cs}(e.transform,t.transform)}(e,t)))}(e.fieldTransforms,t.fieldTransforms)&&(0===e.type?e.value.isEqual(t.value):1!==e.type||e.data.isEqual(t.data)&&e.fieldMask.isEqual(t.fieldMask))}class Hs extends Fs{constructor(e,t,r){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[];super(),this.key=e,this.value=t,this.precondition=r,this.fieldTransforms=n,this.type=0}getFieldMask(){return null}}class $s extends Fs{constructor(e,t,r,n){let a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[];super(),this.key=e,this.data=t,this.fieldMask=r,this.precondition=n,this.fieldTransforms=a,this.type=1}getFieldMask(){return this.fieldMask}}function Ws(e){const t=new Map;return e.fieldMask.fields.forEach((r=>{if(!r.isEmpty()){const n=e.data.field(r);t.set(r,n)}})),t}function Gs(e,t,r){const n=new Map;Yr(e.length===r.length);for(let a=0;a<r.length;a++){const i=e[a],s=i.transform,o=t.data.field(i.field);n.set(i.field,Ss(s,o,r[a]))}return n}function Ks(e,t,r){const n=new Map;for(const a of e){const e=a.transform,i=r.data.field(a.field);n.set(a.field,_s(e,i,t))}return n}class qs extends Fs{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class Xs extends Fs{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class Ys{constructor(e,t,r,n){this.batchId=e,this.localWriteTime=t,this.baseMutations=r,this.mutations=n}applyToRemoteDocument(e,t){const r=t.mutationResults;for(let n=0;n<this.mutations.length;n++){const t=this.mutations[n];t.key.isEqual(e.key)&&Vs(t,e,r[n])}}applyToLocalView(e,t){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(t=Bs(r,e,t,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(t=Bs(r,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const r=fs();return this.mutations.forEach((n=>{const a=e.get(n.key),i=a.overlayedDocument;let s=this.applyToLocalView(i,a.mutatedFields);s=t.has(n.key)?null:s;const o=Us(i,s);null!==o&&r.set(n.key,o),i.isValidDocument()||i.convertToNoDocument(En.min())})),r}keys(){return this.mutations.reduce(((e,t)=>e.add(t.key)),gs())}isEqual(e){return this.batchId===e.batchId&&vn(this.mutations,e.mutations,((e,t)=>js(e,t)))&&vn(this.baseMutations,e.baseMutations,((e,t)=>js(e,t)))}}class Qs{constructor(e,t,r,n){this.batch=e,this.commitVersion=t,this.mutationResults=r,this.docVersions=n}static from(e,t,r){Yr(e.mutations.length===r.length);let n=ps;const a=e.mutations;for(let i=0;i<a.length;i++)n=n.insert(a[i].key,r[i].version);return new Qs(e,t,r,n)}}class Js{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return null!==e&&this.mutation===e.mutation}toString(){return`Overlay{\n      largestBatchId: ${this.largestBatchId},\n      mutation: ${this.mutation.toString()}\n    }`}}class Zs{constructor(e,t){this.count=e,this.unchangedNames=t}}var eo,to;function ro(e){switch(e){case Jr.OK:return Xr();case Jr.CANCELLED:case Jr.UNKNOWN:case Jr.DEADLINE_EXCEEDED:case Jr.RESOURCE_EXHAUSTED:case Jr.INTERNAL:case Jr.UNAVAILABLE:case Jr.UNAUTHENTICATED:return!1;case Jr.INVALID_ARGUMENT:case Jr.NOT_FOUND:case Jr.ALREADY_EXISTS:case Jr.PERMISSION_DENIED:case Jr.FAILED_PRECONDITION:case Jr.ABORTED:case Jr.OUT_OF_RANGE:case Jr.UNIMPLEMENTED:case Jr.DATA_LOSS:return!0;default:return Xr()}}function no(e){if(void 0===e)return Gr("GRPC error has no .code"),Jr.UNKNOWN;switch(e){case eo.OK:return Jr.OK;case eo.CANCELLED:return Jr.CANCELLED;case eo.UNKNOWN:return Jr.UNKNOWN;case eo.DEADLINE_EXCEEDED:return Jr.DEADLINE_EXCEEDED;case eo.RESOURCE_EXHAUSTED:return Jr.RESOURCE_EXHAUSTED;case eo.INTERNAL:return Jr.INTERNAL;case eo.UNAVAILABLE:return Jr.UNAVAILABLE;case eo.UNAUTHENTICATED:return Jr.UNAUTHENTICATED;case eo.INVALID_ARGUMENT:return Jr.INVALID_ARGUMENT;case eo.NOT_FOUND:return Jr.NOT_FOUND;case eo.ALREADY_EXISTS:return Jr.ALREADY_EXISTS;case eo.PERMISSION_DENIED:return Jr.PERMISSION_DENIED;case eo.FAILED_PRECONDITION:return Jr.FAILED_PRECONDITION;case eo.ABORTED:return Jr.ABORTED;case eo.OUT_OF_RANGE:return Jr.OUT_OF_RANGE;case eo.UNIMPLEMENTED:return Jr.UNIMPLEMENTED;case eo.DATA_LOSS:return Jr.DATA_LOSS;default:return Xr()}}(to=eo||(eo={}))[to.OK=0]="OK",to[to.CANCELLED=1]="CANCELLED",to[to.UNKNOWN=2]="UNKNOWN",to[to.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",to[to.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",to[to.NOT_FOUND=5]="NOT_FOUND",to[to.ALREADY_EXISTS=6]="ALREADY_EXISTS",to[to.PERMISSION_DENIED=7]="PERMISSION_DENIED",to[to.UNAUTHENTICATED=16]="UNAUTHENTICATED",to[to.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",to[to.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",to[to.ABORTED=10]="ABORTED",to[to.OUT_OF_RANGE=11]="OUT_OF_RANGE",to[to.UNIMPLEMENTED=12]="UNIMPLEMENTED",to[to.INTERNAL=13]="INTERNAL",to[to.UNAVAILABLE=14]="UNAVAILABLE",to[to.DATA_LOSS=15]="DATA_LOSS";let ao=null;const io=new kr([4294967295,4294967295],0);function so(e){const t=hn().encode(e),r=new Cr;return r.update(t),new Uint8Array(r.digest())}function oo(e){const t=new DataView(e.buffer),r=t.getUint32(0,!0),n=t.getUint32(4,!0),a=t.getUint32(8,!0),i=t.getUint32(12,!0);return[new kr([r,n],0),new kr([a,i],0)]}class lo{constructor(e,t,r){if(this.bitmap=e,this.padding=t,this.hashCount=r,t<0||t>=8)throw new co(`Invalid padding: ${t}`);if(r<0)throw new co(`Invalid hash count: ${r}`);if(e.length>0&&0===this.hashCount)throw new co(`Invalid hash count: ${r}`);if(0===e.length&&0!==t)throw new co(`Invalid padding when bitmap length is 0: ${t}`);this.Ee=8*e.length-t,this.de=kr.fromNumber(this.Ee)}Ae(e,t,r){let n=e.add(t.multiply(kr.fromNumber(r)));return 1===n.compare(io)&&(n=new kr([n.getBits(0),n.getBits(1)],0)),n.modulo(this.de).toNumber()}Re(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(0===this.Ee)return!1;const t=so(e),[r,n]=oo(t);for(let a=0;a<this.hashCount;a++){const e=this.Ae(r,n,a);if(!this.Re(e))return!1}return!0}static create(e,t,r){const n=e%8==0?0:8-e%8,a=new Uint8Array(Math.ceil(e/8)),i=new lo(a,n,t);return r.forEach((e=>i.insert(e))),i}insert(e){if(0===this.Ee)return;const t=so(e),[r,n]=oo(t);for(let a=0;a<this.hashCount;a++){const e=this.Ae(r,n,a);this.Ve(e)}}Ve(e){const t=Math.floor(e/8),r=e%8;this.bitmap[t]|=1<<r}}class co extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}class uo{constructor(e,t,r,n,a){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=r,this.documentUpdates=n,this.resolvedLimboDocuments=a}static createSynthesizedRemoteEventForCurrentChange(e,t,r){const n=new Map;return n.set(e,ho.createSynthesizedTargetChangeForCurrentChange(e,t,r)),new uo(En.min(),n,new Ea(dn),os(),gs())}}class ho{constructor(e,t,r,n,a){this.resumeToken=e,this.current=t,this.addedDocuments=r,this.modifiedDocuments=n,this.removedDocuments=a}static createSynthesizedTargetChangeForCurrentChange(e,t,r){return new ho(r,t,gs(),gs(),gs())}}class fo{constructor(e,t,r,n){this.me=e,this.removedTargetIds=t,this.key=r,this.fe=n}}class po{constructor(e,t){this.targetId=e,this.ge=t}}class mo{constructor(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Aa.EMPTY_BYTE_STRING,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;this.state=e,this.targetIds=t,this.resumeToken=r,this.cause=n}}class go{constructor(){this.pe=0,this.ye=bo(),this.we=Aa.EMPTY_BYTE_STRING,this.Se=!1,this.be=!0}get current(){return this.Se}get resumeToken(){return this.we}get De(){return 0!==this.pe}get ve(){return this.be}Ce(e){e.approximateByteSize()>0&&(this.be=!0,this.we=e)}Fe(){let e=gs(),t=gs(),r=gs();return this.ye.forEach(((n,a)=>{switch(a){case 0:e=e.add(n);break;case 2:t=t.add(n);break;case 1:r=r.add(n);break;default:Xr()}})),new ho(this.we,this.Se,e,t,r)}Me(){this.be=!1,this.ye=bo()}xe(e,t){this.be=!0,this.ye=this.ye.insert(e,t)}Oe(e){this.be=!0,this.ye=this.ye.remove(e)}Ne(){this.pe+=1}Be(){this.pe-=1,Yr(this.pe>=0)}Le(){this.be=!0,this.Se=!0}}class vo{constructor(e){this.ke=e,this.qe=new Map,this.Qe=os(),this.$e=yo(),this.Ue=yo(),this.Ke=new Ea(dn)}We(e){for(const t of e.me)e.fe&&e.fe.isFoundDocument()?this.Ge(t,e.fe):this.ze(t,e.key,e.fe);for(const t of e.removedTargetIds)this.ze(t,e.key,e.fe)}je(e){this.forEachTarget(e,(t=>{const r=this.He(t);switch(e.state){case 0:this.Je(t)&&r.Ce(e.resumeToken);break;case 1:r.Be(),r.De||r.Me(),r.Ce(e.resumeToken);break;case 2:r.Be(),r.De||this.removeTarget(t);break;case 3:this.Je(t)&&(r.Le(),r.Ce(e.resumeToken));break;case 4:this.Je(t)&&(this.Ye(t),r.Ce(e.resumeToken));break;default:Xr()}}))}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.qe.forEach(((e,r)=>{this.Je(r)&&t(r)}))}Ze(e){const t=e.targetId,r=e.ge.count,n=this.Xe(t);if(n){const a=n.target;if(zi(a))if(0===r){const e=new In(a.path);this.ze(t,e,pi.newNoDocument(e,En.min()))}else Yr(1===r);else{const n=this.et(t);if(n!==r){const r=this.tt(e),a=r?this.nt(r,e,n):1;if(0!==a){this.Ye(t);const e=2===a?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ke=this.Ke.insert(t,e)}null==ao||ao.rt(function(e,t,r,n,a){var i,s,o,l,c,u;const h={localCacheCount:e,existenceFilterCount:t.count,databaseId:r.database,projectId:r.projectId},f=t.unchangedNames;return f&&(h.bloomFilter={applied:0===a,hashCount:null!==(i=null==f?void 0:f.hashCount)&&void 0!==i?i:0,bitmapLength:null!==(l=null===(o=null===(s=null==f?void 0:f.bits)||void 0===s?void 0:s.bitmap)||void 0===o?void 0:o.length)&&void 0!==l?l:0,padding:null!==(u=null===(c=null==f?void 0:f.bits)||void 0===c?void 0:c.padding)&&void 0!==u?u:0,mightContain:e=>{var t;return null!==(t=null==n?void 0:n.mightContain(e))&&void 0!==t&&t}}),h}(n,e.ge,this.ke.it(),r,a))}}}}tt(e){const t=e.ge.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:r="",padding:n=0},hashCount:a=0}=t;let i,s;try{i=xa(r).toUint8Array()}catch(e){if(e instanceof Ia)return Kr("Decoding the base64 bloom filter in existence filter failed ("+e.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw e}try{s=new lo(i,n,a)}catch(e){return Kr(e instanceof co?"BloomFilter error: ":"Applying bloom filter failed: ",e),null}return 0===s.Ee?null:s}nt(e,t,r){return t.ge.count===r-this.st(e,t.targetId)?0:2}st(e,t){const r=this.ke.getRemoteKeysForTarget(t);let n=0;return r.forEach((r=>{const a=this.ke.it(),i=`projects/${a.projectId}/databases/${a.database}/documents/${r.path.canonicalString()}`;e.mightContain(i)||(this.ze(t,r,null),n++)})),n}ot(e){const t=new Map;this.qe.forEach(((r,n)=>{const a=this.Xe(n);if(a){if(r.current&&zi(a.target)){const t=new In(a.target.path);this._t(t).has(n)||this.ut(n,t)||this.ze(n,t,pi.newNoDocument(t,e))}r.ve&&(t.set(n,r.Fe()),r.Me())}}));let r=gs();this.Ue.forEach(((e,t)=>{let n=!0;t.forEachWhile((e=>{const t=this.Xe(e);return!t||"TargetPurposeLimboResolution"===t.purpose||(n=!1,!1)})),n&&(r=r.add(e))})),this.Qe.forEach(((t,r)=>r.setReadTime(e)));const n=new uo(e,t,this.Ke,this.Qe,r);return this.Qe=os(),this.$e=yo(),this.Ue=yo(),this.Ke=new Ea(dn),n}Ge(e,t){if(!this.Je(e))return;const r=this.ut(e,t.key)?2:0;this.He(e).xe(t.key,r),this.Qe=this.Qe.insert(t.key,t),this.$e=this.$e.insert(t.key,this._t(t.key).add(e)),this.Ue=this.Ue.insert(t.key,this.ct(t.key).add(e))}ze(e,t,r){if(!this.Je(e))return;const n=this.He(e);this.ut(e,t)?n.xe(t,1):n.Oe(t),this.Ue=this.Ue.insert(t,this.ct(t).delete(e)),this.Ue=this.Ue.insert(t,this.ct(t).add(e)),r&&(this.Qe=this.Qe.insert(t,r))}removeTarget(e){this.qe.delete(e)}et(e){const t=this.He(e).Fe();return this.ke.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}Ne(e){this.He(e).Ne()}He(e){let t=this.qe.get(e);return t||(t=new go,this.qe.set(e,t)),t}ct(e){let t=this.Ue.get(e);return t||(t=new Sa(dn),this.Ue=this.Ue.insert(e,t)),t}_t(e){let t=this.$e.get(e);return t||(t=new Sa(dn),this.$e=this.$e.insert(e,t)),t}Je(e){const t=null!==this.Xe(e);return t||Wr("WatchChangeAggregator","Detected inactive target",e),t}Xe(e){const t=this.qe.get(e);return t&&t.De?null:this.ke.lt(e)}Ye(e){this.qe.set(e,new go),this.ke.getRemoteKeysForTarget(e).forEach((t=>{this.ze(e,t,null)}))}ut(e,t){return this.ke.getRemoteKeysForTarget(e).has(t)}}function yo(){return new Ea(In.comparator)}function bo(){return new Ea(In.comparator)}const wo={asc:"ASCENDING",desc:"DESCENDING"},Eo={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},To={and:"AND",or:"OR"};class _o{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function So(e,t){return e.useProto3Json||jn(t)?t:{value:t}}function ko(e,t){return e.useProto3Json?`${new Date(1e3*t.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+t.nanoseconds).slice(-9)}Z`:{seconds:""+t.seconds,nanos:t.nanoseconds}}function Co(e,t){return e.useProto3Json?t.toBase64():t.toUint8Array()}function Io(e,t){return ko(e,t.toTimestamp())}function Ao(e){return Yr(!!e),En.fromTimestamp(function(e){const t=Na(e);return new wn(t.seconds,t.nanos)}(e))}function Ro(e,t){return No(e,t).canonicalString()}function No(e,t){const r=function(e){return new Sn(["projects",e.projectId,"databases",e.database])}(e).child("documents");return void 0===t?r:r.child(t)}function Oo(e){const t=Sn.fromString(e);return Yr(Qo(t)),t}function xo(e,t){return Ro(e.databaseId,t.path)}function Po(e,t){const r=Oo(t);if(r.get(1)!==e.databaseId.projectId)throw new Zr(Jr.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+r.get(1)+" vs "+e.databaseId.projectId);if(r.get(3)!==e.databaseId.database)throw new Zr(Jr.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+r.get(3)+" vs "+e.databaseId.database);return new In(Fo(r))}function Do(e,t){return Ro(e.databaseId,t)}function Lo(e){const t=Oo(e);return 4===t.length?Sn.emptyPath():Fo(t)}function Mo(e){return new Sn(["projects",e.databaseId.projectId,"databases",e.databaseId.database]).canonicalString()}function Fo(e){return Yr(e.length>4&&"documents"===e.get(4)),e.popFirst(5)}function Uo(e,t,r){return{name:xo(e,t),fields:r.value.mapValue.fields}}function Vo(e,t){let r;if(t instanceof Hs)r={update:Uo(e,t.key,t.value)};else if(t instanceof qs)r={delete:xo(e,t.key)};else if(t instanceof $s)r={update:Uo(e,t.key,t.data),updateMask:Yo(t.fieldMask)};else{if(!(t instanceof Xs))return Xr();r={verify:xo(e,t.key)}}return t.fieldTransforms.length>0&&(r.updateTransforms=t.fieldTransforms.map((e=>function(e,t){const r=t.transform;if(r instanceof Cs)return{fieldPath:t.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(r instanceof Is)return{fieldPath:t.field.canonicalString(),appendMissingElements:{values:r.elements}};if(r instanceof Rs)return{fieldPath:t.field.canonicalString(),removeAllFromArray:{values:r.elements}};if(r instanceof Os)return{fieldPath:t.field.canonicalString(),increment:r.Ie};throw Xr()}(0,e)))),t.precondition.isNone||(r.currentDocument=function(e,t){return void 0!==t.updateTime?{updateTime:Io(e,t.updateTime)}:void 0!==t.exists?{exists:t.exists}:Xr()}(e,t.precondition)),r}function Bo(e,t){return{documents:[Do(e,t.path)]}}function zo(e,t){const r={structuredQuery:{}},n=t.path;let a;null!==t.collectionGroup?(a=n,r.structuredQuery.from=[{collectionId:t.collectionGroup,allDescendants:!0}]):(a=n.popLast(),r.structuredQuery.from=[{collectionId:n.lastSegment()}]),r.parent=Do(e,a);const i=function(e){if(0!==e.length)return Xo(Ti.create(e,"and"))}(t.filters);i&&(r.structuredQuery.where=i);const s=function(e){if(0!==e.length)return e.map((e=>function(e){return{field:Ko(e.field),direction:$o(e.dir)}}(e)))}(t.orderBy);s&&(r.structuredQuery.orderBy=s);const o=So(e,t.limit);return null!==o&&(r.structuredQuery.limit=o),t.startAt&&(r.structuredQuery.startAt=function(e){return{before:e.inclusive,values:e.position}}(t.startAt)),t.endAt&&(r.structuredQuery.endAt=function(e){return{before:!e.inclusive,values:e.position}}(t.endAt)),{ht:r,parent:a}}function jo(e){let t=Lo(e.parent);const r=e.structuredQuery,n=r.from?r.from.length:0;let a=null;if(n>0){Yr(1===n);const e=r.from[0];e.allDescendants?a=e.collectionId:t=t.child(e.collectionId)}let i=[];r.where&&(i=function(e){const t=Ho(e);return t instanceof Ti&&Si(t)?t.getFilters():[t]}(r.where));let s=[];r.orderBy&&(s=function(e){return e.map((e=>function(e){return new yi(qo(e.field),function(e){switch(e){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(e.direction))}(e)))}(r.orderBy));let o=null;r.limit&&(o=function(e){let t;return t="object"==typeof e?e.value:e,jn(t)?null:t}(r.limit));let l=null;r.startAt&&(l=function(e){const t=!!e.before,r=e.values||[];return new mi(r,t)}(r.startAt));let c=null;return r.endAt&&(c=function(e){const t=!e.before,r=e.values||[];return new mi(r,t)}(r.endAt)),Hi(t,a,s,i,o,"F",l,c)}function Ho(e){return void 0!==e.unaryFilter?function(e){switch(e.unaryFilter.op){case"IS_NAN":const t=qo(e.unaryFilter.field);return Ei.create(t,"==",{doubleValue:NaN});case"IS_NULL":const r=qo(e.unaryFilter.field);return Ei.create(r,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const n=qo(e.unaryFilter.field);return Ei.create(n,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const a=qo(e.unaryFilter.field);return Ei.create(a,"!=",{nullValue:"NULL_VALUE"});default:return Xr()}}(e):void 0!==e.fieldFilter?function(e){return Ei.create(qo(e.fieldFilter.field),function(e){switch(e){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return Xr()}}(e.fieldFilter.op),e.fieldFilter.value)}(e):void 0!==e.compositeFilter?function(e){return Ti.create(e.compositeFilter.filters.map((e=>Ho(e))),function(e){switch(e){case"AND":return"and";case"OR":return"or";default:return Xr()}}(e.compositeFilter.op))}(e):Xr()}function $o(e){return wo[e]}function Wo(e){return Eo[e]}function Go(e){return To[e]}function Ko(e){return{fieldPath:e.canonicalString()}}function qo(e){return Cn.fromServerFormat(e.fieldPath)}function Xo(e){return e instanceof Ei?function(e){if("=="===e.op){if(oi(e.value))return{unaryFilter:{field:Ko(e.field),op:"IS_NAN"}};if(si(e.value))return{unaryFilter:{field:Ko(e.field),op:"IS_NULL"}}}else if("!="===e.op){if(oi(e.value))return{unaryFilter:{field:Ko(e.field),op:"IS_NOT_NAN"}};if(si(e.value))return{unaryFilter:{field:Ko(e.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Ko(e.field),op:Wo(e.op),value:e.value}}}(e):e instanceof Ti?function(e){const t=e.getFilters().map((e=>Xo(e)));return 1===t.length?t[0]:{compositeFilter:{op:Go(e.op),filters:t}}}(e):Xr()}function Yo(e){const t=[];return e.fields.forEach((e=>t.push(e.canonicalString()))),{fieldPaths:t}}function Qo(e){return e.length>=4&&"projects"===e.get(0)&&"databases"===e.get(2)}class Jo{constructor(e,t,r,n){let a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:En.min(),i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:En.min(),s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:Aa.EMPTY_BYTE_STRING,o=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null;this.target=e,this.targetId=t,this.purpose=r,this.sequenceNumber=n,this.snapshotVersion=a,this.lastLimboFreeSnapshotVersion=i,this.resumeToken=s,this.expectedCount=o}withSequenceNumber(e){return new Jo(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new Jo(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Jo(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Jo(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}class Zo{constructor(e){this.Tt=e}}function el(e){const t=jo({parent:e.parent,structuredQuery:e.structuredQuery});return"LAST"===e.limitType?Qi(t,t.limit,"L"):t}class tl{constructor(){}At(e,t){this.Rt(e,t),t.Vt()}Rt(e,t){if("nullValue"in e)this.ft(t,5);else if("booleanValue"in e)this.ft(t,10),t.gt(e.booleanValue?1:0);else if("integerValue"in e)this.ft(t,15),t.gt(Oa(e.integerValue));else if("doubleValue"in e){const r=Oa(e.doubleValue);isNaN(r)?this.ft(t,13):(this.ft(t,15),Hn(r)?t.gt(0):t.gt(r))}else if("timestampValue"in e){let r=e.timestampValue;this.ft(t,20),"string"==typeof r&&(r=Na(r)),t.yt(`${r.seconds||""}`),t.gt(r.nanos||0)}else if("stringValue"in e)this.wt(e.stringValue,t),this.St(t);else if("bytesValue"in e)this.ft(t,30),t.bt(xa(e.bytesValue)),this.St(t);else if("referenceValue"in e)this.Dt(e.referenceValue,t);else if("geoPointValue"in e){const r=e.geoPointValue;this.ft(t,45),t.gt(r.latitude||0),t.gt(r.longitude||0)}else"mapValue"in e?hi(e)?this.ft(t,Number.MAX_SAFE_INTEGER):ci(e)?this.vt(e.mapValue,t):(this.Ct(e.mapValue,t),this.St(t)):"arrayValue"in e?(this.Ft(e.arrayValue,t),this.St(t)):Xr()}wt(e,t){this.ft(t,25),this.Mt(e,t)}Mt(e,t){t.yt(e)}Ct(e,t){const r=e.fields||{};this.ft(t,55);for(const n of Object.keys(r))this.wt(n,t),this.Rt(r[n],t)}vt(e,t){var r,n;const a=e.fields||{};this.ft(t,53);const i=Ka,s=(null===(n=null===(r=a[i].arrayValue)||void 0===r?void 0:r.values)||void 0===n?void 0:n.length)||0;this.ft(t,15),t.gt(Oa(s)),this.wt(i,t),this.Rt(a[i],t)}Ft(e,t){const r=e.values||[];this.ft(t,50);for(const n of r)this.Rt(n,t)}Dt(e,t){this.ft(t,37),In.fromName(e).path.forEach((e=>{this.ft(t,60),this.Mt(e,t)}))}ft(e,t){e.gt(t)}St(e){e.gt(2)}}tl.xt=new tl;class rl{constructor(){this.Tn=new nl}addToCollectionParentIndex(e,t){return this.Tn.add(t),Fn.resolve()}getCollectionParents(e,t){return Fn.resolve(this.Tn.getEntries(t))}addFieldIndex(e,t){return Fn.resolve()}deleteFieldIndex(e,t){return Fn.resolve()}deleteAllFieldIndexes(e){return Fn.resolve()}createTargetIndexes(e,t){return Fn.resolve()}getDocumentsMatchingTarget(e,t){return Fn.resolve(null)}getIndexType(e,t){return Fn.resolve(0)}getFieldIndexes(e,t){return Fn.resolve([])}getNextCollectionGroupToUpdate(e){return Fn.resolve(null)}getMinOffset(e,t){return Fn.resolve(xn.min())}getMinOffsetFromCollectionGroup(e,t){return Fn.resolve(xn.min())}updateCollectionGroup(e,t,r){return Fn.resolve()}updateIndexEntries(e,t){return Fn.resolve()}}class nl{constructor(){this.index={}}add(e){const t=e.lastSegment(),r=e.popLast(),n=this.index[t]||new Sa(Sn.comparator),a=!n.has(r);return this.index[t]=n.add(r),a}has(e){const t=e.lastSegment(),r=e.popLast(),n=this.index[t];return n&&n.has(r)}getEntries(e){return(this.index[e]||new Sa(Sn.comparator)).toArray()}}new Uint8Array(0);const al={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},il=41943040;class sl{static withCacheSize(e){return new sl(e,sl.DEFAULT_COLLECTION_PERCENTILE,sl.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=r}}sl.DEFAULT_COLLECTION_PERCENTILE=10,sl.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,sl.DEFAULT=new sl(il,sl.DEFAULT_COLLECTION_PERCENTILE,sl.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),sl.DISABLED=new sl(-1,0,0);class ol{constructor(e){this.$n=e}next(){return this.$n+=2,this.$n}static Un(){return new ol(0)}static Kn(){return new ol(-1)}}const ll="LruGarbageCollector",cl=1048576;function ul(e,t){let[r,n]=e,[a,i]=t;const s=dn(r,a);return 0===s?dn(n,i):s}class hl{constructor(e){this.Hn=e,this.buffer=new Sa(ul),this.Jn=0}Yn(){return++this.Jn}Zn(e){const t=[e,this.Yn()];if(this.buffer.size<this.Hn)this.buffer=this.buffer.add(t);else{const e=this.buffer.last();ul(t,e)<0&&(this.buffer=this.buffer.delete(e).add(t))}}get maxValue(){return this.buffer.last()[0]}}class fl{constructor(e,t,r){this.garbageCollector=e,this.asyncQueue=t,this.localStore=r,this.Xn=null}start(){-1!==this.garbageCollector.params.cacheSizeCollectionThreshold&&this.er(6e4)}stop(){this.Xn&&(this.Xn.cancel(),this.Xn=null)}get started(){return null!==this.Xn}er(e){Wr(ll,`Garbage collection scheduled in ${e}ms`),this.Xn=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,(async()=>{this.Xn=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(e){Vn(e)?Wr(ll,"Ignoring IndexedDB error during garbage collection: ",e):await Mn(e)}await this.er(3e5)}))}}class dl{constructor(e,t){this.tr=e,this.params=t}calculateTargetCount(e,t){return this.tr.nr(e).next((e=>Math.floor(t/100*e)))}nthSequenceNumber(e,t){if(0===t)return Fn.resolve(Bn.ae);const r=new hl(t);return this.tr.forEachTarget(e,(e=>r.Zn(e.sequenceNumber))).next((()=>this.tr.rr(e,(e=>r.Zn(e))))).next((()=>r.maxValue))}removeTargets(e,t,r){return this.tr.removeTargets(e,t,r)}removeOrphanedDocuments(e,t){return this.tr.removeOrphanedDocuments(e,t)}collect(e,t){return-1===this.params.cacheSizeCollectionThreshold?(Wr("LruGarbageCollector","Garbage collection skipped; disabled"),Fn.resolve(al)):this.getCacheSize(e).next((r=>r<this.params.cacheSizeCollectionThreshold?(Wr("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),al):this.ir(e,t)))}getCacheSize(e){return this.tr.getCacheSize(e)}ir(e,t){let r,n,a,i,s,o,l;const c=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next((t=>(t>this.params.maximumSequenceNumbersToCollect?(Wr("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${t}`),n=this.params.maximumSequenceNumbersToCollect):n=t,i=Date.now(),this.nthSequenceNumber(e,n)))).next((n=>(r=n,s=Date.now(),this.removeTargets(e,r,t)))).next((t=>(a=t,o=Date.now(),this.removeOrphanedDocuments(e,r)))).next((e=>(l=Date.now(),$r()<=rt.DEBUG&&Wr("LruGarbageCollector",`LRU Garbage Collection\n\tCounted targets in ${i-c}ms\n\tDetermined least recently used ${n} in `+(s-i)+"ms\n"+`\tRemoved ${a} targets in `+(o-s)+"ms\n"+`\tRemoved ${e} documents in `+(l-o)+"ms\n"+`Total Duration: ${l-c}ms`),Fn.resolve({didRun:!0,sequenceNumbersCollected:n,targetsRemoved:a,documentsRemoved:e}))))}}function pl(e,t){return new dl(e,t)}class ml{constructor(){this.changes=new is((e=>e.toString()),((e,t)=>e.isEqual(t))),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,pi.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const r=this.changes.get(t);return void 0!==r?Fn.resolve(r):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}class gl{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}class vl{constructor(e,t,r,n){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=r,this.indexManager=n}getDocument(e,t){let r=null;return this.documentOverlayCache.getOverlay(e,t).next((n=>(r=n,this.remoteDocumentCache.getEntry(e,t)))).next((e=>(null!==r&&Bs(r.mutation,e,Ca.empty(),wn.now()),e)))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next((t=>this.getLocalViewOfDocuments(e,t,gs()).next((()=>t))))}getLocalViewOfDocuments(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:gs();const n=hs();return this.populateOverlays(e,n,t).next((()=>this.computeViews(e,t,n,r).next((e=>{let t=cs();return e.forEach(((e,r)=>{t=t.insert(e,r.overlayedDocument)})),t}))))}getOverlayedDocuments(e,t){const r=hs();return this.populateOverlays(e,r,t).next((()=>this.computeViews(e,t,r,gs())))}populateOverlays(e,t,r){const n=[];return r.forEach((e=>{t.has(e)||n.push(e)})),this.documentOverlayCache.getOverlays(e,n).next((e=>{e.forEach(((e,r)=>{t.set(e,r)}))}))}computeViews(e,t,r,n){let a=os();const i=ds(),s=ds();return t.forEach(((e,t)=>{const s=r.get(t.key);n.has(t.key)&&(void 0===s||s.mutation instanceof $s)?a=a.insert(t.key,t):void 0!==s?(i.set(t.key,s.mutation.getFieldMask()),Bs(s.mutation,t,s.mutation.getFieldMask(),wn.now())):i.set(t.key,Ca.empty())})),this.recalculateAndSaveOverlays(e,a).next((e=>(e.forEach(((e,t)=>i.set(e,t))),t.forEach(((e,t)=>{var r;return s.set(e,new gl(t,null!==(r=i.get(e))&&void 0!==r?r:null))})),s)))}recalculateAndSaveOverlays(e,t){const r=ds();let n=new Ea(((e,t)=>e-t)),a=gs();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next((e=>{for(const a of e)a.keys().forEach((e=>{const i=t.get(e);if(null===i)return;let s=r.get(e)||Ca.empty();s=a.applyToLocalView(i,s),r.set(e,s);const o=(n.get(a.batchId)||gs()).add(e);n=n.insert(a.batchId,o)}))})).next((()=>{const i=[],s=n.getReverseIterator();for(;s.hasNext();){const n=s.getNext(),o=n.key,l=n.value,c=fs();l.forEach((e=>{if(!a.has(e)){const n=Us(t.get(e),r.get(e));null!==n&&c.set(e,n),a=a.add(e)}})),i.push(this.documentOverlayCache.saveOverlays(e,o,c))}return Fn.waitFor(i)})).next((()=>r))}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next((t=>this.recalculateAndSaveOverlays(e,t)))}getDocumentsMatchingQuery(e,t,r,n){return function(e){return In.isDocumentKey(e.path)&&null===e.collectionGroup&&0===e.filters.length}(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):Gi(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,r,n):this.getDocumentsMatchingCollectionQuery(e,t,r,n)}getNextDocuments(e,t,r,n){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,r,n).next((a=>{const i=n-a.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,r.largestBatchId,n-a.size):Fn.resolve(hs());let s=An,o=a;return i.next((t=>Fn.forEach(t,((t,r)=>(s<r.largestBatchId&&(s=r.largestBatchId),a.get(t)?Fn.resolve():this.remoteDocumentCache.getEntry(e,t).next((e=>{o=o.insert(t,e)}))))).next((()=>this.populateOverlays(e,t,a))).next((()=>this.computeViews(e,o,t,gs()))).next((e=>({batchId:s,changes:us(e)})))))}))}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new In(t)).next((e=>{let t=cs();return e.isFoundDocument()&&(t=t.insert(e.key,e)),t}))}getDocumentsMatchingCollectionGroupQuery(e,t,r,n){const a=t.collectionGroup;let i=cs();return this.indexManager.getCollectionParents(e,a).next((s=>Fn.forEach(s,(s=>{const o=function(e,t){return new ji(t,null,e.explicitOrderBy.slice(),e.filters.slice(),e.limit,e.limitType,e.startAt,e.endAt)}(t,s.child(a));return this.getDocumentsMatchingCollectionQuery(e,o,r,n).next((e=>{e.forEach(((e,t)=>{i=i.insert(e,t)}))}))})).next((()=>i))))}getDocumentsMatchingCollectionQuery(e,t,r,n){let a;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,r.largestBatchId).next((i=>(a=i,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,r,a,n)))).next((e=>{a.forEach(((t,r)=>{const n=r.getKey();null===e.get(n)&&(e=e.insert(n,pi.newInvalidDocument(n)))}));let r=cs();return e.forEach(((e,n)=>{const i=a.get(e);void 0!==i&&Bs(i.mutation,n,Ca.empty(),wn.now()),ts(t,n)&&(r=r.insert(e,n))})),r}))}}class yl{constructor(e){this.serializer=e,this.dr=new Map,this.Ar=new Map}getBundleMetadata(e,t){return Fn.resolve(this.dr.get(t))}saveBundleMetadata(e,t){return this.dr.set(t.id,function(e){return{id:e.id,version:e.version,createTime:Ao(e.createTime)}}(t)),Fn.resolve()}getNamedQuery(e,t){return Fn.resolve(this.Ar.get(t))}saveNamedQuery(e,t){return this.Ar.set(t.name,function(e){return{name:e.name,query:el(e.bundledQuery),readTime:Ao(e.readTime)}}(t)),Fn.resolve()}}class bl{constructor(){this.overlays=new Ea(In.comparator),this.Rr=new Map}getOverlay(e,t){return Fn.resolve(this.overlays.get(t))}getOverlays(e,t){const r=hs();return Fn.forEach(t,(t=>this.getOverlay(e,t).next((e=>{null!==e&&r.set(t,e)})))).next((()=>r))}saveOverlays(e,t,r){return r.forEach(((r,n)=>{this.Et(e,t,n)})),Fn.resolve()}removeOverlaysForBatchId(e,t,r){const n=this.Rr.get(r);return void 0!==n&&(n.forEach((e=>this.overlays=this.overlays.remove(e))),this.Rr.delete(r)),Fn.resolve()}getOverlaysForCollection(e,t,r){const n=hs(),a=t.length+1,i=new In(t.child("")),s=this.overlays.getIteratorFrom(i);for(;s.hasNext();){const e=s.getNext().value,i=e.getKey();if(!t.isPrefixOf(i.path))break;i.path.length===a&&e.largestBatchId>r&&n.set(e.getKey(),e)}return Fn.resolve(n)}getOverlaysForCollectionGroup(e,t,r,n){let a=new Ea(((e,t)=>e-t));const i=this.overlays.getIterator();for(;i.hasNext();){const e=i.getNext().value;if(e.getKey().getCollectionGroup()===t&&e.largestBatchId>r){let t=a.get(e.largestBatchId);null===t&&(t=hs(),a=a.insert(e.largestBatchId,t)),t.set(e.getKey(),e)}}const s=hs(),o=a.getIterator();for(;o.hasNext()&&(o.getNext().value.forEach(((e,t)=>s.set(e,t))),!(s.size()>=n)););return Fn.resolve(s)}Et(e,t,r){const n=this.overlays.get(r.key);if(null!==n){const e=this.Rr.get(n.largestBatchId).delete(r.key);this.Rr.set(n.largestBatchId,e)}this.overlays=this.overlays.insert(r.key,new Js(t,r));let a=this.Rr.get(t);void 0===a&&(a=gs(),this.Rr.set(t,a)),this.Rr.set(t,a.add(r.key))}}class wl{constructor(){this.sessionToken=Aa.EMPTY_BYTE_STRING}getSessionToken(e){return Fn.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,Fn.resolve()}}class El{constructor(){this.Vr=new Sa(Tl.mr),this.gr=new Sa(Tl.pr)}isEmpty(){return this.Vr.isEmpty()}addReference(e,t){const r=new Tl(e,t);this.Vr=this.Vr.add(r),this.gr=this.gr.add(r)}yr(e,t){e.forEach((e=>this.addReference(e,t)))}removeReference(e,t){this.wr(new Tl(e,t))}Sr(e,t){e.forEach((e=>this.removeReference(e,t)))}br(e){const t=new In(new Sn([])),r=new Tl(t,e),n=new Tl(t,e+1),a=[];return this.gr.forEachInRange([r,n],(e=>{this.wr(e),a.push(e.key)})),a}Dr(){this.Vr.forEach((e=>this.wr(e)))}wr(e){this.Vr=this.Vr.delete(e),this.gr=this.gr.delete(e)}vr(e){const t=new In(new Sn([])),r=new Tl(t,e),n=new Tl(t,e+1);let a=gs();return this.gr.forEachInRange([r,n],(e=>{a=a.add(e.key)})),a}containsKey(e){const t=new Tl(e,0),r=this.Vr.firstAfterOrEqual(t);return null!==r&&e.isEqual(r.key)}}class Tl{constructor(e,t){this.key=e,this.Cr=t}static mr(e,t){return In.comparator(e.key,t.key)||dn(e.Cr,t.Cr)}static pr(e,t){return dn(e.Cr,t.Cr)||In.comparator(e.key,t.key)}}class _l{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.Fr=1,this.Mr=new Sa(Tl.mr)}checkEmpty(e){return Fn.resolve(0===this.mutationQueue.length)}addMutationBatch(e,t,r,n){const a=this.Fr;this.Fr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const i=new Ys(a,t,r,n);this.mutationQueue.push(i);for(const s of n)this.Mr=this.Mr.add(new Tl(s.key,a)),this.indexManager.addToCollectionParentIndex(e,s.key.path.popLast());return Fn.resolve(i)}lookupMutationBatch(e,t){return Fn.resolve(this.Or(t))}getNextMutationBatchAfterBatchId(e,t){const r=t+1,n=this.Nr(r),a=n<0?0:n;return Fn.resolve(this.mutationQueue.length>a?this.mutationQueue[a]:null)}getHighestUnacknowledgedBatchId(){return Fn.resolve(0===this.mutationQueue.length?zn:this.Fr-1)}getAllMutationBatches(e){return Fn.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const r=new Tl(t,0),n=new Tl(t,Number.POSITIVE_INFINITY),a=[];return this.Mr.forEachInRange([r,n],(e=>{const t=this.Or(e.Cr);a.push(t)})),Fn.resolve(a)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new Sa(dn);return t.forEach((e=>{const t=new Tl(e,0),n=new Tl(e,Number.POSITIVE_INFINITY);this.Mr.forEachInRange([t,n],(e=>{r=r.add(e.Cr)}))})),Fn.resolve(this.Br(r))}getAllMutationBatchesAffectingQuery(e,t){const r=t.path,n=r.length+1;let a=r;In.isDocumentKey(a)||(a=a.child(""));const i=new Tl(new In(a),0);let s=new Sa(dn);return this.Mr.forEachWhile((e=>{const t=e.key.path;return!!r.isPrefixOf(t)&&(t.length===n&&(s=s.add(e.Cr)),!0)}),i),Fn.resolve(this.Br(s))}Br(e){const t=[];return e.forEach((e=>{const r=this.Or(e);null!==r&&t.push(r)})),t}removeMutationBatch(e,t){Yr(0===this.Lr(t.batchId,"removed")),this.mutationQueue.shift();let r=this.Mr;return Fn.forEach(t.mutations,(n=>{const a=new Tl(n.key,t.batchId);return r=r.delete(a),this.referenceDelegate.markPotentiallyOrphaned(e,n.key)})).next((()=>{this.Mr=r}))}qn(e){}containsKey(e,t){const r=new Tl(t,0),n=this.Mr.firstAfterOrEqual(r);return Fn.resolve(t.isEqual(n&&n.key))}performConsistencyCheck(e){return this.mutationQueue.length,Fn.resolve()}Lr(e,t){return this.Nr(e)}Nr(e){return 0===this.mutationQueue.length?0:e-this.mutationQueue[0].batchId}Or(e){const t=this.Nr(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}class Sl{constructor(e){this.kr=e,this.docs=new Ea(In.comparator),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const r=t.key,n=this.docs.get(r),a=n?n.size:0,i=this.kr(t);return this.docs=this.docs.insert(r,{document:t.mutableCopy(),size:i}),this.size+=i-a,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const r=this.docs.get(t);return Fn.resolve(r?r.document.mutableCopy():pi.newInvalidDocument(t))}getEntries(e,t){let r=os();return t.forEach((e=>{const t=this.docs.get(e);r=r.insert(e,t?t.document.mutableCopy():pi.newInvalidDocument(e))})),Fn.resolve(r)}getDocumentsMatchingQuery(e,t,r,n){let a=os();const i=t.path,s=new In(i.child("__id-9223372036854775808__")),o=this.docs.getIteratorFrom(s);for(;o.hasNext();){const{key:e,value:{document:s}}=o.getNext();if(!i.isPrefixOf(e.path))break;e.path.length>i.length+1||Pn(On(s),r)<=0||(n.has(s.key)||ts(t,s))&&(a=a.insert(s.key,s.mutableCopy()))}return Fn.resolve(a)}getAllFromCollectionGroup(e,t,r,n){Xr()}qr(e,t){return Fn.forEach(this.docs,(e=>t(e)))}newChangeBuffer(e){return new kl(this)}getSize(e){return Fn.resolve(this.size)}}class kl extends ml{constructor(e){super(),this.Ir=e}applyChanges(e){const t=[];return this.changes.forEach(((r,n)=>{n.isValidDocument()?t.push(this.Ir.addEntry(e,n)):this.Ir.removeEntry(r)})),Fn.waitFor(t)}getFromCache(e,t){return this.Ir.getEntry(e,t)}getAllFromCache(e,t){return this.Ir.getEntries(e,t)}}class Cl{constructor(e){this.persistence=e,this.Qr=new is((e=>Vi(e)),Bi),this.lastRemoteSnapshotVersion=En.min(),this.highestTargetId=0,this.$r=0,this.Ur=new El,this.targetCount=0,this.Kr=ol.Un()}forEachTarget(e,t){return this.Qr.forEach(((e,r)=>t(r))),Fn.resolve()}getLastRemoteSnapshotVersion(e){return Fn.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return Fn.resolve(this.$r)}allocateTargetId(e){return this.highestTargetId=this.Kr.next(),Fn.resolve(this.highestTargetId)}setTargetsMetadata(e,t,r){return r&&(this.lastRemoteSnapshotVersion=r),t>this.$r&&(this.$r=t),Fn.resolve()}zn(e){this.Qr.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.Kr=new ol(t),this.highestTargetId=t),e.sequenceNumber>this.$r&&(this.$r=e.sequenceNumber)}addTargetData(e,t){return this.zn(t),this.targetCount+=1,Fn.resolve()}updateTargetData(e,t){return this.zn(t),Fn.resolve()}removeTargetData(e,t){return this.Qr.delete(t.target),this.Ur.br(t.targetId),this.targetCount-=1,Fn.resolve()}removeTargets(e,t,r){let n=0;const a=[];return this.Qr.forEach(((i,s)=>{s.sequenceNumber<=t&&null===r.get(s.targetId)&&(this.Qr.delete(i),a.push(this.removeMatchingKeysForTargetId(e,s.targetId)),n++)})),Fn.waitFor(a).next((()=>n))}getTargetCount(e){return Fn.resolve(this.targetCount)}getTargetData(e,t){const r=this.Qr.get(t)||null;return Fn.resolve(r)}addMatchingKeys(e,t,r){return this.Ur.yr(t,r),Fn.resolve()}removeMatchingKeys(e,t,r){this.Ur.Sr(t,r);const n=this.persistence.referenceDelegate,a=[];return n&&t.forEach((t=>{a.push(n.markPotentiallyOrphaned(e,t))})),Fn.waitFor(a)}removeMatchingKeysForTargetId(e,t){return this.Ur.br(t),Fn.resolve()}getMatchingKeysForTargetId(e,t){const r=this.Ur.vr(t);return Fn.resolve(r)}containsKey(e,t){return Fn.resolve(this.Ur.containsKey(t))}}class Il{constructor(e,t){this.Wr={},this.overlays={},this.Gr=new Bn(0),this.zr=!1,this.zr=!0,this.jr=new wl,this.referenceDelegate=e(this),this.Hr=new Cl(this),this.indexManager=new rl,this.remoteDocumentCache=function(e){return new Sl(e)}((e=>this.referenceDelegate.Jr(e))),this.serializer=new Zo(t),this.Yr=new yl(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.zr=!1,Promise.resolve()}get started(){return this.zr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new bl,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let r=this.Wr[e.toKey()];return r||(r=new _l(t,this.referenceDelegate),this.Wr[e.toKey()]=r),r}getGlobalsCache(){return this.jr}getTargetCache(){return this.Hr}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Yr}runTransaction(e,t,r){Wr("MemoryPersistence","Starting transaction:",e);const n=new Al(this.Gr.next());return this.referenceDelegate.Zr(),r(n).next((e=>this.referenceDelegate.Xr(n).next((()=>e)))).toPromise().then((e=>(n.raiseOnCommittedEvent(),e)))}ei(e,t){return Fn.or(Object.values(this.Wr).map((r=>()=>r.containsKey(e,t))))}}class Al extends Ln{constructor(e){super(),this.currentSequenceNumber=e}}class Rl{constructor(e){this.persistence=e,this.ti=new El,this.ni=null}static ri(e){return new Rl(e)}get ii(){if(this.ni)return this.ni;throw Xr()}addReference(e,t,r){return this.ti.addReference(r,t),this.ii.delete(r.toString()),Fn.resolve()}removeReference(e,t,r){return this.ti.removeReference(r,t),this.ii.add(r.toString()),Fn.resolve()}markPotentiallyOrphaned(e,t){return this.ii.add(t.toString()),Fn.resolve()}removeTarget(e,t){this.ti.br(t.targetId).forEach((e=>this.ii.add(e.toString())));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,t.targetId).next((e=>{e.forEach((e=>this.ii.add(e.toString())))})).next((()=>r.removeTargetData(e,t)))}Zr(){this.ni=new Set}Xr(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return Fn.forEach(this.ii,(r=>{const n=In.fromPath(r);return this.si(e,n).next((e=>{e||t.removeEntry(n,En.min())}))})).next((()=>(this.ni=null,t.apply(e))))}updateLimboDocument(e,t){return this.si(e,t).next((e=>{e?this.ii.delete(t.toString()):this.ii.add(t.toString())}))}Jr(e){return 0}si(e,t){return Fn.or([()=>Fn.resolve(this.ti.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.ei(e,t)])}}class Nl{constructor(e,t){this.persistence=e,this.oi=new is((e=>Gn(e.path)),((e,t)=>e.isEqual(t))),this.garbageCollector=pl(this,t)}static ri(e,t){return new Nl(e,t)}Zr(){}Xr(e){return Fn.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}nr(e){const t=this.sr(e);return this.persistence.getTargetCache().getTargetCount(e).next((e=>t.next((t=>e+t))))}sr(e){let t=0;return this.rr(e,(e=>{t++})).next((()=>t))}rr(e,t){return Fn.forEach(this.oi,((r,n)=>this.ar(e,r,n).next((e=>e?Fn.resolve():t(n)))))}removeTargets(e,t,r){return this.persistence.getTargetCache().removeTargets(e,t,r)}removeOrphanedDocuments(e,t){let r=0;const n=this.persistence.getRemoteDocumentCache(),a=n.newChangeBuffer();return n.qr(e,(n=>this.ar(e,n,t).next((e=>{e||(r++,a.removeEntry(n,En.min()))})))).next((()=>a.apply(e))).next((()=>r))}markPotentiallyOrphaned(e,t){return this.oi.set(t,e.currentSequenceNumber),Fn.resolve()}removeTarget(e,t){const r=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,r)}addReference(e,t,r){return this.oi.set(r,e.currentSequenceNumber),Fn.resolve()}removeReference(e,t,r){return this.oi.set(r,e.currentSequenceNumber),Fn.resolve()}updateLimboDocument(e,t){return this.oi.set(t,e.currentSequenceNumber),Fn.resolve()}Jr(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=ri(e.data.value)),t}ar(e,t,r){return Fn.or([()=>this.persistence.ei(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{const e=this.oi.get(t);return Fn.resolve(void 0!==e&&e>r)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}class Ol{constructor(e,t,r,n){this.targetId=e,this.fromCache=t,this.Hi=r,this.Ji=n}static Yi(e,t){let r=gs(),n=gs();for(const a of t.docChanges)switch(a.type){case 0:r=r.add(a.doc.key);break;case 1:n=n.add(a.doc.key)}return new Ol(e,t.fromCache,r,n)}}class xl{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}class Pl{constructor(){this.Zi=!1,this.Xi=!1,this.es=100,this.ts=Ue()?8:Un(Fe())>0?6:4}initialize(e,t){this.ns=e,this.indexManager=t,this.Zi=!0}getDocumentsMatchingQuery(e,t,r,n){const a={result:null};return this.rs(e,t).next((e=>{a.result=e})).next((()=>{if(!a.result)return this.ss(e,t,n,r).next((e=>{a.result=e}))})).next((()=>{if(a.result)return;const r=new xl;return this._s(e,t,r).next((n=>{if(a.result=n,this.Xi)return this.us(e,t,r,n.size)}))})).next((()=>a.result))}us(e,t,r,n){return r.documentReadCount<this.es?($r()<=rt.DEBUG&&Wr("QueryEngine","SDK will not create cache indexes for query:",es(t),"since it only creates cache indexes for collection contains","more than or equal to",this.es,"documents"),Fn.resolve()):($r()<=rt.DEBUG&&Wr("QueryEngine","Query:",es(t),"scans",r.documentReadCount,"local documents and returns",n,"documents as results."),r.documentReadCount>this.ts*n?($r()<=rt.DEBUG&&Wr("QueryEngine","The SDK decides to create cache indexes for query:",es(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,qi(t))):Fn.resolve())}rs(e,t){if(Wi(t))return Fn.resolve(null);let r=qi(t);return this.indexManager.getIndexType(e,r).next((n=>0===n?null:(null!==t.limit&&1===n&&(t=Qi(t,null,"F"),r=qi(t)),this.indexManager.getDocumentsMatchingTarget(e,r).next((n=>{const a=gs(...n);return this.ns.getDocuments(e,a).next((n=>this.indexManager.getMinOffset(e,r).next((r=>{const i=this.cs(t,n);return this.ls(t,i,a,r.readTime)?this.rs(e,Qi(t,null,"F")):this.hs(e,i,t,r)}))))})))))}ss(e,t,r,n){return Wi(t)||n.isEqual(En.min())?Fn.resolve(null):this.ns.getDocuments(e,r).next((a=>{const i=this.cs(t,a);return this.ls(t,i,r,n)?Fn.resolve(null):($r()<=rt.DEBUG&&Wr("QueryEngine","Re-using previous result from %s to execute query: %s",n.toString(),es(t)),this.hs(e,i,t,Nn(n,An)).next((e=>e)))}))}cs(e,t){let r=new Sa(ns(e));return t.forEach(((t,n)=>{ts(e,n)&&(r=r.add(n))})),r}ls(e,t,r,n){if(null===e.limit)return!1;if(r.size!==t.size)return!0;const a="F"===e.limitType?t.last():t.first();return!!a&&(a.hasPendingWrites||a.version.compareTo(n)>0)}_s(e,t,r){return $r()<=rt.DEBUG&&Wr("QueryEngine","Using full collection scan to execute query:",es(t)),this.ns.getDocumentsMatchingQuery(e,t,xn.min(),r)}hs(e,t,r,n){return this.ns.getDocumentsMatchingQuery(e,r,n).next((e=>(t.forEach((t=>{e=e.insert(t.key,t)})),e)))}}const Dl="LocalStore";class Ll{constructor(e,t,r,n){this.persistence=e,this.Ps=t,this.serializer=n,this.Ts=new Ea(dn),this.Is=new is((e=>Vi(e)),Bi),this.Es=new Map,this.ds=e.getRemoteDocumentCache(),this.Hr=e.getTargetCache(),this.Yr=e.getBundleCache(),this.As(r)}As(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new vl(this.ds,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.ds.setIndexManager(this.indexManager),this.Ps.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(t=>e.collect(t,this.Ts)))}}function Ml(e,t,r,n){return new Ll(e,t,r,n)}async function Fl(e,t){const r=Qr(e);return await r.persistence.runTransaction("Handle user change","readonly",(e=>{let n;return r.mutationQueue.getAllMutationBatches(e).next((a=>(n=a,r.As(t),r.mutationQueue.getAllMutationBatches(e)))).next((t=>{const a=[],i=[];let s=gs();for(const e of n){a.push(e.batchId);for(const t of e.mutations)s=s.add(t.key)}for(const e of t){i.push(e.batchId);for(const t of e.mutations)s=s.add(t.key)}return r.localDocuments.getDocuments(e,s).next((e=>({Rs:e,removedBatchIds:a,addedBatchIds:i})))}))}))}function Ul(e){const t=Qr(e);return t.persistence.runTransaction("Get last remote snapshot version","readonly",(e=>t.Hr.getLastRemoteSnapshotVersion(e)))}function Vl(e,t,r){let n=gs(),a=gs();return r.forEach((e=>n=n.add(e))),t.getEntries(e,n).next((e=>{let n=os();return r.forEach(((r,i)=>{const s=e.get(r);i.isFoundDocument()!==s.isFoundDocument()&&(a=a.add(r)),i.isNoDocument()&&i.version.isEqual(En.min())?(t.removeEntry(r,i.readTime),n=n.insert(r,i)):!s.isValidDocument()||i.version.compareTo(s.version)>0||0===i.version.compareTo(s.version)&&s.hasPendingWrites?(t.addEntry(i),n=n.insert(r,i)):Wr(Dl,"Ignoring outdated watch update for ",r,". Current version:",s.version," Watch version:",i.version)})),{Vs:n,fs:a}}))}function Bl(e,t){const r=Qr(e);return r.persistence.runTransaction("Get next mutation batch","readonly",(e=>(void 0===t&&(t=zn),r.mutationQueue.getNextMutationBatchAfterBatchId(e,t))))}function zl(e,t){const r=Qr(e);return r.persistence.runTransaction("Allocate target","readwrite",(e=>{let n;return r.Hr.getTargetData(e,t).next((a=>a?(n=a,Fn.resolve(n)):r.Hr.allocateTargetId(e).next((a=>(n=new Jo(t,a,"TargetPurposeListen",e.currentSequenceNumber),r.Hr.addTargetData(e,n).next((()=>n)))))))})).then((e=>{const n=r.Ts.get(e.targetId);return(null===n||e.snapshotVersion.compareTo(n.snapshotVersion)>0)&&(r.Ts=r.Ts.insert(e.targetId,e),r.Is.set(t,e.targetId)),e}))}async function jl(e,t,r){const n=Qr(e),a=n.Ts.get(t),i=r?"readwrite":"readwrite-primary";try{r||await n.persistence.runTransaction("Release target",i,(e=>n.persistence.referenceDelegate.removeTarget(e,a)))}catch(e){if(!Vn(e))throw e;Wr(Dl,`Failed to update sequence numbers for target ${t}: ${e}`)}n.Ts=n.Ts.remove(t),n.Is.delete(a.target)}function Hl(e,t,r){const n=Qr(e);let a=En.min(),i=gs();return n.persistence.runTransaction("Execute query","readwrite",(e=>function(e,t,r){const n=Qr(e),a=n.Is.get(r);return void 0!==a?Fn.resolve(n.Ts.get(a)):n.Hr.getTargetData(t,r)}(n,e,qi(t)).next((t=>{if(t)return a=t.lastLimboFreeSnapshotVersion,n.Hr.getMatchingKeysForTargetId(e,t.targetId).next((e=>{i=e}))})).next((()=>n.Ps.getDocumentsMatchingQuery(e,t,r?a:En.min(),r?i:gs()))).next((e=>($l(n,rs(t),e),{documents:e,gs:i})))))}function $l(e,t,r){let n=e.Es.get(t)||En.min();r.forEach(((e,t)=>{t.readTime.compareTo(n)>0&&(n=t.readTime)})),e.Es.set(t,n)}class Wl{constructor(){this.activeTargetIds=ys()}Ds(e){this.activeTargetIds=this.activeTargetIds.add(e)}vs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}bs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class Gl{constructor(){this.ho=new Wl,this.Po={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,r){}addLocalQueryTarget(e){return(!(arguments.length>1&&void 0!==arguments[1])||arguments[1])&&this.ho.Ds(e),this.Po[e]||"not-current"}updateQueryState(e,t,r){this.Po[e]=t}removeLocalQueryTarget(e){this.ho.vs(e)}isLocalQueryTarget(e){return this.ho.activeTargetIds.has(e)}clearQueryState(e){delete this.Po[e]}getAllActiveQueryTargets(){return this.ho.activeTargetIds}isActiveQueryTarget(e){return this.ho.activeTargetIds.has(e)}start(){return this.ho=new Wl,Promise.resolve()}handleUserChange(e,t,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}class Kl{To(e){}shutdown(){}}const ql="ConnectivityMonitor";class Xl{constructor(){this.Io=()=>this.Eo(),this.Ao=()=>this.Ro(),this.Vo=[],this.mo()}To(e){this.Vo.push(e)}shutdown(){window.removeEventListener("online",this.Io),window.removeEventListener("offline",this.Ao)}mo(){window.addEventListener("online",this.Io),window.addEventListener("offline",this.Ao)}Eo(){Wr(ql,"Network connectivity changed: AVAILABLE");for(const e of this.Vo)e(0)}Ro(){Wr(ql,"Network connectivity changed: UNAVAILABLE");for(const e of this.Vo)e(1)}static D(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener}}let Yl=null;function Ql(){return null===Yl?Yl=268435456+Math.round(2147483648*Math.random()):Yl++,"0x"+Yl.toString(16)}const Jl="RestConnection",Zl={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class ec{get fo(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",r=encodeURIComponent(this.databaseId.projectId),n=encodeURIComponent(this.databaseId.database);this.po=t+"://"+e.host,this.yo=`projects/${r}/databases/${n}`,this.wo=this.databaseId.database===za?`project_id=${r}`:`project_id=${r}&database_id=${n}`}So(e,t,r,n,a){const i=Ql(),s=this.bo(e,t.toUriEncodedString());Wr(Jl,`Sending RPC '${e}' ${i}:`,s,r);const o={"google-cloud-resource-prefix":this.yo,"x-goog-request-params":this.wo};return this.Do(o,n,a),this.vo(e,s,o,r).then((t=>(Wr(Jl,`Received RPC '${e}' ${i}: `,t),t)),(t=>{throw Kr(Jl,`RPC '${e}' ${i} failed with error: `,t,"url: ",s,"request:",r),t}))}Co(e,t,r,n,a,i){return this.So(e,t,r,n,a)}Do(e,t,r){e["X-Goog-Api-Client"]="gl-js/ fire/"+jr,e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach(((t,r)=>e[r]=t)),r&&r.headers.forEach(((t,r)=>e[r]=t))}bo(e,t){const r=Zl[e];return`${this.po}/v1/${t}:${r}`}terminate(){}}class tc{constructor(e){this.Fo=e.Fo,this.Mo=e.Mo}xo(e){this.Oo=e}No(e){this.Bo=e}Lo(e){this.ko=e}onMessage(e){this.qo=e}close(){this.Mo()}send(e){this.Fo(e)}Qo(){this.Oo()}$o(){this.Bo()}Uo(e){this.ko(e)}Ko(e){this.qo(e)}}const rc="WebChannelConnection";class nc extends ec{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}vo(e,t,r,n){const a=Ql();return new Promise(((i,s)=>{const o=new Rr;o.setWithCredentials(!0),o.listenOnce(Or.COMPLETE,(()=>{try{switch(o.getLastErrorCode()){case xr.NO_ERROR:const t=o.getResponseJson();Wr(rc,`XHR for RPC '${e}' ${a} received:`,JSON.stringify(t)),i(t);break;case xr.TIMEOUT:Wr(rc,`RPC '${e}' ${a} timed out`),s(new Zr(Jr.DEADLINE_EXCEEDED,"Request time out"));break;case xr.HTTP_ERROR:const r=o.getStatus();if(Wr(rc,`RPC '${e}' ${a} failed with status:`,r,"response text:",o.getResponseText()),r>0){let e=o.getResponseJson();Array.isArray(e)&&(e=e[0]);const t=null==e?void 0:e.error;if(t&&t.status&&t.message){const e=function(e){const t=e.toLowerCase().replace(/_/g,"-");return Object.values(Jr).indexOf(t)>=0?t:Jr.UNKNOWN}(t.status);s(new Zr(e,t.message))}else s(new Zr(Jr.UNKNOWN,"Server responded with status "+o.getStatus()))}else s(new Zr(Jr.UNAVAILABLE,"Connection failed."));break;default:Xr()}}finally{Wr(rc,`RPC '${e}' ${a} completed.`)}}));const l=JSON.stringify(n);Wr(rc,`RPC '${e}' ${a} sending request:`,n),o.send(t,"POST",l,r,15)}))}Wo(e,t,r){const n=Ql(),a=[this.po,"/","google.firestore.v1.Firestore","/",e,"/channel"],i=Mr(),s=Lr(),o={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},l=this.longPollingOptions.timeoutSeconds;void 0!==l&&(o.longPollingTimeout=Math.round(1e3*l)),this.useFetchStreams&&(o.useFetchStreams=!0),this.Do(o.initMessageHeaders,t,r),o.encodeInitMessageHeaders=!0;const c=a.join("");Wr(rc,`Creating RPC '${e}' stream ${n}: ${c}`,o);const u=i.createWebChannel(c,o);let h=!1,f=!1;const d=new tc({Fo:t=>{f?Wr(rc,`Not sending because RPC '${e}' stream ${n} is closed:`,t):(h||(Wr(rc,`Opening RPC '${e}' stream ${n} transport.`),u.open(),h=!0),Wr(rc,`RPC '${e}' stream ${n} sending:`,t),u.send(t))},Mo:()=>u.close()}),p=(e,t,r)=>{e.listen(t,(e=>{try{r(e)}catch(e){setTimeout((()=>{throw e}),0)}}))};return p(u,Nr.EventType.OPEN,(()=>{f||(Wr(rc,`RPC '${e}' stream ${n} transport opened.`),d.Qo())})),p(u,Nr.EventType.CLOSE,(()=>{f||(f=!0,Wr(rc,`RPC '${e}' stream ${n} transport closed`),d.Uo())})),p(u,Nr.EventType.ERROR,(t=>{f||(f=!0,Kr(rc,`RPC '${e}' stream ${n} transport errored:`,t),d.Uo(new Zr(Jr.UNAVAILABLE,"The operation could not be completed")))})),p(u,Nr.EventType.MESSAGE,(t=>{var r;if(!f){const a=t.data[0];Yr(!!a);const i=a,s=(null==i?void 0:i.error)||(null===(r=i[0])||void 0===r?void 0:r.error);if(s){Wr(rc,`RPC '${e}' stream ${n} received error:`,s);const t=s.status;let r=function(e){const t=eo[e];if(void 0!==t)return no(t)}(t),a=s.message;void 0===r&&(r=Jr.INTERNAL,a="Unknown error status: "+t+" with message "+s.message),f=!0,d.Uo(new Zr(r,a)),u.close()}else Wr(rc,`RPC '${e}' stream ${n} received:`,a),d.Ko(a)}})),p(s,Dr.STAT_EVENT,(t=>{t.stat===Pr.PROXY?Wr(rc,`RPC '${e}' stream ${n} detected buffering proxy`):t.stat===Pr.NOPROXY&&Wr(rc,`RPC '${e}' stream ${n} detected no buffering proxy`)})),setTimeout((()=>{d.$o()}),0),d}}function ac(){return"undefined"!=typeof document?document:null}function ic(e){return new _o(e,!0)}class sc{constructor(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1e3,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1.5,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:6e4;this.Ti=e,this.timerId=t,this.Go=r,this.zo=n,this.jo=a,this.Ho=0,this.Jo=null,this.Yo=Date.now(),this.reset()}reset(){this.Ho=0}Zo(){this.Ho=this.jo}Xo(e){this.cancel();const t=Math.floor(this.Ho+this.e_()),r=Math.max(0,Date.now()-this.Yo),n=Math.max(0,t-r);n>0&&Wr("ExponentialBackoff",`Backing off for ${n} ms (base delay: ${this.Ho} ms, delay with jitter: ${t} ms, last attempt: ${r} ms ago)`),this.Jo=this.Ti.enqueueAfterDelay(this.timerId,n,(()=>(this.Yo=Date.now(),e()))),this.Ho*=this.zo,this.Ho<this.Go&&(this.Ho=this.Go),this.Ho>this.jo&&(this.Ho=this.jo)}t_(){null!==this.Jo&&(this.Jo.skipDelay(),this.Jo=null)}cancel(){null!==this.Jo&&(this.Jo.cancel(),this.Jo=null)}e_(){return(Math.random()-.5)*this.Ho}}const oc="PersistentStream";class lc{constructor(e,t,r,n,a,i,s,o){this.Ti=e,this.n_=r,this.r_=n,this.connection=a,this.authCredentialsProvider=i,this.appCheckCredentialsProvider=s,this.listener=o,this.state=0,this.i_=0,this.s_=null,this.o_=null,this.stream=null,this.__=0,this.a_=new sc(e,t)}u_(){return 1===this.state||5===this.state||this.c_()}c_(){return 2===this.state||3===this.state}start(){this.__=0,4!==this.state?this.auth():this.l_()}async stop(){this.u_()&&await this.close(0)}h_(){this.state=0,this.a_.reset()}P_(){this.c_()&&null===this.s_&&(this.s_=this.Ti.enqueueAfterDelay(this.n_,6e4,(()=>this.T_())))}I_(e){this.E_(),this.stream.send(e)}async T_(){if(this.c_())return this.close(0)}E_(){this.s_&&(this.s_.cancel(),this.s_=null)}d_(){this.o_&&(this.o_.cancel(),this.o_=null)}async close(e,t){this.E_(),this.d_(),this.a_.cancel(),this.i_++,4!==e?this.a_.reset():t&&t.code===Jr.RESOURCE_EXHAUSTED?(Gr(t.toString()),Gr("Using maximum backoff delay to prevent overloading the backend."),this.a_.Zo()):t&&t.code===Jr.UNAUTHENTICATED&&3!==this.state&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),null!==this.stream&&(this.A_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.Lo(t)}A_(){}auth(){this.state=1;const e=this.R_(this.i_),t=this.i_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((e=>{let[r,n]=e;this.i_===t&&this.V_(r,n)}),(t=>{e((()=>{const e=new Zr(Jr.UNKNOWN,"Fetching auth token failed: "+t.message);return this.m_(e)}))}))}V_(e,t){const r=this.R_(this.i_);this.stream=this.f_(e,t),this.stream.xo((()=>{r((()=>this.listener.xo()))})),this.stream.No((()=>{r((()=>(this.state=2,this.o_=this.Ti.enqueueAfterDelay(this.r_,1e4,(()=>(this.c_()&&(this.state=3),Promise.resolve()))),this.listener.No())))})),this.stream.Lo((e=>{r((()=>this.m_(e)))})),this.stream.onMessage((e=>{r((()=>1==++this.__?this.g_(e):this.onNext(e)))}))}l_(){this.state=5,this.a_.Xo((async()=>{this.state=0,this.start()}))}m_(e){return Wr(oc,`close with error: ${e}`),this.stream=null,this.close(4,e)}R_(e){return t=>{this.Ti.enqueueAndForget((()=>this.i_===e?t():(Wr(oc,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class cc extends lc{constructor(e,t,r,n,a,i){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,r,n,i),this.serializer=a}f_(e,t){return this.connection.Wo("Listen",e,t)}g_(e){return this.onNext(e)}onNext(e){this.a_.reset();const t=function(e,t){let r;if("targetChange"in t){t.targetChange;const n=function(e){return"NO_CHANGE"===e?0:"ADD"===e?1:"REMOVE"===e?2:"CURRENT"===e?3:"RESET"===e?4:Xr()}(t.targetChange.targetChangeType||"NO_CHANGE"),a=t.targetChange.targetIds||[],i=function(e,t){return e.useProto3Json?(Yr(void 0===t||"string"==typeof t),Aa.fromBase64String(t||"")):(Yr(void 0===t||t instanceof Buffer||t instanceof Uint8Array),Aa.fromUint8Array(t||new Uint8Array))}(e,t.targetChange.resumeToken),s=t.targetChange.cause,o=s&&function(e){const t=void 0===e.code?Jr.UNKNOWN:no(e.code);return new Zr(t,e.message||"")}(s);r=new mo(n,a,i,o||null)}else if("documentChange"in t){t.documentChange;const n=t.documentChange;n.document,n.document.name,n.document.updateTime;const a=Po(e,n.document.name),i=Ao(n.document.updateTime),s=n.document.createTime?Ao(n.document.createTime):En.min(),o=new fi({mapValue:{fields:n.document.fields}}),l=pi.newFoundDocument(a,i,s,o),c=n.targetIds||[],u=n.removedTargetIds||[];r=new fo(c,u,l.key,l)}else if("documentDelete"in t){t.documentDelete;const n=t.documentDelete;n.document;const a=Po(e,n.document),i=n.readTime?Ao(n.readTime):En.min(),s=pi.newNoDocument(a,i),o=n.removedTargetIds||[];r=new fo([],o,s.key,s)}else if("documentRemove"in t){t.documentRemove;const n=t.documentRemove;n.document;const a=Po(e,n.document),i=n.removedTargetIds||[];r=new fo([],i,a,null)}else{if(!("filter"in t))return Xr();{t.filter;const e=t.filter;e.targetId;const{count:n=0,unchangedNames:a}=e,i=new Zs(n,a),s=e.targetId;r=new po(s,i)}}return r}(this.serializer,e),r=function(e){if(!("targetChange"in e))return En.min();const t=e.targetChange;return t.targetIds&&t.targetIds.length?En.min():t.readTime?Ao(t.readTime):En.min()}(e);return this.listener.p_(t,r)}y_(e){const t={};t.database=Mo(this.serializer),t.addTarget=function(e,t){let r;const n=t.target;if(r=zi(n)?{documents:Bo(e,n)}:{query:zo(e,n).ht},r.targetId=t.targetId,t.resumeToken.approximateByteSize()>0){r.resumeToken=Co(e,t.resumeToken);const n=So(e,t.expectedCount);null!==n&&(r.expectedCount=n)}else if(t.snapshotVersion.compareTo(En.min())>0){r.readTime=ko(e,t.snapshotVersion.toTimestamp());const n=So(e,t.expectedCount);null!==n&&(r.expectedCount=n)}return r}(this.serializer,e);const r=function(e,t){const r=function(e){switch(e){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return Xr()}}(t.purpose);return null==r?null:{"goog-listen-tags":r}}(this.serializer,e);r&&(t.labels=r),this.I_(t)}w_(e){const t={};t.database=Mo(this.serializer),t.removeTarget=e,this.I_(t)}}class uc extends lc{constructor(e,t,r,n,a,i){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,r,n,i),this.serializer=a}get S_(){return this.__>0}start(){this.lastStreamToken=void 0,super.start()}A_(){this.S_&&this.b_([])}f_(e,t){return this.connection.Wo("Write",e,t)}g_(e){return Yr(!!e.streamToken),this.lastStreamToken=e.streamToken,Yr(!e.writeResults||0===e.writeResults.length),this.listener.D_()}onNext(e){Yr(!!e.streamToken),this.lastStreamToken=e.streamToken,this.a_.reset();const t=function(e,t){return e&&e.length>0?(Yr(void 0!==t),e.map((e=>function(e,t){let r=e.updateTime?Ao(e.updateTime):Ao(t);return r.isEqual(En.min())&&(r=Ao(t)),new Ds(r,e.transformResults||[])}(e,t)))):[]}(e.writeResults,e.commitTime),r=Ao(e.commitTime);return this.listener.v_(r,t)}C_(){const e={};e.database=Mo(this.serializer),this.I_(e)}b_(e){const t={streamToken:this.lastStreamToken,writes:e.map((e=>Vo(this.serializer,e)))};this.I_(t)}}class hc{}class fc extends hc{constructor(e,t,r,n){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=r,this.serializer=n,this.F_=!1}M_(){if(this.F_)throw new Zr(Jr.FAILED_PRECONDITION,"The client has already been terminated.")}So(e,t,r,n){return this.M_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((a=>{let[i,s]=a;return this.connection.So(e,No(t,r),n,i,s)})).catch((e=>{throw"FirebaseError"===e.name?(e.code===Jr.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),e):new Zr(Jr.UNKNOWN,e.toString())}))}Co(e,t,r,n,a){return this.M_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((i=>{let[s,o]=i;return this.connection.Co(e,No(t,r),n,s,o,a)})).catch((e=>{throw"FirebaseError"===e.name?(e.code===Jr.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),e):new Zr(Jr.UNKNOWN,e.toString())}))}terminate(){this.F_=!0,this.connection.terminate()}}class dc{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.x_=0,this.O_=null,this.N_=!0}B_(){0===this.x_&&(this.L_("Unknown"),this.O_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this.O_=null,this.k_("Backend didn't respond within 10 seconds."),this.L_("Offline"),Promise.resolve()))))}q_(e){"Online"===this.state?this.L_("Unknown"):(this.x_++,this.x_>=1&&(this.Q_(),this.k_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.L_("Offline")))}set(e){this.Q_(),this.x_=0,"Online"===e&&(this.N_=!1),this.L_(e)}L_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}k_(e){const t=`Could not reach Cloud Firestore backend. ${e}\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.N_?(Gr(t),this.N_=!1):Wr("OnlineStateTracker",t)}Q_(){null!==this.O_&&(this.O_.cancel(),this.O_=null)}}const pc="RemoteStore";class mc{constructor(e,t,r,n,a){this.localStore=e,this.datastore=t,this.asyncQueue=r,this.remoteSyncer={},this.U_=[],this.K_=new Map,this.W_=new Set,this.G_=[],this.z_=a,this.z_.To((e=>{r.enqueueAndForget((async()=>{Sc(this)&&(Wr(pc,"Restarting streams for network reachability change."),await async function(e){const t=Qr(e);t.W_.add(4),await vc(t),t.j_.set("Unknown"),t.W_.delete(4),await gc(t)}(this))}))})),this.j_=new dc(r,n)}}async function gc(e){if(Sc(e))for(const t of e.G_)await t(!0)}async function vc(e){for(const t of e.G_)await t(!1)}function yc(e,t){const r=Qr(e);r.K_.has(t.targetId)||(r.K_.set(t.targetId,t),_c(r)?Tc(r):Hc(r).c_()&&wc(r,t))}function bc(e,t){const r=Qr(e),n=Hc(r);r.K_.delete(t),n.c_()&&Ec(r,t),0===r.K_.size&&(n.c_()?n.P_():Sc(r)&&r.j_.set("Unknown"))}function wc(e,t){if(e.H_.Ne(t.targetId),t.resumeToken.approximateByteSize()>0||t.snapshotVersion.compareTo(En.min())>0){const r=e.remoteSyncer.getRemoteKeysForTarget(t.targetId).size;t=t.withExpectedCount(r)}Hc(e).y_(t)}function Ec(e,t){e.H_.Ne(t),Hc(e).w_(t)}function Tc(e){e.H_=new vo({getRemoteKeysForTarget:t=>e.remoteSyncer.getRemoteKeysForTarget(t),lt:t=>e.K_.get(t)||null,it:()=>e.datastore.serializer.databaseId}),Hc(e).start(),e.j_.B_()}function _c(e){return Sc(e)&&!Hc(e).u_()&&e.K_.size>0}function Sc(e){return 0===Qr(e).W_.size}function kc(e){e.H_=void 0}async function Cc(e){e.j_.set("Online")}async function Ic(e){e.K_.forEach(((t,r)=>{wc(e,t)}))}async function Ac(e,t){kc(e),_c(e)?(e.j_.q_(t),Tc(e)):e.j_.set("Unknown")}async function Rc(e,t,r){if(e.j_.set("Online"),t instanceof mo&&2===t.state&&t.cause)try{await async function(e,t){const r=t.cause;for(const n of t.targetIds)e.K_.has(n)&&(await e.remoteSyncer.rejectListen(n,r),e.K_.delete(n),e.H_.removeTarget(n))}(e,t)}catch(r){Wr(pc,"Failed to remove targets %s: %s ",t.targetIds.join(","),r),await Nc(e,r)}else if(t instanceof fo?e.H_.We(t):t instanceof po?e.H_.Ze(t):e.H_.je(t),!r.isEqual(En.min()))try{const t=await Ul(e.localStore);r.compareTo(t)>=0&&await function(e,t){const r=e.H_.ot(t);return r.targetChanges.forEach(((r,n)=>{if(r.resumeToken.approximateByteSize()>0){const a=e.K_.get(n);a&&e.K_.set(n,a.withResumeToken(r.resumeToken,t))}})),r.targetMismatches.forEach(((t,r)=>{const n=e.K_.get(t);if(!n)return;e.K_.set(t,n.withResumeToken(Aa.EMPTY_BYTE_STRING,n.snapshotVersion)),Ec(e,t);const a=new Jo(n.target,t,r,n.sequenceNumber);wc(e,a)})),e.remoteSyncer.applyRemoteEvent(r)}(e,r)}catch(t){Wr(pc,"Failed to raise snapshot:",t),await Nc(e,t)}}async function Nc(e,t,r){if(!Vn(t))throw t;e.W_.add(1),await vc(e),e.j_.set("Offline"),r||(r=()=>Ul(e.localStore)),e.asyncQueue.enqueueRetryable((async()=>{Wr(pc,"Retrying IndexedDB access"),await r(),e.W_.delete(1),await gc(e)}))}function Oc(e,t){return t().catch((r=>Nc(e,r,t)))}async function xc(e){const t=Qr(e),r=$c(t);let n=t.U_.length>0?t.U_[t.U_.length-1].batchId:zn;for(;Pc(t);)try{const e=await Bl(t.localStore,n);if(null===e){0===t.U_.length&&r.P_();break}n=e.batchId,Dc(t,e)}catch(e){await Nc(t,e)}Lc(t)&&Mc(t)}function Pc(e){return Sc(e)&&e.U_.length<10}function Dc(e,t){e.U_.push(t);const r=$c(e);r.c_()&&r.S_&&r.b_(t.mutations)}function Lc(e){return Sc(e)&&!$c(e).u_()&&e.U_.length>0}function Mc(e){$c(e).start()}async function Fc(e){$c(e).C_()}async function Uc(e){const t=$c(e);for(const r of e.U_)t.b_(r.mutations)}async function Vc(e,t,r){const n=e.U_.shift(),a=Qs.from(n,t,r);await Oc(e,(()=>e.remoteSyncer.applySuccessfulWrite(a))),await xc(e)}async function Bc(e,t){t&&$c(e).S_&&await async function(e,t){if(function(e){return ro(e)&&e!==Jr.ABORTED}(t.code)){const r=e.U_.shift();$c(e).h_(),await Oc(e,(()=>e.remoteSyncer.rejectFailedWrite(r.batchId,t))),await xc(e)}}(e,t),Lc(e)&&Mc(e)}async function zc(e,t){const r=Qr(e);r.asyncQueue.verifyOperationInProgress(),Wr(pc,"RemoteStore received new credentials");const n=Sc(r);r.W_.add(3),await vc(r),n&&r.j_.set("Unknown"),await r.remoteSyncer.handleCredentialChange(t),r.W_.delete(3),await gc(r)}async function jc(e,t){const r=Qr(e);t?(r.W_.delete(2),await gc(r)):t||(r.W_.add(2),await vc(r),r.j_.set("Unknown"))}function Hc(e){return e.J_||(e.J_=function(e,t,r){const n=Qr(e);return n.M_(),new cc(t,n.connection,n.authCredentials,n.appCheckCredentials,n.serializer,r)}(e.datastore,e.asyncQueue,{xo:Cc.bind(null,e),No:Ic.bind(null,e),Lo:Ac.bind(null,e),p_:Rc.bind(null,e)}),e.G_.push((async t=>{t?(e.J_.h_(),_c(e)?Tc(e):e.j_.set("Unknown")):(await e.J_.stop(),kc(e))}))),e.J_}function $c(e){return e.Y_||(e.Y_=function(e,t,r){const n=Qr(e);return n.M_(),new uc(t,n.connection,n.authCredentials,n.appCheckCredentials,n.serializer,r)}(e.datastore,e.asyncQueue,{xo:()=>Promise.resolve(),No:Fc.bind(null,e),Lo:Bc.bind(null,e),D_:Uc.bind(null,e),v_:Vc.bind(null,e)}),e.G_.push((async t=>{t?(e.Y_.h_(),await xc(e)):(await e.Y_.stop(),e.U_.length>0&&(Wr(pc,`Stopping write stream with ${e.U_.length} pending writes`),e.U_=[]))}))),e.Y_}class Wc{constructor(e,t,r,n,a){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=r,this.op=n,this.removalCallback=a,this.deferred=new en,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((e=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(e,t,r,n,a){const i=Date.now()+r,s=new Wc(e,t,i,n,a);return s.start(r),s}start(e){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new Zr(Jr.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>null!==this.timerHandle?(this.clearTimeout(),this.op().then((e=>this.deferred.resolve(e)))):Promise.resolve()))}clearTimeout(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Gc(e,t){if(Gr("AsyncQueue",`${t}: ${e}`),Vn(e))return new Zr(Jr.UNAVAILABLE,`${t}: ${e}`);throw e}class Kc{static emptySet(e){return new Kc(e.comparator)}constructor(e){this.comparator=e?(t,r)=>e(t,r)||In.comparator(t.key,r.key):(e,t)=>In.comparator(e.key,t.key),this.keyedMap=cs(),this.sortedSet=new Ea(this.comparator)}has(e){return null!=this.keyedMap.get(e)}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal(((t,r)=>(e(t),!1)))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof Kc))return!1;if(this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;t.hasNext();){const e=t.getNext().key,n=r.getNext().key;if(!e.isEqual(n))return!1}return!0}toString(){const e=[];return this.forEach((t=>{e.push(t.toString())})),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"}copy(e,t){const r=new Kc;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=t,r}}class qc{constructor(){this.Z_=new Ea(In.comparator)}track(e){const t=e.doc.key,r=this.Z_.get(t);r?0!==e.type&&3===r.type?this.Z_=this.Z_.insert(t,e):3===e.type&&1!==r.type?this.Z_=this.Z_.insert(t,{type:r.type,doc:e.doc}):2===e.type&&2===r.type?this.Z_=this.Z_.insert(t,{type:2,doc:e.doc}):2===e.type&&0===r.type?this.Z_=this.Z_.insert(t,{type:0,doc:e.doc}):1===e.type&&0===r.type?this.Z_=this.Z_.remove(t):1===e.type&&2===r.type?this.Z_=this.Z_.insert(t,{type:1,doc:r.doc}):0===e.type&&1===r.type?this.Z_=this.Z_.insert(t,{type:2,doc:e.doc}):Xr():this.Z_=this.Z_.insert(t,e)}X_(){const e=[];return this.Z_.inorderTraversal(((t,r)=>{e.push(r)})),e}}class Xc{constructor(e,t,r,n,a,i,s,o,l){this.query=e,this.docs=t,this.oldDocs=r,this.docChanges=n,this.mutatedKeys=a,this.fromCache=i,this.syncStateChanged=s,this.excludesMetadataChanges=o,this.hasCachedResults=l}static fromInitialDocuments(e,t,r,n,a){const i=[];return t.forEach((e=>{i.push({type:0,doc:e})})),new Xc(e,t,Kc.emptySet(t),i,r,n,!0,!1,a)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Ji(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,r=e.docChanges;if(t.length!==r.length)return!1;for(let n=0;n<t.length;n++)if(t[n].type!==r[n].type||!t[n].doc.isEqual(r[n].doc))return!1;return!0}}class Yc{constructor(){this.ea=void 0,this.ta=[]}na(){return this.ta.some((e=>e.ra()))}}class Qc{constructor(){this.queries=Jc(),this.onlineState="Unknown",this.ia=new Set}terminate(){!function(e,t){const r=Qr(e),n=r.queries;r.queries=Jc(),n.forEach(((e,r)=>{for(const n of r.ta)n.onError(t)}))}(this,new Zr(Jr.ABORTED,"Firestore shutting down"))}}function Jc(){return new is((e=>Zi(e)),Ji)}async function Zc(e,t){const r=Qr(e);let n=3;const a=t.query;let i=r.queries.get(a);i?!i.na()&&t.ra()&&(n=2):(i=new Yc,n=t.ra()?0:1);try{switch(n){case 0:i.ea=await r.onListen(a,!0);break;case 1:i.ea=await r.onListen(a,!1);break;case 2:await r.onFirstRemoteStoreListen(a)}}catch(e){const r=Gc(e,`Initialization of query '${es(t.query)}' failed`);return void t.onError(r)}r.queries.set(a,i),i.ta.push(t),t.sa(r.onlineState),i.ea&&t.oa(i.ea)&&nu(r)}async function eu(e,t){const r=Qr(e),n=t.query;let a=3;const i=r.queries.get(n);if(i){const e=i.ta.indexOf(t);e>=0&&(i.ta.splice(e,1),0===i.ta.length?a=t.ra()?0:1:!i.na()&&t.ra()&&(a=2))}switch(a){case 0:return r.queries.delete(n),r.onUnlisten(n,!0);case 1:return r.queries.delete(n),r.onUnlisten(n,!1);case 2:return r.onLastRemoteStoreUnlisten(n);default:return}}function tu(e,t){const r=Qr(e);let n=!1;for(const a of t){const e=a.query,t=r.queries.get(e);if(t){for(const e of t.ta)e.oa(a)&&(n=!0);t.ea=a}}n&&nu(r)}function ru(e,t,r){const n=Qr(e),a=n.queries.get(t);if(a)for(const i of a.ta)i.onError(r);n.queries.delete(t)}function nu(e){e.ia.forEach((e=>{e.next()}))}var au,iu;(iu=au||(au={}))._a="default",iu.Cache="cache";class su{constructor(e,t,r){this.query=e,this.aa=t,this.ua=!1,this.ca=null,this.onlineState="Unknown",this.options=r||{}}oa(e){if(!this.options.includeMetadataChanges){const t=[];for(const r of e.docChanges)3!==r.type&&t.push(r);e=new Xc(e.query,e.docs,e.oldDocs,t,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.ua?this.la(e)&&(this.aa.next(e),t=!0):this.ha(e,this.onlineState)&&(this.Pa(e),t=!0),this.ca=e,t}onError(e){this.aa.error(e)}sa(e){this.onlineState=e;let t=!1;return this.ca&&!this.ua&&this.ha(this.ca,e)&&(this.Pa(this.ca),t=!0),t}ha(e,t){if(!e.fromCache)return!0;if(!this.ra())return!0;const r="Offline"!==t;return(!this.options.Ta||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||"Offline"===t)}la(e){if(e.docChanges.length>0)return!0;const t=this.ca&&this.ca.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&!0===this.options.includeMetadataChanges}Pa(e){e=Xc.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.ua=!0,this.aa.next(e)}ra(){return this.options.source!==au.Cache}}class ou{constructor(e){this.key=e}}class lu{constructor(e){this.key=e}}class cu{constructor(e,t){this.query=e,this.fa=t,this.ga=null,this.hasCachedResults=!1,this.current=!1,this.pa=gs(),this.mutatedKeys=gs(),this.ya=ns(e),this.wa=new Kc(this.ya)}get Sa(){return this.fa}ba(e,t){const r=t?t.Da:new qc,n=t?t.wa:this.wa;let a=t?t.mutatedKeys:this.mutatedKeys,i=n,s=!1;const o="F"===this.query.limitType&&n.size===this.query.limit?n.last():null,l="L"===this.query.limitType&&n.size===this.query.limit?n.first():null;if(e.inorderTraversal(((e,t)=>{const c=n.get(e),u=ts(this.query,t)?t:null,h=!!c&&this.mutatedKeys.has(c.key),f=!!u&&(u.hasLocalMutations||this.mutatedKeys.has(u.key)&&u.hasCommittedMutations);let d=!1;c&&u?c.data.isEqual(u.data)?h!==f&&(r.track({type:3,doc:u}),d=!0):this.va(c,u)||(r.track({type:2,doc:u}),d=!0,(o&&this.ya(u,o)>0||l&&this.ya(u,l)<0)&&(s=!0)):!c&&u?(r.track({type:0,doc:u}),d=!0):c&&!u&&(r.track({type:1,doc:c}),d=!0,(o||l)&&(s=!0)),d&&(u?(i=i.add(u),a=f?a.add(e):a.delete(e)):(i=i.delete(e),a=a.delete(e)))})),null!==this.query.limit)for(;i.size>this.query.limit;){const e="F"===this.query.limitType?i.last():i.first();i=i.delete(e.key),a=a.delete(e.key),r.track({type:1,doc:e})}return{wa:i,Da:r,ls:s,mutatedKeys:a}}va(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,r,n){const a=this.wa;this.wa=e.wa,this.mutatedKeys=e.mutatedKeys;const i=e.Da.X_();i.sort(((e,t)=>function(e,t){const r=e=>{switch(e){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Xr()}};return r(e)-r(t)}(e.type,t.type)||this.ya(e.doc,t.doc))),this.Ca(r),n=null!=n&&n;const s=t&&!n?this.Fa():[],o=0===this.pa.size&&this.current&&!n?1:0,l=o!==this.ga;return this.ga=o,0!==i.length||l?{snapshot:new Xc(this.query,e.wa,a,i,e.mutatedKeys,0===o,l,!1,!!r&&r.resumeToken.approximateByteSize()>0),Ma:s}:{Ma:s}}sa(e){return this.current&&"Offline"===e?(this.current=!1,this.applyChanges({wa:this.wa,Da:new qc,mutatedKeys:this.mutatedKeys,ls:!1},!1)):{Ma:[]}}xa(e){return!this.fa.has(e)&&!!this.wa.has(e)&&!this.wa.get(e).hasLocalMutations}Ca(e){e&&(e.addedDocuments.forEach((e=>this.fa=this.fa.add(e))),e.modifiedDocuments.forEach((e=>{})),e.removedDocuments.forEach((e=>this.fa=this.fa.delete(e))),this.current=e.current)}Fa(){if(!this.current)return[];const e=this.pa;this.pa=gs(),this.wa.forEach((e=>{this.xa(e.key)&&(this.pa=this.pa.add(e.key))}));const t=[];return e.forEach((e=>{this.pa.has(e)||t.push(new lu(e))})),this.pa.forEach((r=>{e.has(r)||t.push(new ou(r))})),t}Oa(e){this.fa=e.gs,this.pa=gs();const t=this.ba(e.documents);return this.applyChanges(t,!0)}Na(){return Xc.fromInitialDocuments(this.query,this.wa,this.mutatedKeys,0===this.ga,this.hasCachedResults)}}const uu="SyncEngine";class hu{constructor(e,t,r){this.query=e,this.targetId=t,this.view=r}}class fu{constructor(e){this.key=e,this.Ba=!1}}class du{constructor(e,t,r,n,a,i){this.localStore=e,this.remoteStore=t,this.eventManager=r,this.sharedClientState=n,this.currentUser=a,this.maxConcurrentLimboResolutions=i,this.La={},this.ka=new is((e=>Zi(e)),Ji),this.qa=new Map,this.Qa=new Set,this.$a=new Ea(In.comparator),this.Ua=new Map,this.Ka=new El,this.Wa={},this.Ga=new Map,this.za=ol.Kn(),this.onlineState="Unknown",this.ja=void 0}get isPrimaryClient(){return!0===this.ja}}async function pu(e,t){let r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];const n=Lu(e);let a;const i=n.ka.get(t);return i?(n.sharedClientState.addLocalQueryTarget(i.targetId),a=i.view.Na()):a=await gu(n,t,r,!0),a}async function mu(e,t){const r=Lu(e);await gu(r,t,!0,!1)}async function gu(e,t,r,n){const a=await zl(e.localStore,qi(t)),i=a.targetId,s=e.sharedClientState.addLocalQueryTarget(i,r);let o;return n&&(o=await vu(e,t,i,"current"===s,a.resumeToken)),e.isPrimaryClient&&r&&yc(e.remoteStore,a),o}async function vu(e,t,r,n,a){e.Ha=(t,r,n)=>async function(e,t,r,n){let a=t.view.ba(r);a.ls&&(a=await Hl(e.localStore,t.query,!1).then((e=>{let{documents:r}=e;return t.view.ba(r,a)})));const i=n&&n.targetChanges.get(t.targetId),s=n&&null!=n.targetMismatches.get(t.targetId),o=t.view.applyChanges(a,e.isPrimaryClient,i,s);return Ru(e,t.targetId,o.Ma),o.snapshot}(e,t,r,n);const i=await Hl(e.localStore,t,!0),s=new cu(t,i.gs),o=s.ba(i.documents),l=ho.createSynthesizedTargetChangeForCurrentChange(r,n&&"Offline"!==e.onlineState,a),c=s.applyChanges(o,e.isPrimaryClient,l);Ru(e,r,c.Ma);const u=new hu(t,r,s);return e.ka.set(t,u),e.qa.has(r)?e.qa.get(r).push(t):e.qa.set(r,[t]),c.snapshot}async function yu(e,t,r){const n=Qr(e),a=n.ka.get(t),i=n.qa.get(a.targetId);if(i.length>1)return n.qa.set(a.targetId,i.filter((e=>!Ji(e,t)))),void n.ka.delete(t);n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(a.targetId),n.sharedClientState.isActiveQueryTarget(a.targetId)||await jl(n.localStore,a.targetId,!1).then((()=>{n.sharedClientState.clearQueryState(a.targetId),r&&bc(n.remoteStore,a.targetId),Iu(n,a.targetId)})).catch(Mn)):(Iu(n,a.targetId),await jl(n.localStore,a.targetId,!0))}async function bu(e,t){const r=Qr(e),n=r.ka.get(t),a=r.qa.get(n.targetId);r.isPrimaryClient&&1===a.length&&(r.sharedClientState.removeLocalQueryTarget(n.targetId),bc(r.remoteStore,n.targetId))}async function wu(e,t){const r=Qr(e);try{const e=await function(e,t){const r=Qr(e),n=t.snapshotVersion;let a=r.Ts;return r.persistence.runTransaction("Apply remote event","readwrite-primary",(e=>{const i=r.ds.newChangeBuffer({trackRemovals:!0});a=r.Ts;const s=[];t.targetChanges.forEach(((i,o)=>{const l=a.get(o);if(!l)return;s.push(r.Hr.removeMatchingKeys(e,i.removedDocuments,o).next((()=>r.Hr.addMatchingKeys(e,i.addedDocuments,o))));let c=l.withSequenceNumber(e.currentSequenceNumber);null!==t.targetMismatches.get(o)?c=c.withResumeToken(Aa.EMPTY_BYTE_STRING,En.min()).withLastLimboFreeSnapshotVersion(En.min()):i.resumeToken.approximateByteSize()>0&&(c=c.withResumeToken(i.resumeToken,n)),a=a.insert(o,c),function(e,t,r){return 0===e.resumeToken.approximateByteSize()||(t.snapshotVersion.toMicroseconds()-e.snapshotVersion.toMicroseconds()>=3e8||r.addedDocuments.size+r.modifiedDocuments.size+r.removedDocuments.size>0)}(l,c,i)&&s.push(r.Hr.updateTargetData(e,c))}));let o=os(),l=gs();if(t.documentUpdates.forEach((n=>{t.resolvedLimboDocuments.has(n)&&s.push(r.persistence.referenceDelegate.updateLimboDocument(e,n))})),s.push(Vl(e,i,t.documentUpdates).next((e=>{o=e.Vs,l=e.fs}))),!n.isEqual(En.min())){const t=r.Hr.getLastRemoteSnapshotVersion(e).next((t=>r.Hr.setTargetsMetadata(e,e.currentSequenceNumber,n)));s.push(t)}return Fn.waitFor(s).next((()=>i.apply(e))).next((()=>r.localDocuments.getLocalViewOfDocuments(e,o,l))).next((()=>o))})).then((e=>(r.Ts=a,e)))}(r.localStore,t);t.targetChanges.forEach(((e,t)=>{const n=r.Ua.get(t);n&&(Yr(e.addedDocuments.size+e.modifiedDocuments.size+e.removedDocuments.size<=1),e.addedDocuments.size>0?n.Ba=!0:e.modifiedDocuments.size>0?Yr(n.Ba):e.removedDocuments.size>0&&(Yr(n.Ba),n.Ba=!1))})),await xu(r,e,t)}catch(e){await Mn(e)}}function Eu(e,t,r){const n=Qr(e);if(n.isPrimaryClient&&0===r||!n.isPrimaryClient&&1===r){const e=[];n.ka.forEach(((r,n)=>{const a=n.view.sa(t);a.snapshot&&e.push(a.snapshot)})),function(e,t){const r=Qr(e);r.onlineState=t;let n=!1;r.queries.forEach(((e,r)=>{for(const a of r.ta)a.sa(t)&&(n=!0)})),n&&nu(r)}(n.eventManager,t),e.length&&n.La.p_(e),n.onlineState=t,n.isPrimaryClient&&n.sharedClientState.setOnlineState(t)}}async function Tu(e,t,r){const n=Qr(e);n.sharedClientState.updateQueryState(t,"rejected",r);const a=n.Ua.get(t),i=a&&a.key;if(i){let e=new Ea(In.comparator);e=e.insert(i,pi.newNoDocument(i,En.min()));const r=gs().add(i),a=new uo(En.min(),new Map,new Ea(dn),e,r);await wu(n,a),n.$a=n.$a.remove(i),n.Ua.delete(t),Ou(n)}else await jl(n.localStore,t,!1).then((()=>Iu(n,t,r))).catch(Mn)}async function _u(e,t){const r=Qr(e),n=t.batch.batchId;try{const e=await function(e,t){const r=Qr(e);return r.persistence.runTransaction("Acknowledge batch","readwrite-primary",(e=>{const n=t.batch.keys(),a=r.ds.newChangeBuffer({trackRemovals:!0});return function(e,t,r,n){const a=r.batch,i=a.keys();let s=Fn.resolve();return i.forEach((e=>{s=s.next((()=>n.getEntry(t,e))).next((t=>{const i=r.docVersions.get(e);Yr(null!==i),t.version.compareTo(i)<0&&(a.applyToRemoteDocument(t,r),t.isValidDocument()&&(t.setReadTime(r.commitVersion),n.addEntry(t)))}))})),s.next((()=>e.mutationQueue.removeMutationBatch(t,a)))}(r,e,t,a).next((()=>a.apply(e))).next((()=>r.mutationQueue.performConsistencyCheck(e))).next((()=>r.documentOverlayCache.removeOverlaysForBatchId(e,n,t.batch.batchId))).next((()=>r.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(e,function(e){let t=gs();for(let r=0;r<e.mutationResults.length;++r)e.mutationResults[r].transformResults.length>0&&(t=t.add(e.batch.mutations[r].key));return t}(t)))).next((()=>r.localDocuments.getDocuments(e,n)))}))}(r.localStore,t);Cu(r,n,null),ku(r,n),r.sharedClientState.updateMutationState(n,"acknowledged"),await xu(r,e)}catch(e){await Mn(e)}}async function Su(e,t,r){const n=Qr(e);try{const e=await function(e,t){const r=Qr(e);return r.persistence.runTransaction("Reject batch","readwrite-primary",(e=>{let n;return r.mutationQueue.lookupMutationBatch(e,t).next((t=>(Yr(null!==t),n=t.keys(),r.mutationQueue.removeMutationBatch(e,t)))).next((()=>r.mutationQueue.performConsistencyCheck(e))).next((()=>r.documentOverlayCache.removeOverlaysForBatchId(e,n,t))).next((()=>r.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(e,n))).next((()=>r.localDocuments.getDocuments(e,n)))}))}(n.localStore,t);Cu(n,t,r),ku(n,t),n.sharedClientState.updateMutationState(t,"rejected",r),await xu(n,e)}catch(r){await Mn(r)}}function ku(e,t){(e.Ga.get(t)||[]).forEach((e=>{e.resolve()})),e.Ga.delete(t)}function Cu(e,t,r){const n=Qr(e);let a=n.Wa[n.currentUser.toKey()];if(a){const e=a.get(t);e&&(r?e.reject(r):e.resolve(),a=a.remove(t)),n.Wa[n.currentUser.toKey()]=a}}function Iu(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;e.sharedClientState.removeLocalQueryTarget(t);for(const n of e.qa.get(t))e.ka.delete(n),r&&e.La.Ja(n,r);e.qa.delete(t),e.isPrimaryClient&&e.Ka.br(t).forEach((t=>{e.Ka.containsKey(t)||Au(e,t)}))}function Au(e,t){e.Qa.delete(t.path.canonicalString());const r=e.$a.get(t);null!==r&&(bc(e.remoteStore,r),e.$a=e.$a.remove(t),e.Ua.delete(r),Ou(e))}function Ru(e,t,r){for(const n of r)n instanceof ou?(e.Ka.addReference(n.key,t),Nu(e,n)):n instanceof lu?(Wr(uu,"Document no longer in limbo: "+n.key),e.Ka.removeReference(n.key,t),e.Ka.containsKey(n.key)||Au(e,n.key)):Xr()}function Nu(e,t){const r=t.key,n=r.path.canonicalString();e.$a.get(r)||e.Qa.has(n)||(Wr(uu,"New document in limbo: "+r),e.Qa.add(n),Ou(e))}function Ou(e){for(;e.Qa.size>0&&e.$a.size<e.maxConcurrentLimboResolutions;){const t=e.Qa.values().next().value;e.Qa.delete(t);const r=new In(Sn.fromString(t)),n=e.za.next();e.Ua.set(n,new fu(r)),e.$a=e.$a.insert(r,n),yc(e.remoteStore,new Jo(qi($i(r.path)),n,"TargetPurposeLimboResolution",Bn.ae))}}async function xu(e,t,r){const n=Qr(e),a=[],i=[],s=[];n.ka.isEmpty()||(n.ka.forEach(((e,o)=>{s.push(n.Ha(o,t,r).then((e=>{var t;if((e||r)&&n.isPrimaryClient){const a=e?!e.fromCache:null===(t=null==r?void 0:r.targetChanges.get(o.targetId))||void 0===t?void 0:t.current;n.sharedClientState.updateQueryState(o.targetId,a?"current":"not-current")}if(e){a.push(e);const t=Ol.Yi(o.targetId,e);i.push(t)}})))})),await Promise.all(s),n.La.p_(a),await async function(e,t){const r=Qr(e);try{await r.persistence.runTransaction("notifyLocalViewChanges","readwrite",(e=>Fn.forEach(t,(t=>Fn.forEach(t.Hi,(n=>r.persistence.referenceDelegate.addReference(e,t.targetId,n))).next((()=>Fn.forEach(t.Ji,(n=>r.persistence.referenceDelegate.removeReference(e,t.targetId,n)))))))))}catch(e){if(!Vn(e))throw e;Wr(Dl,"Failed to update sequence numbers: "+e)}for(const n of t){const e=n.targetId;if(!n.fromCache){const t=r.Ts.get(e),n=t.snapshotVersion,a=t.withLastLimboFreeSnapshotVersion(n);r.Ts=r.Ts.insert(e,a)}}}(n.localStore,i))}async function Pu(e,t){const r=Qr(e);if(!r.currentUser.isEqual(t)){Wr(uu,"User change. New user:",t.toKey());const e=await Fl(r.localStore,t);r.currentUser=t,function(e,t){e.Ga.forEach((e=>{e.forEach((e=>{e.reject(new Zr(Jr.CANCELLED,t))}))})),e.Ga.clear()}(r,"'waitForPendingWrites' promise is rejected due to a user change."),r.sharedClientState.handleUserChange(t,e.removedBatchIds,e.addedBatchIds),await xu(r,e.Rs)}}function Du(e,t){const r=Qr(e),n=r.Ua.get(t);if(n&&n.Ba)return gs().add(n.key);{let e=gs();const n=r.qa.get(t);if(!n)return e;for(const t of n){const n=r.ka.get(t);e=e.unionWith(n.view.Sa)}return e}}function Lu(e){const t=Qr(e);return t.remoteStore.remoteSyncer.applyRemoteEvent=wu.bind(null,t),t.remoteStore.remoteSyncer.getRemoteKeysForTarget=Du.bind(null,t),t.remoteStore.remoteSyncer.rejectListen=Tu.bind(null,t),t.La.p_=tu.bind(null,t.eventManager),t.La.Ja=ru.bind(null,t.eventManager),t}function Mu(e){const t=Qr(e);return t.remoteStore.remoteSyncer.applySuccessfulWrite=_u.bind(null,t),t.remoteStore.remoteSyncer.rejectFailedWrite=Su.bind(null,t),t}class Fu{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=ic(e.databaseInfo.databaseId),this.sharedClientState=this.Za(e),this.persistence=this.Xa(e),await this.persistence.start(),this.localStore=this.eu(e),this.gcScheduler=this.tu(e,this.localStore),this.indexBackfillerScheduler=this.nu(e,this.localStore)}tu(e,t){return null}nu(e,t){return null}eu(e){return Ml(this.persistence,new Pl,e.initialUser,this.serializer)}Xa(e){return new Il(Rl.ri,this.serializer)}Za(e){return new Gl}async terminate(){var e,t;null===(e=this.gcScheduler)||void 0===e||e.stop(),null===(t=this.indexBackfillerScheduler)||void 0===t||t.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Fu.provider={build:()=>new Fu};class Uu extends Fu{constructor(e){super(),this.cacheSizeBytes=e}tu(e,t){Yr(this.persistence.referenceDelegate instanceof Nl);const r=this.persistence.referenceDelegate.garbageCollector;return new fl(r,e.asyncQueue,t)}Xa(e){const t=void 0!==this.cacheSizeBytes?sl.withCacheSize(this.cacheSizeBytes):sl.DEFAULT;return new Il((e=>Nl.ri(e,t)),this.serializer)}}class Vu{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=e=>Eu(this.syncEngine,e,1),this.remoteStore.remoteSyncer.handleCredentialChange=Pu.bind(null,this.syncEngine),await jc(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return new Qc}createDatastore(e){const t=ic(e.databaseInfo.databaseId),r=function(e){return new nc(e)}(e.databaseInfo);return function(e,t,r,n){return new fc(e,t,r,n)}(e.authCredentials,e.appCheckCredentials,r,t)}createRemoteStore(e){return function(e,t,r,n,a){return new mc(e,t,r,n,a)}(this.localStore,this.datastore,e.asyncQueue,(e=>Eu(this.syncEngine,e,0)),Xl.D()?new Xl:new Kl)}createSyncEngine(e,t){return function(e,t,r,n,a,i,s){const o=new du(e,t,r,n,a,i);return s&&(o.ja=!0),o}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){var e,t;await async function(e){const t=Qr(e);Wr(pc,"RemoteStore shutting down."),t.W_.add(5),await vc(t),t.z_.shutdown(),t.j_.set("Unknown")}(this.remoteStore),null===(e=this.datastore)||void 0===e||e.terminate(),null===(t=this.eventManager)||void 0===t||t.terminate()}}Vu.provider={build:()=>new Vu};class Bu{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.iu(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.iu(this.observer.error,e):Gr("Uncaught Error in snapshot listener:",e.toString()))}su(){this.muted=!0}iu(e,t){setTimeout((()=>{this.muted||e(t)}),0)}}const zu="FirestoreClient";class ju{constructor(e,t,r,n,a){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=r,this.databaseInfo=n,this.user=zr.UNAUTHENTICATED,this.clientId=fn.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=a,this.authCredentials.start(r,(async e=>{Wr(zu,"Received user=",e.uid),await this.authCredentialListener(e),this.user=e})),this.appCheckCredentials.start(r,(e=>(Wr(zu,"Received new app check token=",e),this.appCheckCredentialListener(e,this.user))))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new en;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const r=Gc(t,"Failed to shutdown persistence");e.reject(r)}})),e.promise}}async function Hu(e,t){e.asyncQueue.verifyOperationInProgress(),Wr(zu,"Initializing OfflineComponentProvider");const r=e.configuration;await t.initialize(r);let n=r.initialUser;e.setCredentialChangeListener((async e=>{n.isEqual(e)||(await Fl(t.localStore,e),n=e)})),t.persistence.setDatabaseDeletedListener((()=>e.terminate())),e._offlineComponents=t}async function $u(e,t){e.asyncQueue.verifyOperationInProgress();const r=await Wu(e);Wr(zu,"Initializing OnlineComponentProvider"),await t.initialize(r,e.configuration),e.setCredentialChangeListener((e=>zc(t.remoteStore,e))),e.setAppCheckTokenChangeListener(((e,r)=>zc(t.remoteStore,r))),e._onlineComponents=t}async function Wu(e){if(!e._offlineComponents)if(e._uninitializedComponentsProvider){Wr(zu,"Using user provided OfflineComponentProvider");try{await Hu(e,e._uninitializedComponentsProvider._offline)}catch(t){const r=t;if(!function(e){return"FirebaseError"===e.name?e.code===Jr.FAILED_PRECONDITION||e.code===Jr.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&e instanceof DOMException)||22===e.code||20===e.code||11===e.code}(r))throw r;Kr("Error using user provided cache. Falling back to memory cache: "+r),await Hu(e,new Fu)}}else Wr(zu,"Using default OfflineComponentProvider"),await Hu(e,new Uu(void 0));return e._offlineComponents}async function Gu(e){return e._onlineComponents||(e._uninitializedComponentsProvider?(Wr(zu,"Using user provided OnlineComponentProvider"),await $u(e,e._uninitializedComponentsProvider._online)):(Wr(zu,"Using default OnlineComponentProvider"),await $u(e,new Vu))),e._onlineComponents}function Ku(e){return Gu(e).then((e=>e.syncEngine))}async function qu(e){const t=await Gu(e),r=t.eventManager;return r.onListen=pu.bind(null,t.syncEngine),r.onUnlisten=yu.bind(null,t.syncEngine),r.onFirstRemoteStoreListen=mu.bind(null,t.syncEngine),r.onLastRemoteStoreUnlisten=bu.bind(null,t.syncEngine),r}function Xu(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const n=new en;return e.asyncQueue.enqueueAndForget((async()=>function(e,t,r,n,a){const i=new Bu({next:r=>{i.su(),t.enqueueAndForget((()=>eu(e,s))),r.fromCache&&"server"===n.source?a.reject(new Zr(Jr.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):a.resolve(r)},error:e=>a.reject(e)}),s=new su(r,i,{includeMetadataChanges:!0,Ta:!0});return Zc(e,s)}(await qu(e),e.asyncQueue,t,r,n))),n.promise}function Yu(e){const t={};return void 0!==e.timeoutSeconds&&(t.timeoutSeconds=e.timeoutSeconds),t}const Qu=new Map;function Ju(e,t,r){if(!r)throw new Zr(Jr.INVALID_ARGUMENT,`Function ${e}() cannot be called with an empty ${t}.`)}function Zu(e){if(!In.isDocumentKey(e))throw new Zr(Jr.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${e} has ${e.length}.`)}function eh(e){if(In.isDocumentKey(e))throw new Zr(Jr.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${e} has ${e.length}.`)}function th(e){if(void 0===e)return"undefined";if(null===e)return"null";if("string"==typeof e)return e.length>20&&(e=`${e.substring(0,20)}...`),JSON.stringify(e);if("number"==typeof e||"boolean"==typeof e)return""+e;if("object"==typeof e){if(e instanceof Array)return"an array";{const t=function(e){return e.constructor?e.constructor.name:null}(e);return t?`a custom ${t} object`:"an object"}}return"function"==typeof e?"a function":Xr()}function rh(e,t){if("_delegate"in e&&(e=e._delegate),!(e instanceof t)){if(t.name===e.constructor.name)throw new Zr(Jr.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const r=th(e);throw new Zr(Jr.INVALID_ARGUMENT,`Expected type '${t.name}', but it was: ${r}`)}}return e}const nh="firestore.googleapis.com",ah=!0;class ih{constructor(e){var t,r;if(void 0===e.host){if(void 0!==e.ssl)throw new Zr(Jr.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=nh,this.ssl=ah}else this.host=e.host,this.ssl=null!==(t=e.ssl)&&void 0!==t?t:ah;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,void 0===e.cacheSizeBytes)this.cacheSizeBytes=il;else{if(-1!==e.cacheSizeBytes&&e.cacheSizeBytes<cl)throw new Zr(Jr.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}(function(e,t,r,n){if(!0===t&&!0===n)throw new Zr(Jr.INVALID_ARGUMENT,`${e} and ${r} cannot be used together.`)})("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:void 0===e.experimentalAutoDetectLongPolling?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=Yu(null!==(r=e.experimentalLongPollingOptions)&&void 0!==r?r:{}),function(e){if(void 0!==e.timeoutSeconds){if(isNaN(e.timeoutSeconds))throw new Zr(Jr.INVALID_ARGUMENT,`invalid long polling timeout: ${e.timeoutSeconds} (must not be NaN)`);if(e.timeoutSeconds<5)throw new Zr(Jr.INVALID_ARGUMENT,`invalid long polling timeout: ${e.timeoutSeconds} (minimum allowed value is 5)`);if(e.timeoutSeconds>30)throw new Zr(Jr.INVALID_ARGUMENT,`invalid long polling timeout: ${e.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(e,t){return e.timeoutSeconds===t.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class sh{constructor(e,t,r,n){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=r,this._app=n,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new ih({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new Zr(Jr.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return"notTerminated"!==this._terminateTask}_setSettings(e){if(this._settingsFrozen)throw new Zr(Jr.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new ih(e),this._emulatorOptions=e.emulatorOptions||{},void 0!==e.credentials&&(this._authCredentials=function(e){if(!e)return new rn;switch(e.type){case"firstParty":return new on(e.sessionIndex||"0",e.iamToken||null,e.authTokenFactory||null);case"provider":return e.client;default:throw new Zr(Jr.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return"notTerminated"===this._terminateTask&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){"notTerminated"===this._terminateTask?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(e){const t=Qu.get(e);t&&(Wr("ComponentProvider","Removing Datastore"),Qu.delete(e),t.terminate())}(this),Promise.resolve()}}function oh(e,t,r){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};var a;const i=(e=rh(e,sh))._getSettings(),s=Object.assign(Object.assign({},i),{emulatorOptions:e._getEmulatorOptions()}),o=`${t}:${r}`;i.host!==nh&&i.host!==o&&Kr("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const l=Object.assign(Object.assign({},i),{host:o,ssl:!1,emulatorOptions:n});if(!He(l,s)&&(e._setSettings(l),n.mockUserToken)){let t,r;if("string"==typeof n.mockUserToken)t=n.mockUserToken,r=zr.MOCK_USER;else{t=function(e,t){if(e.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const r=t||"demo-project",n=e.iat||0,a=e.sub||e.user_id;if(!a)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const i=Object.assign({iss:`https://securetoken.google.com/${r}`,aud:r,iat:n,exp:n+3600,auth_time:n,sub:a,user_id:a,firebase:{sign_in_provider:"custom",identities:{}}},e);return[Re(JSON.stringify({alg:"none",type:"JWT"})),Re(JSON.stringify(i)),""].join(".")}(n.mockUserToken,null===(a=e._app)||void 0===a?void 0:a.options.projectId);const i=n.mockUserToken.sub||n.mockUserToken.user_id;if(!i)throw new Zr(Jr.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");r=new zr(i)}e._authCredentials=new nn(new tn(t,r))}}class lh{constructor(e,t,r){this.converter=t,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new lh(this.firestore,e,this._query)}}class ch{constructor(e,t,r){this.converter=t,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new uh(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new ch(this.firestore,e,this._key)}}class uh extends lh{constructor(e,t,r){super(e,t,$i(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new ch(this.firestore,null,new In(e))}withConverter(e){return new uh(this.firestore,e,this._path)}}function hh(e,t){for(var r=arguments.length,n=new Array(r>2?r-2:0),a=2;a<r;a++)n[a-2]=arguments[a];if(e=Ye(e),Ju("collection","path",t),e instanceof sh){const r=Sn.fromString(t,...n);return eh(r),new uh(e,null,r)}{if(!(e instanceof ch||e instanceof uh))throw new Zr(Jr.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=e._path.child(Sn.fromString(t,...n));return eh(r),new uh(e.firestore,null,r)}}function fh(e,t){for(var r=arguments.length,n=new Array(r>2?r-2:0),a=2;a<r;a++)n[a-2]=arguments[a];if(e=Ye(e),1===arguments.length&&(t=fn.newId()),Ju("doc","path",t),e instanceof sh){const r=Sn.fromString(t,...n);return Zu(r),new ch(e,null,new In(r))}{if(!(e instanceof ch||e instanceof uh))throw new Zr(Jr.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=e._path.child(Sn.fromString(t,...n));return Zu(r),new ch(e.firestore,e instanceof uh?e.converter:null,new In(r))}}const dh="AsyncQueue";class ph{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Promise.resolve();this.Vu=[],this.mu=!1,this.fu=[],this.gu=null,this.pu=!1,this.yu=!1,this.wu=[],this.a_=new sc(this,"async_queue_retry"),this.Su=()=>{const e=ac();e&&Wr(dh,"Visibility state changed to "+e.visibilityState),this.a_.t_()},this.bu=e;const t=ac();t&&"function"==typeof t.addEventListener&&t.addEventListener("visibilitychange",this.Su)}get isShuttingDown(){return this.mu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.Du(),this.vu(e)}enterRestrictedMode(e){if(!this.mu){this.mu=!0,this.yu=e||!1;const t=ac();t&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this.Su)}}enqueue(e){if(this.Du(),this.mu)return new Promise((()=>{}));const t=new en;return this.vu((()=>this.mu&&this.yu?Promise.resolve():(e().then(t.resolve,t.reject),t.promise))).then((()=>t.promise))}enqueueRetryable(e){this.enqueueAndForget((()=>(this.Vu.push(e),this.Cu())))}async Cu(){if(0!==this.Vu.length){try{await this.Vu[0](),this.Vu.shift(),this.a_.reset()}catch(Ok){if(!Vn(Ok))throw Ok;Wr(dh,"Operation failed with retryable error: "+Ok)}this.Vu.length>0&&this.a_.Xo((()=>this.Cu()))}}vu(e){const t=this.bu.then((()=>(this.pu=!0,e().catch((e=>{this.gu=e,this.pu=!1;const t=function(e){let t=e.message||"";return e.stack&&(t=e.stack.includes(e.message)?e.stack:e.message+"\n"+e.stack),t}(e);throw Gr("INTERNAL UNHANDLED ERROR: ",t),e})).then((e=>(this.pu=!1,e))))));return this.bu=t,t}enqueueAfterDelay(e,t,r){this.Du(),this.wu.indexOf(e)>-1&&(t=0);const n=Wc.createAndSchedule(this,e,t,r,(e=>this.Fu(e)));return this.fu.push(n),n}Du(){this.gu&&Xr()}verifyOperationInProgress(){}async Mu(){let e;do{e=this.bu,await e}while(e!==this.bu)}xu(e){for(const t of this.fu)if(t.timerId===e)return!0;return!1}Ou(e){return this.Mu().then((()=>{this.fu.sort(((e,t)=>e.targetTimeMs-t.targetTimeMs));for(const t of this.fu)if(t.skipDelay(),"all"!==e&&t.timerId===e)break;return this.Mu()}))}Nu(e){this.wu.push(e)}Fu(e){const t=this.fu.indexOf(e);this.fu.splice(t,1)}}class mh extends sh{constructor(e,t,r,n){super(e,t,r,n),this.type="firestore",this._queue=new ph,this._persistenceKey=(null==n?void 0:n.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new ph(e),this._firestoreClient=void 0,await e}}}function gh(e){if(e._terminated)throw new Zr(Jr.FAILED_PRECONDITION,"The client has already been terminated.");return e._firestoreClient||vh(e),e._firestoreClient}function vh(e){var t,r,n;const a=e._freezeSettings(),i=function(e,t,r,n){return new Ba(e,t,r,n.host,n.ssl,n.experimentalForceLongPolling,n.experimentalAutoDetectLongPolling,Yu(n.experimentalLongPollingOptions),n.useFetchStreams)}(e._databaseId,(null===(t=e._app)||void 0===t?void 0:t.options.appId)||"",e._persistenceKey,a);e._componentsProvider||(null===(r=a.localCache)||void 0===r?void 0:r._offlineComponentProvider)&&(null===(n=a.localCache)||void 0===n?void 0:n._onlineComponentProvider)&&(e._componentsProvider={_offline:a.localCache._offlineComponentProvider,_online:a.localCache._onlineComponentProvider}),e._firestoreClient=new ju(e._authCredentials,e._appCheckCredentials,e._queue,i,e._componentsProvider&&function(e){const t=null==e?void 0:e._online.build();return{_offline:null==e?void 0:e._offline.build(t),_online:t}}(e._componentsProvider))}class yh{constructor(e){this._byteString=e}static fromBase64String(e){try{return new yh(Aa.fromBase64String(e))}catch(e){throw new Zr(Jr.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+e)}}static fromUint8Array(e){return new yh(Aa.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}class bh{constructor(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];for(let n=0;n<t.length;++n)if(0===t[n].length)throw new Zr(Jr.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Cn(t)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}class wh{constructor(e){this._methodName=e}}class Eh{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new Zr(Jr.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new Zr(Jr.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return dn(this._lat,e._lat)||dn(this._long,e._long)}}class Th{constructor(e){this._values=(e||[]).map((e=>e))}toArray(){return this._values.map((e=>e))}isEqual(e){return function(e,t){if(e.length!==t.length)return!1;for(let r=0;r<e.length;++r)if(e[r]!==t[r])return!1;return!0}(this._values,e._values)}}const _h=/^__.*__$/;class Sh{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return null!==this.fieldMask?new $s(e,this.data,this.fieldMask,t,this.fieldTransforms):new Hs(e,this.data,t,this.fieldTransforms)}}class kh{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return new $s(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function Ch(e){switch(e){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Xr()}}class Ih{constructor(e,t,r,n,a,i){this.settings=e,this.databaseId=t,this.serializer=r,this.ignoreUndefinedProperties=n,void 0===a&&this.Bu(),this.fieldTransforms=a||[],this.fieldMask=i||[]}get path(){return this.settings.path}get Lu(){return this.settings.Lu}ku(e){return new Ih(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}qu(e){var t;const r=null===(t=this.path)||void 0===t?void 0:t.child(e),n=this.ku({path:r,Qu:!1});return n.$u(e),n}Uu(e){var t;const r=null===(t=this.path)||void 0===t?void 0:t.child(e),n=this.ku({path:r,Qu:!1});return n.Bu(),n}Ku(e){return this.ku({path:void 0,Qu:!0})}Wu(e){return jh(e,this.settings.methodName,this.settings.Gu||!1,this.path,this.settings.zu)}contains(e){return void 0!==this.fieldMask.find((t=>e.isPrefixOf(t)))||void 0!==this.fieldTransforms.find((t=>e.isPrefixOf(t.field)))}Bu(){if(this.path)for(let e=0;e<this.path.length;e++)this.$u(this.path.get(e))}$u(e){if(0===e.length)throw this.Wu("Document fields must not be empty");if(Ch(this.Lu)&&_h.test(e))throw this.Wu('Document fields cannot begin and end with "__"')}}class Ah{constructor(e,t,r){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=r||ic(e)}ju(e,t,r){let n=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return new Ih({Lu:e,methodName:t,zu:r,path:Cn.emptyPath(),Qu:!1,Gu:n},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Rh(e){const t=e._freezeSettings(),r=ic(e._databaseId);return new Ah(e._databaseId,!!t.ignoreUndefinedProperties,r)}function Nh(e,t,r,n,a){let i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{};const s=e.ju(i.merge||i.mergeFields?2:0,t,r,a);Uh("Data must be an object, but it was:",s,n);const o=Mh(n,s);let l,c;if(i.merge)l=new Ca(s.fieldMask),c=s.fieldTransforms;else if(i.mergeFields){const e=[];for(const n of i.mergeFields){const a=Vh(t,n,r);if(!s.contains(a))throw new Zr(Jr.INVALID_ARGUMENT,`Field '${a}' is specified in your field mask but missing from your input data.`);Hh(e,a)||e.push(a)}l=new Ca(e),c=s.fieldTransforms.filter((e=>l.covers(e.field)))}else l=null,c=s.fieldTransforms;return new Sh(new fi(o),l,c)}class Oh extends wh{_toFieldTransform(e){if(2!==e.Lu)throw 1===e.Lu?e.Wu(`${this._methodName}() can only appear at the top level of your update data`):e.Wu(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof Oh}}function xh(e,t,r,n){const a=e.ju(1,t,r);Uh("Data must be an object, but it was:",a,n);const i=[],s=fi.empty();ba(n,((e,n)=>{const o=zh(t,e,r);n=Ye(n);const l=a.Uu(o);if(n instanceof Oh)i.push(o);else{const e=Lh(n,l);null!=e&&(i.push(o),s.set(o,e))}}));const o=new Ca(i);return new kh(s,o,a.fieldTransforms)}function Ph(e,t,r,n,a,i){const s=e.ju(1,t,r),o=[Vh(t,n,r)],l=[a];if(i.length%2!=0)throw new Zr(Jr.INVALID_ARGUMENT,`Function ${t}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let f=0;f<i.length;f+=2)o.push(Vh(t,i[f])),l.push(i[f+1]);const c=[],u=fi.empty();for(let f=o.length-1;f>=0;--f)if(!Hh(c,o[f])){const e=o[f];let t=l[f];t=Ye(t);const r=s.Uu(e);if(t instanceof Oh)c.push(e);else{const n=Lh(t,r);null!=n&&(c.push(e),u.set(e,n))}}const h=new Ca(c);return new kh(u,h,s.fieldTransforms)}function Dh(e,t,r){let n=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return Lh(r,e.ju(n?4:3,t))}function Lh(e,t){if(Fh(e=Ye(e)))return Uh("Unsupported field value:",t,e),Mh(e,t);if(e instanceof wh)return function(e,t){if(!Ch(t.Lu))throw t.Wu(`${e._methodName}() can only be used with update() and set()`);if(!t.path)throw t.Wu(`${e._methodName}() is not currently supported inside arrays`);const r=e._toFieldTransform(t);r&&t.fieldTransforms.push(r)}(e,t),null;if(void 0===e&&t.ignoreUndefinedProperties)return null;if(t.path&&t.fieldMask.push(t.path),e instanceof Array){if(t.settings.Qu&&4!==t.Lu)throw t.Wu("Nested arrays are not supported");return function(e,t){const r=[];let n=0;for(const a of e){let e=Lh(a,t.Ku(n));null==e&&(e={nullValue:"NULL_VALUE"}),r.push(e),n++}return{arrayValue:{values:r}}}(e,t)}return function(e,t){if(null===(e=Ye(e)))return{nullValue:"NULL_VALUE"};if("number"==typeof e)return Es(t.serializer,e);if("boolean"==typeof e)return{booleanValue:e};if("string"==typeof e)return{stringValue:e};if(e instanceof Date){const r=wn.fromDate(e);return{timestampValue:ko(t.serializer,r)}}if(e instanceof wn){const r=new wn(e.seconds,1e3*Math.floor(e.nanoseconds/1e3));return{timestampValue:ko(t.serializer,r)}}if(e instanceof Eh)return{geoPointValue:{latitude:e.latitude,longitude:e.longitude}};if(e instanceof yh)return{bytesValue:Co(t.serializer,e._byteString)};if(e instanceof ch){const r=t.databaseId,n=e.firestore._databaseId;if(!n.isEqual(r))throw t.Wu(`Document reference is for database ${n.projectId}/${n.database} but should be for database ${r.projectId}/${r.database}`);return{referenceValue:Ro(e.firestore._databaseId||t.databaseId,e._key.path)}}if(e instanceof Th)return function(e,t){return{mapValue:{fields:{[Ha]:{stringValue:Ga},[Ka]:{arrayValue:{values:e.toArray().map((e=>{if("number"!=typeof e)throw t.Wu("VectorValues must only contain numeric values.");return bs(t.serializer,e)}))}}}}}}(e,t);throw t.Wu(`Unsupported field value: ${th(e)}`)}(e,t)}function Mh(e,t){const r={};return wa(e)?t.path&&t.path.length>0&&t.fieldMask.push(t.path):ba(e,((e,n)=>{const a=Lh(n,t.qu(e));null!=a&&(r[e]=a)})),{mapValue:{fields:r}}}function Fh(e){return!("object"!=typeof e||null===e||e instanceof Array||e instanceof Date||e instanceof wn||e instanceof Eh||e instanceof yh||e instanceof ch||e instanceof wh||e instanceof Th)}function Uh(e,t,r){if(!Fh(r)||!function(e){return"object"==typeof e&&null!==e&&(Object.getPrototypeOf(e)===Object.prototype||null===Object.getPrototypeOf(e))}(r)){const n=th(r);throw"an object"===n?t.Wu(e+" a custom object"):t.Wu(e+" "+n)}}function Vh(e,t,r){if((t=Ye(t))instanceof bh)return t._internalPath;if("string"==typeof t)return zh(e,t);throw jh("Field path arguments must be of type string or ",e,!1,void 0,r)}const Bh=new RegExp("[~\\*/\\[\\]]");function zh(e,t,r){if(t.search(Bh)>=0)throw jh(`Invalid field path (${t}). Paths must not contain '~', '*', '/', '[', or ']'`,e,!1,void 0,r);try{return new bh(...t.split("."))._internalPath}catch(n){throw jh(`Invalid field path (${t}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,e,!1,void 0,r)}}function jh(e,t,r,n,a){const i=n&&!n.isEmpty(),s=void 0!==a;let o=`Function ${t}() called with invalid data`;r&&(o+=" (via `toFirestore()`)"),o+=". ";let l="";return(i||s)&&(l+=" (found",i&&(l+=` in field ${n}`),s&&(l+=` in document ${a}`),l+=")"),new Zr(Jr.INVALID_ARGUMENT,o+e+l)}function Hh(e,t){return e.some((e=>e.isEqual(t)))}class $h{constructor(e,t,r,n,a){this._firestore=e,this._userDataWriter=t,this._key=r,this._document=n,this._converter=a}get id(){return this._key.path.lastSegment()}get ref(){return new ch(this._firestore,this._converter,this._key)}exists(){return null!==this._document}data(){if(this._document){if(this._converter){const e=new Wh(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(Gh("DocumentSnapshot.get",e));if(null!==t)return this._userDataWriter.convertValue(t)}}}class Wh extends $h{data(){return super.data()}}function Gh(e,t){return"string"==typeof t?zh(e,t):t instanceof bh?t._internalPath:t._delegate._internalPath}function Kh(e){if("L"===e.limitType&&0===e.explicitOrderBy.length)throw new Zr(Jr.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class qh{}class Xh extends qh{}function Yh(e,t){let r=[];for(var n=arguments.length,a=new Array(n>2?n-2:0),i=2;i<n;i++)a[i-2]=arguments[i];t instanceof qh&&r.push(t),r=r.concat(a),function(e){const t=e.filter((e=>e instanceof Zh)).length,r=e.filter((e=>e instanceof Qh)).length;if(t>1||t>0&&r>0)throw new Zr(Jr.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(const s of r)e=s._apply(e);return e}class Qh extends Xh{constructor(e,t,r){super(),this._field=e,this._op=t,this._value=r,this.type="where"}static _create(e,t,r){return new Qh(e,t,r)}_apply(e){const t=this._parse(e);return rf(e._query,t),new lh(e.firestore,e.converter,Yi(e._query,t))}_parse(e){const t=Rh(e.firestore),r=function(e,t,r,n,a,i,s){let o;if(a.isKeyField()){if("array-contains"===i||"array-contains-any"===i)throw new Zr(Jr.INVALID_ARGUMENT,`Invalid Query. You can't perform '${i}' queries on documentId().`);if("in"===i||"not-in"===i){tf(s,i);const t=[];for(const r of s)t.push(ef(n,e,r));o={arrayValue:{values:t}}}else o=ef(n,e,s)}else"in"!==i&&"not-in"!==i&&"array-contains-any"!==i||tf(s,i),o=Dh(r,t,s,"in"===i||"not-in"===i);return Ei.create(a,i,o)}(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value);return r}}function Jh(e,t,r){const n=t,a=Gh("where",e);return Qh._create(a,n,r)}class Zh extends qh{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new Zh(e,t)}_parse(e){const t=this._queryConstraints.map((t=>t._parse(e))).filter((e=>e.getFilters().length>0));return 1===t.length?t[0]:Ti.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return 0===t.getFilters().length?e:(function(e,t){let r=e;const n=t.getFlattenedFilters();for(const a of n)rf(r,a),r=Yi(r,a)}(e._query,t),new lh(e.firestore,e.converter,Yi(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return"and"===this.type?"and":"or"}}function ef(e,t,r){if("string"==typeof(r=Ye(r))){if(""===r)throw new Zr(Jr.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!Gi(t)&&-1!==r.indexOf("/"))throw new Zr(Jr.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${r}' contains a '/' character.`);const n=t.path.child(Sn.fromString(r));if(!In.isDocumentKey(n))throw new Zr(Jr.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${n}' is not because it has an odd number of segments (${n.length}).`);return ni(e,new In(n))}if(r instanceof ch)return ni(e,r._key);throw new Zr(Jr.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${th(r)}.`)}function tf(e,t){if(!Array.isArray(e)||0===e.length)throw new Zr(Jr.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${t.toString()}' filters.`)}function rf(e,t){const r=function(e,t){for(const r of e)for(const e of r.getFlattenedFilters())if(t.indexOf(e.op)>=0)return e.op;return null}(e.filters,function(e){switch(e){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(t.op));if(null!==r)throw r===t.op?new Zr(Jr.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${t.op.toString()}' filter.`):new Zr(Jr.INVALID_ARGUMENT,`Invalid query. You cannot use '${t.op.toString()}' filters with '${r.toString()}' filters.`)}class nf{convertValue(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"none";switch(qa(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Oa(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(xa(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw Xr()}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"none";const r={};return ba(e,((e,n)=>{r[e]=this.convertValue(n,t)})),r}convertVectorValue(e){var t,r,n;const a=null===(n=null===(r=null===(t=e.fields)||void 0===t?void 0:t[Ka].arrayValue)||void 0===r?void 0:r.values)||void 0===n?void 0:n.map((e=>Oa(e.doubleValue)));return new Th(a)}convertGeoPoint(e){return new Eh(Oa(e.latitude),Oa(e.longitude))}convertArray(e,t){return(e.values||[]).map((e=>this.convertValue(e,t)))}convertServerTimestamp(e,t){switch(t){case"previous":const r=Ua(e);return null==r?null:this.convertValue(r,t);case"estimate":return this.convertTimestamp(Va(e));default:return null}}convertTimestamp(e){const t=Na(e);return new wn(t.seconds,t.nanos)}convertDocumentKey(e,t){const r=Sn.fromString(e);Yr(Qo(r));const n=new ja(r.get(1),r.get(3)),a=new In(r.popFirst(5));return n.isEqual(t)||Gr(`Document ${a} contains a document reference within a different database (${n.projectId}/${n.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),a}}function af(e,t,r){let n;return n=e?r&&(r.merge||r.mergeFields)?e.toFirestore(t,r):e.toFirestore(t):t,n}class sf{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class of extends $h{constructor(e,t,r,n,a,i){super(e,t,r,n,i),this._firestore=e,this._firestoreImpl=e,this.metadata=a}exists(){return super.exists()}data(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(this._document){if(this._converter){const t=new lf(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(this._document){const r=this._document.data.field(Gh("DocumentSnapshot.get",e));if(null!==r)return this._userDataWriter.convertValue(r,t.serverTimestamps)}}}class lf extends of{data(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return super.data(e)}}class cf{constructor(e,t,r,n){this._firestore=e,this._userDataWriter=t,this._snapshot=n,this.metadata=new sf(n.hasPendingWrites,n.fromCache),this.query=r}get docs(){const e=[];return this.forEach((t=>e.push(t))),e}get size(){return this._snapshot.docs.size}get empty(){return 0===this.size}forEach(e,t){this._snapshot.docs.forEach((r=>{e.call(t,new lf(this._firestore,this._userDataWriter,r.key,r,new sf(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(){const e=!!(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).includeMetadataChanges;if(e&&this._snapshot.excludesMetadataChanges)throw new Zr(Jr.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===e||(this._cachedChanges=function(e,t){if(e._snapshot.oldDocs.isEmpty()){let t=0;return e._snapshot.docChanges.map((r=>{const n=new lf(e._firestore,e._userDataWriter,r.doc.key,r.doc,new sf(e._snapshot.mutatedKeys.has(r.doc.key),e._snapshot.fromCache),e.query.converter);return r.doc,{type:"added",doc:n,oldIndex:-1,newIndex:t++}}))}{let r=e._snapshot.oldDocs;return e._snapshot.docChanges.filter((e=>t||3!==e.type)).map((t=>{const n=new lf(e._firestore,e._userDataWriter,t.doc.key,t.doc,new sf(e._snapshot.mutatedKeys.has(t.doc.key),e._snapshot.fromCache),e.query.converter);let a=-1,i=-1;return 0!==t.type&&(a=r.indexOf(t.doc.key),r=r.delete(t.doc.key)),1!==t.type&&(r=r.add(t.doc),i=r.indexOf(t.doc.key)),{type:uf(t.type),doc:n,oldIndex:a,newIndex:i}}))}}(this,e),this._cachedChangesIncludeMetadataChanges=e),this._cachedChanges}}function uf(e){switch(e){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Xr()}}class hf extends nf{constructor(e){super(),this.firestore=e}convertBytes(e){return new yh(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new ch(this.firestore,null,t)}}function ff(e){e=rh(e,lh);const t=rh(e.firestore,mh),r=gh(t),n=new hf(t);return Kh(e._query),Xu(r,e._query).then((r=>new cf(t,n,e,r)))}function df(e,t){return function(e,t){const r=new en;return e.asyncQueue.enqueueAndForget((async()=>async function(e,t,r){const n=Mu(e);try{const e=await function(e,t){const r=Qr(e),n=wn.now(),a=t.reduce(((e,t)=>e.add(t.key)),gs());let i,s;return r.persistence.runTransaction("Locally write mutations","readwrite",(e=>{let o=os(),l=gs();return r.ds.getEntries(e,a).next((e=>{o=e,o.forEach(((e,t)=>{t.isValidDocument()||(l=l.add(e))}))})).next((()=>r.localDocuments.getOverlayedDocuments(e,o))).next((a=>{i=a;const s=[];for(const e of t){const t=zs(e,i.get(e.key).overlayedDocument);null!=t&&s.push(new $s(e.key,t,di(t.value.mapValue),Ls.exists(!0)))}return r.mutationQueue.addMutationBatch(e,n,s,t)})).next((t=>{s=t;const n=t.applyToLocalDocumentSet(i,l);return r.documentOverlayCache.saveOverlays(e,t.batchId,n)}))})).then((()=>({batchId:s.batchId,changes:us(i)})))}(n.localStore,t);n.sharedClientState.addPendingMutation(e.batchId),function(e,t,r){let n=e.Wa[e.currentUser.toKey()];n||(n=new Ea(dn)),n=n.insert(t,r),e.Wa[e.currentUser.toKey()]=n}(n,e.batchId,r),await xu(n,e.changes),await xc(n.remoteStore)}catch(e){const t=Gc(e,"Failed to persist write");r.reject(t)}}(await Ku(e),t,r))),r.promise}(gh(e),t)}class pf{constructor(e,t){this._firestore=e,this._commitHandler=t,this._mutations=[],this._committed=!1,this._dataReader=Rh(e)}set(e,t,r){this._verifyNotCommitted();const n=mf(e,this._firestore),a=af(n.converter,t,r),i=Nh(this._dataReader,"WriteBatch.set",n._key,a,null!==n.converter,r);return this._mutations.push(i.toMutation(n._key,Ls.none())),this}update(e,t,r){this._verifyNotCommitted();const n=mf(e,this._firestore);let a;for(var i=arguments.length,s=new Array(i>3?i-3:0),o=3;o<i;o++)s[o-3]=arguments[o];return a="string"==typeof(t=Ye(t))||t instanceof bh?Ph(this._dataReader,"WriteBatch.update",n._key,t,r,s):xh(this._dataReader,"WriteBatch.update",n._key,t),this._mutations.push(a.toMutation(n._key,Ls.exists(!0))),this}delete(e){this._verifyNotCommitted();const t=mf(e,this._firestore);return this._mutations=this._mutations.concat(new qs(t._key,Ls.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new Zr(Jr.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}function mf(e,t){if((e=Ye(e)).firestore!==t)throw new Zr(Jr.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return e}new WeakMap;!function(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];!function(e){jr=e}(hr),sr(new Qe("firestore",((e,r)=>{let{instanceIdentifier:n,options:a}=r;const i=e.getProvider("app").getImmediate(),s=new mh(new an(e.getProvider("auth-internal")),new cn(i,e.getProvider("app-check-internal")),function(e,t){if(!Object.prototype.hasOwnProperty.apply(e.options,["projectId"]))throw new Zr(Jr.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new ja(e.options.projectId,t)}(i,n),i);return a=Object.assign({useFetchStreams:t},a),s._setSettings(a),s}),"PUBLIC").setMultipleInstances(!0)),pr(Vr,Br,e),pr(Vr,Br,"esm2017")}();function gf(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var a=0;for(n=Object.getOwnPropertySymbols(e);a<n.length;a++)t.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(e,n[a])&&(r[n[a]]=e[n[a]])}return r}Object.create;Object.create;"function"===typeof SuppressedError&&SuppressedError;function vf(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const yf=vf,bf=new ze("auth","Firebase",{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}),wf=new ot("@firebase/auth");function Ef(e){if(wf.logLevel<=rt.ERROR){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];wf.error(`Auth (${hr}): ${e}`,...r)}}function Tf(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];throw Cf(e,...r)}function _f(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];return Cf(e,...r)}function Sf(e,t,r){const n=Object.assign(Object.assign({},yf()),{[t]:r});return new ze("auth","Firebase",n).create(t,{appName:e.name})}function kf(e){return Sf(e,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function Cf(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];if("string"!==typeof e){const t=r[0],n=[...r.slice(1)];return n[0]&&(n[0].appName=e.name),e._errorFactory.create(t,...n)}return bf.create(e,...r)}function If(e,t){if(!e){for(var r=arguments.length,n=new Array(r>2?r-2:0),a=2;a<r;a++)n[a-2]=arguments[a];throw Cf(t,...n)}}function Af(e){const t="INTERNAL ASSERTION FAILED: "+e;throw Ef(t),new Error(t)}function Rf(e,t){e||Af(t)}function Nf(){var e;return"undefined"!==typeof self&&(null===(e=self.location)||void 0===e?void 0:e.href)||""}function Of(){return"http:"===xf()||"https:"===xf()}function xf(){var e;return"undefined"!==typeof self&&(null===(e=self.location)||void 0===e?void 0:e.protocol)||null}function Pf(){return!("undefined"!==typeof navigator&&navigator&&"onLine"in navigator&&"boolean"===typeof navigator.onLine&&(Of()||function(){const e="object"===typeof chrome?chrome.runtime:"object"===typeof browser?browser.runtime:void 0;return"object"===typeof e&&void 0!==e.id}()||"connection"in navigator))||navigator.onLine}class Df{constructor(e,t){this.shortDelay=e,this.longDelay=t,Rf(t>e,"Short delay should be less than long delay!"),this.isMobile="undefined"!==typeof window&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Fe())||"object"===typeof navigator&&"ReactNative"===navigator.product}get(){return Pf()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}function Lf(e,t){Rf(e.emulator,"Emulator should always be set here");const{url:r}=e.emulator;return t?`${r}${t.startsWith("/")?t.slice(1):t}`:r}class Mf{static initialize(e,t,r){this.fetchImpl=e,t&&(this.headersImpl=t),r&&(this.responseImpl=r)}static fetch(){return this.fetchImpl?this.fetchImpl:"undefined"!==typeof self&&"fetch"in self?self.fetch:"undefined"!==typeof globalThis&&globalThis.fetch?globalThis.fetch:"undefined"!==typeof fetch?fetch:void Af("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){return this.headersImpl?this.headersImpl:"undefined"!==typeof self&&"Headers"in self?self.Headers:"undefined"!==typeof globalThis&&globalThis.Headers?globalThis.Headers:"undefined"!==typeof Headers?Headers:void Af("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){return this.responseImpl?this.responseImpl:"undefined"!==typeof self&&"Response"in self?self.Response:"undefined"!==typeof globalThis&&globalThis.Response?globalThis.Response:"undefined"!==typeof Response?Response:void Af("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const Ff={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"},Uf=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],Vf=new Df(3e4,6e4);function Bf(e,t){return e.tenantId&&!t.tenantId?Object.assign(Object.assign({},t),{tenantId:e.tenantId}):t}async function zf(e,t,r,n){return jf(e,arguments.length>4&&void 0!==arguments[4]?arguments[4]:{},(async()=>{let a={},i={};n&&("GET"===t?i=n:a={body:JSON.stringify(n)});const s=We(Object.assign({key:e.config.apiKey},i)).slice(1),o=await e._getAdditionalHeaders();o["Content-Type"]="application/json",e.languageCode&&(o["X-Firebase-Locale"]=e.languageCode);const l=Object.assign({method:t,headers:o},a);return"undefined"!==typeof navigator&&"Cloudflare-Workers"===navigator.userAgent||(l.referrerPolicy="no-referrer"),Mf.fetch()(await $f(e,e.config.apiHost,r,s),l)}))}async function jf(e,t,r){e._canInitEmulator=!1;const n=Object.assign(Object.assign({},Ff),t);try{const t=new Gf(e),a=await Promise.race([r(),t.promise]);t.clearNetworkTimeout();const i=await a.json();if("needConfirmation"in i)throw Kf(e,"account-exists-with-different-credential",i);if(a.ok&&!("errorMessage"in i))return i;{const t=a.ok?i.errorMessage:i.error.message,[r,s]=t.split(" : ");if("FEDERATED_USER_ID_ALREADY_LINKED"===r)throw Kf(e,"credential-already-in-use",i);if("EMAIL_EXISTS"===r)throw Kf(e,"email-already-in-use",i);if("USER_DISABLED"===r)throw Kf(e,"user-disabled",i);const o=n[r]||r.toLowerCase().replace(/[_\s]+/g,"-");if(s)throw Sf(e,o,s);Tf(e,o)}}catch(Ok){if(Ok instanceof Be)throw Ok;Tf(e,"network-request-failed",{message:String(Ok)})}}async function Hf(e,t,r,n){let a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};const i=await zf(e,t,r,n,a);return"mfaPendingCredential"in i&&Tf(e,"multi-factor-auth-required",{_serverResponse:i}),i}async function $f(e,t,r,n){const a=`${t}${r}?${n}`,i=e,s=i.config.emulator?Lf(e.config,a):`${e.config.apiScheme}://${a}`;if(Uf.includes(r)&&(await i._persistenceManagerAvailable,"COOKIE"===i._getPersistenceType())){return i._getPersistence()._getFinalTarget(s).toString()}return s}function Wf(e){switch(e){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class Gf{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise(((e,t)=>{this.timer=setTimeout((()=>t(_f(this.auth,"network-request-failed"))),Vf.get())}))}}function Kf(e,t,r){const n={appName:e.name};r.email&&(n.email=r.email),r.phoneNumber&&(n.phoneNumber=r.phoneNumber);const a=_f(e,t,n);return a.customData._tokenResponse=r,a}function qf(e){return void 0!==e&&void 0!==e.enterprise}class Xf{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],void 0===e.recaptchaKey)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||0===this.recaptchaEnforcementState.length)return null;for(const t of this.recaptchaEnforcementState)if(t.provider&&t.provider===e)return Wf(t.enforcementState);return null}isProviderEnabled(e){return"ENFORCE"===this.getProviderEnforcementState(e)||"AUDIT"===this.getProviderEnforcementState(e)}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function Yf(e,t){return zf(e,"GET","/v2/recaptchaConfig",Bf(e,t))}async function Qf(e,t){return zf(e,"POST","/v1/accounts:lookup",t)}function Jf(e){if(e)try{const t=new Date(Number(e));if(!isNaN(t.getTime()))return t.toUTCString()}catch(Ok){}}function Zf(e){return 1e3*Number(e)}function ed(e){const[t,r,n]=e.split(".");if(void 0===t||void 0===r||void 0===n)return Ef("JWT malformed, contained fewer than 3 sections"),null;try{const e=Ne(r);return e?JSON.parse(e):(Ef("Failed to decode base64 JWT payload"),null)}catch(Ok){return Ef("Caught error parsing JWT payload as JSON",null===Ok||void 0===Ok?void 0:Ok.toString()),null}}function td(e){const t=ed(e);return If(t,"internal-error"),If("undefined"!==typeof t.exp,"internal-error"),If("undefined"!==typeof t.iat,"internal-error"),Number(t.exp)-Number(t.iat)}async function rd(e,t){if(arguments.length>2&&void 0!==arguments[2]&&arguments[2])return t;try{return await t}catch(Ok){throw Ok instanceof Be&&function(e){let{code:t}=e;return"auth/user-disabled"===t||"auth/user-token-expired"===t}(Ok)&&e.auth.currentUser===e&&await e.auth.signOut(),Ok}}class nd{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,null!==this.timerId&&clearTimeout(this.timerId))}getInterval(e){var t;if(e){const e=this.errorBackoff;return this.errorBackoff=Math.min(2*this.errorBackoff,96e4),e}{this.errorBackoff=3e4;const e=(null!==(t=this.user.stsTokenManager.expirationTime)&&void 0!==t?t:0)-Date.now()-3e5;return Math.max(0,e)}}schedule(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout((async()=>{await this.iteration()}),t)}async iteration(){try{await this.user.getIdToken(!0)}catch(Ok){return void("auth/network-request-failed"===(null===Ok||void 0===Ok?void 0:Ok.code)&&this.schedule(!0))}this.schedule()}}class ad{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=Jf(this.lastLoginAt),this.creationTime=Jf(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}async function id(e){var t;const r=e.auth,n=await e.getIdToken(),a=await rd(e,Qf(r,{idToken:n}));If(null===a||void 0===a?void 0:a.users.length,r,"internal-error");const i=a.users[0];e._notifyReloadListener(i);const s=(null===(t=i.providerUserInfo)||void 0===t?void 0:t.length)?sd(i.providerUserInfo):[],o=(l=e.providerData,c=s,[...l.filter((e=>!c.some((t=>t.providerId===e.providerId)))),...c]);var l,c;const u=e.isAnonymous,h=!(e.email&&i.passwordHash)&&!(null===o||void 0===o?void 0:o.length),f=!!u&&h,d={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:o,metadata:new ad(i.createdAt,i.lastLoginAt),isAnonymous:f};Object.assign(e,d)}function sd(e){return e.map((e=>{var{providerId:t}=e,r=gf(e,["providerId"]);return{providerId:t,uid:r.rawId||"",displayName:r.displayName||null,email:r.email||null,phoneNumber:r.phoneNumber||null,photoURL:r.photoUrl||null}}))}class od{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){If(e.idToken,"internal-error"),If("undefined"!==typeof e.idToken,"internal-error"),If("undefined"!==typeof e.refreshToken,"internal-error");const t="expiresIn"in e&&"undefined"!==typeof e.expiresIn?Number(e.expiresIn):td(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){If(0!==e.length,"internal-error");const t=td(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e){return arguments.length>1&&void 0!==arguments[1]&&arguments[1]||!this.accessToken||this.isExpired?(If(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null):this.accessToken}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:r,refreshToken:n,expiresIn:a}=await async function(e,t){const r=await jf(e,{},(async()=>{const r=We({grant_type:"refresh_token",refresh_token:t}).slice(1),{tokenApiHost:n,apiKey:a}=e.config,i=await $f(e,n,"/v1/token",`key=${a}`),s=await e._getAdditionalHeaders();return s["Content-Type"]="application/x-www-form-urlencoded",Mf.fetch()(i,{method:"POST",headers:s,body:r})}));return{accessToken:r.access_token,expiresIn:r.expires_in,refreshToken:r.refresh_token}}(e,t);this.updateTokensAndExpiration(r,n,Number(a))}updateTokensAndExpiration(e,t,r){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+1e3*r}static fromJSON(e,t){const{refreshToken:r,accessToken:n,expirationTime:a}=t,i=new od;return r&&(If("string"===typeof r,"internal-error",{appName:e}),i.refreshToken=r),n&&(If("string"===typeof n,"internal-error",{appName:e}),i.accessToken=n),a&&(If("number"===typeof a,"internal-error",{appName:e}),i.expirationTime=a),i}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new od,this.toJSON())}_performRefresh(){return Af("not implemented")}}function ld(e,t){If("string"===typeof e||"undefined"===typeof e,"internal-error",{appName:t})}class cd{constructor(e){var{uid:t,auth:r,stsTokenManager:n}=e,a=gf(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new nd(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=t,this.auth=r,this.stsTokenManager=n,this.accessToken=n.accessToken,this.displayName=a.displayName||null,this.email=a.email||null,this.emailVerified=a.emailVerified||!1,this.phoneNumber=a.phoneNumber||null,this.photoURL=a.photoURL||null,this.isAnonymous=a.isAnonymous||!1,this.tenantId=a.tenantId||null,this.providerData=a.providerData?[...a.providerData]:[],this.metadata=new ad(a.createdAt||void 0,a.lastLoginAt||void 0)}async getIdToken(e){const t=await rd(this,this.stsTokenManager.getToken(this.auth,e));return If(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return async function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const r=Ye(e),n=await r.getIdToken(t),a=ed(n);If(a&&a.exp&&a.auth_time&&a.iat,r.auth,"internal-error");const i="object"===typeof a.firebase?a.firebase:void 0,s=null===i||void 0===i?void 0:i.sign_in_provider;return{claims:a,token:n,authTime:Jf(Zf(a.auth_time)),issuedAtTime:Jf(Zf(a.iat)),expirationTime:Jf(Zf(a.exp)),signInProvider:s||null,signInSecondFactor:(null===i||void 0===i?void 0:i.sign_in_second_factor)||null}}(this,e)}reload(){return async function(e){const t=Ye(e);await id(t),await t.auth._persistUserIfCurrent(t),t.auth._notifyListenersIfCurrent(t)}(this)}_assign(e){this!==e&&(If(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map((e=>Object.assign({},e))),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new cd(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return t.metadata._copy(this.metadata),t}_onReload(e){If(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),t&&await id(this),await this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(lr(this.auth.app))return Promise.reject(kf(this.auth));const e=await this.getIdToken();return await rd(this,async function(e,t){return zf(e,"POST","/v1/accounts:delete",t)}(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map((e=>Object.assign({},e))),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){var r,n,a,i,s,o,l,c;const u=null!==(r=t.displayName)&&void 0!==r?r:void 0,h=null!==(n=t.email)&&void 0!==n?n:void 0,f=null!==(a=t.phoneNumber)&&void 0!==a?a:void 0,d=null!==(i=t.photoURL)&&void 0!==i?i:void 0,p=null!==(s=t.tenantId)&&void 0!==s?s:void 0,m=null!==(o=t._redirectEventId)&&void 0!==o?o:void 0,g=null!==(l=t.createdAt)&&void 0!==l?l:void 0,v=null!==(c=t.lastLoginAt)&&void 0!==c?c:void 0,{uid:y,emailVerified:b,isAnonymous:w,providerData:E,stsTokenManager:T}=t;If(y&&T,e,"internal-error");const _=od.fromJSON(this.name,T);If("string"===typeof y,e,"internal-error"),ld(u,e.name),ld(h,e.name),If("boolean"===typeof b,e,"internal-error"),If("boolean"===typeof w,e,"internal-error"),ld(f,e.name),ld(d,e.name),ld(p,e.name),ld(m,e.name),ld(g,e.name),ld(v,e.name);const S=new cd({uid:y,auth:e,email:h,emailVerified:b,displayName:u,isAnonymous:w,photoURL:d,phoneNumber:f,tenantId:p,stsTokenManager:_,createdAt:g,lastLoginAt:v});return E&&Array.isArray(E)&&(S.providerData=E.map((e=>Object.assign({},e)))),m&&(S._redirectEventId=m),S}static async _fromIdTokenResponse(e,t){let r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const n=new od;n.updateFromServerResponse(t);const a=new cd({uid:t.localId,auth:e,stsTokenManager:n,isAnonymous:r});return await id(a),a}static async _fromGetAccountInfoResponse(e,t,r){const n=t.users[0];If(void 0!==n.localId,"internal-error");const a=void 0!==n.providerUserInfo?sd(n.providerUserInfo):[],i=!(n.email&&n.passwordHash)&&!(null===a||void 0===a?void 0:a.length),s=new od;s.updateFromIdToken(r);const o=new cd({uid:n.localId,auth:e,stsTokenManager:s,isAnonymous:i}),l={uid:n.localId,displayName:n.displayName||null,photoURL:n.photoUrl||null,email:n.email||null,emailVerified:n.emailVerified||!1,phoneNumber:n.phoneNumber||null,tenantId:n.tenantId||null,providerData:a,metadata:new ad(n.createdAt,n.lastLoginAt),isAnonymous:!(n.email&&n.passwordHash)&&!(null===a||void 0===a?void 0:a.length)};return Object.assign(o,l),o}}const ud=new Map;function hd(e){Rf(e instanceof Function,"Expected a class definition");let t=ud.get(e);return t?(Rf(t instanceof e,"Instance stored in cache mismatched with class"),t):(t=new e,ud.set(e,t),t)}class fd{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return void 0===t?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}fd.type="NONE";const dd=fd;function pd(e,t,r){return`firebase:${e}:${t}:${r}`}class md{constructor(e,t,r){this.persistence=e,this.auth=t,this.userKey=r;const{config:n,name:a}=this.auth;this.fullUserKey=pd(this.userKey,n.apiKey,a),this.fullPersistenceKey=pd("persistence",n.apiKey,a),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if("string"===typeof e){const t=await Qf(this.auth,{idToken:e}).catch((()=>{}));return t?cd._fromGetAccountInfoResponse(this.auth,t,e):null}return cd._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();return await this.removeCurrentUser(),this.persistence=e,t?this.setCurrentUser(t):void 0}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"authUser";if(!t.length)return new md(hd(dd),e,r);const n=(await Promise.all(t.map((async e=>{if(await e._isAvailable())return e})))).filter((e=>e));let a=n[0]||hd(dd);const i=pd(r,e.config.apiKey,e.name);let s=null;for(const c of t)try{const t=await c._get(i);if(t){let r;if("string"===typeof t){const n=await Qf(e,{idToken:t}).catch((()=>{}));if(!n)break;r=await cd._fromGetAccountInfoResponse(e,n,t)}else r=cd._fromJSON(e,t);c!==a&&(s=r),a=c;break}}catch(l){}const o=n.filter((e=>e._shouldAllowMigration));return a._shouldAllowMigration&&o.length?(a=o[0],s&&await a._set(i,s.toJSON()),await Promise.all(t.map((async e=>{if(e!==a)try{await e._remove(i)}catch(l){}}))),new md(a,e,r)):new md(a,e,r)}}function gd(e){const t=e.toLowerCase();if(t.includes("opera/")||t.includes("opr/")||t.includes("opios/"))return"Opera";if(wd(t))return"IEMobile";if(t.includes("msie")||t.includes("trident/"))return"IE";if(t.includes("edge/"))return"Edge";if(vd(t))return"Firefox";if(t.includes("silk/"))return"Silk";if(Td(t))return"Blackberry";if(_d(t))return"Webos";if(yd(t))return"Safari";if((t.includes("chrome/")||bd(t))&&!t.includes("edge/"))return"Chrome";if(Ed(t))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=e.match(t);if(2===(null===r||void 0===r?void 0:r.length))return r[1]}return"Other"}function vd(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Fe();return/firefox\//i.test(e)}function yd(){const e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:Fe()).toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function bd(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Fe();return/crios\//i.test(e)}function wd(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Fe();return/iemobile/i.test(e)}function Ed(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Fe();return/android/i.test(e)}function Td(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Fe();return/blackberry/i.test(e)}function _d(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Fe();return/webos/i.test(e)}function Sd(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Fe();return/iphone|ipad|ipod/i.test(e)||/macintosh/i.test(e)&&/mobile/i.test(e)}function kd(){return function(){const e=Fe();return e.indexOf("MSIE ")>=0||e.indexOf("Trident/")>=0}()&&10===document.documentMode}function Cd(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Fe();return Sd(e)||Ed(e)||_d(e)||Td(e)||/windows phone/i.test(e)||wd(e)}function Id(e){let t,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];switch(e){case"Browser":t=gd(Fe());break;case"Worker":t=`${gd(Fe())}-${e}`;break;default:t=e}const n=r.length?r.join(","):"FirebaseCore-web";return`${t}/JsCore/${hr}/${n}`}class Ad{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const r=t=>new Promise(((r,n)=>{try{r(e(t))}catch(Ok){n(Ok)}}));r.onAbort=t,this.queue.push(r);const n=this.queue.length-1;return()=>{this.queue[n]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const r of this.queue)await r(e),r.onAbort&&t.push(r.onAbort)}catch(Ok){t.reverse();for(const n of t)try{n()}catch(r){}throw this.auth._errorFactory.create("login-blocked",{originalMessage:null===Ok||void 0===Ok?void 0:Ok.message})}}}class Rd{constructor(e){var t,r,n,a;const i=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=null!==(t=i.minPasswordLength)&&void 0!==t?t:6,i.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=i.maxPasswordLength),void 0!==i.containsLowercaseCharacter&&(this.customStrengthOptions.containsLowercaseLetter=i.containsLowercaseCharacter),void 0!==i.containsUppercaseCharacter&&(this.customStrengthOptions.containsUppercaseLetter=i.containsUppercaseCharacter),void 0!==i.containsNumericCharacter&&(this.customStrengthOptions.containsNumericCharacter=i.containsNumericCharacter),void 0!==i.containsNonAlphanumericCharacter&&(this.customStrengthOptions.containsNonAlphanumericCharacter=i.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,"ENFORCEMENT_STATE_UNSPECIFIED"===this.enforcementState&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=null!==(n=null===(r=e.allowedNonAlphanumericCharacters)||void 0===r?void 0:r.join(""))&&void 0!==n?n:"",this.forceUpgradeOnSignin=null!==(a=e.forceUpgradeOnSignin)&&void 0!==a&&a,this.schemaVersion=e.schemaVersion}validatePassword(e){var t,r,n,a,i,s;const o={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,o),this.validatePasswordCharacterOptions(e,o),o.isValid&&(o.isValid=null===(t=o.meetsMinPasswordLength)||void 0===t||t),o.isValid&&(o.isValid=null===(r=o.meetsMaxPasswordLength)||void 0===r||r),o.isValid&&(o.isValid=null===(n=o.containsLowercaseLetter)||void 0===n||n),o.isValid&&(o.isValid=null===(a=o.containsUppercaseLetter)||void 0===a||a),o.isValid&&(o.isValid=null===(i=o.containsNumericCharacter)||void 0===i||i),o.isValid&&(o.isValid=null===(s=o.containsNonAlphanumericCharacter)||void 0===s||s),o}validatePasswordLengthOptions(e,t){const r=this.customStrengthOptions.minPasswordLength,n=this.customStrengthOptions.maxPasswordLength;r&&(t.meetsMinPasswordLength=e.length>=r),n&&(t.meetsMaxPasswordLength=e.length<=n)}validatePasswordCharacterOptions(e,t){let r;this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);for(let n=0;n<e.length;n++)r=e.charAt(n),this.updatePasswordCharacterOptionsStatuses(t,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,t,r,n,a){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=n)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=a))}}class Nd{constructor(e,t,r,n){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=r,this.config=n,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new xd(this),this.idTokenSubscription=new xd(this),this.beforeStateQueue=new Ad(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=bf,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=n.sdkClientVersion,this._persistenceManagerAvailable=new Promise((e=>this._resolvePersistenceManagerAvailable=e))}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=hd(t)),this._initializationPromise=this.queue((async()=>{var r,n,a;if(!this._deleted&&(this.persistenceManager=await md.create(this,e),null===(r=this._resolvePersistenceManagerAvailable)||void 0===r||r.call(this),!this._deleted)){if(null===(n=this._popupRedirectResolver)||void 0===n?void 0:n._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch(Ok){}await this.initializeCurrentUser(t),this.lastNotifiedUid=(null===(a=this.currentUser)||void 0===a?void 0:a.uid)||null,this._deleted||(this._isInitialized=!0)}})),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();return this.currentUser||e?this.currentUser&&e&&this.currentUser.uid===e.uid?(this._currentUser._assign(e),void await this.currentUser.getIdToken()):void await this._updateCurrentUser(e,!0):void 0}async initializeCurrentUserFromIdToken(e){try{const t=await Qf(this,{idToken:e}),r=await cd._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(r)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var t;if(lr(this.app)){const e=this.app.settings.authIdToken;return e?new Promise((t=>{setTimeout((()=>this.initializeCurrentUserFromIdToken(e).then(t,t)))})):this.directlySetCurrentUser(null)}const r=await this.assertedPersistence.getCurrentUser();let n=r,a=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const r=null===(t=this.redirectUser)||void 0===t?void 0:t._redirectEventId,i=null===n||void 0===n?void 0:n._redirectEventId,s=await this.tryRedirectSignIn(e);r&&r!==i||!(null===s||void 0===s?void 0:s.user)||(n=s.user,a=!0)}if(!n)return this.directlySetCurrentUser(null);if(!n._redirectEventId){if(a)try{await this.beforeStateQueue.runMiddleware(n)}catch(Ok){n=r,this._popupRedirectResolver._overrideRedirectResult(this,(()=>Promise.reject(Ok)))}return n?this.reloadAndSetCurrentUserOrClear(n):this.directlySetCurrentUser(null)}return If(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===n._redirectEventId?this.directlySetCurrentUser(n):this.reloadAndSetCurrentUserOrClear(n)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch(Ok){await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await id(e)}catch(Ok){if("auth/network-request-failed"!==(null===Ok||void 0===Ok?void 0:Ok.code))return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=function(){if("undefined"===typeof navigator)return null;const e=navigator;return e.languages&&e.languages[0]||e.language||null}()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(lr(this.app))return Promise.reject(kf(this));const t=e?Ye(e):null;return t&&If(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!this._deleted)return e&&If(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue((async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()}))}async signOut(){return lr(this.app)?Promise.reject(kf(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return lr(this.app)?Promise.reject(kf(this)):this.queue((async()=>{await this.assertedPersistence.setPersistence(hd(e))}))}_getRecaptchaConfig(){return null==this.tenantId?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return null===this.tenantId?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await async function(e){return zf(e,"GET","/v2/passwordPolicy",Bf(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}))}(this),t=new Rd(e);null===this.tenantId?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new ze("auth","Firebase",e())}onAuthStateChanged(e,t,r){return this.registerStateListener(this.authStateSubscription,e,t,r)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,r){return this.registerStateListener(this.idTokenSubscription,e,t,r)}authStateReady(){return new Promise(((e,t)=>{if(this.currentUser)e();else{const r=this.onAuthStateChanged((()=>{r(),e()}),t)}}))}async revokeAccessToken(e){if(this.currentUser){const t={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:await this.currentUser.getIdToken()};null!=this.tenantId&&(t.tenantId=this.tenantId),await async function(e,t){return zf(e,"POST","/v2/accounts:revokeToken",Bf(e,t))}(this,t)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:null===(e=this._currentUser)||void 0===e?void 0:e.toJSON()}}async _setRedirectUser(e,t){const r=await this.getOrInitRedirectPersistenceManager(t);return null===e?r.removeCurrentUser():r.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&hd(e)||this._popupRedirectResolver;If(t,this,"argument-error"),this.redirectPersistenceManager=await md.create(this,[hd(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var t,r;return this._isInitialized&&await this.queue((async()=>{})),(null===(t=this._currentUser)||void 0===t?void 0:t._redirectEventId)===e?this._currentUser:(null===(r=this.redirectUser)||void 0===r?void 0:r._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue((async()=>this.directlySetCurrentUser(e)))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const r=null!==(t=null===(e=this.currentUser)||void 0===e?void 0:e.uid)&&void 0!==t?t:null;this.lastNotifiedUid!==r&&(this.lastNotifiedUid=r,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,r,n){if(this._deleted)return()=>{};const a="function"===typeof t?t:t.next.bind(t);let i=!1;const s=this._isInitialized?Promise.resolve():this._initializationPromise;if(If(s,this,"internal-error"),s.then((()=>{i||a(this.currentUser)})),"function"===typeof t){const a=e.addObserver(t,r,n);return()=>{i=!0,a()}}{const r=e.addObserver(t);return()=>{i=!0,r()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return If(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){e&&!this.frameworks.includes(e)&&(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=Id(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const t={"X-Client-Version":this.clientVersion};this.app.options.appId&&(t["X-Firebase-gmpid"]=this.app.options.appId);const r=await(null===(e=this.heartbeatServiceProvider.getImmediate({optional:!0}))||void 0===e?void 0:e.getHeartbeatsHeader());r&&(t["X-Firebase-Client"]=r);const n=await this._getAppCheckToken();return n&&(t["X-Firebase-AppCheck"]=n),t}async _getAppCheckToken(){var e;if(lr(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const t=await(null===(e=this.appCheckServiceProvider.getImmediate({optional:!0}))||void 0===e?void 0:e.getToken());return(null===t||void 0===t?void 0:t.error)&&function(e){if(wf.logLevel<=rt.WARN){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];wf.warn(`Auth (${hr}): ${e}`,...r)}}(`Error while retrieving App Check token: ${t.error}`),null===t||void 0===t?void 0:t.token}}function Od(e){return Ye(e)}class xd{constructor(e){this.auth=e,this.observer=null,this.addObserver=function(e,t){const r=new qe(e,t);return r.subscribe.bind(r)}((e=>this.observer=e))}get next(){return If(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}let Pd={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function Dd(e){return Pd.loadJS(e)}function Ld(e){return`__${e}${Math.floor(1e6*Math.random())}`}class Md{constructor(){this.enterprise=new Fd}ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}class Fd{ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}const Ud="NO_RECAPTCHA";class Vd{constructor(e){this.type="recaptcha-enterprise",this.auth=Od(e)}async verify(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"verify",t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];function r(t,r,n){const a=window.grecaptcha;qf(a)?a.enterprise.ready((()=>{a.enterprise.execute(t,{action:e}).then((e=>{r(e)})).catch((()=>{r(Ud)}))})):n(Error("No reCAPTCHA enterprise script loaded."))}if(this.auth.settings.appVerificationDisabledForTesting){return(new Md).execute("siteKey",{action:"verify"})}return new Promise(((e,n)=>{(async function(e){if(!t){if(null==e.tenantId&&null!=e._agentRecaptchaConfig)return e._agentRecaptchaConfig.siteKey;if(null!=e.tenantId&&void 0!==e._tenantRecaptchaConfigs[e.tenantId])return e._tenantRecaptchaConfigs[e.tenantId].siteKey}return new Promise((async(t,r)=>{Yf(e,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then((n=>{if(void 0!==n.recaptchaKey){const r=new Xf(n);return null==e.tenantId?e._agentRecaptchaConfig=r:e._tenantRecaptchaConfigs[e.tenantId]=r,t(r.siteKey)}r(new Error("recaptcha Enterprise site key undefined"))})).catch((e=>{r(e)}))}))})(this.auth).then((a=>{if(!t&&qf(window.grecaptcha))r(a,e,n);else{if("undefined"===typeof window)return void n(new Error("RecaptchaVerifier is only supported in browser"));let t=Pd.recaptchaEnterpriseScript;0!==t.length&&(t+=a),Dd(t).then((()=>{r(a,e,n)})).catch((e=>{n(e)}))}})).catch((e=>{n(e)}))}))}}async function Bd(e,t,r){let n=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=arguments.length>4&&void 0!==arguments[4]&&arguments[4];const i=new Vd(e);let s;if(a)s=Ud;else try{s=await i.verify(r)}catch(l){s=await i.verify(r,!0)}const o=Object.assign({},t);if("mfaSmsEnrollment"===r||"mfaSmsSignIn"===r){if("phoneEnrollmentInfo"in o){const e=o.phoneEnrollmentInfo.phoneNumber,t=o.phoneEnrollmentInfo.recaptchaToken;Object.assign(o,{phoneEnrollmentInfo:{phoneNumber:e,recaptchaToken:t,captchaResponse:s,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in o){const e=o.phoneSignInInfo.recaptchaToken;Object.assign(o,{phoneSignInInfo:{recaptchaToken:e,captchaResponse:s,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return o}return n?Object.assign(o,{captchaResp:s}):Object.assign(o,{captchaResponse:s}),Object.assign(o,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(o,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),o}async function zd(e,t,r,n,a){var i,s;if("EMAIL_PASSWORD_PROVIDER"===a){if(null===(i=e._getRecaptchaConfig())||void 0===i?void 0:i.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const a=await Bd(e,t,r,"getOobCode"===r);return n(e,a)}return n(e,t).catch((async a=>{if("auth/missing-recaptcha-token"===a.code){console.log(`${r} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const a=await Bd(e,t,r,"getOobCode"===r);return n(e,a)}return Promise.reject(a)}))}if("PHONE_PROVIDER"===a){if(null===(s=e._getRecaptchaConfig())||void 0===s?void 0:s.isProviderEnabled("PHONE_PROVIDER")){const a=await Bd(e,t,r);return n(e,a).catch((async a=>{var i;if("AUDIT"===(null===(i=e._getRecaptchaConfig())||void 0===i?void 0:i.getProviderEnforcementState("PHONE_PROVIDER"))&&("auth/missing-recaptcha-token"===a.code||"auth/invalid-app-credential"===a.code)){console.log(`Failed to verify with reCAPTCHA Enterprise. Automatically triggering the reCAPTCHA v2 flow to complete the ${r} flow.`);const a=await Bd(e,t,r,!1,!0);return n(e,a)}return Promise.reject(a)}))}{const a=await Bd(e,t,r,!1,!0);return n(e,a)}}return Promise.reject(a+" provider is not supported.")}async function jd(e){const t=Od(e),r=await Yf(t,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}),n=new Xf(r);if(null==t.tenantId?t._agentRecaptchaConfig=n:t._tenantRecaptchaConfigs[t.tenantId]=n,n.isAnyProviderEnabled()){new Vd(t).verify()}}function Hd(e,t,r){const n=Od(e);If(/^https?:\/\//.test(t),n,"invalid-emulator-scheme");const a=!!(null===r||void 0===r?void 0:r.disableWarnings),i=$d(t),{host:s,port:o}=function(e){const t=$d(e),r=/(\/\/)?([^?#/]+)/.exec(e.substr(t.length));if(!r)return{host:"",port:null};const n=r[2].split("@").pop()||"",a=/^(\[[^\]]+\])(:|$)/.exec(n);if(a){const e=a[1];return{host:e,port:Wd(n.substr(e.length+1))}}{const[e,t]=n.split(":");return{host:e,port:Wd(t)}}}(t),l={url:`${i}//${s}${null===o?"":`:${o}`}/`},c=Object.freeze({host:s,port:o,protocol:i.replace(":",""),options:Object.freeze({disableWarnings:a})});if(!n._canInitEmulator)return If(n.config.emulator&&n.emulatorConfig,n,"emulator-config-failed"),void If(He(l,n.config.emulator)&&He(c,n.emulatorConfig),n,"emulator-config-failed");n.config.emulator=l,n.emulatorConfig=c,n.settings.appVerificationDisabledForTesting=!0,a||function(){function e(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}"undefined"!==typeof console&&"function"===typeof console.info&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials.");"undefined"!==typeof window&&"undefined"!==typeof document&&("loading"===document.readyState?window.addEventListener("DOMContentLoaded",e):e())}()}function $d(e){const t=e.indexOf(":");return t<0?"":e.substr(0,t+1)}function Wd(e){if(!e)return null;const t=Number(e);return isNaN(t)?null:t}class Gd{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return Af("not implemented")}_getIdTokenResponse(e){return Af("not implemented")}_linkToIdToken(e,t){return Af("not implemented")}_getReauthenticationResolver(e){return Af("not implemented")}}async function Kd(e,t){return zf(e,"POST","/v1/accounts:signUp",t)}async function qd(e,t){return Hf(e,"POST","/v1/accounts:signInWithPassword",Bf(e,t))}class Xd extends Gd{constructor(e,t,r){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;super("password",r),this._email=e,this._password=t,this._tenantId=n}static _fromEmailAndPassword(e,t){return new Xd(e,t,"password")}static _fromEmailAndCode(e,t){return new Xd(e,t,"emailLink",arguments.length>2&&void 0!==arguments[2]?arguments[2]:null)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const t="string"===typeof e?JSON.parse(e):e;if((null===t||void 0===t?void 0:t.email)&&(null===t||void 0===t?void 0:t.password)){if("password"===t.signInMethod)return this._fromEmailAndPassword(t.email,t.password);if("emailLink"===t.signInMethod)return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":return zd(e,{returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"},"signInWithPassword",qd,"EMAIL_PASSWORD_PROVIDER");case"emailLink":return async function(e,t){return Hf(e,"POST","/v1/accounts:signInWithEmailLink",Bf(e,t))}(e,{email:this._email,oobCode:this._password});default:Tf(e,"internal-error")}}async _linkToIdToken(e,t){switch(this.signInMethod){case"password":return zd(e,{idToken:t,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",Kd,"EMAIL_PASSWORD_PROVIDER");case"emailLink":return async function(e,t){return Hf(e,"POST","/v1/accounts:signInWithEmailLink",Bf(e,t))}(e,{idToken:t,email:this._email,oobCode:this._password});default:Tf(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}async function Yd(e,t){return Hf(e,"POST","/v1/accounts:signInWithIdp",Bf(e,t))}class Qd extends Gd{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new Qd(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):Tf("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t="string"===typeof e?JSON.parse(e):e,{providerId:r,signInMethod:n}=t,a=gf(t,["providerId","signInMethod"]);if(!r||!n)return null;const i=new Qd(r,n);return i.idToken=a.idToken||void 0,i.accessToken=a.accessToken||void 0,i.secret=a.secret,i.nonce=a.nonce,i.pendingToken=a.pendingToken||null,i}_getIdTokenResponse(e){return Yd(e,this.buildRequest())}_linkToIdToken(e,t){const r=this.buildRequest();return r.idToken=t,Yd(e,r)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,Yd(e,t)}buildRequest(){const e={requestUri:"http://localhost",returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=We(t)}return e}}async function Jd(e,t){return zf(e,"POST","/v1/accounts:sendVerificationCode",Bf(e,t))}const Zd={USER_NOT_FOUND:"user-not-found"};class ep extends Gd{constructor(e){super("phone","phone"),this.params=e}static _fromVerification(e,t){return new ep({verificationId:e,verificationCode:t})}static _fromTokenResponse(e,t){return new ep({phoneNumber:e,temporaryProof:t})}_getIdTokenResponse(e){return async function(e,t){return Hf(e,"POST","/v1/accounts:signInWithPhoneNumber",Bf(e,t))}(e,this._makeVerificationRequest())}_linkToIdToken(e,t){return async function(e,t){const r=await Hf(e,"POST","/v1/accounts:signInWithPhoneNumber",Bf(e,t));if(r.temporaryProof)throw Kf(e,"account-exists-with-different-credential",r);return r}(e,Object.assign({idToken:t},this._makeVerificationRequest()))}_getReauthenticationResolver(e){return async function(e,t){return Hf(e,"POST","/v1/accounts:signInWithPhoneNumber",Bf(e,Object.assign(Object.assign({},t),{operation:"REAUTH"})),Zd)}(e,this._makeVerificationRequest())}_makeVerificationRequest(){const{temporaryProof:e,phoneNumber:t,verificationId:r,verificationCode:n}=this.params;return e&&t?{temporaryProof:e,phoneNumber:t}:{sessionInfo:r,code:n}}toJSON(){const e={providerId:this.providerId};return this.params.phoneNumber&&(e.phoneNumber=this.params.phoneNumber),this.params.temporaryProof&&(e.temporaryProof=this.params.temporaryProof),this.params.verificationCode&&(e.verificationCode=this.params.verificationCode),this.params.verificationId&&(e.verificationId=this.params.verificationId),e}static fromJSON(e){"string"===typeof e&&(e=JSON.parse(e));const{verificationId:t,verificationCode:r,phoneNumber:n,temporaryProof:a}=e;return r||t||n||a?new ep({verificationId:t,verificationCode:r,phoneNumber:n,temporaryProof:a}):null}}class tp{constructor(e){var t,r,n,a,i,s;const o=Ge(Ke(e)),l=null!==(t=o.apiKey)&&void 0!==t?t:null,c=null!==(r=o.oobCode)&&void 0!==r?r:null,u=function(e){switch(e){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}(null!==(n=o.mode)&&void 0!==n?n:null);If(l&&c&&u,"argument-error"),this.apiKey=l,this.operation=u,this.code=c,this.continueUrl=null!==(a=o.continueUrl)&&void 0!==a?a:null,this.languageCode=null!==(i=o.languageCode)&&void 0!==i?i:null,this.tenantId=null!==(s=o.tenantId)&&void 0!==s?s:null}static parseLink(e){const t=function(e){const t=Ge(Ke(e)).link,r=t?Ge(Ke(t)).deep_link_id:null,n=Ge(Ke(e)).deep_link_id;return(n?Ge(Ke(n)).link:null)||n||r||t||e}(e);try{return new tp(t)}catch(r){return null}}}class rp{constructor(){this.providerId=rp.PROVIDER_ID}static credential(e,t){return Xd._fromEmailAndPassword(e,t)}static credentialWithLink(e,t){const r=tp.parseLink(t);return If(r,"argument-error"),Xd._fromEmailAndCode(e,r.code,r.tenantId)}}rp.PROVIDER_ID="password",rp.EMAIL_PASSWORD_SIGN_IN_METHOD="password",rp.EMAIL_LINK_SIGN_IN_METHOD="emailLink";class np{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}class ap extends np{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class ip extends ap{constructor(){super("facebook.com")}static credential(e){return Qd._fromParams({providerId:ip.PROVIDER_ID,signInMethod:ip.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return ip.credentialFromTaggedObject(e)}static credentialFromError(e){return ip.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject(e){let{_tokenResponse:t}=e;if(!t||!("oauthAccessToken"in t))return null;if(!t.oauthAccessToken)return null;try{return ip.credential(t.oauthAccessToken)}catch(r){return null}}}ip.FACEBOOK_SIGN_IN_METHOD="facebook.com",ip.PROVIDER_ID="facebook.com";class sp extends ap{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return Qd._fromParams({providerId:sp.PROVIDER_ID,signInMethod:sp.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return sp.credentialFromTaggedObject(e)}static credentialFromError(e){return sp.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject(e){let{_tokenResponse:t}=e;if(!t)return null;const{oauthIdToken:r,oauthAccessToken:n}=t;if(!r&&!n)return null;try{return sp.credential(r,n)}catch(a){return null}}}sp.GOOGLE_SIGN_IN_METHOD="google.com",sp.PROVIDER_ID="google.com";class op extends ap{constructor(){super("github.com")}static credential(e){return Qd._fromParams({providerId:op.PROVIDER_ID,signInMethod:op.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return op.credentialFromTaggedObject(e)}static credentialFromError(e){return op.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject(e){let{_tokenResponse:t}=e;if(!t||!("oauthAccessToken"in t))return null;if(!t.oauthAccessToken)return null;try{return op.credential(t.oauthAccessToken)}catch(r){return null}}}op.GITHUB_SIGN_IN_METHOD="github.com",op.PROVIDER_ID="github.com";class lp extends ap{constructor(){super("twitter.com")}static credential(e,t){return Qd._fromParams({providerId:lp.PROVIDER_ID,signInMethod:lp.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return lp.credentialFromTaggedObject(e)}static credentialFromError(e){return lp.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject(e){let{_tokenResponse:t}=e;if(!t)return null;const{oauthAccessToken:r,oauthTokenSecret:n}=t;if(!r||!n)return null;try{return lp.credential(r,n)}catch(a){return null}}}lp.TWITTER_SIGN_IN_METHOD="twitter.com",lp.PROVIDER_ID="twitter.com";class cp{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,r){let n=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const a=await cd._fromIdTokenResponse(e,r,n),i=up(r);return new cp({user:a,providerId:i,_tokenResponse:r,operationType:t})}static async _forOperation(e,t,r){await e._updateTokensIfNecessary(r,!0);const n=up(r);return new cp({user:e,providerId:n,_tokenResponse:r,operationType:t})}}function up(e){return e.providerId?e.providerId:"phoneNumber"in e?"phone":null}class hp extends Be{constructor(e,t,r,n){var a;super(t.code,t.message),this.operationType=r,this.user=n,Object.setPrototypeOf(this,hp.prototype),this.customData={appName:e.name,tenantId:null!==(a=e.tenantId)&&void 0!==a?a:void 0,_serverResponse:t.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,t,r,n){return new hp(e,t,r,n)}}function fp(e,t,r,n){return("reauthenticate"===t?r._getReauthenticationResolver(e):r._getIdTokenResponse(e)).catch((r=>{if("auth/multi-factor-auth-required"===r.code)throw hp._fromErrorAndOperation(e,r,t,n);throw r}))}async function dp(e,t){let r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const n=await rd(e,t._linkToIdToken(e.auth,await e.getIdToken()),r);return cp._forOperation(e,"link",n)}async function pp(e,t){let r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const{auth:n}=e;if(lr(n.app))return Promise.reject(kf(n));const a="reauthenticate";try{const i=await rd(e,fp(n,a,t,e),r);If(i.idToken,n,"internal-error");const s=ed(i.idToken);If(s,n,"internal-error");const{sub:o}=s;return If(e.uid===o,n,"user-mismatch"),cp._forOperation(e,a,i)}catch(Ok){throw"auth/user-not-found"===(null===Ok||void 0===Ok?void 0:Ok.code)&&Tf(n,"user-mismatch"),Ok}}async function mp(e,t){let r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(lr(e.app))return Promise.reject(kf(e));const n="signIn",a=await fp(e,n,t),i=await cp._fromIdTokenResponse(e,n,a);return r||await e._updateCurrentUser(i.user),i}async function gp(e,t){return mp(Od(e),t)}async function vp(e){const t=Od(e);t._getPasswordPolicyInternal()&&await t._updatePasswordPolicy()}function yp(e,t){return zf(e,"POST","/v2/accounts/mfaEnrollment:start",Bf(e,t))}new WeakMap;const bp="__sak";class wp{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(bp,"1"),this.storage.removeItem(bp),Promise.resolve(!0)):Promise.resolve(!1)}catch(e){return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}class Ep extends wp{constructor(){super((()=>window.localStorage),"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=Cd(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const r=this.storage.getItem(t),n=this.localCache[t];r!==n&&e(t,n,r)}}onStorageEvent(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!e.key)return void this.forAllChangedKeys(((e,t,r)=>{this.notifyListeners(e,r)}));const r=e.key;t?this.detachListener():this.stopPolling();const n=()=>{const e=this.storage.getItem(r);(t||this.localCache[r]!==e)&&this.notifyListeners(r,e)},a=this.storage.getItem(r);kd()&&a!==e.newValue&&e.newValue!==e.oldValue?setTimeout(n,10):n()}notifyListeners(e,t){this.localCache[e]=t;const r=this.listeners[e];if(r)for(const n of Array.from(r))n(t?JSON.parse(t):t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval((()=>{this.forAllChangedKeys(((e,t,r)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:r}),!0)}))}),1e3)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){0===Object.keys(this.listeners).length&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),0===this.listeners[e].size&&delete this.listeners[e]),0===Object.keys(this.listeners).length&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}Ep.type="LOCAL";const Tp=Ep;function _p(e){var t,r;const n=e.replace(/[\\^$.*+?()[\]{}|]/g,"\\$&"),a=RegExp(`${n}=([^;]+)`);return null!==(r=null===(t=document.cookie.match(a))||void 0===t?void 0:t[1])&&void 0!==r?r:null}function Sp(e){return`${"http:"===window.location.protocol?"__dev_":"__HOST-"}FIREBASE_${e.split(":")[3]}`}class kp{constructor(){this.type="COOKIE",this.listenerUnsubscribes=new Map}_getFinalTarget(e){if(void 0===typeof window)return e;const t=new URL(`${window.location.origin}/__cookies__`);return t.searchParams.set("finalTarget",e),t}async _isAvailable(){var e;return!("boolean"===typeof isSecureContext&&!isSecureContext)&&("undefined"!==typeof navigator&&"undefined"!==typeof document&&(null===(e=navigator.cookieEnabled)||void 0===e||e))}async _set(e,t){}async _get(e){if(!this._isAvailable())return null;const t=Sp(e);if(window.cookieStore){const e=await window.cookieStore.get(t);return null===e||void 0===e?void 0:e.value}return _p(t)}async _remove(e){if(!this._isAvailable())return;if(!await this._get(e))return;const t=Sp(e);document.cookie=`${t}=;Max-Age=34560000;Partitioned;Secure;SameSite=Strict;Path=/;Priority=High`,await fetch("/__cookies__",{method:"DELETE"}).catch((()=>{}))}_addListener(e,t){if(!this._isAvailable())return;const r=Sp(e);if(window.cookieStore){const e=e=>{const n=e.changed.find((e=>e.name===r));n&&t(n.value);e.deleted.find((e=>e.name===r))&&t(null)},n=()=>window.cookieStore.removeEventListener("change",e);return this.listenerUnsubscribes.set(t,n),window.cookieStore.addEventListener("change",e)}let n=_p(r);const a=setInterval((()=>{const e=_p(r);e!==n&&(t(e),n=e)}),1e3);this.listenerUnsubscribes.set(t,(()=>clearInterval(a)))}_removeListener(e,t){const r=this.listenerUnsubscribes.get(t);r&&(r(),this.listenerUnsubscribes.delete(t))}}kp.type="COOKIE";class Cp extends wp{constructor(){super((()=>window.sessionStorage),"SESSION")}_addListener(e,t){}_removeListener(e,t){}}Cp.type="SESSION";const Ip=Cp;class Ap{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find((t=>t.isListeningto(e)));if(t)return t;const r=new Ap(e);return this.receivers.push(r),r}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:r,eventType:n,data:a}=t.data,i=this.handlersMap[n];if(!(null===i||void 0===i?void 0:i.size))return;t.ports[0].postMessage({status:"ack",eventId:r,eventType:n});const s=Array.from(i).map((async e=>e(t.origin,a))),o=await function(e){return Promise.all(e.map((async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}})))}(s);t.ports[0].postMessage({status:"done",eventId:r,eventType:n,response:o})}_subscribe(e,t){0===Object.keys(this.handlersMap).length&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),t&&0!==this.handlersMap[e].size||delete this.handlersMap[e],0===Object.keys(this.handlersMap).length&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}function Rp(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10,r="";for(let n=0;n<t;n++)r+=Math.floor(10*Math.random());return e+r}Ap.receivers=[];class Np{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:50;const n="undefined"!==typeof MessageChannel?new MessageChannel:null;if(!n)throw new Error("connection_unavailable");let a,i;return new Promise(((s,o)=>{const l=Rp("",20);n.port1.start();const c=setTimeout((()=>{o(new Error("unsupported_event"))}),r);i={messageChannel:n,onMessage(e){const t=e;if(t.data.eventId===l)switch(t.data.status){case"ack":clearTimeout(c),a=setTimeout((()=>{o(new Error("timeout"))}),3e3);break;case"done":clearTimeout(a),s(t.data.response);break;default:clearTimeout(c),clearTimeout(a),o(new Error("invalid_response"))}}},this.handlers.add(i),n.port1.addEventListener("message",i.onMessage),this.target.postMessage({eventType:e,eventId:l,data:t},[n.port2])})).finally((()=>{i&&this.removeMessageHandler(i)}))}}function Op(){return window}function xp(){return"undefined"!==typeof Op().WorkerGlobalScope&&"function"===typeof Op().importScripts}const Pp="firebaseLocalStorageDb",Dp="firebaseLocalStorage",Lp="fbase_key";class Mp{constructor(e){this.request=e}toPromise(){return new Promise(((e,t)=>{this.request.addEventListener("success",(()=>{e(this.request.result)})),this.request.addEventListener("error",(()=>{t(this.request.error)}))}))}}function Fp(e,t){return e.transaction([Dp],t?"readwrite":"readonly").objectStore(Dp)}function Up(){const e=indexedDB.open(Pp,1);return new Promise(((t,r)=>{e.addEventListener("error",(()=>{r(e.error)})),e.addEventListener("upgradeneeded",(()=>{const t=e.result;try{t.createObjectStore(Dp,{keyPath:Lp})}catch(Ok){r(Ok)}})),e.addEventListener("success",(async()=>{const r=e.result;r.objectStoreNames.contains(Dp)?t(r):(r.close(),await function(){const e=indexedDB.deleteDatabase(Pp);return new Mp(e).toPromise()}(),t(await Up()))}))}))}async function Vp(e,t,r){const n=Fp(e,!0).put({[Lp]:t,value:r});return new Mp(n).toPromise()}function Bp(e,t){const r=Fp(e,!0).delete(t);return new Mp(r).toPromise()}class zp{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then((()=>{}),(()=>{}))}async _openDb(){return this.db||(this.db=await Up()),this.db}async _withRetries(e){let t=0;for(;;)try{const t=await this._openDb();return await e(t)}catch(Ok){if(t++>3)throw Ok;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return xp()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Ap._getInstance(xp()?self:null),this.receiver._subscribe("keyChanged",(async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)}))),this.receiver._subscribe("ping",(async(e,t)=>["keyChanged"]))}async initializeSender(){var e,t;if(this.activeServiceWorker=await async function(){if(!(null===navigator||void 0===navigator?void 0:navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch(e){return null}}(),!this.activeServiceWorker)return;this.sender=new Np(this.activeServiceWorker);const r=await this.sender._send("ping",{},800);r&&(null===(e=r[0])||void 0===e?void 0:e.fulfilled)&&(null===(t=r[0])||void 0===t?void 0:t.value.includes("keyChanged"))&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(this.sender&&this.activeServiceWorker&&function(){var e;return(null===(e=null===navigator||void 0===navigator?void 0:navigator.serviceWorker)||void 0===e?void 0:e.controller)||null}()===this.activeServiceWorker)try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch(t){}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await Up();return await Vp(e,bp,"1"),await Bp(e,bp),!0}catch(e){}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite((async()=>(await this._withRetries((r=>Vp(r,e,t))),this.localCache[e]=t,this.notifyServiceWorker(e))))}async _get(e){const t=await this._withRetries((t=>async function(e,t){const r=Fp(e,!1).get(t),n=await new Mp(r).toPromise();return void 0===n?null:n.value}(t,e)));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite((async()=>(await this._withRetries((t=>Bp(t,e))),delete this.localCache[e],this.notifyServiceWorker(e))))}async _poll(){const e=await this._withRetries((e=>{const t=Fp(e,!1).getAll();return new Mp(t).toPromise()}));if(!e)return[];if(0!==this.pendingWrites)return[];const t=[],r=new Set;if(0!==e.length)for(const{fbase_key:n,value:a}of e)r.add(n),JSON.stringify(this.localCache[n])!==JSON.stringify(a)&&(this.notifyListeners(n,a),t.push(n));for(const n of Object.keys(this.localCache))this.localCache[n]&&!r.has(n)&&(this.notifyListeners(n,null),t.push(n));return t}notifyListeners(e,t){this.localCache[e]=t;const r=this.listeners[e];if(r)for(const n of Array.from(r))n(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval((async()=>this._poll()),800)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){0===Object.keys(this.listeners).length&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),0===this.listeners[e].size&&delete this.listeners[e]),0===Object.keys(this.listeners).length&&this.stopPolling()}}zp.type="LOCAL";const jp=zp;function Hp(e,t){return zf(e,"POST","/v2/accounts/mfaSignIn:start",Bf(e,t))}Ld("rcb"),new Df(3e4,6e4);const $p="recaptcha";async function Wp(e,t,r){var n;if(!e._getRecaptchaConfig())try{await jd(e)}catch(a){console.log("Failed to initialize reCAPTCHA Enterprise config. Triggering the reCAPTCHA v2 verification.")}try{let a;if(a="string"===typeof t?{phoneNumber:t}:t,"session"in a){const t=a.session;if("phoneNumber"in a){If("enroll"===t.type,e,"internal-error");const n={idToken:t.credential,phoneEnrollmentInfo:{phoneNumber:a.phoneNumber,clientType:"CLIENT_TYPE_WEB"}},i=zd(e,n,"mfaSmsEnrollment",(async(e,t)=>{if(t.phoneEnrollmentInfo.captchaResponse===Ud){If((null===r||void 0===r?void 0:r.type)===$p,e,"argument-error");return yp(e,await Gp(e,t,r))}return yp(e,t)}),"PHONE_PROVIDER");return(await i.catch((e=>Promise.reject(e)))).phoneSessionInfo.sessionInfo}{If("signin"===t.type,e,"internal-error");const i=(null===(n=a.multiFactorHint)||void 0===n?void 0:n.uid)||a.multiFactorUid;If(i,e,"missing-multi-factor-info");const s={mfaPendingCredential:t.credential,mfaEnrollmentId:i,phoneSignInInfo:{clientType:"CLIENT_TYPE_WEB"}},o=zd(e,s,"mfaSmsSignIn",(async(e,t)=>{if(t.phoneSignInInfo.captchaResponse===Ud){If((null===r||void 0===r?void 0:r.type)===$p,e,"argument-error");return Hp(e,await Gp(e,t,r))}return Hp(e,t)}),"PHONE_PROVIDER");return(await o.catch((e=>Promise.reject(e)))).phoneResponseInfo.sessionInfo}}{const t={phoneNumber:a.phoneNumber,clientType:"CLIENT_TYPE_WEB"},n=zd(e,t,"sendVerificationCode",(async(e,t)=>{if(t.captchaResponse===Ud){If((null===r||void 0===r?void 0:r.type)===$p,e,"argument-error");return Jd(e,await Gp(e,t,r))}return Jd(e,t)}),"PHONE_PROVIDER");return(await n.catch((e=>Promise.reject(e)))).sessionInfo}}finally{null===r||void 0===r||r._reset()}}async function Gp(e,t,r){If(r.type===$p,e,"argument-error");const n=await r.verify();If("string"===typeof n,e,"argument-error");const a=Object.assign({},t);if("phoneEnrollmentInfo"in a){const e=a.phoneEnrollmentInfo.phoneNumber,t=a.phoneEnrollmentInfo.captchaResponse,r=a.phoneEnrollmentInfo.clientType,i=a.phoneEnrollmentInfo.recaptchaVersion;return Object.assign(a,{phoneEnrollmentInfo:{phoneNumber:e,recaptchaToken:n,captchaResponse:t,clientType:r,recaptchaVersion:i}}),a}if("phoneSignInInfo"in a){const e=a.phoneSignInInfo.captchaResponse,t=a.phoneSignInInfo.clientType,r=a.phoneSignInInfo.recaptchaVersion;return Object.assign(a,{phoneSignInInfo:{recaptchaToken:n,captchaResponse:e,clientType:t,recaptchaVersion:r}}),a}return Object.assign(a,{recaptchaToken:n}),a}class Kp{constructor(e){this.providerId=Kp.PROVIDER_ID,this.auth=Od(e)}verifyPhoneNumber(e,t){return Wp(this.auth,e,Ye(t))}static credential(e,t){return ep._fromVerification(e,t)}static credentialFromResult(e){const t=e;return Kp.credentialFromTaggedObject(t)}static credentialFromError(e){return Kp.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject(e){let{_tokenResponse:t}=e;if(!t)return null;const{phoneNumber:r,temporaryProof:n}=t;return r&&n?ep._fromTokenResponse(r,n):null}}function qp(e,t){return t?hd(t):(If(e._popupRedirectResolver,e,"argument-error"),e._popupRedirectResolver)}Kp.PROVIDER_ID="phone",Kp.PHONE_SIGN_IN_METHOD="phone";class Xp extends Gd{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Yd(e,this._buildIdpRequest())}_linkToIdToken(e,t){return Yd(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return Yd(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function Yp(e){return mp(e.auth,new Xp(e),e.bypassAuthState)}function Qp(e){const{auth:t,user:r}=e;return If(r,t,"internal-error"),pp(r,new Xp(e),e.bypassAuthState)}async function Jp(e){const{auth:t,user:r}=e;return If(r,t,"internal-error"),dp(r,new Xp(e),e.bypassAuthState)}class Zp{constructor(e,t,r,n){let a=arguments.length>4&&void 0!==arguments[4]&&arguments[4];this.auth=e,this.resolver=r,this.user=n,this.bypassAuthState=a,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise((async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(Ok){this.reject(Ok)}}))}async onAuthEvent(e){const{urlResponse:t,sessionId:r,postBody:n,tenantId:a,error:i,type:s}=e;if(i)return void this.reject(i);const o={auth:this.auth,requestUri:t,sessionId:r,tenantId:a||void 0,postBody:n||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(s)(o))}catch(Ok){this.reject(Ok)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return Yp;case"linkViaPopup":case"linkViaRedirect":return Jp;case"reauthViaPopup":case"reauthViaRedirect":return Qp;default:Tf(this.auth,"internal-error")}}resolve(e){Rf(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Rf(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const em=new Df(2e3,1e4);class tm extends Zp{constructor(e,t,r,n,a){super(e,t,n,a),this.provider=r,this.authWindow=null,this.pollId=null,tm.currentPopupAction&&tm.currentPopupAction.cancel(),tm.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return If(e,this.auth,"internal-error"),e}async onExecution(){Rf(1===this.filter.length,"Popup operations only handle one event");const e=Rp();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch((e=>{this.reject(e)})),this.resolver._isIframeWebStorageSupported(this.auth,(e=>{e||this.reject(_f(this.auth,"web-storage-unsupported"))})),this.pollUserCancellation()}get eventId(){var e;return(null===(e=this.authWindow)||void 0===e?void 0:e.associatedEvent)||null}cancel(){this.reject(_f(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,tm.currentPopupAction=null}pollUserCancellation(){const e=()=>{var t,r;(null===(r=null===(t=this.authWindow)||void 0===t?void 0:t.window)||void 0===r?void 0:r.closed)?this.pollId=window.setTimeout((()=>{this.pollId=null,this.reject(_f(this.auth,"popup-closed-by-user"))}),8e3):this.pollId=window.setTimeout(e,em.get())};e()}}tm.currentPopupAction=null;const rm=new Map;class nm extends Zp{constructor(e,t){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,arguments.length>2&&void 0!==arguments[2]&&arguments[2]),this.eventId=null}async execute(){let e=rm.get(this.auth._key());if(!e){try{const t=await async function(e,t){const r=sm(t),n=im(e);if(!await n._isAvailable())return!1;const a="true"===await n._get(r);return await n._remove(r),a}(this.resolver,this.auth),r=t?await super.execute():null;e=()=>Promise.resolve(r)}catch(Ok){e=()=>Promise.reject(Ok)}rm.set(this.auth._key(),e)}return this.bypassAuthState||rm.set(this.auth._key(),(()=>Promise.resolve(null))),e()}async onAuthEvent(e){if("signInViaRedirect"===e.type)return super.onAuthEvent(e);if("unknown"!==e.type){if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}else this.resolve(null)}async onExecution(){}cleanUp(){}}function am(e,t){rm.set(e._key(),t)}function im(e){return hd(e._redirectPersistence)}function sm(e){return pd("pendingRedirect",e.config.apiKey,e.name)}async function om(e,t){let r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(lr(e.app))return Promise.reject(kf(e));const n=Od(e),a=qp(n,t),i=new nm(n,a,r),s=await i.execute();return s&&!r&&(delete s.user._redirectEventId,await n._persistUserIfCurrent(s.user),await n._setRedirectUser(null,t)),s}class lm{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach((r=>{this.isEventForConsumer(e,r)&&(t=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))})),this.hasHandledPotentialRedirect||!function(e){switch(e.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return um(e);default:return!1}}(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){var r;if(e.error&&!um(e)){const n=(null===(r=e.error.code)||void 0===r?void 0:r.split("auth/")[1])||"internal-error";t.onError(_f(this.auth,n))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const r=null===t.eventId||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=6e5&&this.cachedEventUids.clear(),this.cachedEventUids.has(cm(e))}saveEventToCache(e){this.cachedEventUids.add(cm(e)),this.lastProcessedEventTime=Date.now()}}function cm(e){return[e.type,e.eventId,e.sessionId,e.tenantId].filter((e=>e)).join("-")}function um(e){let{type:t,error:r}=e;return"unknown"===t&&"auth/no-auth-event"===(null===r||void 0===r?void 0:r.code)}const hm=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,fm=/^https?/;async function dm(e){if(e.config.emulator)return;const{authorizedDomains:t}=await async function(e){return zf(e,"GET","/v1/projects",arguments.length>1&&void 0!==arguments[1]?arguments[1]:{})}(e);for(const n of t)try{if(pm(n))return}catch(r){}Tf(e,"unauthorized-domain")}function pm(e){const t=Nf(),{protocol:r,hostname:n}=new URL(t);if(e.startsWith("chrome-extension://")){const a=new URL(e);return""===a.hostname&&""===n?"chrome-extension:"===r&&e.replace("chrome-extension://","")===t.replace("chrome-extension://",""):"chrome-extension:"===r&&a.hostname===n}if(!fm.test(r))return!1;if(hm.test(e))return n===e;const a=e.replace(/\./g,"\\.");return new RegExp("^(.+\\."+a+"|"+a+")$","i").test(n)}const mm=new Df(3e4,6e4);function gm(){const e=Op().___jsl;if(null===e||void 0===e?void 0:e.H)for(const t of Object.keys(e.H))if(e.H[t].r=e.H[t].r||[],e.H[t].L=e.H[t].L||[],e.H[t].r=[...e.H[t].L],e.CP)for(let r=0;r<e.CP.length;r++)e.CP[r]=null}function vm(e){return new Promise(((t,r)=>{var n,a,i;function s(){gm(),gapi.load("gapi.iframes",{callback:()=>{t(gapi.iframes.getContext())},ontimeout:()=>{gm(),r(_f(e,"network-request-failed"))},timeout:mm.get()})}if(null===(a=null===(n=Op().gapi)||void 0===n?void 0:n.iframes)||void 0===a?void 0:a.Iframe)t(gapi.iframes.getContext());else{if(!(null===(i=Op().gapi)||void 0===i?void 0:i.load)){const t=Ld("iframefcb");return Op()[t]=()=>{gapi.load?s():r(_f(e,"network-request-failed"))},Dd(`${Pd.gapiScript}?onload=${t}`).catch((e=>r(e)))}s()}})).catch((e=>{throw ym=null,e}))}let ym=null;const bm=new Df(5e3,15e3),wm={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},Em=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function Tm(e){const t=e.config;If(t.authDomain,e,"auth-domain-config-required");const r=t.emulator?Lf(t,"emulator/auth/iframe"):`https://${e.config.authDomain}/__/auth/iframe`,n={apiKey:t.apiKey,appName:e.name,v:hr},a=Em.get(e.config.apiHost);a&&(n.eid=a);const i=e._getFrameworks();return i.length&&(n.fw=i.join(",")),`${r}?${We(n).slice(1)}`}async function _m(e){const t=await function(e){return ym=ym||vm(e),ym}(e),r=Op().gapi;return If(r,e,"internal-error"),t.open({where:document.body,url:Tm(e),messageHandlersFilter:r.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:wm,dontclear:!0},(t=>new Promise((async(r,n)=>{await t.restyle({setHideOnLeave:!1});const a=_f(e,"network-request-failed"),i=Op().setTimeout((()=>{n(a)}),bm.get());function s(){Op().clearTimeout(i),r(t)}t.ping(s).then(s,(()=>{n(a)}))}))))}const Sm={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"};class km{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch(Ok){}}}function Cm(e,t,r){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:500,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:600;const i=Math.max((window.screen.availHeight-a)/2,0).toString(),s=Math.max((window.screen.availWidth-n)/2,0).toString();let o="";const l=Object.assign(Object.assign({},Sm),{width:n.toString(),height:a.toString(),top:i,left:s}),c=Fe().toLowerCase();r&&(o=bd(c)?"_blank":r),vd(c)&&(t=t||"http://localhost",l.scrollbars="yes");const u=Object.entries(l).reduce(((e,t)=>{let[r,n]=t;return`${e}${r}=${n},`}),"");if(function(){var e;return Sd(arguments.length>0&&void 0!==arguments[0]?arguments[0]:Fe())&&!!(null===(e=window.navigator)||void 0===e?void 0:e.standalone)}(c)&&"_self"!==o)return function(e,t){const r=document.createElement("a");r.href=e,r.target=t;const n=document.createEvent("MouseEvent");n.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),r.dispatchEvent(n)}(t||"",o),new km(null);const h=window.open(t||"",o,u);If(h,e,"popup-blocked");try{h.focus()}catch(Ok){}return new km(h)}const Im="__/auth/handler",Am="emulator/auth/handler",Rm=encodeURIComponent("fac");async function Nm(e,t,r,n,a,i){If(e.config.authDomain,e,"auth-domain-config-required"),If(e.config.apiKey,e,"invalid-api-key");const s={apiKey:e.config.apiKey,appName:e.name,authType:r,redirectUrl:n,v:hr,eventId:a};if(t instanceof np){t.setDefaultLanguage(e.languageCode),s.providerId=t.providerId||"",function(e){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}(t.getCustomParameters())||(s.customParameters=JSON.stringify(t.getCustomParameters()));for(const[e,t]of Object.entries(i||{}))s[e]=t}if(t instanceof ap){const e=t.getScopes().filter((e=>""!==e));e.length>0&&(s.scopes=e.join(","))}e.tenantId&&(s.tid=e.tenantId);const o=s;for(const u of Object.keys(o))void 0===o[u]&&delete o[u];const l=await e._getAppCheckToken(),c=l?`#${Rm}=${encodeURIComponent(l)}`:"";return`${function(e){let{config:t}=e;if(!t.emulator)return`https://${t.authDomain}/${Im}`;return Lf(t,Am)}(e)}?${We(o).slice(1)}${c}`}const Om="webStorageSupport";const xm=class{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=Ip,this._completeRedirectFn=om,this._overrideRedirectResult=am}async _openPopup(e,t,r,n){var a;Rf(null===(a=this.eventManagers[e._key()])||void 0===a?void 0:a.manager,"_initialize() not called before _openPopup()");return Cm(e,await Nm(e,t,r,Nf(),n),Rp())}async _openRedirect(e,t,r,n){await this._originValidation(e);return function(e){Op().location.href=e}(await Nm(e,t,r,Nf(),n)),new Promise((()=>{}))}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:e,promise:r}=this.eventManagers[t];return e?Promise.resolve(e):(Rf(r,"If manager is not set, promise should be"),r)}const r=this.initAndGetManager(e);return this.eventManagers[t]={promise:r},r.catch((()=>{delete this.eventManagers[t]})),r}async initAndGetManager(e){const t=await _m(e),r=new lm(e);return t.register("authEvent",(t=>{If(null===t||void 0===t?void 0:t.authEvent,e,"invalid-auth-event");return{status:r.onEvent(t.authEvent)?"ACK":"ERROR"}}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=t,r}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(Om,{type:Om},(r=>{var n;const a=null===(n=null===r||void 0===r?void 0:r[0])||void 0===n?void 0:n[Om];void 0!==a&&t(!!a),Tf(e,"internal-error")}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=dm(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return Cd()||yd()||Sd()}};var Pm="@firebase/auth",Dm="1.10.0";class Lm{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),(null===(e=this.auth.currentUser)||void 0===e?void 0:e.uid)||null}async getToken(e){if(this.assertAuthConfigured(),await this.auth._initializationPromise,!this.auth.currentUser)return null;return{accessToken:await this.auth.currentUser.getIdToken(e)}}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged((t=>{e((null===t||void 0===t?void 0:t.stsTokenManager.accessToken)||null)}));this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){If(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}const Mm=Le("authIdTokenMaxAge")||300;let Fm=null;var Um;Pd={loadJS:e=>new Promise(((t,r)=>{const n=document.createElement("script");n.setAttribute("src",e),n.onload=t,n.onerror=e=>{const t=_f("internal-error");t.customData=e,r(t)},n.type="text/javascript",n.charset="UTF-8",function(){var e,t;return null!==(t=null===(e=document.getElementsByTagName("head"))||void 0===e?void 0:e[0])&&void 0!==t?t:document}().appendChild(n)})),gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="},Um="Browser",sr(new Qe("auth",((e,t)=>{let{options:r}=t;const n=e.getProvider("app").getImmediate(),a=e.getProvider("heartbeat"),i=e.getProvider("app-check-internal"),{apiKey:s,authDomain:o}=n.options;If(s&&!s.includes(":"),"invalid-api-key",{appName:n.name});const l={apiKey:s,authDomain:o,clientPlatform:Um,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:Id(Um)},c=new Nd(n,a,i,l);return function(e,t){const r=(null===t||void 0===t?void 0:t.persistence)||[],n=(Array.isArray(r)?r:[r]).map(hd);(null===t||void 0===t?void 0:t.errorMap)&&e._updateErrorMap(t.errorMap),e._initializeWithPersistence(n,null===t||void 0===t?void 0:t.popupRedirectResolver)}(c,r),c}),"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback(((e,t,r)=>{e.getProvider("auth-internal").initialize()}))),sr(new Qe("auth-internal",(e=>(e=>new Lm(e))(Od(e.getProvider("auth").getImmediate()))),"PRIVATE").setInstantiationMode("EXPLICIT")),pr(Pm,Dm,function(e){switch(e){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}(Um)),pr(Pm,Dm,"esm2017");const Vm=fr({apiKey:"AIzaSyCY8824TtcW7_0ahUyV7-gIcbDuSzM-A-k",authDomain:"convenios-b58bd.firebaseapp.com",projectId:"convenios-b58bd",storageBucket:"convenios-b58bd.firebaseapp.com",messagingSenderId:"5050872496",appId:"1:5050872496:web:44dac645fffd1facb89aad"}),Bm=function(e,t){const r="object"==typeof e?e:dr(),n="string"==typeof e?e:t||za,a=or(r,"firestore").getImmediate({identifier:n});if(!a._initialized){const e=(e=>{const t=Pe(e);if(!t)return;const r=t.lastIndexOf(":");if(r<=0||r+1===t.length)throw new Error(`Invalid host ${t} with no separate hostname and port!`);const n=parseInt(t.substring(r+1),10);return"["===t[0]?[t.substring(1,r-1),n]:[t.substring(0,r),n]})("firestore");e&&oh(a,...e)}return a}(Vm),zm=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:dr();const t=or(e,"auth");if(t.isInitialized())return t.getImmediate();const r=function(e,t){const r=or(e,"auth");if(r.isInitialized()){const e=r.getImmediate();if(He(r.getOptions(),null!==t&&void 0!==t?t:{}))return e;Tf(e,"already-initialized")}return r.initialize({options:t})}(e,{popupRedirectResolver:xm,persistence:[jp,Tp,Ip]}),n=Le("authTokenSyncURL");if(n&&"boolean"===typeof isSecureContext&&isSecureContext){const e=new URL(n,location.origin);if(location.origin===e.origin){const t=(a=e.toString(),async e=>{const t=e&&await e.getIdTokenResult(),r=t&&((new Date).getTime()-Date.parse(t.issuedAtTime))/1e3;if(r&&r>Mm)return;const n=null===t||void 0===t?void 0:t.token;Fm!==n&&(Fm=n,await fetch(a,{method:n?"POST":"DELETE",headers:n?{Authorization:`Bearer ${n}`}:{}}))});!function(e,t,r){Ye(e).beforeAuthStateChanged(t,r)}(r,t,(()=>t(r.currentUser))),function(e,t,r,n){Ye(e).onIdTokenChanged(t,r,n)}(r,(e=>t(e)))}}var a;const i=Pe("auth");return i&&Hd(r,`http://${i}`),r}(Vm);var jm=r(579);const Hm=(0,a.createContext)();function $m(e){let{children:t}=e;const[r,n]=(0,a.useState)(null),[i,s]=(0,a.useState)(!0);(0,a.useEffect)((()=>{const e=function(e,t,r,n){return Ye(e).onAuthStateChanged(t,r,n)}(zm,(e=>{n(e),s(!1)}));return()=>e()}),[]);const o={user:r,login:(e,t)=>function(e,t,r){return lr(e.app)?Promise.reject(kf(e)):gp(Ye(e),rp.credential(t,r)).catch((async t=>{throw"auth/password-does-not-meet-requirements"===t.code&&vp(e),t}))}(zm,e,t),logout:()=>function(e){return Ye(e).signOut()}(zm),loading:i};return(0,jm.jsx)(Hm.Provider,{value:o,children:t})}function Wm(){return(0,a.useContext)(Hm)}const Gm=function(e){let{children:t}=e;const{user:r,loading:n}=Wm();return n?(0,jm.jsx)("div",{children:"Cargando..."}):r?t:(0,jm.jsx)(ve,{to:"/login"})};const Km=function(){const[e,t]=(0,a.useState)(""),[r,n]=(0,a.useState)(""),[i,s]=(0,a.useState)(""),{login:o}=Wm(),l=ne();return(0,jm.jsx)("div",{className:"login-container",children:(0,jm.jsxs)("div",{className:"login-form",children:[(0,jm.jsx)("h2",{children:"Iniciar Sesi\xf3n"}),i&&(0,jm.jsx)("div",{className:"error-message",children:i}),(0,jm.jsxs)("form",{onSubmit:async t=>{t.preventDefault(),s("");try{await o(e,r),l("/")}catch(i){s("Error al iniciar sesi\xf3n: "+i.message)}},children:[(0,jm.jsxs)("div",{className:"form-group",children:[(0,jm.jsx)("label",{children:"Email:"}),(0,jm.jsx)("input",{type:"email",value:e,onChange:e=>t(e.target.value),required:!0})]}),(0,jm.jsxs)("div",{className:"form-group",children:[(0,jm.jsx)("label",{children:"Contrase\xf1a:"}),(0,jm.jsx)("input",{type:"password",value:r,onChange:e=>n(e.target.value),required:!0})]}),(0,jm.jsx)("button",{type:"submit",children:"Iniciar Sesi\xf3n"})]})]})})};var qm={version:"0.18.5"},Xm=1200,Ym=1252,Qm=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],Jm={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},Zm=function(e){-1!=Qm.indexOf(e)&&(Ym=Jm[0]=e)};var eg=function(e){Xm=e,Zm(e)};function tg(){eg(1200),Zm(1252)}function rg(e){for(var t=[],r=0,n=e.length;r<n;++r)t[r]=e.charCodeAt(r);return t}function ng(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r+1)+(e.charCodeAt(2*r)<<8));return t.join("")}var ag,ig=function(e){var t=e.charCodeAt(0),r=e.charCodeAt(1);return 255==t&&254==r?function(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r)+(e.charCodeAt(2*r+1)<<8));return t.join("")}(e.slice(2)):254==t&&255==r?ng(e.slice(2)):65279==t?e.slice(1):e},sg=function(e){return String.fromCharCode(e)},og=function(e){return String.fromCharCode(e)};var lg="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function cg(e){for(var t="",r=0,n=0,a=0,i=0,s=0,o=0,l=0,c=0;c<e.length;)i=(r=e.charCodeAt(c++))>>2,s=(3&r)<<4|(n=e.charCodeAt(c++))>>4,o=(15&n)<<2|(a=e.charCodeAt(c++))>>6,l=63&a,isNaN(n)?o=l=64:isNaN(a)&&(l=64),t+=lg.charAt(i)+lg.charAt(s)+lg.charAt(o)+lg.charAt(l);return t}function ug(e){var t="",r=0,n=0,a=0,i=0,s=0,o=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var l=0;l<e.length;)r=lg.indexOf(e.charAt(l++))<<2|(i=lg.indexOf(e.charAt(l++)))>>4,t+=String.fromCharCode(r),n=(15&i)<<4|(s=lg.indexOf(e.charAt(l++)))>>2,64!==s&&(t+=String.fromCharCode(n)),a=(3&s)<<6|(o=lg.indexOf(e.charAt(l++))),64!==o&&(t+=String.fromCharCode(a));return t}var hg=function(){return"undefined"!==typeof Buffer&&"undefined"!==typeof process&&"undefined"!==typeof process.versions&&!!process.versions.node}(),fg=function(){if("undefined"!==typeof Buffer){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch(Ok){e=!0}return e?function(e,t){return t?new Buffer(e,t):new Buffer(e)}:Buffer.from.bind(Buffer)}return function(){}}();function dg(e){return hg?Buffer.alloc?Buffer.alloc(e):new Buffer(e):"undefined"!=typeof Uint8Array?new Uint8Array(e):new Array(e)}function pg(e){return hg?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):"undefined"!=typeof Uint8Array?new Uint8Array(e):new Array(e)}var mg=function(e){return hg?fg(e,"binary"):e.split("").map((function(e){return 255&e.charCodeAt(0)}))};function gg(e){if(Array.isArray(e))return e.map((function(e){return String.fromCharCode(e)})).join("");for(var t=[],r=0;r<e.length;++r)t[r]=String.fromCharCode(e[r]);return t.join("")}function vg(e){if("undefined"==typeof ArrayBuffer)throw new Error("Unsupported");if(e instanceof ArrayBuffer)return vg(new Uint8Array(e));for(var t=new Array(e.length),r=0;r<e.length;++r)t[r]=e[r];return t}var yg=hg?function(e){return Buffer.concat(e.map((function(e){return Buffer.isBuffer(e)?e:fg(e)})))}:function(e){if("undefined"!==typeof Uint8Array){var t=0,r=0;for(t=0;t<e.length;++t)r+=e[t].length;var n=new Uint8Array(r),a=0;for(t=0,r=0;t<e.length;r+=a,++t)if(a=e[t].length,e[t]instanceof Uint8Array)n.set(e[t],r);else{if("string"==typeof e[t])throw"wtf";n.set(new Uint8Array(e[t]),r)}return n}return[].concat.apply([],e.map((function(e){return Array.isArray(e)?e:[].slice.call(e)})))};var bg=/\u0000/g,wg=/[\u0001-\u0006]/g;function Eg(e){for(var t="",r=e.length-1;r>=0;)t+=e.charAt(r--);return t}function Tg(e,t){var r=""+e;return r.length>=t?r:Ov("0",t-r.length)+r}function _g(e,t){var r=""+e;return r.length>=t?r:Ov(" ",t-r.length)+r}function Sg(e,t){var r=""+e;return r.length>=t?r:r+Ov(" ",t-r.length)}var kg=Math.pow(2,32);function Cg(e,t){return e>kg||e<-kg?function(e,t){var r=""+Math.round(e);return r.length>=t?r:Ov("0",t-r.length)+r}(e,t):function(e,t){var r=""+e;return r.length>=t?r:Ov("0",t-r.length)+r}(Math.round(e),t)}function Ig(e,t){return t=t||0,e.length>=7+t&&103===(32|e.charCodeAt(t))&&101===(32|e.charCodeAt(t+1))&&110===(32|e.charCodeAt(t+2))&&101===(32|e.charCodeAt(t+3))&&114===(32|e.charCodeAt(t+4))&&97===(32|e.charCodeAt(t+5))&&108===(32|e.charCodeAt(t+6))}var Ag=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],Rg=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];var Ng={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"\u4e0a\u5348/\u4e0b\u5348 "hh"\u6642"mm"\u5206"ss"\u79d2 "'},Og={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},xg={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function Pg(e,t,r){for(var n=e<0?-1:1,a=e*n,i=0,s=1,o=0,l=1,c=0,u=0,h=Math.floor(a);c<t&&(o=(h=Math.floor(a))*s+i,u=h*c+l,!(a-h<5e-8));)a=1/(a-h),i=s,s=o,l=c,c=u;if(u>t&&(c>t?(u=l,o=i):(u=c,o=s)),!r)return[0,n*o,u];var f=Math.floor(n*o/u);return[f,n*o-f*u,u]}function Dg(e,t,r){if(e>2958465||e<0)return null;var n=0|e,a=Math.floor(86400*(e-n)),i=0,s=[],o={D:n,T:a,u:86400*(e-n)-a,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(o.u)<1e-6&&(o.u=0),t&&t.date1904&&(n+=1462),o.u>.9999&&(o.u=0,86400==++a&&(o.T=a=0,++n,++o.D)),60===n)s=r?[1317,10,29]:[1900,2,29],i=3;else if(0===n)s=r?[1317,8,29]:[1900,1,0],i=6;else{n>60&&--n;var l=new Date(1900,0,1);l.setDate(l.getDate()+n-1),s=[l.getFullYear(),l.getMonth()+1,l.getDate()],i=l.getDay(),n<60&&(i=(i+6)%7),r&&(i=function(e,t){t[0]-=581;var r=e.getDay();e<60&&(r=(r+6)%7);return r}(l,s))}return o.y=s[0],o.m=s[1],o.d=s[2],o.S=a%60,a=Math.floor(a/60),o.M=a%60,a=Math.floor(a/60),o.H=a,o.q=i,o}var Lg=new Date(1899,11,31,0,0,0),Mg=Lg.getTime(),Fg=new Date(1900,2,1,0,0,0);function Ug(e,t){var r=e.getTime();return t?r-=1262304e5:e>=Fg&&(r+=864e5),(r-(Mg+6e4*(e.getTimezoneOffset()-Lg.getTimezoneOffset())))/864e5}function Vg(e){return-1==e.indexOf(".")?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function Bg(e){var t,r=Math.floor(Math.log(Math.abs(e))*Math.LOG10E);return t=r>=-4&&r<=-1?e.toPrecision(10+r):Math.abs(r)<=9?function(e){var t=e<0?12:11,r=Vg(e.toFixed(12));return r.length<=t||(r=e.toPrecision(10)).length<=t?r:e.toExponential(5)}(e):10===r?e.toFixed(10).substr(0,12):function(e){var t=Vg(e.toFixed(11));return t.length>(e<0?12:11)||"0"===t||"-0"===t?e.toPrecision(6):t}(e),Vg(function(e){return-1==e.indexOf("E")?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}(t.toUpperCase()))}function zg(e,t){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(0|e)===e?e.toString(10):Bg(e);case"undefined":return"";case"object":if(null==e)return"";if(e instanceof Date)return lv(14,Ug(e,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+e)}function jg(e,t,r,n){var a,i="",s=0,o=0,l=r.y,c=0;switch(e){case 98:l=r.y+543;case 121:switch(t.length){case 1:case 2:a=l%100,c=2;break;default:a=l%1e4,c=4}break;case 109:switch(t.length){case 1:case 2:a=r.m,c=t.length;break;case 3:return Rg[r.m-1][1];case 5:return Rg[r.m-1][0];default:return Rg[r.m-1][2]}break;case 100:switch(t.length){case 1:case 2:a=r.d,c=t.length;break;case 3:return Ag[r.q][0];default:return Ag[r.q][1]}break;case 104:switch(t.length){case 1:case 2:a=1+(r.H+11)%12,c=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:a=r.H,c=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:a=r.M,c=t.length;break;default:throw"bad minute format: "+t}break;case 115:if("s"!=t&&"ss"!=t&&".0"!=t&&".00"!=t&&".000"!=t)throw"bad second format: "+t;return 0!==r.u||"s"!=t&&"ss"!=t?(o=n>=2?3===n?1e3:100:1===n?10:1,(s=Math.round(o*(r.S+r.u)))>=60*o&&(s=0),"s"===t?0===s?"0":""+s/o:(i=Tg(s,2+n),"ss"===t?i.substr(0,2):"."+i.substr(2,t.length-1))):Tg(r.S,t.length);case 90:switch(t){case"[h]":case"[hh]":a=24*r.D+r.H;break;case"[m]":case"[mm]":a=60*(24*r.D+r.H)+r.M;break;case"[s]":case"[ss]":a=60*(60*(24*r.D+r.H)+r.M)+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+t}c=3===t.length?1:2;break;case 101:a=l,c=1}return c>0?Tg(a,c):""}function Hg(e){if(e.length<=3)return e;for(var t=e.length%3,r=e.substr(0,t);t!=e.length;t+=3)r+=(r.length>0?",":"")+e.substr(t,3);return r}var $g=/%/g;function Wg(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(0==t)return"0.0E+0";if(t<0)return"-"+Wg(e,-t);var a=e.indexOf(".");-1===a&&(a=e.indexOf("E"));var i=Math.floor(Math.log(t)*Math.LOG10E)%a;if(i<0&&(i+=a),-1===(r=(t/Math.pow(10,i)).toPrecision(n+1+(a+i)%a)).indexOf("e")){var s=Math.floor(Math.log(t)*Math.LOG10E);for(-1===r.indexOf(".")?r=r.charAt(0)+"."+r.substr(1)+"E+"+(s-r.length+i):r+="E+"+(s-i);"0."===r.substr(0,2);)r=(r=r.charAt(0)+r.substr(2,a)+"."+r.substr(2+a)).replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,(function(e,t,r,n){return t+r+n.substr(0,(a+i)%a)+"."+n.substr(i)+"E"}))}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var Gg=/# (\?+)( ?)\/( ?)(\d+)/;var Kg=/^#*0*\.([0#]+)/,qg=/\).*[0#]/,Xg=/\(###\) ###\\?-####/;function Yg(e){for(var t,r="",n=0;n!=e.length;++n)switch(t=e.charCodeAt(n)){case 35:break;case 63:r+=" ";break;case 48:r+="0";break;default:r+=String.fromCharCode(t)}return r}function Qg(e,t){var r=Math.pow(10,t);return""+Math.round(e*r)/r}function Jg(e,t){var r=e-Math.floor(e),n=Math.pow(10,t);return t<(""+Math.round(r*n)).length?0:Math.round(r*n)}function Zg(e,t,r){if(40===e.charCodeAt(0)&&!t.match(qg)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Zg("n",n,r):"("+Zg("n",n,-r)+")"}if(44===t.charCodeAt(t.length-1))return function(e,t,r){for(var n=t.length-1;44===t.charCodeAt(n-1);)--n;return rv(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}(e,t,r);if(-1!==t.indexOf("%"))return function(e,t,r){var n=t.replace($g,""),a=t.length-n.length;return rv(e,n,r*Math.pow(10,2*a))+Ov("%",a)}(e,t,r);if(-1!==t.indexOf("E"))return Wg(t,r);if(36===t.charCodeAt(0))return"$"+Zg(e,t.substr(" "==t.charAt(1)?2:1),r);var a,i,s,o,l=Math.abs(r),c=r<0?"-":"";if(t.match(/^00+$/))return c+Cg(l,t.length);if(t.match(/^[#?]+$/))return"0"===(a=Cg(r,0))&&(a=""),a.length>t.length?a:Yg(t.substr(0,t.length-a.length))+a;if(i=t.match(Gg))return function(e,t,r){var n=parseInt(e[4],10),a=Math.round(t*n),i=Math.floor(a/n),s=a-i*n,o=n;return r+(0===i?"":""+i)+" "+(0===s?Ov(" ",e[1].length+1+e[4].length):_g(s,e[1].length)+e[2]+"/"+e[3]+Tg(o,e[4].length))}(i,l,c);if(t.match(/^#+0+$/))return c+Cg(l,t.length-t.indexOf("0"));if(i=t.match(Kg))return a=Qg(r,i[1].length).replace(/^([^\.]+)$/,"$1."+Yg(i[1])).replace(/\.$/,"."+Yg(i[1])).replace(/\.(\d*)$/,(function(e,t){return"."+t+Ov("0",Yg(i[1]).length-t.length)})),-1!==t.indexOf("0.")?a:a.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),i=t.match(/^(0*)\.(#*)$/))return c+Qg(l,i[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,i[1].length?"0.":".");if(i=t.match(/^#{1,3},##0(\.?)$/))return c+Hg(Cg(l,0));if(i=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Zg(e,t,-r):Hg(""+(Math.floor(r)+function(e,t){return t<(""+Math.round((e-Math.floor(e))*Math.pow(10,t))).length?1:0}(r,i[1].length)))+"."+Tg(Jg(r,i[1].length),i[1].length);if(i=t.match(/^#,#*,#0/))return Zg(e,t.replace(/^#,#*,/,""),r);if(i=t.match(/^([0#]+)(\\?-([0#]+))+$/))return a=Eg(Zg(e,t.replace(/[\\-]/g,""),r)),s=0,Eg(Eg(t.replace(/\\/g,"")).replace(/[0#]/g,(function(e){return s<a.length?a.charAt(s++):"0"===e?"0":""})));if(t.match(Xg))return"("+(a=Zg(e,"##########",r)).substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var u="";if(i=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(i[4].length,7),o=Pg(l,Math.pow(10,s)-1,!1),a=""+c," "==(u=rv("n",i[1],o[1])).charAt(u.length-1)&&(u=u.substr(0,u.length-1)+"0"),a+=u+i[2]+"/"+i[3],(u=Sg(o[2],s)).length<i[4].length&&(u=Yg(i[4].substr(i[4].length-u.length))+u),a+=u;if(i=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(Math.max(i[1].length,i[4].length),7),c+((o=Pg(l,Math.pow(10,s)-1,!0))[0]||(o[1]?"":"0"))+" "+(o[1]?_g(o[1],s)+i[2]+"/"+i[3]+Sg(o[2],s):Ov(" ",2*s+1+i[2].length+i[3].length));if(i=t.match(/^[#0?]+$/))return a=Cg(r,0),t.length<=a.length?a:Yg(t.substr(0,t.length-a.length))+a;if(i=t.match(/^([#0?]+)\.([#0]+)$/)){a=""+r.toFixed(Math.min(i[2].length,10)).replace(/([^0])0+$/,"$1"),s=a.indexOf(".");var h=t.indexOf(".")-s,f=t.length-a.length-h;return Yg(t.substr(0,h)+a+t.substr(t.length-f))}if(i=t.match(/^00,000\.([#0]*0)$/))return s=Jg(r,i[1].length),r<0?"-"+Zg(e,t,-r):Hg(function(e){return e<2147483647&&e>-2147483648?""+(e>=0?0|e:e-1|0):""+Math.floor(e)}(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,(function(e){return"00,"+(e.length<3?Tg(0,3-e.length):"")+e}))+"."+Tg(s,i[1].length);switch(t){case"###,##0.00":return Zg(e,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var d=Hg(Cg(l,0));return"0"!==d?c+d:"";case"###,###.00":return Zg(e,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return Zg(e,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+t+"|")}function ev(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(0==t)return"0.0E+0";if(t<0)return"-"+ev(e,-t);var a=e.indexOf(".");-1===a&&(a=e.indexOf("E"));var i=Math.floor(Math.log(t)*Math.LOG10E)%a;if(i<0&&(i+=a),!(r=(t/Math.pow(10,i)).toPrecision(n+1+(a+i)%a)).match(/[Ee]/)){var s=Math.floor(Math.log(t)*Math.LOG10E);-1===r.indexOf(".")?r=r.charAt(0)+"."+r.substr(1)+"E+"+(s-r.length+i):r+="E+"+(s-i),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,(function(e,t,r,n){return t+r+n.substr(0,(a+i)%a)+"."+n.substr(i)+"E"}))}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function tv(e,t,r){if(40===e.charCodeAt(0)&&!t.match(qg)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?tv("n",n,r):"("+tv("n",n,-r)+")"}if(44===t.charCodeAt(t.length-1))return function(e,t,r){for(var n=t.length-1;44===t.charCodeAt(n-1);)--n;return rv(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}(e,t,r);if(-1!==t.indexOf("%"))return function(e,t,r){var n=t.replace($g,""),a=t.length-n.length;return rv(e,n,r*Math.pow(10,2*a))+Ov("%",a)}(e,t,r);if(-1!==t.indexOf("E"))return ev(t,r);if(36===t.charCodeAt(0))return"$"+tv(e,t.substr(" "==t.charAt(1)?2:1),r);var a,i,s,o,l=Math.abs(r),c=r<0?"-":"";if(t.match(/^00+$/))return c+Tg(l,t.length);if(t.match(/^[#?]+$/))return a=""+r,0===r&&(a=""),a.length>t.length?a:Yg(t.substr(0,t.length-a.length))+a;if(i=t.match(Gg))return function(e,t,r){return r+(0===t?"":""+t)+Ov(" ",e[1].length+2+e[4].length)}(i,l,c);if(t.match(/^#+0+$/))return c+Tg(l,t.length-t.indexOf("0"));if(i=t.match(Kg))return a=(a=(""+r).replace(/^([^\.]+)$/,"$1."+Yg(i[1])).replace(/\.$/,"."+Yg(i[1]))).replace(/\.(\d*)$/,(function(e,t){return"."+t+Ov("0",Yg(i[1]).length-t.length)})),-1!==t.indexOf("0.")?a:a.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),i=t.match(/^(0*)\.(#*)$/))return c+(""+l).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,i[1].length?"0.":".");if(i=t.match(/^#{1,3},##0(\.?)$/))return c+Hg(""+l);if(i=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+tv(e,t,-r):Hg(""+r)+"."+Ov("0",i[1].length);if(i=t.match(/^#,#*,#0/))return tv(e,t.replace(/^#,#*,/,""),r);if(i=t.match(/^([0#]+)(\\?-([0#]+))+$/))return a=Eg(tv(e,t.replace(/[\\-]/g,""),r)),s=0,Eg(Eg(t.replace(/\\/g,"")).replace(/[0#]/g,(function(e){return s<a.length?a.charAt(s++):"0"===e?"0":""})));if(t.match(Xg))return"("+(a=tv(e,"##########",r)).substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var u="";if(i=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(i[4].length,7),o=Pg(l,Math.pow(10,s)-1,!1),a=""+c," "==(u=rv("n",i[1],o[1])).charAt(u.length-1)&&(u=u.substr(0,u.length-1)+"0"),a+=u+i[2]+"/"+i[3],(u=Sg(o[2],s)).length<i[4].length&&(u=Yg(i[4].substr(i[4].length-u.length))+u),a+=u;if(i=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(Math.max(i[1].length,i[4].length),7),c+((o=Pg(l,Math.pow(10,s)-1,!0))[0]||(o[1]?"":"0"))+" "+(o[1]?_g(o[1],s)+i[2]+"/"+i[3]+Sg(o[2],s):Ov(" ",2*s+1+i[2].length+i[3].length));if(i=t.match(/^[#0?]+$/))return a=""+r,t.length<=a.length?a:Yg(t.substr(0,t.length-a.length))+a;if(i=t.match(/^([#0]+)\.([#0]+)$/)){a=""+r.toFixed(Math.min(i[2].length,10)).replace(/([^0])0+$/,"$1"),s=a.indexOf(".");var h=t.indexOf(".")-s,f=t.length-a.length-h;return Yg(t.substr(0,h)+a+t.substr(t.length-f))}if(i=t.match(/^00,000\.([#0]*0)$/))return r<0?"-"+tv(e,t,-r):Hg(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,(function(e){return"00,"+(e.length<3?Tg(0,3-e.length):"")+e}))+"."+Tg(0,i[1].length);switch(t){case"###,###":case"##,###":case"#,###":var d=Hg(""+l);return"0"!==d?c+d:"";default:if(t.match(/\.[0#?]*$/))return tv(e,t.slice(0,t.lastIndexOf(".")),r)+Yg(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}function rv(e,t,r){return(0|r)===r?tv(e,t,r):Zg(e,t,r)}var nv=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function av(e){for(var t=0,r="",n="";t<e.length;)switch(r=e.charAt(t)){case"G":Ig(e,t)&&(t+=6),t++;break;case'"':for(;34!==e.charCodeAt(++t)&&t<e.length;);++t;break;case"\\":case"_":t+=2;break;case"@":++t;break;case"B":case"b":if("1"===e.charAt(t+1)||"2"===e.charAt(t+1))return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"\u4e0a":if("A/P"===e.substr(t,3).toUpperCase())return!0;if("AM/PM"===e.substr(t,5).toUpperCase())return!0;if("\u4e0a\u5348/\u4e0b\u5348"===e.substr(t,5).toUpperCase())return!0;++t;break;case"[":for(n=r;"]"!==e.charAt(t++)&&t<e.length;)n+=e.charAt(t);if(n.match(nv))return!0;break;case".":case"0":case"#":for(;t<e.length&&("0#?.,E+-%".indexOf(r=e.charAt(++t))>-1||"\\"==r&&"-"==e.charAt(t+1)&&"0#".indexOf(e.charAt(t+2))>-1););break;case"?":for(;e.charAt(++t)===r;);break;case"*":++t," "!=e.charAt(t)&&"*"!=e.charAt(t)||++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<e.length&&"0123456789".indexOf(e.charAt(++t))>-1;);break;default:++t}return!1}var iv=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function sv(e,t){if(null==t)return!1;var r=parseFloat(t[2]);switch(t[1]){case"=":if(e==r)return!0;break;case">":if(e>r)return!0;break;case"<":if(e<r)return!0;break;case"<>":if(e!=r)return!0;break;case">=":if(e>=r)return!0;break;case"<=":if(e<=r)return!0}return!1}function ov(e,t){var r=function(e){for(var t=[],r=!1,n=0,a=0;n<e.length;++n)switch(e.charCodeAt(n)){case 34:r=!r;break;case 95:case 42:case 92:++n;break;case 59:t[t.length]=e.substr(a,n-a),a=n+1}if(t[t.length]=e.substr(a),!0===r)throw new Error("Format |"+e+"| unterminated string ");return t}(e),n=r.length,a=r[n-1].indexOf("@");if(n<4&&a>-1&&--n,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if("number"!==typeof t)return[4,4===r.length||a>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=a>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=a>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=a>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"]}var i=t>0?r[0]:t<0?r[1]:r[2];if(-1===r[0].indexOf("[")&&-1===r[1].indexOf("["))return[n,i];if(null!=r[0].match(/\[[=<>]/)||null!=r[1].match(/\[[=<>]/)){var s=r[0].match(iv),o=r[1].match(iv);return sv(t,s)?[n,r[0]]:sv(t,o)?[n,r[1]]:[n,r[null!=s&&null!=o?2:1]]}return[n,i]}function lv(e,t,r){null==r&&(r={});var n="";switch(typeof e){case"string":n="m/d/yy"==e&&r.dateNF?r.dateNF:e;break;case"number":null==(n=14==e&&r.dateNF?r.dateNF:(null!=r.table?r.table:Ng)[e])&&(n=r.table&&r.table[Og[e]]||Ng[Og[e]]),null==n&&(n=xg[e]||"General")}if(Ig(n,0))return zg(t,r);t instanceof Date&&(t=Ug(t,r.date1904));var a=ov(n,t);if(Ig(a[1]))return zg(t,r);if(!0===t)t="TRUE";else if(!1===t)t="FALSE";else if(""===t||null==t)return"";return function(e,t,r,n){for(var a,i,s,o=[],l="",c=0,u="",h="t",f="H";c<e.length;)switch(u=e.charAt(c)){case"G":if(!Ig(e,c))throw new Error("unrecognized character "+u+" in "+e);o[o.length]={t:"G",v:"General"},c+=7;break;case'"':for(l="";34!==(s=e.charCodeAt(++c))&&c<e.length;)l+=String.fromCharCode(s);o[o.length]={t:"t",v:l},++c;break;case"\\":var d=e.charAt(++c),p="("===d||")"===d?d:"t";o[o.length]={t:p,v:d},++c;break;case"_":o[o.length]={t:"t",v:" "},c+=2;break;case"@":o[o.length]={t:"T",v:t},++c;break;case"B":case"b":if("1"===e.charAt(c+1)||"2"===e.charAt(c+1)){if(null==a&&null==(a=Dg(t,r,"2"===e.charAt(c+1))))return"";o[o.length]={t:"X",v:e.substr(c,2)},h=u,c+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":u=u.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0)return"";if(null==a&&null==(a=Dg(t,r)))return"";for(l=u;++c<e.length&&e.charAt(c).toLowerCase()===u;)l+=u;"m"===u&&"h"===h.toLowerCase()&&(u="M"),"h"===u&&(u=f),o[o.length]={t:u,v:l},h=u;break;case"A":case"a":case"\u4e0a":var m={t:u,v:u};if(null==a&&(a=Dg(t,r)),"A/P"===e.substr(c,3).toUpperCase()?(null!=a&&(m.v=a.H>=12?"P":"A"),m.t="T",f="h",c+=3):"AM/PM"===e.substr(c,5).toUpperCase()?(null!=a&&(m.v=a.H>=12?"PM":"AM"),m.t="T",c+=5,f="h"):"\u4e0a\u5348/\u4e0b\u5348"===e.substr(c,5).toUpperCase()?(null!=a&&(m.v=a.H>=12?"\u4e0b\u5348":"\u4e0a\u5348"),m.t="T",c+=5,f="h"):(m.t="t",++c),null==a&&"T"===m.t)return"";o[o.length]=m,h=u;break;case"[":for(l=u;"]"!==e.charAt(c++)&&c<e.length;)l+=e.charAt(c);if("]"!==l.slice(-1))throw'unterminated "[" block: |'+l+"|";if(l.match(nv)){if(null==a&&null==(a=Dg(t,r)))return"";o[o.length]={t:"Z",v:l.toLowerCase()},h=l.charAt(1)}else l.indexOf("$")>-1&&(l=(l.match(/\$([^-\[\]]*)/)||[])[1]||"$",av(e)||(o[o.length]={t:"t",v:l}));break;case".":if(null!=a){for(l=u;++c<e.length&&"0"===(u=e.charAt(c));)l+=u;o[o.length]={t:"s",v:l};break}case"0":case"#":for(l=u;++c<e.length&&"0#?.,E+-%".indexOf(u=e.charAt(c))>-1;)l+=u;o[o.length]={t:"n",v:l};break;case"?":for(l=u;e.charAt(++c)===u;)l+=u;o[o.length]={t:u,v:l},h=u;break;case"*":++c," "!=e.charAt(c)&&"*"!=e.charAt(c)||++c;break;case"(":case")":o[o.length]={t:1===n?"t":u,v:u},++c;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(l=u;c<e.length&&"0123456789".indexOf(e.charAt(++c))>-1;)l+=e.charAt(c);o[o.length]={t:"D",v:l};break;case" ":o[o.length]={t:u,v:u},++c;break;case"$":o[o.length]={t:"t",v:"$"},++c;break;default:if(-1===",$-+/():!^&'~{}<>=\u20acacfijklopqrtuvwxzP".indexOf(u))throw new Error("unrecognized character "+u+" in "+e);o[o.length]={t:"t",v:u},++c}var g,v=0,y=0;for(c=o.length-1,h="t";c>=0;--c)switch(o[c].t){case"h":case"H":o[c].t=f,h="h",v<1&&(v=1);break;case"s":(g=o[c].v.match(/\.0+$/))&&(y=Math.max(y,g[0].length-1)),v<3&&(v=3);case"d":case"y":case"M":case"e":h=o[c].t;break;case"m":"s"===h&&(o[c].t="M",v<2&&(v=2));break;case"X":break;case"Z":v<1&&o[c].v.match(/[Hh]/)&&(v=1),v<2&&o[c].v.match(/[Mm]/)&&(v=2),v<3&&o[c].v.match(/[Ss]/)&&(v=3)}switch(v){case 0:break;case 1:a.u>=.5&&(a.u=0,++a.S),a.S>=60&&(a.S=0,++a.M),a.M>=60&&(a.M=0,++a.H);break;case 2:a.u>=.5&&(a.u=0,++a.S),a.S>=60&&(a.S=0,++a.M)}var b,w="";for(c=0;c<o.length;++c)switch(o[c].t){case"t":case"T":case" ":case"D":break;case"X":o[c].v="",o[c].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":o[c].v=jg(o[c].t.charCodeAt(0),o[c].v,a,y),o[c].t="t";break;case"n":case"?":for(b=c+1;null!=o[b]&&("?"===(u=o[b].t)||"D"===u||(" "===u||"t"===u)&&null!=o[b+1]&&("?"===o[b+1].t||"t"===o[b+1].t&&"/"===o[b+1].v)||"("===o[c].t&&(" "===u||"n"===u||")"===u)||"t"===u&&("/"===o[b].v||" "===o[b].v&&null!=o[b+1]&&"?"==o[b+1].t));)o[c].v+=o[b].v,o[b]={v:"",t:";"},++b;w+=o[c].v,c=b-1;break;case"G":o[c].t="t",o[c].v=zg(t,r)}var E,T,_="";if(w.length>0){40==w.charCodeAt(0)?(E=t<0&&45===w.charCodeAt(0)?-t:t,T=rv("n",w,E)):(T=rv("n",w,E=t<0&&n>1?-t:t),E<0&&o[0]&&"t"==o[0].t&&(T=T.substr(1),o[0].v="-"+o[0].v)),b=T.length-1;var S=o.length;for(c=0;c<o.length;++c)if(null!=o[c]&&"t"!=o[c].t&&o[c].v.indexOf(".")>-1){S=c;break}var k=o.length;if(S===o.length&&-1===T.indexOf("E")){for(c=o.length-1;c>=0;--c)null!=o[c]&&-1!=="n?".indexOf(o[c].t)&&(b>=o[c].v.length-1?(b-=o[c].v.length,o[c].v=T.substr(b+1,o[c].v.length)):b<0?o[c].v="":(o[c].v=T.substr(0,b+1),b=-1),o[c].t="t",k=c);b>=0&&k<o.length&&(o[k].v=T.substr(0,b+1)+o[k].v)}else if(S!==o.length&&-1===T.indexOf("E")){for(b=T.indexOf(".")-1,c=S;c>=0;--c)if(null!=o[c]&&-1!=="n?".indexOf(o[c].t)){for(i=o[c].v.indexOf(".")>-1&&c===S?o[c].v.indexOf(".")-1:o[c].v.length-1,_=o[c].v.substr(i+1);i>=0;--i)b>=0&&("0"===o[c].v.charAt(i)||"#"===o[c].v.charAt(i))&&(_=T.charAt(b--)+_);o[c].v=_,o[c].t="t",k=c}for(b>=0&&k<o.length&&(o[k].v=T.substr(0,b+1)+o[k].v),b=T.indexOf(".")+1,c=S;c<o.length;++c)if(null!=o[c]&&(-1!=="n?(".indexOf(o[c].t)||c===S)){for(i=o[c].v.indexOf(".")>-1&&c===S?o[c].v.indexOf(".")+1:0,_=o[c].v.substr(0,i);i<o[c].v.length;++i)b<T.length&&(_+=T.charAt(b++));o[c].v=_,o[c].t="t",k=c}}}for(c=0;c<o.length;++c)null!=o[c]&&"n?".indexOf(o[c].t)>-1&&(E=n>1&&t<0&&c>0&&"-"===o[c-1].v?-t:t,o[c].v=rv(o[c].t,o[c].v,E),o[c].t="t");var C="";for(c=0;c!==o.length;++c)null!=o[c]&&(C+=o[c].v);return C}(a[1],t,r,a[0])}function cv(e,t){if("number"!=typeof t){t=+t||-1;for(var r=0;r<392;++r)if(void 0!=Ng[r]){if(Ng[r]==e){t=r;break}}else t<0&&(t=r);t<0&&(t=391)}return Ng[t]=e,t}function uv(){var e;e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"\u4e0a\u5348/\u4e0b\u5348 "hh"\u6642"mm"\u5206"ss"\u79d2 "',Ng=e}var hv={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},fv=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;var dv=function(){var e={};e.version="1.2.0";var t=function(){for(var e=0,t=new Array(256),r=0;256!=r;++r)e=1&(e=1&(e=1&(e=1&(e=1&(e=1&(e=1&(e=1&(e=r)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1,t[r]=e;return"undefined"!==typeof Int32Array?new Int32Array(t):t}();var r=function(e){var t=0,r=0,n=0,a="undefined"!==typeof Int32Array?new Int32Array(4096):new Array(4096);for(n=0;256!=n;++n)a[n]=e[n];for(n=0;256!=n;++n)for(r=e[n],t=256+n;t<4096;t+=256)r=a[t]=r>>>8^e[255&r];var i=[];for(n=1;16!=n;++n)i[n-1]="undefined"!==typeof Int32Array?a.subarray(256*n,256*n+256):a.slice(256*n,256*n+256);return i}(t),n=r[0],a=r[1],i=r[2],s=r[3],o=r[4],l=r[5],c=r[6],u=r[7],h=r[8],f=r[9],d=r[10],p=r[11],m=r[12],g=r[13],v=r[14];return e.table=t,e.bstr=function(e,r){for(var n=~r,a=0,i=e.length;a<i;)n=n>>>8^t[255&(n^e.charCodeAt(a++))];return~n},e.buf=function(e,r){for(var y=~r,b=e.length-15,w=0;w<b;)y=v[e[w++]^255&y]^g[e[w++]^y>>8&255]^m[e[w++]^y>>16&255]^p[e[w++]^y>>>24]^d[e[w++]]^f[e[w++]]^h[e[w++]]^u[e[w++]]^c[e[w++]]^l[e[w++]]^o[e[w++]]^s[e[w++]]^i[e[w++]]^a[e[w++]]^n[e[w++]]^t[e[w++]];for(b+=15;w<b;)y=y>>>8^t[255&(y^e[w++])];return~y},e.str=function(e,r){for(var n=~r,a=0,i=e.length,s=0,o=0;a<i;)(s=e.charCodeAt(a++))<128?n=n>>>8^t[255&(n^s)]:s<2048?n=(n=n>>>8^t[255&(n^(192|s>>6&31))])>>>8^t[255&(n^(128|63&s))]:s>=55296&&s<57344?(s=64+(1023&s),o=1023&e.charCodeAt(a++),n=(n=(n=(n=n>>>8^t[255&(n^(240|s>>8&7))])>>>8^t[255&(n^(128|s>>2&63))])>>>8^t[255&(n^(128|o>>6&15|(3&s)<<4))])>>>8^t[255&(n^(128|63&o))]):n=(n=(n=n>>>8^t[255&(n^(224|s>>12&15))])>>>8^t[255&(n^(128|s>>6&63))])>>>8^t[255&(n^(128|63&s))];return~n},e}(),pv=function(){var e,t={};function r(e){if("/"==e.charAt(e.length-1))return-1===e.slice(0,-1).indexOf("/")?e:r(e.slice(0,-1));var t=e.lastIndexOf("/");return-1===t?e:e.slice(0,t+1)}function n(e){if("/"==e.charAt(e.length-1))return n(e.slice(0,-1));var t=e.lastIndexOf("/");return-1===t?e:e.slice(t+1)}function a(e,t){"string"===typeof t&&(t=new Date(t));var r=t.getHours();r=(r=r<<6|t.getMinutes())<<5|t.getSeconds()>>>1,e.write_shift(2,r);var n=t.getFullYear()-1980;n=(n=n<<4|t.getMonth()+1)<<5|t.getDate(),e.write_shift(2,n)}function i(e){lb(e,0);for(var t={},r=0;e.l<=e.length-4;){var n=e.read_shift(2),a=e.read_shift(2),i=e.l+a,s={};if(21589===n)1&(r=e.read_shift(1))&&(s.mtime=e.read_shift(4)),a>5&&(2&r&&(s.atime=e.read_shift(4)),4&r&&(s.ctime=e.read_shift(4))),s.mtime&&(s.mt=new Date(1e3*s.mtime));e.l=i,t[n]=s}return t}function s(){return e||(e={})}function o(e,t){if(80==e[0]&&75==e[1])return ne(e,t);if(109==(32|e[0])&&105==(32|e[1]))return function(e,t){if("mime-version:"!=T(e.slice(0,13)).toLowerCase())throw new Error("Unsupported MAD header");var r=t&&t.root||"",n=(hg&&Buffer.isBuffer(e)?e.toString("binary"):T(e)).split("\r\n"),a=0,i="";for(a=0;a<n.length;++a)if(i=n[a],/^Content-Location:/i.test(i)&&(i=i.slice(i.indexOf("file")),r||(r=i.slice(0,i.lastIndexOf("/")+1)),i.slice(0,r.length)!=r))for(;r.length>0&&(r=(r=r.slice(0,r.length-1)).slice(0,r.lastIndexOf("/")+1),i.slice(0,r.length)!=r););var s=(n[1]||"").match(/boundary="(.*?)"/);if(!s)throw new Error("MAD cannot find boundary");var o="--"+(s[1]||""),l=[],c=[],u={FileIndex:l,FullPaths:c};f(u);var h,d=0;for(a=0;a<n.length;++a){var p=n[a];p!==o&&p!==o+"--"||(d++&&ce(u,n.slice(h,a),r),h=a)}return u}(e,t);if(e.length<512)throw new Error("CFB file size "+e.length+" < 512");var r,n,a,i,s,o,d=512,p=[],m=e.slice(0,512);lb(m,0);var g=function(e){if(80==e[e.l]&&75==e[e.l+1])return[0,0];e.chk(y,"Header Signature: "),e.l+=16;var t=e.read_shift(2,"u");return[e.read_shift(2,"u"),t]}(m);switch(r=g[0]){case 3:d=512;break;case 4:d=4096;break;case 0:if(0==g[1])return ne(e,t);default:throw new Error("Major Version: Expected 3 or 4 saw "+r)}512!==d&&lb(m=e.slice(0,d),28);var b=e.slice(0,d);!function(e,t){var r=9;switch(e.l+=2,r=e.read_shift(2)){case 9:if(3!=t)throw new Error("Sector Shift: Expected 9 saw "+r);break;case 12:if(4!=t)throw new Error("Sector Shift: Expected 12 saw "+r);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+r)}e.chk("0600","Mini Sector Shift: "),e.chk("000000000000","Reserved: ")}(m,r);var w=m.read_shift(4,"i");if(3===r&&0!==w)throw new Error("# Directory Sectors: Expected 0 saw "+w);m.l+=4,i=m.read_shift(4,"i"),m.l+=4,m.chk("00100000","Mini Stream Cutoff Size: "),s=m.read_shift(4,"i"),n=m.read_shift(4,"i"),o=m.read_shift(4,"i"),a=m.read_shift(4,"i");for(var E=-1,_=0;_<109&&!((E=m.read_shift(4,"i"))<0);++_)p[_]=E;var S=function(e,t){for(var r=Math.ceil(e.length/t)-1,n=[],a=1;a<r;++a)n[a-1]=e.slice(a*t,(a+1)*t);return n[r-1]=e.slice(r*t),n}(e,d);c(o,a,S,d,p);var k=function(e,t,r,n){var a=e.length,i=[],s=[],o=[],l=[],c=n-1,u=0,h=0,f=0,d=0;for(u=0;u<a;++u)if(o=[],(f=u+t)>=a&&(f-=a),!s[f]){l=[];var p=[];for(h=f;h>=0;){p[h]=!0,s[h]=!0,o[o.length]=h,l.push(e[h]);var m=r[Math.floor(4*h/n)];if(n<4+(d=4*h&c))throw new Error("FAT boundary crossed: "+h+" 4 "+n);if(!e[m])break;if(p[h=eb(e[m],d)])break}i[f]={nodes:o,data:Ry([l])}}return i}(S,i,p,d);k[i].name="!Directory",n>0&&s!==v&&(k[s].name="!MiniFAT"),k[p[0]].name="!FAT",k.fat_addrs=p,k.ssz=d;var C=[],I=[],A=[];!function(e,t,r,n,a,i,s,o){for(var c,f=0,d=n.length?2:0,p=t[e].data,m=0,g=0;m<p.length;m+=128){var y=p.slice(m,m+128);lb(y,64),g=y.read_shift(2),c=Oy(y,0,g-d),n.push(c);var b={name:c,type:y.read_shift(1),color:y.read_shift(1),L:y.read_shift(4,"i"),R:y.read_shift(4,"i"),C:y.read_shift(4,"i"),clsid:y.read_shift(16),state:y.read_shift(4,"i"),start:0,size:0};0!==y.read_shift(2)+y.read_shift(2)+y.read_shift(2)+y.read_shift(2)&&(b.ct=h(y,y.l-8)),0!==y.read_shift(2)+y.read_shift(2)+y.read_shift(2)+y.read_shift(2)&&(b.mt=h(y,y.l-8)),b.start=y.read_shift(4,"i"),b.size=y.read_shift(4,"i"),b.size<0&&b.start<0&&(b.size=b.type=0,b.start=v,b.name=""),5===b.type?(f=b.start,a>0&&f!==v&&(t[f].name="!StreamData")):b.size>=4096?(b.storage="fat",void 0===t[b.start]&&(t[b.start]=u(r,b.start,t.fat_addrs,t.ssz)),t[b.start].name=b.name,b.content=t[b.start].data.slice(0,b.size)):(b.storage="minifat",b.size<0?b.size=0:f!==v&&b.start!==v&&t[f]&&(b.content=l(b,t[f].data,(t[o]||{}).data))),b.content&&lb(b.content,0),i[c]=b,s.push(b)}}(i,k,S,C,n,{},I,s),function(e,t,r){for(var n=0,a=0,i=0,s=0,o=0,l=r.length,c=[],u=[];n<l;++n)c[n]=u[n]=n,t[n]=r[n];for(;o<u.length;++o)a=e[n=u[o]].L,i=e[n].R,s=e[n].C,c[n]===n&&(-1!==a&&c[a]!==a&&(c[n]=c[a]),-1!==i&&c[i]!==i&&(c[n]=c[i])),-1!==s&&(c[s]=n),-1!==a&&n!=c[n]&&(c[a]=c[n],u.lastIndexOf(a)<o&&u.push(a)),-1!==i&&n!=c[n]&&(c[i]=c[n],u.lastIndexOf(i)<o&&u.push(i));for(n=1;n<l;++n)c[n]===n&&(-1!==i&&c[i]!==i?c[n]=c[i]:-1!==a&&c[a]!==a&&(c[n]=c[a]));for(n=1;n<l;++n)if(0!==e[n].type){if((o=n)!=c[o])do{o=c[o],t[n]=t[o]+"/"+t[n]}while(0!==o&&-1!==c[o]&&o!=c[o]);c[n]=-1}for(t[0]+="/",n=1;n<l;++n)2!==e[n].type&&(t[n]+="/")}(I,A,C),C.shift();var R={FileIndex:I,FullPaths:A};return t&&t.raw&&(R.raw={header:b,sectors:S}),R}function l(e,t,r){for(var n=e.start,a=e.size,i=[],s=n;r&&a>0&&s>=0;)i.push(t.slice(s*g,s*g+g)),a-=g,s=eb(r,4*s);return 0===i.length?ub(0):yg(i).slice(0,e.size)}function c(e,t,r,n,a){var i=v;if(e===v){if(0!==t)throw new Error("DIFAT chain shorter than expected")}else if(-1!==e){var s=r[e],o=(n>>>2)-1;if(!s)return;for(var l=0;l<o&&(i=eb(s,4*l))!==v;++l)a.push(i);c(eb(s,n-4),t-1,r,n,a)}}function u(e,t,r,n,a){var i=[],s=[];a||(a=[]);var o=n-1,l=0,c=0;for(l=t;l>=0;){a[l]=!0,i[i.length]=l,s.push(e[l]);var u=r[Math.floor(4*l/n)];if(n<4+(c=4*l&o))throw new Error("FAT boundary crossed: "+l+" 4 "+n);if(!e[u])break;l=eb(e[u],c)}return{nodes:i,data:Ry([s])}}function h(e,t){return new Date(1e3*(Zy(e,t+4)/1e7*Math.pow(2,32)+Zy(e,t)/1e7-11644473600))}function f(e,t){var r=t||{},n=r.root||"Root Entry";if(e.FullPaths||(e.FullPaths=[]),e.FileIndex||(e.FileIndex=[]),e.FullPaths.length!==e.FileIndex.length)throw new Error("inconsistent CFB structure");0===e.FullPaths.length&&(e.FullPaths[0]=n+"/",e.FileIndex[0]={name:n,type:5}),r.CLSID&&(e.FileIndex[0].clsid=r.CLSID),function(e){var t="\x01Sh33tJ5";if(pv.find(e,"/"+t))return;var r=ub(4);r[0]=55,r[1]=r[3]=50,r[2]=54,e.FileIndex.push({name:t,type:2,content:r,size:4,L:69,R:69,C:69}),e.FullPaths.push(e.FullPaths[0]+t),d(e)}(e)}function d(e,t){f(e);for(var a=!1,i=!1,s=e.FullPaths.length-1;s>=0;--s){var o=e.FileIndex[s];switch(o.type){case 0:i?a=!0:(e.FileIndex.pop(),e.FullPaths.pop());break;case 1:case 2:case 5:i=!0,isNaN(o.R*o.L*o.C)&&(a=!0),o.R>-1&&o.L>-1&&o.R==o.L&&(a=!0);break;default:a=!0}}if(a||t){var l=new Date(1987,1,19),c=0,u=Object.create?Object.create(null):{},h=[];for(s=0;s<e.FullPaths.length;++s)u[e.FullPaths[s]]=!0,0!==e.FileIndex[s].type&&h.push([e.FullPaths[s],e.FileIndex[s]]);for(s=0;s<h.length;++s){var d=r(h[s][0]);(i=u[d])||(h.push([d,{name:n(d).replace("/",""),type:1,clsid:w,ct:l,mt:l,content:null}]),u[d]=!0)}for(h.sort((function(e,t){return function(e,t){for(var r=e.split("/"),n=t.split("/"),a=0,i=0,s=Math.min(r.length,n.length);a<s;++a){if(i=r[a].length-n[a].length)return i;if(r[a]!=n[a])return r[a]<n[a]?-1:1}return r.length-n.length}(e[0],t[0])})),e.FullPaths=[],e.FileIndex=[],s=0;s<h.length;++s)e.FullPaths[s]=h[s][0],e.FileIndex[s]=h[s][1];for(s=0;s<h.length;++s){var p=e.FileIndex[s],m=e.FullPaths[s];if(p.name=n(m).replace("/",""),p.L=p.R=p.C=-(p.color=1),p.size=p.content?p.content.length:0,p.start=0,p.clsid=p.clsid||w,0===s)p.C=h.length>1?1:-1,p.size=0,p.type=5;else if("/"==m.slice(-1)){for(c=s+1;c<h.length&&r(e.FullPaths[c])!=m;++c);for(p.C=c>=h.length?-1:c,c=s+1;c<h.length&&r(e.FullPaths[c])!=r(m);++c);p.R=c>=h.length?-1:c,p.type=1}else r(e.FullPaths[s+1]||"")==r(m)&&(p.R=s+1),p.type=2}}}function p(e,t){var r=t||{};if("mad"==r.fileType)return function(e,t){for(var r=t||{},n=r.boundary||"SheetJS",a=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+(n="------="+n).slice(2)+'"',"","",""],i=e.FullPaths[0],s=i,o=e.FileIndex[0],l=1;l<e.FullPaths.length;++l)if(s=e.FullPaths[l].slice(i.length),(o=e.FileIndex[l]).size&&o.content&&"\x01Sh33tJ5"!=s){s=s.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,(function(e){return"_x"+e.charCodeAt(0).toString(16)+"_"})).replace(/[\u0080-\uFFFF]/g,(function(e){return"_u"+e.charCodeAt(0).toString(16)+"_"}));for(var c=o.content,u=hg&&Buffer.isBuffer(c)?c.toString("binary"):T(c),h=0,f=Math.min(1024,u.length),d=0,p=0;p<=f;++p)(d=u.charCodeAt(p))>=32&&d<128&&++h;var m=h>=4*f/5;a.push(n),a.push("Content-Location: "+(r.root||"file:///C:/SheetJS/")+s),a.push("Content-Transfer-Encoding: "+(m?"quoted-printable":"base64")),a.push("Content-Type: "+se(o,s)),a.push(""),a.push(m?le(u):oe(u))}return a.push(n+"--\r\n"),a.join("\r\n")}(e,r);if(d(e),"zip"===r.fileType)return function(e,t){var r=t||{},n=[],i=[],s=ub(1),o=r.compression?8:0,l=0;0;var c=0,u=0,h=0,f=0,d=e.FullPaths[0],p=d,m=e.FileIndex[0],g=[],v=0;for(c=1;c<e.FullPaths.length;++c)if(p=e.FullPaths[c].slice(d.length),(m=e.FileIndex[c]).size&&m.content&&"\x01Sh33tJ5"!=p){var y=h,b=ub(p.length);for(u=0;u<p.length;++u)b.write_shift(1,127&p.charCodeAt(u));b=b.slice(0,b.l),g[f]=dv.buf(m.content,0);var w=m.content;8==o&&(w=_(w)),(s=ub(30)).write_shift(4,67324752),s.write_shift(2,20),s.write_shift(2,l),s.write_shift(2,o),m.mt?a(s,m.mt):s.write_shift(4,0),s.write_shift(-4,8&l?0:g[f]),s.write_shift(4,8&l?0:w.length),s.write_shift(4,8&l?0:m.content.length),s.write_shift(2,b.length),s.write_shift(2,0),h+=s.length,n.push(s),h+=b.length,n.push(b),h+=w.length,n.push(w),8&l&&((s=ub(12)).write_shift(-4,g[f]),s.write_shift(4,w.length),s.write_shift(4,m.content.length),h+=s.l,n.push(s)),(s=ub(46)).write_shift(4,33639248),s.write_shift(2,0),s.write_shift(2,20),s.write_shift(2,l),s.write_shift(2,o),s.write_shift(4,0),s.write_shift(-4,g[f]),s.write_shift(4,w.length),s.write_shift(4,m.content.length),s.write_shift(2,b.length),s.write_shift(2,0),s.write_shift(2,0),s.write_shift(2,0),s.write_shift(2,0),s.write_shift(4,0),s.write_shift(4,y),v+=s.l,i.push(s),v+=b.length,i.push(b),++f}return s=ub(22),s.write_shift(4,101010256),s.write_shift(2,0),s.write_shift(2,0),s.write_shift(2,f),s.write_shift(2,f),s.write_shift(4,v),s.write_shift(4,h),s.write_shift(2,0),yg([yg(n),yg(i),s])}(e,r);var n=function(e){for(var t=0,r=0,n=0;n<e.FileIndex.length;++n){var a=e.FileIndex[n];if(a.content){var i=a.content.length;i>0&&(i<4096?t+=i+63>>6:r+=i+511>>9)}}for(var s=e.FullPaths.length+3>>2,o=t+127>>7,l=(t+7>>3)+r+s+o,c=l+127>>7,u=c<=109?0:Math.ceil((c-109)/127);l+c+u+127>>7>c;)u=++c<=109?0:Math.ceil((c-109)/127);var h=[1,u,c,o,s,r,t,0];return e.FileIndex[0].size=t<<6,h[7]=(e.FileIndex[0].start=h[0]+h[1]+h[2]+h[3]+h[4]+h[5])+(h[6]+7>>3),h}(e),i=ub(n[7]<<9),s=0,o=0;for(s=0;s<8;++s)i.write_shift(1,b[s]);for(s=0;s<8;++s)i.write_shift(2,0);for(i.write_shift(2,62),i.write_shift(2,3),i.write_shift(2,65534),i.write_shift(2,9),i.write_shift(2,6),s=0;s<3;++s)i.write_shift(2,0);for(i.write_shift(4,0),i.write_shift(4,n[2]),i.write_shift(4,n[0]+n[1]+n[2]+n[3]-1),i.write_shift(4,0),i.write_shift(4,4096),i.write_shift(4,n[3]?n[0]+n[1]+n[2]-1:v),i.write_shift(4,n[3]),i.write_shift(-4,n[1]?n[0]-1:v),i.write_shift(4,n[1]),s=0;s<109;++s)i.write_shift(-4,s<n[2]?n[1]+s:-1);if(n[1])for(o=0;o<n[1];++o){for(;s<236+127*o;++s)i.write_shift(-4,s<n[2]?n[1]+s:-1);i.write_shift(-4,o===n[1]-1?v:o+1)}var l=function(e){for(o+=e;s<o-1;++s)i.write_shift(-4,s+1);e&&(++s,i.write_shift(-4,v))};for(o=s=0,o+=n[1];s<o;++s)i.write_shift(-4,E.DIFSECT);for(o+=n[2];s<o;++s)i.write_shift(-4,E.FATSECT);l(n[3]),l(n[4]);for(var c=0,u=0,h=e.FileIndex[0];c<e.FileIndex.length;++c)(h=e.FileIndex[c]).content&&((u=h.content.length)<4096||(h.start=o,l(u+511>>9)));for(l(n[6]+7>>3);511&i.l;)i.write_shift(-4,E.ENDOFCHAIN);for(o=s=0,c=0;c<e.FileIndex.length;++c)(h=e.FileIndex[c]).content&&(!(u=h.content.length)||u>=4096||(h.start=o,l(u+63>>6)));for(;511&i.l;)i.write_shift(-4,E.ENDOFCHAIN);for(s=0;s<n[4]<<2;++s){var f=e.FullPaths[s];if(f&&0!==f.length){h=e.FileIndex[s],0===s&&(h.start=h.size?h.start-1:v);var p=0===s&&r.root||h.name;if(u=2*(p.length+1),i.write_shift(64,p,"utf16le"),i.write_shift(2,u),i.write_shift(1,h.type),i.write_shift(1,h.color),i.write_shift(-4,h.L),i.write_shift(-4,h.R),i.write_shift(-4,h.C),h.clsid)i.write_shift(16,h.clsid,"hex");else for(c=0;c<4;++c)i.write_shift(4,0);i.write_shift(4,h.state||0),i.write_shift(4,0),i.write_shift(4,0),i.write_shift(4,0),i.write_shift(4,0),i.write_shift(4,h.start),i.write_shift(4,h.size),i.write_shift(4,0)}else{for(c=0;c<17;++c)i.write_shift(4,0);for(c=0;c<3;++c)i.write_shift(4,-1);for(c=0;c<12;++c)i.write_shift(4,0)}}for(s=1;s<e.FileIndex.length;++s)if((h=e.FileIndex[s]).size>=4096)if(i.l=h.start+1<<9,hg&&Buffer.isBuffer(h.content))h.content.copy(i,i.l,0,h.size),i.l+=h.size+511&-512;else{for(c=0;c<h.size;++c)i.write_shift(1,h.content[c]);for(;511&c;++c)i.write_shift(1,0)}for(s=1;s<e.FileIndex.length;++s)if((h=e.FileIndex[s]).size>0&&h.size<4096)if(hg&&Buffer.isBuffer(h.content))h.content.copy(i,i.l,0,h.size),i.l+=h.size+63&-64;else{for(c=0;c<h.size;++c)i.write_shift(1,h.content[c]);for(;63&c;++c)i.write_shift(1,0)}if(hg)i.l=i.length;else for(;i.l<i.length;)i.write_shift(1,0);return i}t.version="1.2.1";var m,g=64,v=-2,y="d0cf11e0a1b11ae1",b=[208,207,17,224,161,177,26,225],w="00000000000000000000000000000000",E={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:v,FREESECT:-1,HEADER_SIGNATURE:y,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:w,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function T(e){for(var t=new Array(e.length),r=0;r<e.length;++r)t[r]=String.fromCharCode(e[r]);return t.join("")}function _(e){return m?m.deflateRawSync(e):q(e)}var S=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],k=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],C=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function I(e){var t=139536&(e<<1|e<<11)|558144&(e<<5|e<<15);return 255&(t>>16|t>>8|t)}for(var A="undefined"!==typeof Uint8Array,R=A?new Uint8Array(256):[],N=0;N<256;++N)R[N]=I(N);function O(e,t){var r=R[255&e];return t<=8?r>>>8-t:(r=r<<8|R[e>>8&255],t<=16?r>>>16-t:(r=r<<8|R[e>>16&255])>>>24-t)}function x(e,t){var r=7&t,n=t>>>3;return(e[n]|(r<=6?0:e[n+1]<<8))>>>r&3}function P(e,t){var r=7&t,n=t>>>3;return(e[n]|(r<=5?0:e[n+1]<<8))>>>r&7}function D(e,t){var r=7&t,n=t>>>3;return(e[n]|(r<=3?0:e[n+1]<<8))>>>r&31}function L(e,t){var r=7&t,n=t>>>3;return(e[n]|(r<=1?0:e[n+1]<<8))>>>r&127}function M(e,t,r){var n=7&t,a=t>>>3,i=(1<<r)-1,s=e[a]>>>n;return r<8-n?s&i:(s|=e[a+1]<<8-n,r<16-n?s&i:(s|=e[a+2]<<16-n,r<24-n?s&i:(s|=e[a+3]<<24-n)&i))}function F(e,t,r){var n=7&t,a=t>>>3;return n<=5?e[a]|=(7&r)<<n:(e[a]|=r<<n&255,e[a+1]=(7&r)>>8-n),t+3}function U(e,t,r){return r=(1&r)<<(7&t),e[t>>>3]|=r,t+1}function V(e,t,r){var n=t>>>3;return r<<=7&t,e[n]|=255&r,r>>>=8,e[n+1]=r,t+8}function B(e,t,r){var n=t>>>3;return r<<=7&t,e[n]|=255&r,r>>>=8,e[n+1]=255&r,e[n+2]=r>>>8,t+16}function z(e,t){var r=e.length,n=2*r>t?2*r:t+5,a=0;if(r>=t)return e;if(hg){var i=pg(n);if(e.copy)e.copy(i);else for(;a<e.length;++a)i[a]=e[a];return i}if(A){var s=new Uint8Array(n);if(s.set)s.set(e);else for(;a<r;++a)s[a]=e[a];return s}return e.length=n,e}function j(e){for(var t=new Array(e),r=0;r<e;++r)t[r]=0;return t}function H(e,t,r){var n=1,a=0,i=0,s=0,o=0,l=e.length,c=A?new Uint16Array(32):j(32);for(i=0;i<32;++i)c[i]=0;for(i=l;i<r;++i)e[i]=0;l=e.length;var u=A?new Uint16Array(l):j(l);for(i=0;i<l;++i)c[a=e[i]]++,n<a&&(n=a),u[i]=0;for(c[0]=0,i=1;i<=n;++i)c[i+16]=o=o+c[i-1]<<1;for(i=0;i<l;++i)0!=(o=e[i])&&(u[i]=c[o+16]++);var h=0;for(i=0;i<l;++i)if(0!=(h=e[i]))for(o=O(u[i],n)>>n-h,s=(1<<n+4-h)-1;s>=0;--s)t[o|s<<h]=15&h|i<<4;return n}var $=A?new Uint16Array(512):j(512),W=A?new Uint16Array(32):j(32);if(!A){for(var G=0;G<512;++G)$[G]=0;for(G=0;G<32;++G)W[G]=0}!function(){for(var e=[],t=0;t<32;t++)e.push(5);H(e,W,32);var r=[];for(t=0;t<=143;t++)r.push(8);for(;t<=255;t++)r.push(9);for(;t<=279;t++)r.push(7);for(;t<=287;t++)r.push(8);H(r,$,288)}();var K=function(){for(var e=A?new Uint8Array(32768):[],t=0,r=0;t<C.length-1;++t)for(;r<C[t+1];++r)e[r]=t;for(;r<32768;++r)e[r]=29;var n=A?new Uint8Array(259):[];for(t=0,r=0;t<k.length-1;++t)for(;r<k[t+1];++r)n[r]=t;return function(t,r){return t.length<8?function(e,t){for(var r=0;r<e.length;){var n=Math.min(65535,e.length-r),a=r+n==e.length;for(t.write_shift(1,+a),t.write_shift(2,n),t.write_shift(2,65535&~n);n-- >0;)t[t.l++]=e[r++]}return t.l}(t,r):function(t,r){for(var a=0,i=0,s=A?new Uint16Array(32768):[];i<t.length;){var o=Math.min(65535,t.length-i);if(o<10){for(7&(a=F(r,a,+!(i+o!=t.length)))&&(a+=8-(7&a)),r.l=a/8|0,r.write_shift(2,o),r.write_shift(2,65535&~o);o-- >0;)r[r.l++]=t[i++];a=8*r.l}else{a=F(r,a,+!(i+o!=t.length)+2);for(var l=0;o-- >0;){var c=t[i],u=-1,h=0;if((u=s[l=32767&(l<<5^c)])&&((u|=-32768&i)>i&&(u-=32768),u<i))for(;t[u+h]==t[i+h]&&h<250;)++h;if(h>2){(c=n[h])<=22?a=V(r,a,R[c+1]>>1)-1:(V(r,a,3),V(r,a+=5,R[c-23]>>5),a+=3);var f=c<8?0:c-4>>2;f>0&&(B(r,a,h-k[c]),a+=f),c=e[i-u],a=V(r,a,R[c]>>3),a-=3;var d=c<4?0:c-2>>1;d>0&&(B(r,a,i-u-C[c]),a+=d);for(var p=0;p<h;++p)s[l]=32767&i,l=32767&(l<<5^t[i]),++i;o-=h-1}else c<=143?c+=48:a=U(r,a,1),a=V(r,a,R[c]),s[l]=32767&i,++i}a=V(r,a,0)-1}}return r.l=(a+7)/8|0,r.l}(t,r)}}();function q(e){var t=ub(50+Math.floor(1.1*e.length)),r=K(e,t);return t.slice(0,r)}var X=A?new Uint16Array(32768):j(32768),Y=A?new Uint16Array(32768):j(32768),Q=A?new Uint16Array(128):j(128),J=1,Z=1;function ee(e,t){var r=D(e,t)+257,n=D(e,t+=5)+1,a=function(e,t){var r=7&t,n=t>>>3;return(e[n]|(r<=4?0:e[n+1]<<8))>>>r&15}(e,t+=5)+4;t+=4;for(var i=0,s=A?new Uint8Array(19):j(19),o=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],l=1,c=A?new Uint8Array(8):j(8),u=A?new Uint8Array(8):j(8),h=s.length,f=0;f<a;++f)s[S[f]]=i=P(e,t),l<i&&(l=i),c[i]++,t+=3;var d=0;for(c[0]=0,f=1;f<=l;++f)u[f]=d=d+c[f-1]<<1;for(f=0;f<h;++f)0!=(d=s[f])&&(o[f]=u[d]++);var p=0;for(f=0;f<h;++f)if(0!=(p=s[f])){d=R[o[f]]>>8-p;for(var m=(1<<7-p)-1;m>=0;--m)Q[d|m<<p]=7&p|f<<3}var g=[];for(l=1;g.length<r+n;)switch(t+=7&(d=Q[L(e,t)]),d>>>=3){case 16:for(i=3+x(e,t),t+=2,d=g[g.length-1];i-- >0;)g.push(d);break;case 17:for(i=3+P(e,t),t+=3;i-- >0;)g.push(0);break;case 18:for(i=11+L(e,t),t+=7;i-- >0;)g.push(0);break;default:g.push(d),l<d&&(l=d)}var v=g.slice(0,r),y=g.slice(r);for(f=r;f<286;++f)v[f]=0;for(f=n;f<30;++f)y[f]=0;return J=H(v,X,286),Z=H(y,Y,30),t}function te(e,t){var r=function(e,t){if(3==e[0]&&!(3&e[1]))return[dg(t),2];for(var r=0,n=0,a=pg(t||1<<18),i=0,s=a.length>>>0,o=0,l=0;0==(1&n);)if(n=P(e,r),r+=3,n>>>1!=0)for(n>>1==1?(o=9,l=5):(r=ee(e,r),o=J,l=Z);;){!t&&s<i+32767&&(s=(a=z(a,i+32767)).length);var c=M(e,r,o),u=n>>>1==1?$[c]:X[c];if(r+=15&u,0===((u>>>=4)>>>8&255))a[i++]=u;else{if(256==u)break;var h=(u-=257)<8?0:u-4>>2;h>5&&(h=0);var f=i+k[u];h>0&&(f+=M(e,r,h),r+=h),c=M(e,r,l),r+=15&(u=n>>>1==1?W[c]:Y[c]);var d=(u>>>=4)<4?0:u-2>>1,p=C[u];for(d>0&&(p+=M(e,r,d),r+=d),!t&&s<f&&(s=(a=z(a,f+100)).length);i<f;)a[i]=a[i-p],++i}}else{7&r&&(r+=8-(7&r));var m=e[r>>>3]|e[1+(r>>>3)]<<8;if(r+=32,m>0)for(!t&&s<i+m&&(s=(a=z(a,i+m)).length);m-- >0;)a[i++]=e[r>>>3],r+=8}return t?[a,r+7>>>3]:[a.slice(0,i),r+7>>>3]}(e.slice(e.l||0),t);return e.l+=r[1],r[0]}function re(e,t){if(!e)throw new Error(t);"undefined"!==typeof console&&console.error(t)}function ne(e,t){var r=e;lb(r,0);var n={FileIndex:[],FullPaths:[]};f(n,{root:t.root});for(var a=r.length-4;(80!=r[a]||75!=r[a+1]||5!=r[a+2]||6!=r[a+3])&&a>=0;)--a;r.l=a+4,r.l+=4;var s=r.read_shift(2);r.l+=6;var o=r.read_shift(4);for(r.l=o,a=0;a<s;++a){r.l+=20;var l=r.read_shift(4),c=r.read_shift(4),u=r.read_shift(2),h=r.read_shift(2),d=r.read_shift(2);r.l+=8;var p=r.read_shift(4),m=i(r.slice(r.l+u,r.l+u+h));r.l+=u+h+d;var g=r.l;r.l=p+4,ae(r,l,c,n,m),r.l=g}return n}function ae(e,t,r,n,a){e.l+=2;var s=e.read_shift(2),o=e.read_shift(2),l=function(e){var t=65535&e.read_shift(2),r=65535&e.read_shift(2),n=new Date,a=31&r,i=15&(r>>>=5);r>>>=4,n.setMilliseconds(0),n.setFullYear(r+1980),n.setMonth(i-1),n.setDate(a);var s=31&t,o=63&(t>>>=5);return t>>>=6,n.setHours(t),n.setMinutes(o),n.setSeconds(s<<1),n}(e);if(8257&s)throw new Error("Unsupported ZIP encryption");e.read_shift(4);for(var c=e.read_shift(4),u=e.read_shift(4),h=e.read_shift(2),f=e.read_shift(2),d="",p=0;p<h;++p)d+=String.fromCharCode(e[e.l++]);if(f){var g=i(e.slice(e.l,e.l+f));(g[21589]||{}).mt&&(l=g[21589].mt),((a||{})[21589]||{}).mt&&(l=a[21589].mt)}e.l+=f;var v=e.slice(e.l,e.l+c);switch(o){case 8:v=function(e,t){if(!m)return te(e,t);var r=new(0,m.InflateRaw),n=r._processChunk(e.slice(e.l),r._finishFlushFlag);return e.l+=r.bytesRead,n}(e,u);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+o)}var y=!1;8&s&&(134695760==e.read_shift(4)&&(e.read_shift(4),y=!0),c=e.read_shift(4),u=e.read_shift(4)),c!=t&&re(y,"Bad compressed size: "+t+" != "+c),u!=r&&re(y,"Bad uncompressed size: "+r+" != "+u),ue(n,d,v,{unsafe:!0,mt:l})}var ie={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function se(e,t){if(e.ctype)return e.ctype;var r=e.name||"",n=r.match(/\.([^\.]+)$/);return n&&ie[n[1]]||t&&(n=(r=t).match(/[\.\\]([^\.\\])+$/))&&ie[n[1]]?ie[n[1]]:"application/octet-stream"}function oe(e){for(var t=cg(e),r=[],n=0;n<t.length;n+=76)r.push(t.slice(n,n+76));return r.join("\r\n")+"\r\n"}function le(e){var t=e.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,(function(e){var t=e.charCodeAt(0).toString(16).toUpperCase();return"="+(1==t.length?"0"+t:t)}));"\n"==(t=t.replace(/ $/gm,"=20").replace(/\t$/gm,"=09")).charAt(0)&&(t="=0D"+t.slice(1));for(var r=[],n=(t=t.replace(/\r(?!\n)/gm,"=0D").replace(/\n\n/gm,"\n=0A").replace(/([^\r\n])\n/gm,"$1=0A")).split("\r\n"),a=0;a<n.length;++a){var i=n[a];if(0!=i.length)for(var s=0;s<i.length;){var o=76,l=i.slice(s,s+o);"="==l.charAt(o-1)?o--:"="==l.charAt(o-2)?o-=2:"="==l.charAt(o-3)&&(o-=3),l=i.slice(s,s+o),(s+=o)<i.length&&(l+="="),r.push(l)}else r.push("")}return r.join("\r\n")}function ce(e,t,r){for(var n,a="",i="",s="",o=0;o<10;++o){var l=t[o];if(!l||l.match(/^\s*$/))break;var c=l.match(/^(.*?):\s*([^\s].*)$/);if(c)switch(c[1].toLowerCase()){case"content-location":a=c[2].trim();break;case"content-type":s=c[2].trim();break;case"content-transfer-encoding":i=c[2].trim()}}switch(++o,i.toLowerCase()){case"base64":n=mg(ug(t.slice(o).join("")));break;case"quoted-printable":n=function(e){for(var t=[],r=0;r<e.length;++r){for(var n=e[r];r<=e.length&&"="==n.charAt(n.length-1);)n=n.slice(0,n.length-1)+e[++r];t.push(n)}for(var a=0;a<t.length;++a)t[a]=t[a].replace(/[=][0-9A-Fa-f]{2}/g,(function(e){return String.fromCharCode(parseInt(e.slice(1),16))}));return mg(t.join("\r\n"))}(t.slice(o));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+i)}var u=ue(e,a.slice(r.length),n,{unsafe:!0});s&&(u.ctype=s)}function ue(e,t,r,a){var i=a&&a.unsafe;i||f(e);var s=!i&&pv.find(e,t);if(!s){var o=e.FullPaths[0];t.slice(0,o.length)==o?o=t:("/"!=o.slice(-1)&&(o+="/"),o=(o+t).replace("//","/")),s={name:n(t),type:2},e.FileIndex.push(s),e.FullPaths.push(o),i||pv.utils.cfb_gc(e)}return s.content=r,s.size=r?r.length:0,a&&(a.CLSID&&(s.clsid=a.CLSID),a.mt&&(s.mt=a.mt),a.ct&&(s.ct=a.ct)),s}return t.find=function(e,t){var r=e.FullPaths.map((function(e){return e.toUpperCase()})),n=r.map((function(e){var t=e.split("/");return t[t.length-("/"==e.slice(-1)?2:1)]})),a=!1;47===t.charCodeAt(0)?(a=!0,t=r[0].slice(0,-1)+t):a=-1!==t.indexOf("/");var i=t.toUpperCase(),s=!0===a?r.indexOf(i):n.indexOf(i);if(-1!==s)return e.FileIndex[s];var o=!i.match(wg);for(i=i.replace(bg,""),o&&(i=i.replace(wg,"!")),s=0;s<r.length;++s){if((o?r[s].replace(wg,"!"):r[s]).replace(bg,"")==i)return e.FileIndex[s];if((o?n[s].replace(wg,"!"):n[s]).replace(bg,"")==i)return e.FileIndex[s]}return null},t.read=function(t,r){var n=r&&r.type;switch(n||hg&&Buffer.isBuffer(t)&&(n="buffer"),n||"base64"){case"file":return function(t,r){return s(),o(e.readFileSync(t),r)}(t,r);case"base64":return o(mg(ug(t)),r);case"binary":return o(mg(t),r)}return o(t,r)},t.parse=o,t.write=function(t,r){var n=p(t,r);switch(r&&r.type||"buffer"){case"file":return s(),e.writeFileSync(r.filename,n),n;case"binary":return"string"==typeof n?n:T(n);case"base64":return cg("string"==typeof n?n:T(n));case"buffer":if(hg)return Buffer.isBuffer(n)?n:fg(n);case"array":return"string"==typeof n?mg(n):n}return n},t.writeFile=function(t,r,n){s();var a=p(t,n);e.writeFileSync(r,a)},t.utils={cfb_new:function(e){var t={};return f(t,e),t},cfb_add:ue,cfb_del:function(e,t){f(e);var r=pv.find(e,t);if(r)for(var n=0;n<e.FileIndex.length;++n)if(e.FileIndex[n]==r)return e.FileIndex.splice(n,1),e.FullPaths.splice(n,1),!0;return!1},cfb_mov:function(e,t,r){f(e);var a=pv.find(e,t);if(a)for(var i=0;i<e.FileIndex.length;++i)if(e.FileIndex[i]==a)return e.FileIndex[i].name=n(r),e.FullPaths[i]=r,!0;return!1},cfb_gc:function(e){d(e,!0)},ReadShift:rb,CheckField:ob,prep_blob:lb,bconcat:yg,use_zlib:function(e){try{var t=new(0,e.InflateRaw);if(t._processChunk(new Uint8Array([3,0]),t._finishFlushFlag),!t.bytesRead)throw new Error("zlib does not expose bytesRead");m=e}catch(Ok){console.error("cannot use native zlib: "+(Ok.message||Ok))}},_deflateRaw:q,_inflateRaw:te,consts:E},t}();let mv;function gv(e){for(var t=Object.keys(e),r=[],n=0;n<t.length;++n)Object.prototype.hasOwnProperty.call(e,t[n])&&r.push(t[n]);return r}function vv(e){for(var t=[],r=gv(e),n=0;n!==r.length;++n)t[e[r[n]]]=r[n];return t}var yv=new Date(1899,11,30,0,0,0);function bv(e,t){var r=e.getTime();return t&&(r-=1263168e5),(r-(yv.getTime()+6e4*(e.getTimezoneOffset()-yv.getTimezoneOffset())))/864e5}var wv=new Date,Ev=yv.getTime()+6e4*(wv.getTimezoneOffset()-yv.getTimezoneOffset()),Tv=wv.getTimezoneOffset();function _v(e){var t=new Date;return t.setTime(24*e*60*60*1e3+Ev),t.getTimezoneOffset()!==Tv&&t.setTime(t.getTime()+6e4*(t.getTimezoneOffset()-Tv)),t}function Sv(e){var t=0,r=0,n=!1,a=e.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!a)throw new Error("|"+e+"| is not an ISO8601 Duration");for(var i=1;i!=a.length;++i)if(a[i]){switch(r=1,i>3&&(n=!0),a[i].slice(a[i].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+a[i].slice(a[i].length-1));case"D":r*=24;case"H":r*=60;case"M":if(!n)throw new Error("Unsupported ISO Duration Field: M");r*=60}t+=r*parseInt(a[i],10)}return t}var kv=new Date("2017-02-19T19:06:09.000Z"),Cv=isNaN(kv.getFullYear())?new Date("2/19/17"):kv,Iv=2017==Cv.getFullYear();function Av(e,t){var r=new Date(e);if(Iv)return t>0?r.setTime(r.getTime()+60*r.getTimezoneOffset()*1e3):t<0&&r.setTime(r.getTime()-60*r.getTimezoneOffset()*1e3),r;if(e instanceof Date)return e;if(1917==Cv.getFullYear()&&!isNaN(r.getFullYear())){var n=r.getFullYear();return e.indexOf(""+n)>-1||r.setFullYear(r.getFullYear()+100),r}var a=e.match(/\d+/g)||["2017","2","19","0","0","0"],i=new Date(+a[0],+a[1]-1,+a[2],+a[3]||0,+a[4]||0,+a[5]||0);return e.indexOf("Z")>-1&&(i=new Date(i.getTime()-60*i.getTimezoneOffset()*1e3)),i}function Rv(e,t){if(hg&&Buffer.isBuffer(e)){if(t){if(255==e[0]&&254==e[1])return py(e.slice(2).toString("utf16le"));if(254==e[1]&&255==e[2])return py(ng(e.slice(2).toString("binary")))}return e.toString("binary")}if("undefined"!==typeof TextDecoder)try{if(t){if(255==e[0]&&254==e[1])return py(new TextDecoder("utf-16le").decode(e.slice(2)));if(254==e[0]&&255==e[1])return py(new TextDecoder("utf-16be").decode(e.slice(2)))}var r={"\u20ac":"\x80","\u201a":"\x82","\u0192":"\x83","\u201e":"\x84","\u2026":"\x85","\u2020":"\x86","\u2021":"\x87","\u02c6":"\x88","\u2030":"\x89","\u0160":"\x8a","\u2039":"\x8b","\u0152":"\x8c","\u017d":"\x8e","\u2018":"\x91","\u2019":"\x92","\u201c":"\x93","\u201d":"\x94","\u2022":"\x95","\u2013":"\x96","\u2014":"\x97","\u02dc":"\x98","\u2122":"\x99","\u0161":"\x9a","\u203a":"\x9b","\u0153":"\x9c","\u017e":"\x9e","\u0178":"\x9f"};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[\u20ac\u201a\u0192\u201e\u2026\u2020\u2021\u02c6\u2030\u0160\u2039\u0152\u017d\u2018\u2019\u201c\u201d\u2022\u2013\u2014\u02dc\u2122\u0161\u203a\u0153\u017e\u0178]/g,(function(e){return r[e]||e}))}catch(Ok){}for(var n=[],a=0;a!=e.length;++a)n.push(String.fromCharCode(e[a]));return n.join("")}function Nv(e){if("undefined"!=typeof JSON&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if("object"!=typeof e||null==e)return e;if(e instanceof Date)return new Date(e.getTime());var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=Nv(e[r]));return t}function Ov(e,t){for(var r="";r.length<t;)r+=e;return r}function xv(e){var t=Number(e);if(!isNaN(t))return isFinite(t)?t:NaN;if(!/\d/.test(e))return t;var r=1,n=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,(function(){return r*=100,""}));return isNaN(t=Number(n))?(n=n.replace(/[(](.*)[)]/,(function(e,t){return r=-r,t})),isNaN(t=Number(n))?t:t/r):t/r}var Pv=["january","february","march","april","may","june","july","august","september","october","november","december"];function Dv(e){var t=new Date(e),r=new Date(NaN),n=t.getYear(),a=t.getMonth(),i=t.getDate();if(isNaN(i))return r;var s=e.toLowerCase();if(s.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if((s=s.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,"")).length>3&&-1==Pv.indexOf(s))return r}else if(s.match(/[a-z]/))return r;return n<0||n>8099?r:(a>0||i>1)&&101!=n?t:e.match(/[^-0-9:,\/\\]/)?r:t}var Lv=function(){var e=5=="abacaba".split(/(:?b)/i).length;return function(t,r,n){if(e||"string"==typeof r)return t.split(r);for(var a=t.split(r),i=[a[0]],s=1;s<a.length;++s)i.push(n),i.push(a[s]);return i}}();function Mv(e){return e?e.content&&e.type?Rv(e.content,!0):e.data?ig(e.data):e.asNodeBuffer&&hg?ig(e.asNodeBuffer().toString("binary")):e.asBinary?ig(e.asBinary()):e._data&&e._data.getContent?ig(Rv(Array.prototype.slice.call(e._data.getContent(),0))):null:null}function Fv(e){if(!e)return null;if(e.data)return rg(e.data);if(e.asNodeBuffer&&hg)return e.asNodeBuffer();if(e._data&&e._data.getContent){var t=e._data.getContent();return"string"==typeof t?rg(t):Array.prototype.slice.call(t)}return e.content&&e.type?e.content:null}function Uv(e,t){for(var r=e.FullPaths||gv(e.files),n=t.toLowerCase().replace(/[\/]/g,"\\"),a=n.replace(/\\/g,"/"),i=0;i<r.length;++i){var s=r[i].replace(/^Root Entry[\/]/,"").toLowerCase();if(n==s||a==s)return e.files?e.files[r[i]]:e.FileIndex[i]}return null}function Vv(e,t){var r=Uv(e,t);if(null==r)throw new Error("Cannot find file "+t+" in zip");return r}function Bv(e,t,r){if(!r)return function(e){return e&&".bin"===e.name.slice(-4)?Fv(e):Mv(e)}(Vv(e,t));if(!t)return null;try{return Bv(e,t)}catch(Ok){return null}}function zv(e,t,r){if(!r)return Mv(Vv(e,t));if(!t)return null;try{return zv(e,t)}catch(Ok){return null}}function jv(e,t,r){if(!r)return Fv(Vv(e,t));if(!t)return null;try{return jv(e,t)}catch(Ok){return null}}function Hv(e){for(var t=e.FullPaths||gv(e.files),r=[],n=0;n<t.length;++n)"/"!=t[n].slice(-1)&&r.push(t[n].replace(/^Root Entry[\/]/,""));return r.sort()}function $v(e,t,r){if(e.FullPaths){var n;if("string"==typeof r)return n=hg?fg(r):function(e){for(var t=[],r=0,n=e.length+250,a=dg(e.length+255),i=0;i<e.length;++i){var s=e.charCodeAt(i);if(s<128)a[r++]=s;else if(s<2048)a[r++]=192|s>>6&31,a[r++]=128|63&s;else if(s>=55296&&s<57344){s=64+(1023&s);var o=1023&e.charCodeAt(++i);a[r++]=240|s>>8&7,a[r++]=128|s>>2&63,a[r++]=128|o>>6&15|(3&s)<<4,a[r++]=128|63&o}else a[r++]=224|s>>12&15,a[r++]=128|s>>6&63,a[r++]=128|63&s;r>n&&(t.push(a.slice(0,r)),r=0,a=dg(65535),n=65530)}return t.push(a.slice(0,r)),yg(t)}(r),pv.utils.cfb_add(e,t,n);pv.utils.cfb_add(e,t,r)}else e.file(t,r)}function Wv(e,t){switch(t.type){case"base64":return pv.read(e,{type:"base64"});case"binary":return pv.read(e,{type:"binary"});case"buffer":case"array":return pv.read(e,{type:"buffer"})}throw new Error("Unrecognized type "+t.type)}function Gv(e,t){if("/"==e.charAt(0))return e.slice(1);var r=t.split("/");"/"!=t.slice(-1)&&r.pop();for(var n=e.split("/");0!==n.length;){var a=n.shift();".."===a?r.pop():"."!==a&&r.push(a)}return r.join("/")}var Kv='<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r\n',qv=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,Xv=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/gm,Yv=Kv.match(Xv)?Xv:/<[^>]*>/g,Qv=/<\w*:/,Jv=/<(\/?)\w+:/;function Zv(e,t,r){for(var n={},a=0,i=0;a!==e.length&&(32!==(i=e.charCodeAt(a))&&10!==i&&13!==i);++a);if(t||(n[0]=e.slice(0,a)),a===e.length)return n;var s=e.match(qv),o=0,l="",c=0,u="",h="",f=1;if(s)for(c=0;c!=s.length;++c){for(h=s[c],i=0;i!=h.length&&61!==h.charCodeAt(i);++i);for(u=h.slice(0,i).trim();32==h.charCodeAt(i+1);)++i;for(f=34==(a=h.charCodeAt(i+1))||39==a?1:0,l=h.slice(i+1+f,h.length-f),o=0;o!=u.length&&58!==u.charCodeAt(o);++o);if(o===u.length)u.indexOf("_")>0&&(u=u.slice(0,u.indexOf("_"))),n[u]=l,r||(n[u.toLowerCase()]=l);else{var d=(5===o&&"xmlns"===u.slice(0,5)?"xmlns":"")+u.slice(o+1);if(n[d]&&"ext"==u.slice(o-3,o))continue;n[d]=l,r||(n[d.toLowerCase()]=l)}}return n}function ey(e){return e.replace(Jv,"<$1")}var ty={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},ry=vv(ty),ny=function(){var e=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/gi,t=/_x([\da-fA-F]{4})_/gi;return function r(n){var a=n+"",i=a.indexOf("<![CDATA[");if(-1==i)return a.replace(e,(function(e,t){return ty[e]||String.fromCharCode(parseInt(t,e.indexOf("x")>-1?16:10))||e})).replace(t,(function(e,t){return String.fromCharCode(parseInt(t,16))}));var s=a.indexOf("]]>");return r(a.slice(0,i))+a.slice(i+9,s)+r(a.slice(s+3))}}(),ay=/[&<>'"]/g;var iy=/[\u0000-\u001f]/g;function sy(e){return(e+"").replace(ay,(function(e){return ry[e]})).replace(/\n/g,"<br/>").replace(iy,(function(e){return"&#x"+("000"+e.charCodeAt(0).toString(16)).slice(-4)+";"}))}var oy=function(){var e=/&#(\d+);/g;function t(e,t){return String.fromCharCode(parseInt(t,10))}return function(r){return r.replace(e,t)}}();function ly(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function cy(e){for(var t="",r=0,n=0,a=0,i=0,s=0,o=0;r<e.length;)(n=e.charCodeAt(r++))<128?t+=String.fromCharCode(n):(a=e.charCodeAt(r++),n>191&&n<224?(s=(31&n)<<6,s|=63&a,t+=String.fromCharCode(s)):(i=e.charCodeAt(r++),n<240?t+=String.fromCharCode((15&n)<<12|(63&a)<<6|63&i):(o=((7&n)<<18|(63&a)<<12|(63&i)<<6|63&(s=e.charCodeAt(r++)))-65536,t+=String.fromCharCode(55296+(o>>>10&1023)),t+=String.fromCharCode(56320+(1023&o)))));return t}function uy(e){var t,r,n,a=dg(2*e.length),i=1,s=0,o=0;for(r=0;r<e.length;r+=i)i=1,(n=e.charCodeAt(r))<128?t=n:n<224?(t=64*(31&n)+(63&e.charCodeAt(r+1)),i=2):n<240?(t=4096*(15&n)+64*(63&e.charCodeAt(r+1))+(63&e.charCodeAt(r+2)),i=3):(i=4,t=262144*(7&n)+4096*(63&e.charCodeAt(r+1))+64*(63&e.charCodeAt(r+2))+(63&e.charCodeAt(r+3)),o=55296+((t-=65536)>>>10&1023),t=56320+(1023&t)),0!==o&&(a[s++]=255&o,a[s++]=o>>>8,o=0),a[s++]=t%256,a[s++]=t>>>8;return a.slice(0,s).toString("ucs2")}function hy(e){return fg(e,"binary").toString("utf8")}var fy="foo bar baz\xe2\x98\x83\xf0\x9f\x8d\xa3",dy=hg&&(hy(fy)==cy(fy)&&hy||uy(fy)==cy(fy)&&uy)||cy,py=hg?function(e){return fg(e,"utf8").toString("binary")}:function(e){for(var t=[],r=0,n=0,a=0;r<e.length;)switch(n=e.charCodeAt(r++),!0){case n<128:t.push(String.fromCharCode(n));break;case n<2048:t.push(String.fromCharCode(192+(n>>6))),t.push(String.fromCharCode(128+(63&n)));break;case n>=55296&&n<57344:n-=55296,a=e.charCodeAt(r++)-56320+(n<<10),t.push(String.fromCharCode(240+(a>>18&7))),t.push(String.fromCharCode(144+(a>>12&63))),t.push(String.fromCharCode(128+(a>>6&63))),t.push(String.fromCharCode(128+(63&a)));break;default:t.push(String.fromCharCode(224+(n>>12))),t.push(String.fromCharCode(128+(n>>6&63))),t.push(String.fromCharCode(128+(63&n)))}return t.join("")},my=function(){var e={};return function(t,r){var n=t+"|"+(r||"");return e[n]?e[n]:e[n]=new RegExp("<(?:\\w+:)?"+t+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+t+">",r||"")}}(),gy=function(){var e=[["nbsp"," "],["middot","\xb7"],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map((function(e){return[new RegExp("&"+e[0]+";","ig"),e[1]]}));return function(t){for(var r=t.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,"\n").replace(/<[^>]*>/g,""),n=0;n<e.length;++n)r=r.replace(e[n][0],e[n][1]);return r}}(),vy=function(){var e={};return function(t){return void 0!==e[t]?e[t]:e[t]=new RegExp("<(?:vt:)?"+t+">([\\s\\S]*?)</(?:vt:)?"+t+">","g")}}(),yy=/<\/?(?:vt:)?variant>/g,by=/<(?:vt:)([^>]*)>([\s\S]*)</;function wy(e,t){var r=Zv(e),n=e.match(vy(r.baseType))||[],a=[];if(n.length!=r.size){if(t.WTF)throw new Error("unexpected vector length "+n.length+" != "+r.size);return a}return n.forEach((function(e){var t=e.replace(yy,"").match(by);t&&a.push({v:dy(t[2]),t:t[1]})})),a}var Ey=/(^\s|\s$|\n)/;function Ty(e){return gv(e).map((function(t){return" "+t+'="'+e[t]+'"'})).join("")}function _y(e,t,r){return"<"+e+(null!=r?Ty(r):"")+(null!=t?(t.match(Ey)?' xml:space="preserve"':"")+">"+t+"</"+e:"/")+">"}function Sy(e){if(hg&&Buffer.isBuffer(e))return e.toString("utf8");if("string"===typeof e)return e;if("undefined"!==typeof Uint8Array&&e instanceof Uint8Array)return dy(gg(vg(e)));throw new Error("Bad input format: expected Buffer or string")}var ky=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/gm,Cy="http://schemas.openxmlformats.org/package/2006/content-types",Iy=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"];var Ay=function(e){for(var t=[],r=0;r<e[0].length;++r)if(e[0][r])for(var n=0,a=e[0][r].length;n<a;n+=10240)t.push.apply(t,e[0][r].slice(n,n+10240));return t},Ry=hg?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map((function(e){return Buffer.isBuffer(e)?e:fg(e)}))):Ay(e)}:Ay,Ny=function(e,t,r){for(var n=[],a=t;a<r;a+=2)n.push(String.fromCharCode(Qy(e,a)));return n.join("").replace(bg,"")},Oy=hg?function(e,t,r){return Buffer.isBuffer(e)?e.toString("utf16le",t,r).replace(bg,""):Ny(e,t,r)}:Ny,xy=function(e,t,r){for(var n=[],a=t;a<t+r;++a)n.push(("0"+e[a].toString(16)).slice(-2));return n.join("")},Py=hg?function(e,t,r){return Buffer.isBuffer(e)?e.toString("hex",t,t+r):xy(e,t,r)}:xy,Dy=function(e,t,r){for(var n=[],a=t;a<r;a++)n.push(String.fromCharCode(Yy(e,a)));return n.join("")},Ly=hg?function(e,t,r){return Buffer.isBuffer(e)?e.toString("utf8",t,r):Dy(e,t,r)}:Dy,My=function(e,t){var r=Zy(e,t);return r>0?Ly(e,t+4,t+4+r-1):""},Fy=My,Uy=function(e,t){var r=Zy(e,t);return r>0?Ly(e,t+4,t+4+r-1):""},Vy=Uy,By=function(e,t){var r=2*Zy(e,t);return r>0?Ly(e,t+4,t+4+r-1):""},zy=By,jy=function(e,t){var r=Zy(e,t);return r>0?Oy(e,t+4,t+4+r):""},Hy=jy,$y=function(e,t){var r=Zy(e,t);return r>0?Ly(e,t+4,t+4+r):""},Wy=$y,Gy=function(e,t){return function(e,t){for(var r=1-2*(e[t+7]>>>7),n=((127&e[t+7])<<4)+(e[t+6]>>>4&15),a=15&e[t+6],i=5;i>=0;--i)a=256*a+e[t+i];return 2047==n?0==a?r*(1/0):NaN:(0==n?n=-1022:(n-=1023,a+=Math.pow(2,52)),r*Math.pow(2,n-52)*a)}(e,t)},Ky=Gy,qy=function(e){return Array.isArray(e)||"undefined"!==typeof Uint8Array&&e instanceof Uint8Array};function Xy(){Oy=function(e,t,r){return ag.utils.decode(1200,e.slice(t,r)).replace(bg,"")},Ly=function(e,t,r){return ag.utils.decode(65001,e.slice(t,r))},Fy=function(e,t){var r=Zy(e,t);return r>0?ag.utils.decode(Ym,e.slice(t+4,t+4+r-1)):""},Vy=function(e,t){var r=Zy(e,t);return r>0?ag.utils.decode(Xm,e.slice(t+4,t+4+r-1)):""},zy=function(e,t){var r=2*Zy(e,t);return r>0?ag.utils.decode(1200,e.slice(t+4,t+4+r-1)):""},Hy=function(e,t){var r=Zy(e,t);return r>0?ag.utils.decode(1200,e.slice(t+4,t+4+r)):""},Wy=function(e,t){var r=Zy(e,t);return r>0?ag.utils.decode(65001,e.slice(t+4,t+4+r)):""}}hg&&(Fy=function(e,t){if(!Buffer.isBuffer(e))return My(e,t);var r=e.readUInt32LE(t);return r>0?e.toString("utf8",t+4,t+4+r-1):""},Vy=function(e,t){if(!Buffer.isBuffer(e))return Uy(e,t);var r=e.readUInt32LE(t);return r>0?e.toString("utf8",t+4,t+4+r-1):""},zy=function(e,t){if(!Buffer.isBuffer(e))return By(e,t);var r=2*e.readUInt32LE(t);return e.toString("utf16le",t+4,t+4+r-1)},Hy=function(e,t){if(!Buffer.isBuffer(e))return jy(e,t);var r=e.readUInt32LE(t);return e.toString("utf16le",t+4,t+4+r)},Wy=function(e,t){if(!Buffer.isBuffer(e))return $y(e,t);var r=e.readUInt32LE(t);return e.toString("utf8",t+4,t+4+r)},Ky=function(e,t){return Buffer.isBuffer(e)?e.readDoubleLE(t):Gy(e,t)},qy=function(e){return Buffer.isBuffer(e)||Array.isArray(e)||"undefined"!==typeof Uint8Array&&e instanceof Uint8Array}),"undefined"!==typeof ag&&Xy();var Yy=function(e,t){return e[t]},Qy=function(e,t){return 256*e[t+1]+e[t]},Jy=function(e,t){var r=256*e[t+1]+e[t];return r<32768?r:-1*(65535-r+1)},Zy=function(e,t){return e[t+3]*(1<<24)+(e[t+2]<<16)+(e[t+1]<<8)+e[t]},eb=function(e,t){return e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]},tb=function(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]};function rb(e,t){var r,n,a,i,s,o,l="",c=[];switch(t){case"dbcs":if(o=this.l,hg&&Buffer.isBuffer(this))l=this.slice(this.l,this.l+2*e).toString("utf16le");else for(s=0;s<e;++s)l+=String.fromCharCode(Qy(this,o)),o+=2;e*=2;break;case"utf8":l=Ly(this,this.l,this.l+e);break;case"utf16le":e*=2,l=Oy(this,this.l,this.l+e);break;case"wstr":if("undefined"===typeof ag)return rb.call(this,e,"dbcs");l=ag.utils.decode(Xm,this.slice(this.l,this.l+2*e)),e*=2;break;case"lpstr-ansi":l=Fy(this,this.l),e=4+Zy(this,this.l);break;case"lpstr-cp":l=Vy(this,this.l),e=4+Zy(this,this.l);break;case"lpwstr":l=zy(this,this.l),e=4+2*Zy(this,this.l);break;case"lpp4":e=4+Zy(this,this.l),l=Hy(this,this.l),2&e&&(e+=2);break;case"8lpp4":e=4+Zy(this,this.l),l=Wy(this,this.l),3&e&&(e+=4-(3&e));break;case"cstr":for(e=0,l="";0!==(a=Yy(this,this.l+e++));)c.push(sg(a));l=c.join("");break;case"_wstr":for(e=0,l="";0!==(a=Qy(this,this.l+e));)c.push(sg(a)),e+=2;e+=2,l=c.join("");break;case"dbcs-cont":for(l="",o=this.l,s=0;s<e;++s){if(this.lens&&-1!==this.lens.indexOf(o))return a=Yy(this,o),this.l=o+1,i=rb.call(this,e-s,a?"dbcs-cont":"sbcs-cont"),c.join("")+i;c.push(sg(Qy(this,o))),o+=2}l=c.join(""),e*=2;break;case"cpstr":if("undefined"!==typeof ag){l=ag.utils.decode(Xm,this.slice(this.l,this.l+e));break}case"sbcs-cont":for(l="",o=this.l,s=0;s!=e;++s){if(this.lens&&-1!==this.lens.indexOf(o))return a=Yy(this,o),this.l=o+1,i=rb.call(this,e-s,a?"dbcs-cont":"sbcs-cont"),c.join("")+i;c.push(sg(Yy(this,o))),o+=1}l=c.join("");break;default:switch(e){case 1:return r=Yy(this,this.l),this.l++,r;case 2:return r=("i"===t?Jy:Qy)(this,this.l),this.l+=2,r;case 4:case-4:return"i"===t||0===(128&this[this.l+3])?(r=(e>0?eb:tb)(this,this.l),this.l+=4,r):(n=Zy(this,this.l),this.l+=4,n);case 8:case-8:if("f"===t)return n=8==e?Ky(this,this.l):Ky([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,n;e=8;case 16:l=Py(this,this.l,e)}}return this.l+=e,l}var nb=function(e,t,r){e[r]=255&t,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24&255},ab=function(e,t,r){e[r]=255&t,e[r+1]=t>>8&255,e[r+2]=t>>16&255,e[r+3]=t>>24&255},ib=function(e,t,r){e[r]=255&t,e[r+1]=t>>>8&255};function sb(e,t,r){var n=0,a=0;if("dbcs"===r){for(a=0;a!=t.length;++a)ib(this,t.charCodeAt(a),this.l+2*a);n=2*t.length}else if("sbcs"===r){if("undefined"!==typeof ag&&874==Ym)for(a=0;a!=t.length;++a){var i=ag.utils.encode(Ym,t.charAt(a));this[this.l+a]=i[0]}else for(t=t.replace(/[^\x00-\x7F]/g,"_"),a=0;a!=t.length;++a)this[this.l+a]=255&t.charCodeAt(a);n=t.length}else{if("hex"===r){for(;a<e;++a)this[this.l++]=parseInt(t.slice(2*a,2*a+2),16)||0;return this}if("utf16le"===r){var s=Math.min(this.l+e,this.length);for(a=0;a<Math.min(t.length,e);++a){var o=t.charCodeAt(a);this[this.l++]=255&o,this[this.l++]=o>>8}for(;this.l<s;)this[this.l++]=0;return this}switch(e){case 1:n=1,this[this.l]=255&t;break;case 2:n=2,this[this.l]=255&t,t>>>=8,this[this.l+1]=255&t;break;case 3:n=3,this[this.l]=255&t,t>>>=8,this[this.l+1]=255&t,t>>>=8,this[this.l+2]=255&t;break;case 4:n=4,nb(this,t,this.l);break;case 8:if(n=8,"f"===r){!function(e,t,r){var n=(t<0||1/t==-1/0?1:0)<<7,a=0,i=0,s=n?-t:t;isFinite(s)?0==s?a=i=0:(a=Math.floor(Math.log(s)/Math.LN2),i=s*Math.pow(2,52-a),a<=-1023&&(!isFinite(i)||i<Math.pow(2,52))?a=-1022:(i-=Math.pow(2,52),a+=1023)):(a=2047,i=isNaN(t)?26985:0);for(var o=0;o<=5;++o,i/=256)e[r+o]=255&i;e[r+6]=(15&a)<<4|15&i,e[r+7]=a>>4|n}(this,t,this.l);break}case 16:break;case-4:n=4,ab(this,t,this.l)}}return this.l+=n,this}function ob(e,t){var r=Py(this,this.l,e.length>>1);if(r!==e)throw new Error(t+"Expected "+e+" saw "+r);this.l+=e.length>>1}function lb(e,t){e.l=t,e.read_shift=rb,e.chk=ob,e.write_shift=sb}function cb(e,t){e.l+=t}function ub(e){var t=dg(e);return lb(t,0),t}function hb(e,t,r){if(e){var n,a,i;lb(e,e.l||0);for(var s=e.length,o=0,l=0;e.l<s;){128&(o=e.read_shift(1))&&(o=(127&o)+((127&e.read_shift(1))<<7));var c=bS[o]||bS[65535];for(i=127&(n=e.read_shift(1)),a=1;a<4&&128&n;++a)i+=(127&(n=e.read_shift(1)))<<7*a;l=e.l+i;var u=c.f&&c.f(e,i,r);if(e.l=l,t(u,c,o))return}}}function fb(){var e=[],t=hg?256:2048,r=function(e){var t=ub(e);return lb(t,0),t},n=r(t),a=function(){n&&(n.length>n.l&&((n=n.slice(0,n.l)).l=n.length),n.length>0&&e.push(n),n=null)},i=function(e){return n&&e<n.length-n.l?n:(a(),n=r(Math.max(e+1,t)))};return{next:i,push:function(e){a(),null==(n=e).l&&(n.l=n.length),i(t)},end:function(){return a(),yg(e)},_bufs:e}}function db(e,t,r){var n=Nv(e);if(t.s?(n.cRel&&(n.c+=t.s.c),n.rRel&&(n.r+=t.s.r)):(n.cRel&&(n.c+=t.c),n.rRel&&(n.r+=t.r)),!r||r.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function pb(e,t,r){var n=Nv(e);return n.s=db(n.s,t.s,r),n.e=db(n.e,t.s,r),n}function mb(e,t){if(e.cRel&&e.c<0)for(e=Nv(e);e.c<0;)e.c+=t>8?16384:256;if(e.rRel&&e.r<0)for(e=Nv(e);e.r<0;)e.r+=t>8?1048576:t>5?65536:16384;var r=Tb(e);return e.cRel||null==e.cRel||(r=r.replace(/^([A-Z])/,"$$$1")),e.rRel||null==e.rRel||(r=function(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}(r)),r}function gb(e,t){return 0!=e.s.r||e.s.rRel||e.e.r!=(t.biff>=12?1048575:t.biff>=8?65536:16384)||e.e.rRel?0!=e.s.c||e.s.cRel||e.e.c!=(t.biff>=12?16383:255)||e.e.cRel?mb(e.s,t.biff)+":"+mb(e.e,t.biff):(e.s.rRel?"":"$")+yb(e.s.r)+":"+(e.e.rRel?"":"$")+yb(e.e.r):(e.s.cRel?"":"$")+wb(e.s.c)+":"+(e.e.cRel?"":"$")+wb(e.e.c)}function vb(e){return parseInt(e.replace(/\$(\d+)$/,"$1"),10)-1}function yb(e){return""+(e+1)}function bb(e){for(var t=e.replace(/^\$([A-Z])/,"$1"),r=0,n=0;n!==t.length;++n)r=26*r+t.charCodeAt(n)-64;return r-1}function wb(e){if(e<0)throw new Error("invalid column "+e);var t="";for(++e;e;e=Math.floor((e-1)/26))t=String.fromCharCode((e-1)%26+65)+t;return t}function Eb(e){for(var t=0,r=0,n=0;n<e.length;++n){var a=e.charCodeAt(n);a>=48&&a<=57?t=10*t+(a-48):a>=65&&a<=90&&(r=26*r+(a-64))}return{c:r-1,r:t-1}}function Tb(e){for(var t=e.c+1,r="";t;t=(t-1)/26|0)r=String.fromCharCode((t-1)%26+65)+r;return r+(e.r+1)}function _b(e){var t=e.indexOf(":");return-1==t?{s:Eb(e),e:Eb(e)}:{s:Eb(e.slice(0,t)),e:Eb(e.slice(t+1))}}function Sb(e,t){return"undefined"===typeof t||"number"===typeof t?Sb(e.s,e.e):("string"!==typeof e&&(e=Tb(e)),"string"!==typeof t&&(t=Tb(t)),e==t?e:e+":"+t)}function kb(e){var t={s:{c:0,r:0},e:{c:0,r:0}},r=0,n=0,a=0,i=e.length;for(r=0;n<i&&!((a=e.charCodeAt(n)-64)<1||a>26);++n)r=26*r+a;for(t.s.c=--r,r=0;n<i&&!((a=e.charCodeAt(n)-48)<0||a>9);++n)r=10*r+a;if(t.s.r=--r,n===i||10!=a)return t.e.c=t.s.c,t.e.r=t.s.r,t;for(++n,r=0;n!=i&&!((a=e.charCodeAt(n)-64)<1||a>26);++n)r=26*r+a;for(t.e.c=--r,r=0;n!=i&&!((a=e.charCodeAt(n)-48)<0||a>9);++n)r=10*r+a;return t.e.r=--r,t}function Cb(e,t){var r="d"==e.t&&t instanceof Date;if(null!=e.z)try{return e.w=lv(e.z,r?bv(t):t)}catch(Ok){}try{return e.w=lv((e.XF||{}).numFmtId||(r?14:0),r?bv(t):t)}catch(Ok){return""+t}}function Ib(e,t,r){return null==e||null==e.t||"z"==e.t?"":void 0!==e.w?e.w:("d"==e.t&&!e.z&&r&&r.dateNF&&(e.z=r.dateNF),"e"==e.t?ew[e.v]||e.v:Cb(e,void 0==t?e.v:t))}function Ab(e,t){var r=t&&t.sheet?t.sheet:"Sheet1",n={};return n[r]=e,{SheetNames:[r],Sheets:n}}function Rb(e,t,r){var n=r||{},a=e?Array.isArray(e):n.dense;var i=e||(a?[]:{}),s=0,o=0;if(i&&null!=n.origin){if("number"==typeof n.origin)s=n.origin;else{var l="string"==typeof n.origin?Eb(n.origin):n.origin;s=l.r,o=l.c}i["!ref"]||(i["!ref"]="A1:A1")}var c={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(i["!ref"]){var u=kb(i["!ref"]);c.s.c=u.s.c,c.s.r=u.s.r,c.e.c=Math.max(c.e.c,u.e.c),c.e.r=Math.max(c.e.r,u.e.r),-1==s&&(c.e.r=s=u.e.r+1)}for(var h=0;h!=t.length;++h)if(t[h]){if(!Array.isArray(t[h]))throw new Error("aoa_to_sheet expects an array of arrays");for(var f=0;f!=t[h].length;++f)if("undefined"!==typeof t[h][f]){var d={v:t[h][f]},p=s+h,m=o+f;if(c.s.r>p&&(c.s.r=p),c.s.c>m&&(c.s.c=m),c.e.r<p&&(c.e.r=p),c.e.c<m&&(c.e.c=m),!t[h][f]||"object"!==typeof t[h][f]||Array.isArray(t[h][f])||t[h][f]instanceof Date)if(Array.isArray(d.v)&&(d.f=t[h][f][1],d.v=d.v[0]),null===d.v)if(d.f)d.t="n";else if(n.nullError)d.t="e",d.v=0;else{if(!n.sheetStubs)continue;d.t="z"}else"number"===typeof d.v?d.t="n":"boolean"===typeof d.v?d.t="b":d.v instanceof Date?(d.z=n.dateNF||Ng[14],n.cellDates?(d.t="d",d.w=lv(d.z,bv(d.v))):(d.t="n",d.v=bv(d.v),d.w=lv(d.z,d.v))):d.t="s";else d=t[h][f];if(a)i[p]||(i[p]=[]),i[p][m]&&i[p][m].z&&(d.z=i[p][m].z),i[p][m]=d;else{var g=Tb({c:m,r:p});i[g]&&i[g].z&&(d.z=i[g].z),i[g]=d}}}return c.s.c<1e7&&(i["!ref"]=Sb(c)),i}function Nb(e,t){return Rb(null,e,t)}function Ob(e){var t=e.read_shift(4);return 0===t?"":e.read_shift(t,"dbcs")}function xb(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function Pb(e,t){var r=e.l,n=e.read_shift(1),a=Ob(e),i=[],s={t:a,h:a};if(0!==(1&n)){for(var o=e.read_shift(4),l=0;l!=o;++l)i.push(xb(e));s.r=i}else s.r=[{ich:0,ifnt:0}];return e.l=r+t,s}var Db=Pb;function Lb(e){var t=e.read_shift(4),r=e.read_shift(2);return r+=e.read_shift(1)<<16,e.l++,{c:t,iStyleRef:r}}function Mb(e){var t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:t}}var Fb=Ob;function Ub(e){var t=e.read_shift(4);return 0===t||4294967295===t?"":e.read_shift(t,"dbcs")}var Vb=Ob,Bb=Ub;function zb(e){var t=e.slice(e.l,e.l+4),r=1&t[0],n=2&t[0];e.l+=4;var a=0===n?Ky([0,0,0,0,252&t[0],t[1],t[2],t[3]],0):eb(t,0)>>2;return r?a/100:a}function jb(e){var t={s:{},e:{}};return t.s.r=e.read_shift(4),t.e.r=e.read_shift(4),t.s.c=e.read_shift(4),t.e.c=e.read_shift(4),t}var Hb=jb;function $b(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function Wb(e,t){var r=e.read_shift(4);switch(r){case 0:return"";case 4294967295:case 4294967294:return{2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"}[e.read_shift(4)]||""}if(r>400)throw new Error("Unsupported Clipboard: "+r.toString(16));return e.l-=4,e.read_shift(0,1==t?"lpstr":"lpwstr")}var Gb=80,Kb=[Gb,81],qb={1:{n:"CodePage",t:2},2:{n:"Category",t:Gb},3:{n:"PresentationFormat",t:Gb},4:{n:"ByteCount",t:3},5:{n:"LineCount",t:3},6:{n:"ParagraphCount",t:3},7:{n:"SlideCount",t:3},8:{n:"NoteCount",t:3},9:{n:"HiddenCount",t:3},10:{n:"MultimediaClipCount",t:3},11:{n:"ScaleCrop",t:11},12:{n:"HeadingPairs",t:4108},13:{n:"TitlesOfParts",t:4126},14:{n:"Manager",t:Gb},15:{n:"Company",t:Gb},16:{n:"LinksUpToDate",t:11},17:{n:"CharacterCount",t:3},19:{n:"SharedDoc",t:11},22:{n:"HyperlinksChanged",t:11},23:{n:"AppVersion",t:3,p:"version"},24:{n:"DigSig",t:65},26:{n:"ContentType",t:Gb},27:{n:"ContentStatus",t:Gb},28:{n:"Language",t:Gb},29:{n:"Version",t:Gb},255:{},2147483648:{n:"Locale",t:19},2147483651:{n:"Behavior",t:19},1919054434:{}},Xb={1:{n:"CodePage",t:2},2:{n:"Title",t:Gb},3:{n:"Subject",t:Gb},4:{n:"Author",t:Gb},5:{n:"Keywords",t:Gb},6:{n:"Comments",t:Gb},7:{n:"Template",t:Gb},8:{n:"LastAuthor",t:Gb},9:{n:"RevNumber",t:Gb},10:{n:"EditTime",t:64},11:{n:"LastPrinted",t:64},12:{n:"CreatedDate",t:64},13:{n:"ModifiedDate",t:64},14:{n:"PageCount",t:3},15:{n:"WordCount",t:3},16:{n:"CharCount",t:3},17:{n:"Thumbnail",t:71},18:{n:"Application",t:Gb},19:{n:"DocSecurity",t:3},255:{},2147483648:{n:"Locale",t:19},2147483651:{n:"Behavior",t:19},1919054434:{}},Yb={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},Qb=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function Jb(e){return e.map((function(e){return[e>>16&255,e>>8&255,255&e]}))}var Zb=Nv(Jb([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0])),ew={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},tw={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},rw={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"};var nw={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function aw(e){var t=e.lastIndexOf("/");return e.slice(0,t+1)+"_rels/"+e.slice(t+1)+".rels"}function iw(e,t){var r={"!id":{}};if(!e)return r;"/"!==t.charAt(0)&&(t="/"+t);var n={};return(e.match(Yv)||[]).forEach((function(e){var a=Zv(e);if("<Relationship"===a[0]){var i={};i.Type=a.Type,i.Target=a.Target,i.Id=a.Id,a.TargetMode&&(i.TargetMode=a.TargetMode);var s="External"===a.TargetMode?a.Target:Gv(a.Target,t);r[s]=i,n[a.Id]=i}})),r["!id"]=n,r}var sw=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],ow=function(){for(var e=new Array(sw.length),t=0;t<sw.length;++t){var r=sw[t],n="(?:"+r[0].slice(0,r[0].indexOf(":"))+":)"+r[0].slice(r[0].indexOf(":")+1);e[t]=new RegExp("<"+n+"[^>]*>([\\s\\S]*?)</"+n+">")}return e}();function lw(e){var t={};e=dy(e);for(var r=0;r<sw.length;++r){var n=sw[r],a=e.match(ow[r]);null!=a&&a.length>0&&(t[n[1]]=ny(a[1])),"date"===n[2]&&t[n[1]]&&(t[n[1]]=Av(t[n[1]]))}return t}var cw=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]];function uw(e,t,r,n){var a=[];if("string"==typeof e)a=wy(e,n);else for(var i=0;i<e.length;++i)a=a.concat(e[i].map((function(e){return{v:e}})));var s="string"==typeof t?wy(t,n).map((function(e){return e.v})):t,o=0,l=0;if(s.length>0)for(var c=0;c!==a.length;c+=2){switch(l=+a[c+1].v,a[c].v){case"Worksheets":case"\u5de5\u4f5c\u8868":case"\u041b\u0438\u0441\u0442\u044b":case"\u0623\u0648\u0631\u0627\u0642 \u0627\u0644\u0639\u0645\u0644":case"\u30ef\u30fc\u30af\u30b7\u30fc\u30c8":case"\u05d2\u05dc\u05d9\u05d5\u05e0\u05d5\u05ea \u05e2\u05d1\u05d5\u05d3\u05d4":case"Arbeitsbl\xe4tter":case"\xc7al\u0131\u015fma Sayfalar\u0131":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de c\xe1lculo":case"Planilhas":case"Regneark":case"Hojas de c\xe1lculo":case"Werkbladen":r.Worksheets=l,r.SheetNames=s.slice(o,o+l);break;case"Named Ranges":case"Rangos con nombre":case"\u540d\u524d\u4ed8\u304d\u4e00\u89a7":case"Benannte Bereiche":case"Navngivne omr\xe5der":r.NamedRanges=l,r.DefinedNames=s.slice(o,o+l);break;case"Charts":case"Diagramme":r.Chartsheets=l,r.ChartNames=s.slice(o,o+l)}o+=l}}var hw=/<[^>]+>[^<]*/g;var fw,dw={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"};function pw(e,t,r){fw||(fw=vv(dw)),e[t=fw[t]||t]=r}function mw(e){var t=e.read_shift(4),r=e.read_shift(4);return new Date(1e3*(r/1e7*Math.pow(2,32)+t/1e7-11644473600)).toISOString().replace(/\.000/,"")}function gw(e,t,r){var n=e.l,a=e.read_shift(0,"lpstr-cp");if(r)for(;e.l-n&3;)++e.l;return a}function vw(e,t,r){var n=e.read_shift(0,"lpwstr");return r&&(e.l+=4-(n.length+1&3)&3),n}function yw(e,t,r){return 31===t?vw(e):gw(e,0,r)}function bw(e,t,r){return yw(e,t,!1===r?0:4)}function ww(e){var t=e.l,r=_w(e,81);return 0==e[e.l]&&0==e[e.l+1]&&e.l-t&2&&(e.l+=2),[r,_w(e,3)]}function Ew(e,t){for(var r=e.read_shift(4),n={},a=0;a!=r;++a){var i=e.read_shift(4),s=e.read_shift(4);n[i]=e.read_shift(s,1200===t?"utf16le":"utf8").replace(bg,"").replace(wg,"!"),1200===t&&s%2&&(e.l+=2)}return 3&e.l&&(e.l=e.l>>3<<2),n}function Tw(e){var t=e.read_shift(4),r=e.slice(e.l,e.l+t);return e.l+=t,(3&t)>0&&(e.l+=4-(3&t)&3),r}function _w(e,t,r){var n,a=e.read_shift(2),i=r||{};if(e.l+=2,12!==t&&a!==t&&-1===Kb.indexOf(t)&&(4126!=(65534&t)||4126!=(65534&a)))throw new Error("Expected type "+t+" saw "+a);switch(12===t?a:t){case 2:return n=e.read_shift(2,"i"),i.raw||(e.l+=2),n;case 3:return n=e.read_shift(4,"i");case 11:return 0!==e.read_shift(4);case 19:return n=e.read_shift(4);case 30:return gw(e,0,4).replace(bg,"");case 31:return vw(e);case 64:return mw(e);case 65:return Tw(e);case 71:return function(e){var t={};return t.Size=e.read_shift(4),e.l+=t.Size+3-(t.Size-1)%4,t}(e);case 80:return bw(e,a,!i.raw).replace(bg,"");case 81:return function(e,t){if(!t)throw new Error("VtUnalignedString must have positive length");return yw(e,t,0)}(e,a).replace(bg,"");case 4108:return function(e){for(var t=e.read_shift(4),r=[],n=0;n<t/2;++n)r.push(ww(e));return r}(e);case 4126:case 4127:return 4127==a?function(e){for(var t=e.read_shift(4),r=[],n=0;n!=t;++n){var a=e.l;r[n]=e.read_shift(0,"lpwstr").replace(bg,""),e.l-a&2&&(e.l+=2)}return r}(e):function(e){for(var t=e.read_shift(4),r=[],n=0;n!=t;++n)r[n]=e.read_shift(0,"lpstr-cp").replace(bg,"");return r}(e);default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+a)}}function Sw(e,t){var r=e.l,n=e.read_shift(4),a=e.read_shift(4),i=[],s=0,o=0,l=-1,c={};for(s=0;s!=a;++s){var u=e.read_shift(4),h=e.read_shift(4);i[s]=[u,h+r]}i.sort((function(e,t){return e[1]-t[1]}));var f={};for(s=0;s!=a;++s){if(e.l!==i[s][1]){var d=!0;if(s>0&&t)switch(t[i[s-1][0]].t){case 2:e.l+2===i[s][1]&&(e.l+=2,d=!1);break;case 80:case 4108:e.l<=i[s][1]&&(e.l=i[s][1],d=!1)}if((!t||0==s)&&e.l<=i[s][1]&&(d=!1,e.l=i[s][1]),d)throw new Error("Read Error: Expected address "+i[s][1]+" at "+e.l+" :"+s)}if(t){var p=t[i[s][0]];if(f[p.n]=_w(e,p.t,{raw:!0}),"version"===p.p&&(f[p.n]=String(f[p.n]>>16)+"."+("0000"+String(65535&f[p.n])).slice(-4)),"CodePage"==p.n)switch(f[p.n]){case 0:f[p.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:eg(o=f[p.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+f[p.n])}}else if(1===i[s][0]){if(o=f.CodePage=_w(e,2),eg(o),-1!==l){var m=e.l;e.l=i[l][1],c=Ew(e,o),e.l=m}}else if(0===i[s][0]){if(0===o){l=s,e.l=i[s+1][1];continue}c=Ew(e,o)}else{var g,v=c[i[s][0]];switch(e[e.l]){case 65:e.l+=4,g=Tw(e);break;case 30:case 31:e.l+=4,g=bw(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 3:e.l+=4,g=e.read_shift(4,"i");break;case 19:e.l+=4,g=e.read_shift(4);break;case 5:e.l+=4,g=e.read_shift(8,"f");break;case 11:e.l+=4,g=Iw(e,4);break;case 64:e.l+=4,g=Av(mw(e));break;default:throw new Error("unparsed value: "+e[e.l])}f[v]=g}}return e.l=r+n,f}function kw(e,t,r){var n=e.content;if(!n)return{};lb(n,0);var a,i,s,o,l=0;n.chk("feff","Byte Order: "),n.read_shift(2);var c=n.read_shift(4),u=n.read_shift(16);if(u!==pv.utils.consts.HEADER_CLSID&&u!==r)throw new Error("Bad PropertySet CLSID "+u);if(1!==(a=n.read_shift(4))&&2!==a)throw new Error("Unrecognized #Sets: "+a);if(i=n.read_shift(16),o=n.read_shift(4),1===a&&o!==n.l)throw new Error("Length mismatch: "+o+" !== "+n.l);2===a&&(s=n.read_shift(16),l=n.read_shift(4));var h,f=Sw(n,t),d={SystemIdentifier:c};for(var p in f)d[p]=f[p];if(d.FMTID=i,1===a)return d;if(l-n.l==2&&(n.l+=2),n.l!==l)throw new Error("Length mismatch 2: "+n.l+" !== "+l);try{h=Sw(n,null)}catch(Ok){}for(p in h)d[p]=h[p];return d.FMTID=[i,s],d}function Cw(e,t){return e.read_shift(t),null}function Iw(e,t){return 1===e.read_shift(t)}function Aw(e){return e.read_shift(2,"u")}function Rw(e,t){return function(e,t,r){for(var n=[],a=e.l+t;e.l<a;)n.push(r(e,a-e.l));if(a!==e.l)throw new Error("Slurp error");return n}(e,t,Aw)}function Nw(e,t,r){var n=e.read_shift(r&&r.biff>=12?2:1),a="sbcs-cont",i=Xm;(r&&r.biff>=8&&(Xm=1200),r&&8!=r.biff)?12==r.biff&&(a="wstr"):e.read_shift(1)&&(a="dbcs-cont");r.biff>=2&&r.biff<=5&&(a="cpstr");var s=n?e.read_shift(n,a):"";return Xm=i,s}function Ow(e){var t=Xm;Xm=1200;var r,n=e.read_shift(2),a=e.read_shift(1),i=4&a,s=8&a,o=1+(1&a),l=0,c={};s&&(l=e.read_shift(2)),i&&(r=e.read_shift(4));var u=2==o?"dbcs-cont":"sbcs-cont",h=0===n?"":e.read_shift(n,u);return s&&(e.l+=4*l),i&&(e.l+=r),c.t=h,s||(c.raw="<t>"+c.t+"</t>",c.r=c.t),Xm=t,c}function xw(e,t,r){if(r){if(r.biff>=2&&r.biff<=5)return e.read_shift(t,"cpstr");if(r.biff>=12)return e.read_shift(t,"dbcs-cont")}return 0===e.read_shift(1)?e.read_shift(t,"sbcs-cont"):e.read_shift(t,"dbcs-cont")}function Pw(e,t,r){var n=e.read_shift(r&&2==r.biff?1:2);return 0===n?(e.l++,""):xw(e,n,r)}function Dw(e,t,r){if(r.biff>5)return Pw(e,0,r);var n=e.read_shift(1);return 0===n?(e.l++,""):e.read_shift(n,r.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function Lw(e,t){var r=e.read_shift(16);switch(r){case"e0c9ea79f9bace118c8200aa004ba90b":return function(e){var t=e.read_shift(4),r=e.l,n=!1;t>24&&(e.l+=t-24,"795881f43b1d7f48af2c825dc4852763"===e.read_shift(16)&&(n=!0),e.l=r);var a=e.read_shift((n?t-24:t)>>1,"utf16le").replace(bg,"");return n&&(e.l+=24),a}(e);case"0303000000000000c000000000000046":return function(e){for(var t=e.read_shift(2),r="";t-- >0;)r+="../";var n=e.read_shift(0,"lpstr-ansi");if(e.l+=2,57005!=e.read_shift(2))throw new Error("Bad FileMoniker");if(0===e.read_shift(4))return r+n.replace(/\\/g,"/");var a=e.read_shift(4);if(3!=e.read_shift(2))throw new Error("Bad FileMoniker");return r+e.read_shift(a>>1,"utf16le").replace(bg,"")}(e);default:throw new Error("Unsupported Moniker "+r)}}function Mw(e){var t=e.read_shift(4);return t>0?e.read_shift(t,"utf16le").replace(bg,""):""}function Fw(e){return[e.read_shift(1),e.read_shift(1),e.read_shift(1),e.read_shift(1)]}function Uw(e,t){var r=Fw(e);return r[3]=0,r}function Vw(e){return{r:e.read_shift(2),c:e.read_shift(2),ixfe:e.read_shift(2)}}function Bw(e,t,r){var n=r.biff>8?4:2;return[e.read_shift(n),e.read_shift(n,"i"),e.read_shift(n,"i")]}function zw(e){return[e.read_shift(2),zb(e)]}function jw(e){var t=e.read_shift(2),r=e.read_shift(2);return{s:{c:e.read_shift(2),r:t},e:{c:e.read_shift(2),r:r}}}function Hw(e){var t=e.read_shift(2),r=e.read_shift(2);return{s:{c:e.read_shift(1),r:t},e:{c:e.read_shift(1),r:r}}}var $w=Hw;function Ww(e){e.l+=4;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2);return e.l+=12,[r,t,n]}function Gw(e){e.l+=2,e.l+=e.read_shift(2)}var Kw={0:Gw,4:Gw,5:Gw,6:Gw,7:function(e){return e.l+=4,e.cf=e.read_shift(2),{}},8:Gw,9:Gw,10:Gw,11:Gw,12:Gw,13:function(e){var t={};return e.l+=4,e.l+=16,t.fSharedNote=e.read_shift(2),e.l+=4,t},14:Gw,15:Gw,16:Gw,17:Gw,18:Gw,19:Gw,20:Gw,21:Ww};function qw(e,t){var r={BIFFVer:0,dt:0};switch(r.BIFFVer=e.read_shift(2),(t-=2)>=2&&(r.dt=e.read_shift(2),e.l-=2),r.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(t>6)throw new Error("Unexpected BIFF Ver "+r.BIFFVer)}return e.read_shift(t),r}function Xw(e,t,r){var n=0;r&&2==r.biff||(n=e.read_shift(2));var a=e.read_shift(2);return r&&2==r.biff&&(n=1-(a>>15),a&=32767),[{Unsynced:1&n,DyZero:(2&n)>>1,ExAsc:(4&n)>>2,ExDsc:(8&n)>>3},a]}var Yw=Dw;function Qw(e,t,r){var n=e.l+t,a=8!=r.biff&&r.biff?2:4,i=e.read_shift(a),s=e.read_shift(a),o=e.read_shift(2),l=e.read_shift(2);return e.l=n,{s:{r:i,c:o},e:{r:s,c:l}}}function Jw(e,t,r){var n=Vw(e);2!=r.biff&&9!=t||++e.l;var a=function(e){var t=e.read_shift(1);return 1===e.read_shift(1)?t:1===t}(e);return n.val=a,n.t=!0===a||!1===a?"b":"e",n}var Zw=function(e,t,r){return 0===t?"":Dw(e,0,r)};function eE(e,t,r){var n,a=e.read_shift(2),i={fBuiltIn:1&a,fWantAdvise:a>>>1&1,fWantPict:a>>>2&1,fOle:a>>>3&1,fOleLink:a>>>4&1,cf:a>>>5&1023,fIcon:a>>>15&1};return 14849===r.sbcch&&(n=function(e,t,r){e.l+=4,t-=4;var n=e.l+t,a=Nw(e,0,r),i=e.read_shift(2);if(i!==(n-=e.l))throw new Error("Malformed AddinUdf: padding = "+n+" != "+i);return e.l+=i,a}(e,t-2,r)),i.body=n||e.read_shift(t-2),"string"===typeof n&&(i.Name=n),i}var tE=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function rE(e,t,r){var n=e.l+t,a=e.read_shift(2),i=e.read_shift(1),s=e.read_shift(1),o=e.read_shift(r&&2==r.biff?1:2),l=0;(!r||r.biff>=5)&&(5!=r.biff&&(e.l+=2),l=e.read_shift(2),5==r.biff&&(e.l+=2),e.l+=4);var c=xw(e,s,r);32&a&&(c=tE[c.charCodeAt(0)]);var u=n-e.l;r&&2==r.biff&&--u;var h=n!=e.l&&0!==o&&u>0?function(e,t,r,n){var a,i=e.l+t,s=$T(e,n,r);i!==e.l&&(a=HT(e,i-e.l,s,r));return[s,a]}(e,u,r,o):[];return{chKey:i,Name:c,itab:l,rgce:h}}function nE(e,t,r){if(r.biff<8)return function(e,t,r){3==e[e.l+1]&&e[e.l]++;var n=Nw(e,0,r);return 3==n.charCodeAt(0)?n.slice(1):n}(e,0,r);for(var n=[],a=e.l+t,i=e.read_shift(r.biff>8?4:2);0!==i--;)n.push(Bw(e,r.biff,r));if(e.l!=a)throw new Error("Bad ExternSheet: "+e.l+" != "+a);return n}function aE(e,t,r){var n=$w(e,6);switch(r.biff){case 2:e.l++,t-=7;break;case 3:case 4:e.l+=2,t-=8;break;default:e.l+=6,t-=12}return[n,YT(e,t,r)]}var iE={8:function(e,t){var r=e.l+t;e.l+=10;var n=e.read_shift(2);e.l+=4,e.l+=2,e.l+=2,e.l+=2,e.l+=4;var a=e.read_shift(1);return e.l+=a,e.l=r,{fmt:n}}};function sE(e,t,r){if(!r.cellStyles)return cb(e,t);var n=r&&r.biff>=12?4:2,a=e.read_shift(n),i=e.read_shift(n),s=e.read_shift(n),o=e.read_shift(n),l=e.read_shift(2);2==n&&(e.l+=2);var c={s:a,e:i,w:s,ixfe:o,flags:l};return(r.biff>=5||!r.biff)&&(c.level=l>>8&7),c}var oE=Vw,lE=Rw,cE=Pw;var uE=[2,3,48,49,131,139,140,245],hE=function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},t=vv({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(t,r){var n=r||{};n.dateNF||(n.dateNF="yyyymmdd");var a=Nb(function(t,r){var n=[],a=dg(1);switch(r.type){case"base64":a=mg(ug(t));break;case"binary":a=mg(t);break;case"buffer":case"array":a=t}lb(a,0);var i=a.read_shift(1),s=!!(136&i),o=!1,l=!1;switch(i){case 2:case 3:case 131:case 139:case 245:break;case 48:case 49:o=!0,s=!0;break;case 140:l=!0;break;default:throw new Error("DBF Unsupported Version: "+i.toString(16))}var c=0,u=521;2==i&&(c=a.read_shift(2)),a.l+=3,2!=i&&(c=a.read_shift(4)),c>1048576&&(c=1e6),2!=i&&(u=a.read_shift(2));var h=a.read_shift(2),f=r.codepage||1252;2!=i&&(a.l+=16,a.read_shift(1),0!==a[a.l]&&(f=e[a[a.l]]),a.l+=1,a.l+=2),l&&(a.l+=36);for(var d=[],p={},m=Math.min(a.length,2==i?521:u-10-(o?264:0)),g=l?32:11;a.l<m&&13!=a[a.l];)switch((p={}).name=ag.utils.decode(f,a.slice(a.l,a.l+g)).replace(/[\u0000\r\n].*$/g,""),a.l+=g,p.type=String.fromCharCode(a.read_shift(1)),2==i||l||(p.offset=a.read_shift(4)),p.len=a.read_shift(1),2==i&&(p.offset=a.read_shift(2)),p.dec=a.read_shift(1),p.name.length&&d.push(p),2!=i&&(a.l+=l?13:14),p.type){case"B":o&&8==p.len||!r.WTF||console.log("Skipping "+p.name+":"+p.type);break;case"G":case"P":r.WTF&&console.log("Skipping "+p.name+":"+p.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+p.type)}if(13!==a[a.l]&&(a.l=u-1),13!==a.read_shift(1))throw new Error("DBF Terminator not found "+a.l+" "+a[a.l]);a.l=u;var v=0,y=0;for(n[0]=[],y=0;y!=d.length;++y)n[0][y]=d[y].name;for(;c-- >0;)if(42!==a[a.l])for(++a.l,n[++v]=[],y=0,y=0;y!=d.length;++y){var b=a.slice(a.l,a.l+d[y].len);a.l+=d[y].len,lb(b,0);var w=ag.utils.decode(f,b);switch(d[y].type){case"C":w.trim().length&&(n[v][y]=w.replace(/\s+$/,""));break;case"D":8===w.length?n[v][y]=new Date(+w.slice(0,4),+w.slice(4,6)-1,+w.slice(6,8)):n[v][y]=w;break;case"F":n[v][y]=parseFloat(w.trim());break;case"+":case"I":n[v][y]=l?2147483648^b.read_shift(-4,"i"):b.read_shift(4,"i");break;case"L":switch(w.trim().toUpperCase()){case"Y":case"T":n[v][y]=!0;break;case"N":case"F":n[v][y]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+w+"|")}break;case"M":if(!s)throw new Error("DBF Unexpected MEMO for type "+i.toString(16));n[v][y]="##MEMO##"+(l?parseInt(w.trim(),10):b.read_shift(4));break;case"N":(w=w.replace(/\u0000/g,"").trim())&&"."!=w&&(n[v][y]=+w||0);break;case"@":n[v][y]=new Date(b.read_shift(-8,"f")-621356832e5);break;case"T":n[v][y]=new Date(864e5*(b.read_shift(4)-2440588)+b.read_shift(4));break;case"Y":n[v][y]=b.read_shift(4,"i")/1e4+b.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":n[v][y]=-b.read_shift(-8,"f");break;case"B":if(o&&8==d[y].len){n[v][y]=b.read_shift(8,"f");break}case"G":case"P":b.l+=d[y].len;break;case"0":if("_NullFlags"===d[y].name)break;default:throw new Error("DBF Unsupported data type "+d[y].type)}}else a.l+=h;if(2!=i&&a.l<a.length&&26!=a[a.l++])throw new Error("DBF EOF Marker missing "+(a.l-1)+" of "+a.length+" "+a[a.l-1].toString(16));return r&&r.sheetRows&&(n=n.slice(0,r.sheetRows)),r.DBF=d,n}(t,n),n);return a["!cols"]=n.DBF.map((function(e){return{wch:e.len,DBF:e}})),delete n.DBF,a}var n={B:8,C:250,L:1,D:8,"?":0,"":0};return{to_workbook:function(e,t){try{return Ab(r(e,t),t)}catch(Ok){if(t&&t.WTF)throw Ok}return{SheetNames:[],Sheets:{}}},to_sheet:r,from_sheet:function(e,r){var a=r||{};if(+a.codepage>=0&&eg(+a.codepage),"string"==a.type)throw new Error("Cannot write DBF to JS string");var i=fb(),s=fk(e,{header:1,raw:!0,cellDates:!0}),o=s[0],l=s.slice(1),c=e["!cols"]||[],u=0,h=0,f=0,d=1;for(u=0;u<o.length;++u)if(((c[u]||{}).DBF||{}).name)o[u]=c[u].DBF.name,++f;else if(null!=o[u]){if(++f,"number"===typeof o[u]&&(o[u]=o[u].toString(10)),"string"!==typeof o[u])throw new Error("DBF Invalid column name "+o[u]+" |"+typeof o[u]+"|");if(o.indexOf(o[u])!==u)for(h=0;h<1024;++h)if(-1==o.indexOf(o[u]+"_"+h)){o[u]+="_"+h;break}}var p=kb(e["!ref"]),m=[],g=[],v=[];for(u=0;u<=p.e.c-p.s.c;++u){var y="",b="",w=0,E=[];for(h=0;h<l.length;++h)null!=l[h][u]&&E.push(l[h][u]);if(0!=E.length&&null!=o[u]){for(h=0;h<E.length;++h){switch(typeof E[h]){case"number":b="B";break;case"string":default:b="C";break;case"boolean":b="L";break;case"object":b=E[h]instanceof Date?"D":"C"}w=Math.max(w,String(E[h]).length),y=y&&y!=b?"C":b}w>250&&(w=250),"C"==(b=((c[u]||{}).DBF||{}).type)&&c[u].DBF.len>w&&(w=c[u].DBF.len),"B"==y&&"N"==b&&(y="N",v[u]=c[u].DBF.dec,w=c[u].DBF.len),g[u]="C"==y||"N"==b?w:n[y]||0,d+=g[u],m[u]=y}else m[u]="?"}var T=i.next(32);for(T.write_shift(4,318902576),T.write_shift(4,l.length),T.write_shift(2,296+32*f),T.write_shift(2,d),u=0;u<4;++u)T.write_shift(4,0);for(T.write_shift(4,(+t[Ym]||3)<<8),u=0,h=0;u<o.length;++u)if(null!=o[u]){var _=i.next(32),S=(o[u].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);_.write_shift(1,S,"sbcs"),_.write_shift(1,"?"==m[u]?"C":m[u],"sbcs"),_.write_shift(4,h),_.write_shift(1,g[u]||n[m[u]]||0),_.write_shift(1,v[u]||0),_.write_shift(1,2),_.write_shift(4,0),_.write_shift(1,0),_.write_shift(4,0),_.write_shift(4,0),h+=g[u]||n[m[u]]||0}var k=i.next(264);for(k.write_shift(4,13),u=0;u<65;++u)k.write_shift(4,0);for(u=0;u<l.length;++u){var C=i.next(d);for(C.write_shift(1,0),h=0;h<o.length;++h)if(null!=o[h])switch(m[h]){case"L":C.write_shift(1,null==l[u][h]?63:l[u][h]?84:70);break;case"B":C.write_shift(8,l[u][h]||0,"f");break;case"N":var I="0";for("number"==typeof l[u][h]&&(I=l[u][h].toFixed(v[h]||0)),f=0;f<g[h]-I.length;++f)C.write_shift(1,32);C.write_shift(1,I,"sbcs");break;case"D":l[u][h]?(C.write_shift(4,("0000"+l[u][h].getFullYear()).slice(-4),"sbcs"),C.write_shift(2,("00"+(l[u][h].getMonth()+1)).slice(-2),"sbcs"),C.write_shift(2,("00"+l[u][h].getDate()).slice(-2),"sbcs")):C.write_shift(8,"00000000","sbcs");break;case"C":var A=String(null!=l[u][h]?l[u][h]:"").slice(0,g[h]);for(C.write_shift(1,A,"sbcs"),f=0;f<g[h]-A.length;++f)C.write_shift(1,32)}}return i.next(1).write_shift(1,26),i.end()}}}(),fE=function(){var e={AA:"\xc0",BA:"\xc1",CA:"\xc2",DA:195,HA:"\xc4",JA:197,AE:"\xc8",BE:"\xc9",CE:"\xca",HE:"\xcb",AI:"\xcc",BI:"\xcd",CI:"\xce",HI:"\xcf",AO:"\xd2",BO:"\xd3",CO:"\xd4",DO:213,HO:"\xd6",AU:"\xd9",BU:"\xda",CU:"\xdb",HU:"\xdc",Aa:"\xe0",Ba:"\xe1",Ca:"\xe2",Da:227,Ha:"\xe4",Ja:229,Ae:"\xe8",Be:"\xe9",Ce:"\xea",He:"\xeb",Ai:"\xec",Bi:"\xed",Ci:"\xee",Hi:"\xef",Ao:"\xf2",Bo:"\xf3",Co:"\xf4",Do:245,Ho:"\xf6",Au:"\xf9",Bu:"\xfa",Cu:"\xfb",Hu:"\xfc",KC:"\xc7",Kc:"\xe7",q:"\xe6",z:"\u0153",a:"\xc6",j:"\u0152",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},t=new RegExp("\x1bN("+gv(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(t,r){var n=e[r];return"number"==typeof n?og(n):n},n=function(e,t,r){var n=t.charCodeAt(0)-32<<4|r.charCodeAt(0)-48;return 59==n?e:og(n)};function a(e,a){var i,s=e.split(/[\n\r]+/),o=-1,l=-1,c=0,u=0,h=[],f=[],d=null,p={},m=[],g=[],v=[],y=0;for(+a.codepage>=0&&eg(+a.codepage);c!==s.length;++c){y=0;var b,w=s[c].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(t,r),E=w.replace(/;;/g,"\0").split(";").map((function(e){return e.replace(/\u0000/g,";")})),T=E[0];if(w.length>0)switch(T){case"ID":case"E":case"B":case"O":case"W":break;case"P":"P"==E[1].charAt(0)&&f.push(w.slice(3).replace(/;;/g,";"));break;case"C":var _=!1,S=!1,k=!1,C=!1,I=-1,A=-1;for(u=1;u<E.length;++u)switch(E[u].charAt(0)){case"A":case"G":break;case"X":l=parseInt(E[u].slice(1))-1,S=!0;break;case"Y":for(o=parseInt(E[u].slice(1))-1,S||(l=0),i=h.length;i<=o;++i)h[i]=[];break;case"K":'"'===(b=E[u].slice(1)).charAt(0)?b=b.slice(1,b.length-1):"TRUE"===b?b=!0:"FALSE"===b?b=!1:isNaN(xv(b))?isNaN(Dv(b).getDate())||(b=Av(b)):(b=xv(b),null!==d&&av(d)&&(b=_v(b))),"undefined"!==typeof ag&&"string"==typeof b&&"string"!=(a||{}).type&&(a||{}).codepage&&(b=ag.utils.decode(a.codepage,b)),_=!0;break;case"E":C=!0;var R=yT(E[u].slice(1),{r:o,c:l});h[o][l]=[h[o][l],R];break;case"S":k=!0,h[o][l]=[h[o][l],"S5S"];break;case"R":I=parseInt(E[u].slice(1))-1;break;case"C":A=parseInt(E[u].slice(1))-1;break;default:if(a&&a.WTF)throw new Error("SYLK bad record "+w)}if(_&&(h[o][l]&&2==h[o][l].length?h[o][l][0]=b:h[o][l]=b,d=null),k){if(C)throw new Error("SYLK shared formula cannot have own formula");var N=I>-1&&h[I][A];if(!N||!N[1])throw new Error("SYLK shared formula cannot find base");h[o][l][1]=ET(N[1],{r:o-I,c:l-A})}break;case"F":var O=0;for(u=1;u<E.length;++u)switch(E[u].charAt(0)){case"X":l=parseInt(E[u].slice(1))-1,++O;break;case"Y":for(o=parseInt(E[u].slice(1))-1,i=h.length;i<=o;++i)h[i]=[];break;case"M":y=parseInt(E[u].slice(1))/20;break;case"F":case"G":case"S":case"D":case"N":break;case"P":d=f[parseInt(E[u].slice(1))];break;case"W":for(v=E[u].slice(1).split(" "),i=parseInt(v[0],10);i<=parseInt(v[1],10);++i)y=parseInt(v[2],10),g[i-1]=0===y?{hidden:!0}:{wch:y},qE(g[i-1]);break;case"C":g[l=parseInt(E[u].slice(1))-1]||(g[l]={});break;case"R":m[o=parseInt(E[u].slice(1))-1]||(m[o]={}),y>0?(m[o].hpt=y,m[o].hpx=QE(y)):0===y&&(m[o].hidden=!0);break;default:if(a&&a.WTF)throw new Error("SYLK bad record "+w)}O<1&&(d=null);break;default:if(a&&a.WTF)throw new Error("SYLK bad record "+w)}}return m.length>0&&(p["!rows"]=m),g.length>0&&(p["!cols"]=g),a&&a.sheetRows&&(h=h.slice(0,a.sheetRows)),[h,p]}function i(e,t){var r=function(e,t){switch(t.type){case"base64":return a(ug(e),t);case"binary":return a(e,t);case"buffer":return a(hg&&Buffer.isBuffer(e)?e.toString("binary"):gg(e),t);case"array":return a(Rv(e),t)}throw new Error("Unrecognized type "+t.type)}(e,t),n=r[0],i=r[1],s=Nb(n,t);return gv(i).forEach((function(e){s[e]=i[e]})),s}function s(e,t,r,n){var a="C;Y"+(r+1)+";X"+(n+1)+";K";switch(e.t){case"n":a+=e.v||0,e.f&&!e.F&&(a+=";E"+wT(e.f,{r:r,c:n}));break;case"b":a+=e.v?"TRUE":"FALSE";break;case"e":a+=e.w||e.v;break;case"d":a+='"'+(e.w||e.v)+'"';break;case"s":a+='"'+e.v.replace(/"/g,"").replace(/;/g,";;")+'"'}return a}return e["|"]=254,{to_workbook:function(e,t){return Ab(i(e,t),t)},to_sheet:i,from_sheet:function(e,t){var r,n,a=["ID;PWXL;N;E"],i=[],o=kb(e["!ref"]),l=Array.isArray(e),c="\r\n";a.push("P;PGeneral"),a.push("F;P0;DG0G8;M255"),e["!cols"]&&(n=a,e["!cols"].forEach((function(e,t){var r="F;W"+(t+1)+" "+(t+1)+" ";e.hidden?r+="0":("number"!=typeof e.width||e.wpx||(e.wpx=HE(e.width)),"number"!=typeof e.wpx||e.wch||(e.wch=$E(e.wpx)),"number"==typeof e.wch&&(r+=Math.round(e.wch)))," "!=r.charAt(r.length-1)&&n.push(r)}))),e["!rows"]&&function(e,t){t.forEach((function(t,r){var n="F;";t.hidden?n+="M0;":t.hpt?n+="M"+20*t.hpt+";":t.hpx&&(n+="M"+20*YE(t.hpx)+";"),n.length>2&&e.push(n+"R"+(r+1))}))}(a,e["!rows"]),a.push("B;Y"+(o.e.r-o.s.r+1)+";X"+(o.e.c-o.s.c+1)+";D"+[o.s.c,o.s.r,o.e.c,o.e.r].join(" "));for(var u=o.s.r;u<=o.e.r;++u)for(var h=o.s.c;h<=o.e.c;++h){var f=Tb({r:u,c:h});(r=l?(e[u]||[])[h]:e[f])&&(null!=r.v||r.f&&!r.F)&&i.push(s(r,0,u,h))}return a.join(c)+c+i.join(c)+c+"E"+c}}}(),dE=function(){function e(e,t){for(var r=e.split("\n"),n=-1,a=-1,i=0,s=[];i!==r.length;++i)if("BOT"!==r[i].trim()){if(!(n<0)){for(var o=r[i].trim().split(","),l=o[0],c=o[1],u=r[++i]||"";1&(u.match(/["]/g)||[]).length&&i<r.length-1;)u+="\n"+r[++i];switch(u=u.trim(),+l){case-1:if("BOT"===u){s[++n]=[],a=0;continue}if("EOD"!==u)throw new Error("Unrecognized DIF special command "+u);break;case 0:"TRUE"===u?s[n][a]=!0:"FALSE"===u?s[n][a]=!1:isNaN(xv(c))?isNaN(Dv(c).getDate())?s[n][a]=c:s[n][a]=Av(c):s[n][a]=xv(c),++a;break;case 1:(u=(u=u.slice(1,u.length-1)).replace(/""/g,'"'))&&u.match(/^=".*"$/)&&(u=u.slice(2,-1)),s[n][a++]=""!==u?u:null}if("EOD"===u)break}}else s[++n]=[],a=0;return t&&t.sheetRows&&(s=s.slice(0,t.sheetRows)),s}function t(t,r){return Nb(function(t,r){switch(r.type){case"base64":return e(ug(t),r);case"binary":return e(t,r);case"buffer":return e(hg&&Buffer.isBuffer(t)?t.toString("binary"):gg(t),r);case"array":return e(Rv(t),r)}throw new Error("Unrecognized type "+r.type)}(t,r),r)}var r=function(){var e=function(e,t,r,n,a){e.push(t),e.push(r+","+n),e.push('"'+a.replace(/"/g,'""')+'"')},t=function(e,t,r,n){e.push(t+","+r),e.push(1==t?'"'+n.replace(/"/g,'""')+'"':n)};return function(r){var n,a=[],i=kb(r["!ref"]),s=Array.isArray(r);e(a,"TABLE",0,1,"sheetjs"),e(a,"VECTORS",0,i.e.r-i.s.r+1,""),e(a,"TUPLES",0,i.e.c-i.s.c+1,""),e(a,"DATA",0,0,"");for(var o=i.s.r;o<=i.e.r;++o){t(a,-1,0,"BOT");for(var l=i.s.c;l<=i.e.c;++l){var c=Tb({r:o,c:l});if(n=s?(r[o]||[])[l]:r[c])switch(n.t){case"n":var u=n.w;u||null==n.v||(u=n.v),null==u?n.f&&!n.F?t(a,1,0,"="+n.f):t(a,1,0,""):t(a,0,u,"V");break;case"b":t(a,0,n.v?1:0,n.v?"TRUE":"FALSE");break;case"s":t(a,1,0,isNaN(n.v)?n.v:'="'+n.v+'"');break;case"d":n.w||(n.w=lv(n.z||Ng[14],bv(Av(n.v)))),t(a,0,n.w,"V");break;default:t(a,1,0,"")}else t(a,1,0,"")}}t(a,-1,0,"EOD");return a.join("\r\n")}}();return{to_workbook:function(e,r){return Ab(t(e,r),r)},to_sheet:t,from_sheet:r}}(),pE=function(){function e(e){return e.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function t(e,t){return Nb(function(e,t){for(var r=e.split("\n"),n=-1,a=-1,i=0,s=[];i!==r.length;++i){var o=r[i].trim().split(":");if("cell"===o[0]){var l=Eb(o[1]);if(s.length<=l.r)for(n=s.length;n<=l.r;++n)s[n]||(s[n]=[]);switch(n=l.r,a=l.c,o[2]){case"t":s[n][a]=o[3].replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,"\n");break;case"v":s[n][a]=+o[3];break;case"vtf":var c=o[o.length-1];case"vtc":"nl"===o[3]?s[n][a]=!!+o[4]:s[n][a]=+o[4],"vtf"==o[2]&&(s[n][a]=[s[n][a],c])}}}return t&&t.sheetRows&&(s=s.slice(0,t.sheetRows)),s}(e,t),t)}var r=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join("\n"),n=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join("\n")+"\n",a=["# SocialCalc Spreadsheet Control Save","part:sheet"].join("\n"),i="--SocialCalcSpreadsheetControlSave--";function s(t){if(!t||!t["!ref"])return"";for(var r,n=[],a=[],i="",s=_b(t["!ref"]),o=Array.isArray(t),l=s.s.r;l<=s.e.r;++l)for(var c=s.s.c;c<=s.e.c;++c)if(i=Tb({r:l,c:c}),(r=o?(t[l]||[])[c]:t[i])&&null!=r.v&&"z"!==r.t){switch(a=["cell",i,"t"],r.t){case"s":case"str":a.push(e(r.v));break;case"n":r.f?(a[2]="vtf",a[3]="n",a[4]=r.v,a[5]=e(r.f)):(a[2]="v",a[3]=r.v);break;case"b":a[2]="vt"+(r.f?"f":"c"),a[3]="nl",a[4]=r.v?"1":"0",a[5]=e(r.f||(r.v?"TRUE":"FALSE"));break;case"d":var u=bv(Av(r.v));a[2]="vtc",a[3]="nd",a[4]=""+u,a[5]=r.w||lv(r.z||Ng[14],u);break;case"e":continue}n.push(a.join(":"))}return n.push("sheet:c:"+(s.e.c-s.s.c+1)+":r:"+(s.e.r-s.s.r+1)+":tvf:1"),n.push("valueformat:1:text-wiki"),n.join("\n")}return{to_workbook:function(e,r){return Ab(t(e,r),r)},to_sheet:t,from_sheet:function(e){return[r,n,a,n,s(e),i].join("\n")}}}(),mE=function(){function e(e,t,r,n,a){a.raw?t[r][n]=e:""===e||("TRUE"===e?t[r][n]=!0:"FALSE"===e?t[r][n]=!1:isNaN(xv(e))?isNaN(Dv(e).getDate())?t[r][n]=e:t[r][n]=Av(e):t[r][n]=xv(e))}var t={44:",",9:"\t",59:";",124:"|"},r={44:3,9:2,59:1,124:0};function n(e){for(var n={},a=!1,i=0,s=0;i<e.length;++i)34==(s=e.charCodeAt(i))?a=!a:!a&&s in t&&(n[s]=(n[s]||0)+1);for(i in s=[],n)Object.prototype.hasOwnProperty.call(n,i)&&s.push([n[i],i]);if(!s.length)for(i in n=r)Object.prototype.hasOwnProperty.call(n,i)&&s.push([n[i],i]);return s.sort((function(e,t){return e[0]-t[0]||r[e[1]]-r[t[1]]})),t[s.pop()[1]]||44}function a(e,t){var r=t||{},a="";var i=r.dense?[]:{},s={s:{c:0,r:0},e:{c:0,r:0}};"sep="==e.slice(0,4)?13==e.charCodeAt(5)&&10==e.charCodeAt(6)?(a=e.charAt(4),e=e.slice(7)):13==e.charCodeAt(5)||10==e.charCodeAt(5)?(a=e.charAt(4),e=e.slice(6)):a=n(e.slice(0,1024)):a=r&&r.FS?r.FS:n(e.slice(0,1024));var o=0,l=0,c=0,u=0,h=0,f=a.charCodeAt(0),d=!1,p=0,m=e.charCodeAt(0);e=e.replace(/\r\n/gm,"\n");var g=null!=r.dateNF?function(e){var t="number"==typeof e?Ng[e]:e;return t=t.replace(fv,"(\\d+)"),new RegExp("^"+t+"$")}(r.dateNF):null;function v(){var t=e.slice(u,h),n={};if('"'==t.charAt(0)&&'"'==t.charAt(t.length-1)&&(t=t.slice(1,-1).replace(/""/g,'"')),0===t.length)n.t="z";else if(r.raw)n.t="s",n.v=t;else if(0===t.trim().length)n.t="s",n.v=t;else if(61==t.charCodeAt(0))34==t.charCodeAt(1)&&34==t.charCodeAt(t.length-1)?(n.t="s",n.v=t.slice(2,-1).replace(/""/g,'"')):1!=t.length?(n.t="n",n.f=t.slice(1)):(n.t="s",n.v=t);else if("TRUE"==t)n.t="b",n.v=!0;else if("FALSE"==t)n.t="b",n.v=!1;else if(isNaN(c=xv(t)))if(!isNaN(Dv(t).getDate())||g&&t.match(g)){n.z=r.dateNF||Ng[14];var a=0;g&&t.match(g)&&(t=function(e,t,r){var n=-1,a=-1,i=-1,s=-1,o=-1,l=-1;(t.match(fv)||[]).forEach((function(e,t){var c=parseInt(r[t+1],10);switch(e.toLowerCase().charAt(0)){case"y":n=c;break;case"d":i=c;break;case"h":s=c;break;case"s":l=c;break;case"m":s>=0?o=c:a=c}})),l>=0&&-1==o&&a>=0&&(o=a,a=-1);var c=(""+(n>=0?n:(new Date).getFullYear())).slice(-4)+"-"+("00"+(a>=1?a:1)).slice(-2)+"-"+("00"+(i>=1?i:1)).slice(-2);7==c.length&&(c="0"+c),8==c.length&&(c="20"+c);var u=("00"+(s>=0?s:0)).slice(-2)+":"+("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(l>=0?l:0)).slice(-2);return-1==s&&-1==o&&-1==l?c:-1==n&&-1==a&&-1==i?u:c+"T"+u}(0,r.dateNF,t.match(g)||[]),a=1),r.cellDates?(n.t="d",n.v=Av(t,a)):(n.t="n",n.v=bv(Av(t,a))),!1!==r.cellText&&(n.w=lv(n.z,n.v instanceof Date?bv(n.v):n.v)),r.cellNF||delete n.z}else n.t="s",n.v=t;else n.t="n",!1!==r.cellText&&(n.w=t),n.v=c;if("z"==n.t||(r.dense?(i[o]||(i[o]=[]),i[o][l]=n):i[Tb({c:l,r:o})]=n),u=h+1,m=e.charCodeAt(u),s.e.c<l&&(s.e.c=l),s.e.r<o&&(s.e.r=o),p==f)++l;else if(l=0,++o,r.sheetRows&&r.sheetRows<=o)return!0}e:for(;h<e.length;++h)switch(p=e.charCodeAt(h)){case 34:34===m&&(d=!d);break;case f:case 10:case 13:if(!d&&v())break e}return h-u>0&&v(),i["!ref"]=Sb(s),i}function i(t,r){return r&&r.PRN?r.FS||"sep="==t.slice(0,4)||t.indexOf("\t")>=0||t.indexOf(",")>=0||t.indexOf(";")>=0?a(t,r):Nb(function(t,r){var n=r||{},a=[];if(!t||0===t.length)return a;for(var i=t.split(/[\r\n]/),s=i.length-1;s>=0&&0===i[s].length;)--s;for(var o=10,l=0,c=0;c<=s;++c)-1==(l=i[c].indexOf(" "))?l=i[c].length:l++,o=Math.max(o,l);for(c=0;c<=s;++c){a[c]=[];var u=0;for(e(i[c].slice(0,o).trim(),a,c,u,n),u=1;u<=(i[c].length-o)/10+1;++u)e(i[c].slice(o+10*(u-1),o+10*u).trim(),a,c,u,n)}return n.sheetRows&&(a=a.slice(0,n.sheetRows)),a}(t,r),r):a(t,r)}function s(e,t){var r="",n="string"==t.type?[0,0,0,0]:ok(e,t);switch(t.type){case"base64":r=ug(e);break;case"binary":case"string":r=e;break;case"buffer":r=65001==t.codepage?e.toString("utf8"):t.codepage&&"undefined"!==typeof ag?ag.utils.decode(t.codepage,e):hg&&Buffer.isBuffer(e)?e.toString("binary"):gg(e);break;case"array":r=Rv(e);break;default:throw new Error("Unrecognized type "+t.type)}return 239==n[0]&&187==n[1]&&191==n[2]?r=dy(r.slice(3)):"string"!=t.type&&"buffer"!=t.type&&65001==t.codepage?r=dy(r):"binary"==t.type&&"undefined"!==typeof ag&&t.codepage&&(r=ag.utils.decode(t.codepage,ag.utils.encode(28591,r))),"socialcalc:version:"==r.slice(0,19)?pE.to_sheet("string"==t.type?r:dy(r),t):i(r,t)}return{to_workbook:function(e,t){return Ab(s(e,t),t)},to_sheet:s,from_sheet:function(e){for(var t,r=[],n=kb(e["!ref"]),a=Array.isArray(e),i=n.s.r;i<=n.e.r;++i){for(var s=[],o=n.s.c;o<=n.e.c;++o){var l=Tb({r:i,c:o});if((t=a?(e[i]||[])[o]:e[l])&&null!=t.v){for(var c=(t.w||(Ib(t),t.w)||"").slice(0,10);c.length<10;)c+=" ";s.push(c+(0===o?" ":""))}else s.push("          ")}r.push(s.join(""))}return r.join("\n")}}}();var gE=function(){function e(e,t,r){if(e){lb(e,e.l||0);for(var n=r.Enum||v;e.l<e.length;){var a=e.read_shift(2),i=n[a]||n[65535],s=e.read_shift(2),o=e.l+s,l=i.f&&i.f(e,s,r);if(e.l=o,t(l,i,a))return}}}function t(t,r){if(!t)return t;var n=r||{};var a=n.dense?[]:{},i="Sheet1",s="",o=0,l={},c=[],u=[],h={s:{r:0,c:0},e:{r:0,c:0}},f=n.sheetRows||0;if(0==t[2]&&(8==t[3]||9==t[3])&&t.length>=16&&5==t[14]&&108===t[15])throw new Error("Unsupported Works 3 for Mac file");if(2==t[2])n.Enum=v,e(t,(function(e,t,r){switch(r){case 0:n.vers=e,e>=4096&&(n.qpro=!0);break;case 6:h=e;break;case 204:e&&(s=e);break;case 222:s=e;break;case 15:case 51:n.qpro||(e[1].v=e[1].v.slice(1));case 13:case 14:case 16:14==r&&112==(112&e[2])&&(15&e[2])>1&&(15&e[2])<15&&(e[1].z=n.dateNF||Ng[14],n.cellDates&&(e[1].t="d",e[1].v=_v(e[1].v))),n.qpro&&e[3]>o&&(a["!ref"]=Sb(h),l[i]=a,c.push(i),a=n.dense?[]:{},h={s:{r:0,c:0},e:{r:0,c:0}},o=e[3],i=s||"Sheet"+(o+1),s="");var u=n.dense?(a[e[0].r]||[])[e[0].c]:a[Tb(e[0])];if(u){u.t=e[1].t,u.v=e[1].v,null!=e[1].z&&(u.z=e[1].z),null!=e[1].f&&(u.f=e[1].f);break}n.dense?(a[e[0].r]||(a[e[0].r]=[]),a[e[0].r][e[0].c]=e[1]):a[Tb(e[0])]=e[1]}}),n);else{if(26!=t[2]&&14!=t[2])throw new Error("Unrecognized LOTUS BOF "+t[2]);n.Enum=y,14==t[2]&&(n.qpro=!0,t.l=0),e(t,(function(e,t,r){switch(r){case 204:i=e;break;case 22:e[1].v=e[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(e[3]>o&&(a["!ref"]=Sb(h),l[i]=a,c.push(i),a=n.dense?[]:{},h={s:{r:0,c:0},e:{r:0,c:0}},o=e[3],i="Sheet"+(o+1)),f>0&&e[0].r>=f)break;n.dense?(a[e[0].r]||(a[e[0].r]=[]),a[e[0].r][e[0].c]=e[1]):a[Tb(e[0])]=e[1],h.e.c<e[0].c&&(h.e.c=e[0].c),h.e.r<e[0].r&&(h.e.r=e[0].r);break;case 27:e[14e3]&&(u[e[14e3][0]]=e[14e3][1]);break;case 1537:u[e[0]]=e[1],e[0]==o&&(i=e[1])}}),n)}if(a["!ref"]=Sb(h),l[s||i]=a,c.push(s||i),!u.length)return{SheetNames:c,Sheets:l};for(var d={},p=[],m=0;m<u.length;++m)l[c[m]]?(p.push(u[m]||c[m]),d[u[m]]=l[u[m]]||l[c[m]]):(p.push(u[m]),d[u[m]]={"!ref":"A1"});return{SheetNames:p,Sheets:d}}function r(e,t,r){var n=[{c:0,r:0},{t:"n",v:0},0,0];return r.qpro&&20768!=r.vers?(n[0].c=e.read_shift(1),n[3]=e.read_shift(1),n[0].r=e.read_shift(2),e.l+=2):(n[2]=e.read_shift(1),n[0].c=e.read_shift(2),n[0].r=e.read_shift(2)),n}function n(e,t,n){var a=e.l+t,i=r(e,0,n);if(i[1].t="s",20768==n.vers){e.l++;var s=e.read_shift(1);return i[1].v=e.read_shift(s,"utf8"),i}return n.qpro&&e.l++,i[1].v=e.read_shift(a-e.l,"cstr"),i}function a(e,t,r){var n=ub(7+r.length);n.write_shift(1,255),n.write_shift(2,t),n.write_shift(2,e),n.write_shift(1,39);for(var a=0;a<n.length;++a){var i=r.charCodeAt(a);n.write_shift(1,i>=128?95:i)}return n.write_shift(1,0),n}function i(e,t,r){var n=ub(7);return n.write_shift(1,255),n.write_shift(2,t),n.write_shift(2,e),n.write_shift(2,r,"i"),n}function s(e,t,r){var n=ub(13);return n.write_shift(1,255),n.write_shift(2,t),n.write_shift(2,e),n.write_shift(8,r,"f"),n}function o(e,t,r){var n=32768&t;return t=(n?e:0)+((t&=-32769)>=8192?t-16384:t),(n?"":"$")+(r?wb(t):yb(t))}var l={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},c=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function u(e){var t=[{c:0,r:0},{t:"n",v:0},0];return t[0].r=e.read_shift(2),t[3]=e[e.l++],t[0].c=e[e.l++],t}function h(e,t,r,n){var a=ub(6+n.length);a.write_shift(2,e),a.write_shift(1,r),a.write_shift(1,t),a.write_shift(1,39);for(var i=0;i<n.length;++i){var s=n.charCodeAt(i);a.write_shift(1,s>=128?95:s)}return a.write_shift(1,0),a}function f(e,t){var r=u(e),n=e.read_shift(4),a=e.read_shift(4),i=e.read_shift(2);if(65535==i)return 0===n&&3221225472===a?(r[1].t="e",r[1].v=15):0===n&&3489660928===a?(r[1].t="e",r[1].v=42):r[1].v=0,r;var s=32768&i;return i=(32767&i)-16446,r[1].v=(1-2*s)*(a*Math.pow(2,i+32)+n*Math.pow(2,i)),r}function d(e,t,r,n){var a=ub(14);if(a.write_shift(2,e),a.write_shift(1,r),a.write_shift(1,t),0==n)return a.write_shift(4,0),a.write_shift(4,0),a.write_shift(2,65535),a;var i,s=0,o=0,l=0;return n<0&&(s=1,n=-n),o=0|Math.log2(n),0==(2147483648&(l=(n/=Math.pow(2,o-31))>>>0))&&(++o,l=(n/=2)>>>0),n-=l,l|=2147483648,l>>>=0,i=(n*=Math.pow(2,32))>>>0,a.write_shift(4,i),a.write_shift(4,l),o+=16383+(s?32768:0),a.write_shift(2,o),a}function p(e,t){var r=u(e),n=e.read_shift(8,"f");return r[1].v=n,r}function m(e,t){return 0==e[e.l+t-1]?e.read_shift(t,"cstr"):""}function g(e,t){var r=ub(5+e.length);r.write_shift(2,14e3),r.write_shift(2,t);for(var n=0;n<e.length;++n){var a=e.charCodeAt(n);r[r.l++]=a>127?95:a}return r[r.l++]=0,r}var v={0:{n:"BOF",f:Aw},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:function(e,t,r){var n={s:{c:0,r:0},e:{c:0,r:0}};return 8==t&&r.qpro?(n.s.c=e.read_shift(1),e.l++,n.s.r=e.read_shift(2),n.e.c=e.read_shift(1),e.l++,n.e.r=e.read_shift(2),n):(n.s.c=e.read_shift(2),n.s.r=e.read_shift(2),12==t&&r.qpro&&(e.l+=2),n.e.c=e.read_shift(2),n.e.r=e.read_shift(2),12==t&&r.qpro&&(e.l+=2),65535==n.s.c&&(n.s.c=n.e.c=n.s.r=n.e.r=0),n)}},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:function(e,t,n){var a=r(e,0,n);return a[1].v=e.read_shift(2,"i"),a}},14:{n:"NUMBER",f:function(e,t,n){var a=r(e,0,n);return a[1].v=e.read_shift(8,"f"),a}},15:{n:"LABEL",f:n},16:{n:"FORMULA",f:function(e,t,n){var a=e.l+t,i=r(e,0,n);if(i[1].v=e.read_shift(8,"f"),n.qpro)e.l=a;else{var s=e.read_shift(2);!function(e,t){lb(e,0);var r=[],n=0,a="",i="",s="",u="";for(;e.l<e.length;){var h=e[e.l++];switch(h){case 0:r.push(e.read_shift(8,"f"));break;case 1:i=o(t[0].c,e.read_shift(2),!0),a=o(t[0].r,e.read_shift(2),!1),r.push(i+a);break;case 2:var f=o(t[0].c,e.read_shift(2),!0),d=o(t[0].r,e.read_shift(2),!1);i=o(t[0].c,e.read_shift(2),!0),a=o(t[0].r,e.read_shift(2),!1),r.push(f+d+":"+i+a);break;case 3:if(e.l<e.length)return void console.error("WK1 premature formula end");break;case 4:r.push("("+r.pop()+")");break;case 5:r.push(e.read_shift(2));break;case 6:for(var p="";h=e[e.l++];)p+=String.fromCharCode(h);r.push('"'+p.replace(/"/g,'""')+'"');break;case 8:r.push("-"+r.pop());break;case 23:r.push("+"+r.pop());break;case 22:r.push("NOT("+r.pop()+")");break;case 20:case 21:u=r.pop(),s=r.pop(),r.push(["AND","OR"][h-20]+"("+s+","+u+")");break;default:if(h<32&&c[h])u=r.pop(),s=r.pop(),r.push(s+c[h]+u);else{if(!l[h])return h<=7?console.error("WK1 invalid opcode "+h.toString(16)):h<=24?console.error("WK1 unsupported op "+h.toString(16)):h<=30?console.error("WK1 invalid opcode "+h.toString(16)):h<=115?console.error("WK1 unsupported function opcode "+h.toString(16)):console.error("WK1 unrecognized opcode "+h.toString(16));if(69==(n=l[h][1])&&(n=e[e.l++]),n>r.length)return void console.error("WK1 bad formula parse 0x"+h.toString(16)+":|"+r.join("|")+"|");var m=r.slice(-n);r.length-=n,r.push(l[h][0]+"("+m.join(",")+")")}}}1==r.length?t[1].f=""+r[0]:console.error("WK1 bad formula parse |"+r.join("|")+"|")}(e.slice(e.l,e.l+s),i),e.l+=s}return i}},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:n},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:m},222:{n:"SHEETNAMELP",f:function(e,t){var r=e[e.l++];r>t-1&&(r=t-1);for(var n="";n.length<r;)n+=String.fromCharCode(e[e.l++]);return n}},65535:{n:""}},y={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:function(e,t){var r=u(e);return r[1].t="s",r[1].v=e.read_shift(t-4,"cstr"),r}},23:{n:"NUMBER17",f:f},24:{n:"NUMBER18",f:function(e,t){var r=u(e);r[1].v=e.read_shift(2);var n=r[1].v>>1;if(1&r[1].v)switch(7&n){case 0:n=5e3*(n>>3);break;case 1:n=500*(n>>3);break;case 2:n=(n>>3)/20;break;case 3:n=(n>>3)/200;break;case 4:n=(n>>3)/2e3;break;case 5:n=(n>>3)/2e4;break;case 6:n=(n>>3)/16;break;case 7:n=(n>>3)/64}return r[1].v=n,r}},25:{n:"FORMULA19",f:function(e,t){var r=f(e);return e.l+=t-14,r}},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:function(e,t){for(var r={},n=e.l+t;e.l<n;){var a=e.read_shift(2);if(14e3==a){for(r[a]=[0,""],r[a][0]=e.read_shift(2);e[e.l];)r[a][1]+=String.fromCharCode(e[e.l]),e.l++;e.l++}}return r}},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:function(e,t){var r=u(e),n=e.read_shift(4);return r[1].v=n>>6,r}},38:{n:"??"},39:{n:"NUMBER27",f:p},40:{n:"FORMULA28",f:function(e,t){var r=p(e);return e.l+=t-10,r}},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:m},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:function(e,t,r){if(r.qpro&&!(t<21)){var n=e.read_shift(1);return e.l+=17,e.l+=1,e.l+=2,[n,e.read_shift(t-21,"cstr")]}}},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:function(e,t){var r=t||{};if(+r.codepage>=0&&eg(+r.codepage),"string"==r.type)throw new Error("Cannot write WK1 to JS string");var n=fb(),o=kb(e["!ref"]),l=Array.isArray(e),c=[];ES(n,0,function(e){var t=ub(2);return t.write_shift(2,e),t}(1030)),ES(n,6,function(e){var t=ub(8);return t.write_shift(2,e.s.c),t.write_shift(2,e.s.r),t.write_shift(2,e.e.c),t.write_shift(2,e.e.r),t}(o));for(var u=Math.min(o.e.r,8191),h=o.s.r;h<=u;++h)for(var f=yb(h),d=o.s.c;d<=o.e.c;++d){h===o.s.r&&(c[d]=wb(d));var p=c[d]+f,m=l?(e[h]||[])[d]:e[p];if(m&&"z"!=m.t)if("n"==m.t)(0|m.v)==m.v&&m.v>=-32768&&m.v<=32767?ES(n,13,i(h,d,m.v)):ES(n,14,s(h,d,m.v));else ES(n,15,a(h,d,Ib(m).slice(0,239)))}return ES(n,1),n.end()},book_to_wk3:function(e,t){var r=t||{};if(+r.codepage>=0&&eg(+r.codepage),"string"==r.type)throw new Error("Cannot write WK3 to JS string");var n=fb();ES(n,0,function(e){var t=ub(26);t.write_shift(2,4096),t.write_shift(2,4),t.write_shift(4,0);for(var r=0,n=0,a=0,i=0;i<e.SheetNames.length;++i){var s=e.SheetNames[i],o=e.Sheets[s];if(o&&o["!ref"]){++a;var l=_b(o["!ref"]);r<l.e.r&&(r=l.e.r),n<l.e.c&&(n=l.e.c)}}r>8191&&(r=8191);return t.write_shift(2,r),t.write_shift(1,a),t.write_shift(1,n),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(1,1),t.write_shift(1,2),t.write_shift(4,0),t.write_shift(4,0),t}(e));for(var a=0,i=0;a<e.SheetNames.length;++a)(e.Sheets[e.SheetNames[a]]||{})["!ref"]&&ES(n,27,g(e.SheetNames[a],i++));var s=0;for(a=0;a<e.SheetNames.length;++a){var o=e.Sheets[e.SheetNames[a]];if(o&&o["!ref"]){for(var l=kb(o["!ref"]),c=Array.isArray(o),u=[],f=Math.min(l.e.r,8191),p=l.s.r;p<=f;++p)for(var m=yb(p),v=l.s.c;v<=l.e.c;++v){p===l.s.r&&(u[v]=wb(v));var y=u[v]+m,b=c?(o[p]||[])[v]:o[y];if(b&&"z"!=b.t)if("n"==b.t)ES(n,23,d(p,v,s,b.v));else ES(n,22,h(p,v,s,Ib(b).slice(0,239)))}++s}}return ES(n,1),n.end()},to_workbook:function(e,r){switch(r.type){case"base64":return t(mg(ug(e)),r);case"binary":return t(mg(e),r);case"buffer":case"array":return t(e,r)}throw"Unsupported type "+r.type}}}();var vE=function(){var e=my("t"),t=my("rPr");function r(r){var n=r.match(e);if(!n)return{t:"s",v:""};var a={t:"s",v:ny(n[1])},i=r.match(t);return i&&(a.s=function(e){var t={},r=e.match(Yv),n=0,a=!1;if(r)for(;n!=r.length;++n){var i=Zv(r[n]);switch(i[0].replace(/\w*:/g,"")){case"<condense":case"<extend":break;case"<shadow":if(!i.val)break;case"<shadow>":case"<shadow/>":t.shadow=1;break;case"</shadow>":break;case"<charset":if("1"==i.val)break;t.cp=Jm[parseInt(i.val,10)];break;case"<outline":if(!i.val)break;case"<outline>":case"<outline/>":t.outline=1;break;case"</outline>":break;case"<rFont":t.name=i.val;break;case"<sz":t.sz=i.val;break;case"<strike":if(!i.val)break;case"<strike>":case"<strike/>":t.strike=1;break;case"</strike>":break;case"<u":if(!i.val)break;switch(i.val){case"double":t.uval="double";break;case"singleAccounting":t.uval="single-accounting";break;case"doubleAccounting":t.uval="double-accounting"}case"<u>":case"<u/>":t.u=1;break;case"</u>":break;case"<b":if("0"==i.val)break;case"<b>":case"<b/>":t.b=1;break;case"</b>":break;case"<i":if("0"==i.val)break;case"<i>":case"<i/>":t.i=1;break;case"</i>":break;case"<color":i.rgb&&(t.color=i.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":t.family=i.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":t.valign=i.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":case"<scheme":case"<scheme>":case"<scheme/>":case"</scheme>":case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(47!==i[0].charCodeAt(1)&&!a)throw new Error("Unrecognized rich format "+i[0])}}return t}(i[1])),a}var n=/<(?:\w+:)?r>/g,a=/<\/(?:\w+:)?r>/;return function(e){return e.replace(n,"").split(a).map(r).filter((function(e){return e.v}))}}(),yE=function(){var e=/(\r\n|\n)/g;function t(t){var r=[[],t.v,[]];return t.v?(t.s&&function(e,t,r){var n=[];e.u&&n.push("text-decoration: underline;"),e.uval&&n.push("text-underline-style:"+e.uval+";"),e.sz&&n.push("font-size:"+e.sz+"pt;"),e.outline&&n.push("text-effect: outline;"),e.shadow&&n.push("text-shadow: auto;"),t.push('<span style="'+n.join("")+'">'),e.b&&(t.push("<b>"),r.push("</b>")),e.i&&(t.push("<i>"),r.push("</i>")),e.strike&&(t.push("<s>"),r.push("</s>"));var a=e.valign||"";"superscript"==a||"super"==a?a="sup":"subscript"==a&&(a="sub"),""!=a&&(t.push("<"+a+">"),r.push("</"+a+">")),r.push("</span>")}(t.s,r[0],r[2]),r[0].join("")+r[1].replace(e,"<br/>")+r[2].join("")):""}return function(e){return e.map(t).join("")}}(),bE=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,wE=/<(?:\w+:)?r>/,EE=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function TE(e,t){var r=!t||t.cellHTML,n={};return e?(e.match(/^\s*<(?:\w+:)?t[^>]*>/)?(n.t=ny(dy(e.slice(e.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),n.r=dy(e),r&&(n.h=sy(n.t))):e.match(wE)&&(n.r=dy(e),n.t=ny(dy((e.replace(EE,"").match(bE)||[]).join("").replace(Yv,""))),r&&(n.h=yE(vE(n.r)))),n):{t:""}}var _E=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,SE=/<(?:\w+:)?(?:si|sstItem)>/g,kE=/<\/(?:\w+:)?(?:si|sstItem)>/;function CE(e){if("undefined"!==typeof ag)return ag.utils.encode(Ym,e);for(var t=[],r=e.split(""),n=0;n<r.length;++n)t[n]=r[n].charCodeAt(0);return t}function IE(e,t){var r={};return r.Major=e.read_shift(2),r.Minor=e.read_shift(2),t>=4&&(e.l+=t-4),r}function AE(e){for(var t=e.read_shift(4),r=e.l+t-4,n={},a=e.read_shift(4),i=[];a-- >0;)i.push({t:e.read_shift(4),v:e.read_shift(0,"lpp4")});if(n.name=e.read_shift(0,"lpp4"),n.comps=i,e.l!=r)throw new Error("Bad DataSpaceMapEntry: "+e.l+" != "+r);return n}function RE(e){var t=function(e){var t={};return e.read_shift(4),e.l+=4,t.id=e.read_shift(0,"lpp4"),t.name=e.read_shift(0,"lpp4"),t.R=IE(e,4),t.U=IE(e,4),t.W=IE(e,4),t}(e);if(t.ename=e.read_shift(0,"8lpp4"),t.blksz=e.read_shift(4),t.cmode=e.read_shift(4),4!=e.read_shift(4))throw new Error("Bad !Primary record");return t}function NE(e,t){var r=e.l+t,n={};n.Flags=63&e.read_shift(4),e.l+=4,n.AlgID=e.read_shift(4);var a=!1;switch(n.AlgID){case 26126:case 26127:case 26128:a=36==n.Flags;break;case 26625:a=4==n.Flags;break;case 0:a=16==n.Flags||4==n.Flags||36==n.Flags;break;default:throw"Unrecognized encryption algorithm: "+n.AlgID}if(!a)throw new Error("Encryption Flags/AlgID mismatch");return n.AlgIDHash=e.read_shift(4),n.KeySize=e.read_shift(4),n.ProviderType=e.read_shift(4),e.l+=8,n.CSPName=e.read_shift(r-e.l>>1,"utf16le"),e.l=r,n}function OE(e,t){var r={},n=e.l+t;return e.l+=4,r.Salt=e.slice(e.l,e.l+16),e.l+=16,r.Verifier=e.slice(e.l,e.l+16),e.l+=16,e.read_shift(4),r.VerifierHash=e.slice(e.l,n),e.l=n,r}function xE(e){if(36!=(63&e.read_shift(4)))throw new Error("EncryptionInfo mismatch");var t=e.read_shift(4);return{t:"Std",h:NE(e,t),v:OE(e,e.length-e.l)}}function PE(){throw new Error("File is password-protected: ECMA-376 Extensible")}function DE(e){var t=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];e.l+=4;var r=e.read_shift(e.length-e.l,"utf8"),n={};return r.replace(Yv,(function(e){var r=Zv(e);switch(ey(r[0])){case"<?xml":case"<encryption":case"</encryption>":case"</keyEncryptors>":case"</keyEncryptor>":break;case"<keyData":t.forEach((function(e){n[e]=r[e]}));break;case"<dataIntegrity":n.encryptedHmacKey=r.encryptedHmacKey,n.encryptedHmacValue=r.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":n.encs=[];break;case"<keyEncryptor":n.uri=r.uri;break;case"<encryptedKey":n.encs.push(r);break;default:throw r[0]}})),n}function LE(e){var t,r,n=0,a=CE(e),i=a.length+1;for((t=dg(i))[0]=a.length,r=1;r!=i;++r)t[r]=a[r-1];for(r=i-1;r>=0;--r)n=((0===(16384&n)?0:1)|n<<1&32767)^t[r];return 52811^n}var ME=function(){var e=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],t=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],r=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],n=function(e,t){return 255&((r=e^t)/2|128*r);var r};return function(a){for(var i,s,o,l=CE(a),c=function(e){for(var n=t[e.length-1],a=104,i=e.length-1;i>=0;--i)for(var s=e[i],o=0;7!=o;++o)64&s&&(n^=r[a]),s*=2,--a;return n}(l),u=l.length,h=dg(16),f=0;16!=f;++f)h[f]=0;for(1===(1&u)&&(i=c>>8,h[u]=n(e[0],i),--u,i=255&c,s=l[l.length-1],h[u]=n(s,i));u>0;)i=c>>8,h[--u]=n(l[u],i),i=255&c,h[--u]=n(l[u],i);for(u=15,o=15-l.length;o>0;)i=c>>8,h[u]=n(e[o],i),--o,i=255&c,h[--u]=n(l[u],i),--u,--o;return h}}(),FE=function(e){var t=0,r=ME(e);return function(e){var n=function(e,t,r,n,a){var i,s;for(a||(a=t),n||(n=ME(e)),i=0;i!=t.length;++i)s=t[i],s=255&((s^=n[r])>>5|s<<3),a[i]=s,++r;return[a,r,n]}("",e,t,r);return t=n[1],n[0]}};function UE(e,t,r){var n=r||{};return n.Info=e.read_shift(2),e.l-=2,1===n.Info?n.Data=function(e){var t={},r=t.EncryptionVersionInfo=IE(e,4);if(1!=r.Major||1!=r.Minor)throw"unrecognized version code "+r.Major+" : "+r.Minor;return t.Salt=e.read_shift(16),t.EncryptedVerifier=e.read_shift(16),t.EncryptedVerifierHash=e.read_shift(16),t}(e):n.Data=function(e,t){var r={},n=r.EncryptionVersionInfo=IE(e,4);if(t-=4,2!=n.Minor)throw new Error("unrecognized minor version code: "+n.Minor);if(n.Major>4||n.Major<2)throw new Error("unrecognized major version code: "+n.Major);r.Flags=e.read_shift(4),t-=4;var a=e.read_shift(4);return t-=4,r.EncryptionHeader=NE(e,a),t-=a,r.EncryptionVerifier=OE(e,t),r}(e,t),n}var VE=function(){function e(e,r){switch(r.type){case"base64":return t(ug(e),r);case"binary":return t(e,r);case"buffer":return t(hg&&Buffer.isBuffer(e)?e.toString("binary"):gg(e),r);case"array":return t(Rv(e),r)}throw new Error("Unrecognized type "+r.type)}function t(e,t){var r=(t||{}).dense?[]:{},n=e.match(/\\trowd.*?\\row\b/g);if(!n.length)throw new Error("RTF missing table");var a={s:{c:0,r:0},e:{c:0,r:n.length-1}};return n.forEach((function(e,t){Array.isArray(r)&&(r[t]=[]);for(var n,i=/\\\w+\b/g,s=0,o=-1;n=i.exec(e);){if("\\cell"===n[0]){var l=e.slice(s,i.lastIndex-n[0].length);if(" "==l[0]&&(l=l.slice(1)),++o,l.length){var c={v:l,t:"s"};Array.isArray(r)?r[t][o]=c:r[Tb({r:t,c:o})]=c}}s=i.lastIndex}o>a.e.c&&(a.e.c=o)})),r["!ref"]=Sb(a),r}return{to_workbook:function(t,r){return Ab(e(t,r),r)},to_sheet:e,from_sheet:function(e){for(var t,r=["{\\rtf1\\ansi"],n=kb(e["!ref"]),a=Array.isArray(e),i=n.s.r;i<=n.e.r;++i){r.push("\\trowd\\trautofit1");for(var s=n.s.c;s<=n.e.c;++s)r.push("\\cellx"+(s+1));for(r.push("\\pard\\intbl"),s=n.s.c;s<=n.e.c;++s){var o=Tb({r:i,c:s});(t=a?(e[i]||[])[s]:e[o])&&(null!=t.v||t.f&&!t.F)&&(r.push(" "+(t.w||(Ib(t),t.w))),r.push("\\cell"))}r.push("\\pard\\intbl\\row")}return r.join("")+"}"}}}();function BE(e){for(var t=0,r=1;3!=t;++t)r=256*r+(e[t]>255?255:e[t]<0?0:e[t]);return r.toString(16).toUpperCase().slice(1)}function zE(e,t){if(0===t)return e;var r=function(e){var t=e[0]/255,r=e[1]/255,n=e[2]/255,a=Math.max(t,r,n),i=Math.min(t,r,n),s=a-i;if(0===s)return[0,0,t];var o,l=0,c=a+i;switch(o=s/(c>1?2-c:c),a){case t:l=((r-n)/s+6)%6;break;case r:l=(n-t)/s+2;break;case n:l=(t-r)/s+4}return[l/6,o,c/2]}(function(e){var t=e.slice("#"===e[0]?1:0).slice(0,6);return[parseInt(t.slice(0,2),16),parseInt(t.slice(2,4),16),parseInt(t.slice(4,6),16)]}(e));return r[2]=t<0?r[2]*(1+t):1-(1-r[2])*(1-t),BE(function(e){var t,r=e[0],n=e[1],a=e[2],i=2*n*(a<.5?a:1-a),s=a-i/2,o=[s,s,s],l=6*r;if(0!==n)switch(0|l){case 0:case 6:t=i*l,o[0]+=i,o[1]+=t;break;case 1:t=i*(2-l),o[0]+=t,o[1]+=i;break;case 2:t=i*(l-2),o[1]+=i,o[2]+=t;break;case 3:t=i*(4-l),o[1]+=t,o[2]+=i;break;case 4:t=i*(l-4),o[2]+=i,o[0]+=t;break;case 5:t=i*(6-l),o[2]+=t,o[0]+=i}for(var c=0;3!=c;++c)o[c]=Math.round(255*o[c]);return o}(r))}var jE=6;function HE(e){return Math.floor((e+Math.round(128/jE)/256)*jE)}function $E(e){return Math.floor((e-5)/jE*100+.5)/100}function WE(e){return Math.round((e*jE+5)/jE*256)/256}function GE(e){return WE($E(HE(e)))}function KE(e){var t=Math.abs(e-GE(e)),r=jE;if(t>.005)for(jE=1;jE<15;++jE)Math.abs(e-GE(e))<=t&&(t=Math.abs(e-GE(e)),r=jE);jE=r}function qE(e){e.width?(e.wpx=HE(e.width),e.wch=$E(e.wpx),e.MDW=jE):e.wpx?(e.wch=$E(e.wpx),e.width=WE(e.wch),e.MDW=jE):"number"==typeof e.wch&&(e.width=WE(e.wch),e.wpx=HE(e.width),e.MDW=jE),e.customWidth&&delete e.customWidth}var XE=96;function YE(e){return 96*e/XE}function QE(e){return e*XE/96}var JE={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};var ZE=["numFmtId","fillId","fontId","borderId","xfId"],eT=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];var tT=function(){var e=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,t=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,r=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,n=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,a=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(i,s,o){var l,c={};return i?((l=(i=i.replace(/<!--([\s\S]*?)-->/gm,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"")).match(e))&&function(e,t,r){t.NumberFmt=[];for(var n=gv(Ng),a=0;a<n.length;++a)t.NumberFmt[n[a]]=Ng[n[a]];var i=e[0].match(Yv);if(i)for(a=0;a<i.length;++a){var s=Zv(i[a]);switch(ey(s[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":case"</numFmt>":break;case"<numFmt":var o=ny(dy(s.formatCode)),l=parseInt(s.numFmtId,10);if(t.NumberFmt[l]=o,l>0){if(l>392){for(l=392;l>60&&null!=t.NumberFmt[l];--l);t.NumberFmt[l]=o}cv(o,l)}break;default:if(r.WTF)throw new Error("unrecognized "+s[0]+" in numFmts")}}}(l,c,o),(l=i.match(n))&&function(e,t,r,n){t.Fonts=[];var a={},i=!1;(e[0].match(Yv)||[]).forEach((function(e){var s=Zv(e);switch(ey(s[0])){case"<fonts":case"<fonts>":case"</fonts>":case"<font":case"<font>":case"<name/>":case"</name>":case"<sz/>":case"</sz>":case"<vertAlign/>":case"</vertAlign>":case"<family/>":case"</family>":case"<scheme/>":case"</scheme>":case"<color/>":case"</color>":case"<extLst":case"<extLst>":case"</extLst>":break;case"</font>":case"<font/>":t.Fonts.push(a),a={};break;case"<name":s.val&&(a.name=dy(s.val));break;case"<b":a.bold=s.val?ly(s.val):1;break;case"<b/>":a.bold=1;break;case"<i":a.italic=s.val?ly(s.val):1;break;case"<i/>":a.italic=1;break;case"<u":switch(s.val){case"none":a.underline=0;break;case"single":a.underline=1;break;case"double":a.underline=2;break;case"singleAccounting":a.underline=33;break;case"doubleAccounting":a.underline=34}break;case"<u/>":a.underline=1;break;case"<strike":a.strike=s.val?ly(s.val):1;break;case"<strike/>":a.strike=1;break;case"<outline":a.outline=s.val?ly(s.val):1;break;case"<outline/>":a.outline=1;break;case"<shadow":a.shadow=s.val?ly(s.val):1;break;case"<shadow/>":a.shadow=1;break;case"<condense":a.condense=s.val?ly(s.val):1;break;case"<condense/>":a.condense=1;break;case"<extend":a.extend=s.val?ly(s.val):1;break;case"<extend/>":a.extend=1;break;case"<sz":s.val&&(a.sz=+s.val);break;case"<vertAlign":s.val&&(a.vertAlign=s.val);break;case"<family":s.val&&(a.family=parseInt(s.val,10));break;case"<scheme":s.val&&(a.scheme=s.val);break;case"<charset":if("1"==s.val)break;s.codepage=Jm[parseInt(s.val,10)];break;case"<color":if(a.color||(a.color={}),s.auto&&(a.color.auto=ly(s.auto)),s.rgb)a.color.rgb=s.rgb.slice(-6);else if(s.indexed){a.color.index=parseInt(s.indexed,10);var o=Zb[a.color.index];81==a.color.index&&(o=Zb[1]),o||(o=Zb[1]),a.color.rgb=o[0].toString(16)+o[1].toString(16)+o[2].toString(16)}else s.theme&&(a.color.theme=parseInt(s.theme,10),s.tint&&(a.color.tint=parseFloat(s.tint)),s.theme&&r.themeElements&&r.themeElements.clrScheme&&(a.color.rgb=zE(r.themeElements.clrScheme[a.color.theme].rgb,a.color.tint||0)));break;case"<AlternateContent":case"<ext":i=!0;break;case"</AlternateContent>":case"</ext>":i=!1;break;default:if(n&&n.WTF&&!i)throw new Error("unrecognized "+s[0]+" in fonts")}}))}(l,c,s,o),(l=i.match(r))&&function(e,t,r,n){t.Fills=[];var a={},i=!1;(e[0].match(Yv)||[]).forEach((function(e){var r=Zv(e);switch(ey(r[0])){case"<fills":case"<fills>":case"</fills>":case"</fill>":case"<gradientFill>":case"<patternFill/>":case"</patternFill>":case"<bgColor/>":case"</bgColor>":case"<fgColor/>":case"</fgColor>":case"<stop":case"<stop/>":case"</stop>":case"<color":case"<color/>":case"</color>":case"<extLst":case"<extLst>":case"</extLst>":break;case"<fill>":case"<fill":case"<fill/>":a={},t.Fills.push(a);break;case"<gradientFill":case"</gradientFill>":t.Fills.push(a),a={};break;case"<patternFill":case"<patternFill>":r.patternType&&(a.patternType=r.patternType);break;case"<bgColor":a.bgColor||(a.bgColor={}),r.indexed&&(a.bgColor.indexed=parseInt(r.indexed,10)),r.theme&&(a.bgColor.theme=parseInt(r.theme,10)),r.tint&&(a.bgColor.tint=parseFloat(r.tint)),r.rgb&&(a.bgColor.rgb=r.rgb.slice(-6));break;case"<fgColor":a.fgColor||(a.fgColor={}),r.theme&&(a.fgColor.theme=parseInt(r.theme,10)),r.tint&&(a.fgColor.tint=parseFloat(r.tint)),null!=r.rgb&&(a.fgColor.rgb=r.rgb.slice(-6));break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(n&&n.WTF&&!i)throw new Error("unrecognized "+r[0]+" in fills")}}))}(l,c,0,o),(l=i.match(a))&&function(e,t,r,n){t.Borders=[];var a={},i=!1;(e[0].match(Yv)||[]).forEach((function(e){var r=Zv(e);switch(ey(r[0])){case"<borders":case"<borders>":case"</borders>":case"</border>":case"<left/>":case"<left":case"<left>":case"</left>":case"<right/>":case"<right":case"<right>":case"</right>":case"<top/>":case"<top":case"<top>":case"</top>":case"<bottom/>":case"<bottom":case"<bottom>":case"</bottom>":case"<diagonal":case"<diagonal>":case"<diagonal/>":case"</diagonal>":case"<horizontal":case"<horizontal>":case"<horizontal/>":case"</horizontal>":case"<vertical":case"<vertical>":case"<vertical/>":case"</vertical>":case"<start":case"<start>":case"<start/>":case"</start>":case"<end":case"<end>":case"<end/>":case"</end>":case"<color":case"<color>":case"<color/>":case"</color>":case"<extLst":case"<extLst>":case"</extLst>":break;case"<border":case"<border>":case"<border/>":a={},r.diagonalUp&&(a.diagonalUp=ly(r.diagonalUp)),r.diagonalDown&&(a.diagonalDown=ly(r.diagonalDown)),t.Borders.push(a);break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(n&&n.WTF&&!i)throw new Error("unrecognized "+r[0]+" in borders")}}))}(l,c,0,o),(l=i.match(t))&&function(e,t,r){var n;t.CellXf=[];var a=!1;(e[0].match(Yv)||[]).forEach((function(e){var i=Zv(e),s=0;switch(ey(i[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":case"</xf>":case"</alignment>":case"<protection":case"</protection>":case"<protection/>":case"<extLst":case"<extLst>":case"</extLst>":break;case"<xf":case"<xf/>":for(delete(n=i)[0],s=0;s<ZE.length;++s)n[ZE[s]]&&(n[ZE[s]]=parseInt(n[ZE[s]],10));for(s=0;s<eT.length;++s)n[eT[s]]&&(n[eT[s]]=ly(n[eT[s]]));if(t.NumberFmt&&n.numFmtId>392)for(s=392;s>60;--s)if(t.NumberFmt[n.numFmtId]==t.NumberFmt[s]){n.numFmtId=s;break}t.CellXf.push(n);break;case"<alignment":case"<alignment/>":var o={};i.vertical&&(o.vertical=i.vertical),i.horizontal&&(o.horizontal=i.horizontal),null!=i.textRotation&&(o.textRotation=i.textRotation),i.indent&&(o.indent=i.indent),i.wrapText&&(o.wrapText=ly(i.wrapText)),n.alignment=o;break;case"<AlternateContent":case"<ext":a=!0;break;case"</AlternateContent>":case"</ext>":a=!1;break;default:if(r&&r.WTF&&!a)throw new Error("unrecognized "+i[0]+" in cellXfs")}}))}(l,c,o),c):c}}();var rT=cb;var nT=cb;var aT=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function iT(e,t,r){t.themeElements.clrScheme=[];var n={};(e[0].match(Yv)||[]).forEach((function(e){var a=Zv(e);switch(a[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":n.rgb=a.val;break;case"<a:sysClr":n.rgb=a.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":"/"===a[0].charAt(1)?(t.themeElements.clrScheme[aT.indexOf(a[0])]=n,n={}):n.name=a[0].slice(3,a[0].length-1);break;default:if(r&&r.WTF)throw new Error("Unrecognized "+a[0]+" in clrScheme")}}))}function sT(){}function oT(){}var lT=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,cT=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,uT=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;var hT=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function fT(e,t){var r;e&&0!==e.length||(e=dT());var n={};if(!(r=e.match(hT)))throw new Error("themeElements not found in theme");return function(e,t,r){var n;t.themeElements={},[["clrScheme",lT,iT],["fontScheme",cT,sT],["fmtScheme",uT,oT]].forEach((function(a){if(!(n=e.match(a[1])))throw new Error(a[0]+" not found in themeElements");a[2](n,t,r)}))}(r[0],n,t),n.raw=e,n}function dT(e,t){if(t&&t.themeXLSX)return t.themeXLSX;if(e&&"string"==typeof e.raw)return e.raw;var r=[Kv];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface="\uff2d\uff33 \uff30\u30b4\u30b7\u30c3\u30af"/>',r[r.length]='<a:font script="Hang" typeface="\ub9d1\uc740 \uace0\ub515"/>',r[r.length]='<a:font script="Hans" typeface="\u5b8b\u4f53"/>',r[r.length]='<a:font script="Hant" typeface="\u65b0\u7d30\u660e\u9ad4"/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface="\uff2d\uff33 \uff30\u30b4\u30b7\u30c3\u30af"/>',r[r.length]='<a:font script="Hang" typeface="\ub9d1\uc740 \uace0\ub515"/>',r[r.length]='<a:font script="Hans" typeface="\u5b8b\u4f53"/>',r[r.length]='<a:font script="Hant" typeface="\u65b0\u7d30\u660e\u9ad4"/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function pT(e){var t={};switch(t.xclrType=e.read_shift(2),t.nTintShade=e.read_shift(2),t.xclrType){case 0:case 4:e.l+=4;break;case 1:t.xclrValue=function(e,t){return cb(e,t)}(e,4);break;case 2:t.xclrValue=Fw(e);break;case 3:t.xclrValue=function(e){return e.read_shift(4)}(e)}return e.l+=8,t}function mT(e){var t=e.read_shift(2),r=e.read_shift(2)-4,n=[t];switch(t){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:n[1]=pT(e);break;case 6:n[1]=function(e,t){return cb(e,t)}(e,r);break;case 14:case 15:n[1]=e.read_shift(1===r?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+t+" "+r)}return n}function gT(e,t,r,n){var a,i=Array.isArray(e);t.forEach((function(t){var s=Eb(t.ref);if(i?(e[s.r]||(e[s.r]=[]),a=e[s.r][s.c]):a=e[t.ref],!a){a={t:"z"},i?e[s.r][s.c]=a:e[t.ref]=a;var o=kb(e["!ref"]||"BDWGO1000001:A1");o.s.r>s.r&&(o.s.r=s.r),o.e.r<s.r&&(o.e.r=s.r),o.s.c>s.c&&(o.s.c=s.c),o.e.c<s.c&&(o.e.c=s.c);var l=Sb(o);l!==e["!ref"]&&(e["!ref"]=l)}a.c||(a.c=[]);var c={a:t.author,t:t.t,r:t.r,T:r};t.h&&(c.h=t.h);for(var u=a.c.length-1;u>=0;--u){if(!r&&a.c[u].T)return;r&&!a.c[u].T&&a.c.splice(u,1)}if(r&&n)for(u=0;u<n.length;++u)if(c.a==n[u].id){c.a=n[u].name||c.a;break}a.c.push(c)}))}var vT=Ob;var yT=function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,t={r:0,c:0};function r(e,r,n,a){var i=!1,s=!1;0==n.length?s=!0:"["==n.charAt(0)&&(s=!0,n=n.slice(1,-1)),0==a.length?i=!0:"["==a.charAt(0)&&(i=!0,a=a.slice(1,-1));var o=n.length>0?0|parseInt(n,10):0,l=a.length>0?0|parseInt(a,10):0;return i?l+=t.c:--l,s?o+=t.r:--o,r+(i?"":"$")+wb(l)+(s?"":"$")+yb(o)}return function(n,a){return t=a,n.replace(e,r)}}(),bT=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,wT=function(){return function(e,t){return e.replace(bT,(function(e,r,n,a,i,s){var o=bb(a)-(n?0:t.c),l=vb(s)-(i?0:t.r);return r+"R"+(0==l?"":i?l+1:"["+l+"]")+"C"+(0==o?"":n?o+1:"["+o+"]")}))}}();function ET(e,t){return e.replace(bT,(function(e,r,n,a,i,s){return r+("$"==n?n+a:wb(bb(a)+t.c))+("$"==i?i+s:yb(vb(s)+t.r))}))}function TT(e,t,r){var n=_b(t).s,a=Eb(r);return ET(e,{r:a.r-n.r,c:a.c-n.c})}function _T(e){return e.replace(/_xlfn\./g,"")}function ST(e){e.l+=1}function kT(e,t){var r=e.read_shift(1==t?1:2);return[16383&r,r>>14&1,r>>15&1]}function CT(e,t,r){var n=2;if(r){if(r.biff>=2&&r.biff<=5)return IT(e);12==r.biff&&(n=4)}var a=e.read_shift(n),i=e.read_shift(n),s=kT(e,2),o=kT(e,2);return{s:{r:a,c:s[0],cRel:s[1],rRel:s[2]},e:{r:i,c:o[0],cRel:o[1],rRel:o[2]}}}function IT(e){var t=kT(e,2),r=kT(e,2),n=e.read_shift(1),a=e.read_shift(1);return{s:{r:t[0],c:n,cRel:t[1],rRel:t[2]},e:{r:r[0],c:a,cRel:r[1],rRel:r[2]}}}function AT(e,t,r){if(r&&r.biff>=2&&r.biff<=5)return function(e){var t=kT(e,2),r=e.read_shift(1);return{r:t[0],c:r,cRel:t[1],rRel:t[2]}}(e);var n=e.read_shift(r&&12==r.biff?4:2),a=kT(e,2);return{r:n,c:a[0],cRel:a[1],rRel:a[2]}}function RT(e){var t=e.read_shift(2),r=e.read_shift(2);return{r:t,c:255&r,fQuoted:!!(16384&r),cRel:r>>15,rRel:r>>15}}function NT(e){var t=1&e[e.l+1];return e.l+=4,[t,1]}function OT(e){return[e.read_shift(1),e.read_shift(1)]}function xT(e,t){var r=[e.read_shift(1)];if(12==t)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2}switch(r[0]){case 4:r[1]=Iw(e,1)?"TRUE":"FALSE",12!=t&&(e.l+=7);break;case 37:case 16:r[1]=ew[e[e.l]],e.l+=12==t?4:8;break;case 0:e.l+=8;break;case 1:r[1]=$b(e);break;case 2:r[1]=Dw(e,0,{biff:t>0&&t<8?2:t});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function PT(e,t,r){for(var n=e.read_shift(12==r.biff?4:2),a=[],i=0;i!=n;++i)a.push((12==r.biff?Hb:jw)(e,8));return a}function DT(e,t,r){var n=0,a=0;12==r.biff?(n=e.read_shift(4),a=e.read_shift(4)):(a=1+e.read_shift(1),n=1+e.read_shift(2)),r.biff>=2&&r.biff<8&&(--n,0==--a&&(a=256));for(var i=0,s=[];i!=n&&(s[i]=[]);++i)for(var o=0;o!=a;++o)s[i][o]=xT(e,r.biff);return s}function LT(e,t,r){return e.l+=2,[RT(e)]}function MT(e){return e.l+=6,[]}function FT(e){return e.l+=2,[Aw(e),1&e.read_shift(2)]}var UT=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];var VT={1:{n:"PtgExp",f:function(e,t,r){return e.l++,r&&12==r.biff?[e.read_shift(4,"i"),0]:[e.read_shift(2),e.read_shift(r&&2==r.biff?1:2)]}},2:{n:"PtgTbl",f:cb},3:{n:"PtgAdd",f:ST},4:{n:"PtgSub",f:ST},5:{n:"PtgMul",f:ST},6:{n:"PtgDiv",f:ST},7:{n:"PtgPower",f:ST},8:{n:"PtgConcat",f:ST},9:{n:"PtgLt",f:ST},10:{n:"PtgLe",f:ST},11:{n:"PtgEq",f:ST},12:{n:"PtgGe",f:ST},13:{n:"PtgGt",f:ST},14:{n:"PtgNe",f:ST},15:{n:"PtgIsect",f:ST},16:{n:"PtgUnion",f:ST},17:{n:"PtgRange",f:ST},18:{n:"PtgUplus",f:ST},19:{n:"PtgUminus",f:ST},20:{n:"PtgPercent",f:ST},21:{n:"PtgParen",f:ST},22:{n:"PtgMissArg",f:ST},23:{n:"PtgStr",f:function(e,t,r){return e.l++,Nw(e,0,r)}},26:{n:"PtgSheet",f:function(e,t,r){return e.l+=5,e.l+=2,e.l+=2==r.biff?1:4,["PTGSHEET"]}},27:{n:"PtgEndSheet",f:function(e,t,r){return e.l+=2==r.biff?4:5,["PTGENDSHEET"]}},28:{n:"PtgErr",f:function(e){return e.l++,ew[e.read_shift(1)]}},29:{n:"PtgBool",f:function(e){return e.l++,0!==e.read_shift(1)}},30:{n:"PtgInt",f:function(e){return e.l++,e.read_shift(2)}},31:{n:"PtgNum",f:function(e){return e.l++,$b(e)}},32:{n:"PtgArray",f:function(e,t,r){var n=(96&e[e.l++])>>5;return e.l+=2==r.biff?6:12==r.biff?14:7,[n]}},33:{n:"PtgFunc",f:function(e,t,r){var n=(96&e[e.l])>>5;e.l+=1;var a=e.read_shift(r&&r.biff<=3?1:2);return[s_[a],i_[a],n]}},34:{n:"PtgFuncVar",f:function(e,t,r){var n=e[e.l++],a=e.read_shift(1),i=r&&r.biff<=3?[88==n?-1:0,e.read_shift(1)]:function(e){return[e[e.l+1]>>7,32767&e.read_shift(2)]}(e);return[a,(0===i[0]?i_:a_)[i[1]]]}},35:{n:"PtgName",f:function(e,t,r){var n=e.read_shift(1)>>>5&3,a=!r||r.biff>=8?4:2,i=e.read_shift(a);switch(r.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12}return[n,0,i]}},36:{n:"PtgRef",f:function(e,t,r){var n=(96&e[e.l])>>5;return e.l+=1,[n,AT(e,0,r)]}},37:{n:"PtgArea",f:function(e,t,r){return[(96&e[e.l++])>>5,CT(e,r.biff>=2&&r.biff,r)]}},38:{n:"PtgMemArea",f:function(e,t,r){var n=e.read_shift(1)>>>5&3;return e.l+=r&&2==r.biff?3:4,[n,e.read_shift(r&&2==r.biff?1:2)]}},39:{n:"PtgMemErr",f:cb},40:{n:"PtgMemNoMem",f:cb},41:{n:"PtgMemFunc",f:function(e,t,r){return[e.read_shift(1)>>>5&3,e.read_shift(r&&2==r.biff?1:2)]}},42:{n:"PtgRefErr",f:function(e,t,r){var n=e.read_shift(1)>>>5&3;return e.l+=4,r.biff<8&&e.l--,12==r.biff&&(e.l+=2),[n]}},43:{n:"PtgAreaErr",f:function(e,t,r){var n=(96&e[e.l++])>>5;return e.l+=r&&r.biff>8?12:r.biff<8?6:8,[n]}},44:{n:"PtgRefN",f:function(e,t,r){var n=(96&e[e.l])>>5;e.l+=1;var a=function(e,t,r){var n=r&&r.biff?r.biff:8;if(n>=2&&n<=5)return function(e){var t=e.read_shift(2),r=e.read_shift(1),n=(32768&t)>>15,a=(16384&t)>>14;return t&=16383,1==n&&t>=8192&&(t-=16384),1==a&&r>=128&&(r-=256),{r:t,c:r,cRel:a,rRel:n}}(e);var a=e.read_shift(n>=12?4:2),i=e.read_shift(2),s=(16384&i)>>14,o=(32768&i)>>15;if(i&=16383,1==o)for(;a>524287;)a-=1048576;if(1==s)for(;i>8191;)i-=16384;return{r:a,c:i,cRel:s,rRel:o}}(e,0,r);return[n,a]}},45:{n:"PtgAreaN",f:function(e,t,r){var n=(96&e[e.l++])>>5,a=function(e,t,r){if(r.biff<8)return IT(e);var n=e.read_shift(12==r.biff?4:2),a=e.read_shift(12==r.biff?4:2),i=kT(e,2),s=kT(e,2);return{s:{r:n,c:i[0],cRel:i[1],rRel:i[2]},e:{r:a,c:s[0],cRel:s[1],rRel:s[2]}}}(e,0,r);return[n,a]}},46:{n:"PtgMemAreaN",f:function(e){return[e.read_shift(1)>>>5&3,e.read_shift(2)]}},47:{n:"PtgMemNoMemN",f:function(e){return[e.read_shift(1)>>>5&3,e.read_shift(2)]}},57:{n:"PtgNameX",f:function(e,t,r){return 5==r.biff?function(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2,"i");e.l+=8;var n=e.read_shift(2);return e.l+=12,[t,r,n]}(e):[e.read_shift(1)>>>5&3,e.read_shift(2),e.read_shift(4)]}},58:{n:"PtgRef3d",f:function(e,t,r){var n=(96&e[e.l])>>5;e.l+=1;var a=e.read_shift(2);return r&&5==r.biff&&(e.l+=12),[n,a,AT(e,0,r)]}},59:{n:"PtgArea3d",f:function(e,t,r){var n=(96&e[e.l++])>>5,a=e.read_shift(2,"i");if(r)switch(r.biff){case 5:e.l+=12;break;case 12:0}return[n,a,CT(e,0,r)]}},60:{n:"PtgRefErr3d",f:function(e,t,r){var n=(96&e[e.l++])>>5,a=e.read_shift(2),i=4;if(r)switch(r.biff){case 5:i=15;break;case 12:i=6}return e.l+=i,[n,a]}},61:{n:"PtgAreaErr3d",f:function(e,t,r){var n=(96&e[e.l++])>>5,a=e.read_shift(2),i=8;if(r)switch(r.biff){case 5:e.l+=12,i=6;break;case 12:i=12}return e.l+=i,[n,a]}},255:{}},BT={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},zT={1:{n:"PtgElfLel",f:FT},2:{n:"PtgElfRw",f:LT},3:{n:"PtgElfCol",f:LT},6:{n:"PtgElfRwV",f:LT},7:{n:"PtgElfColV",f:LT},10:{n:"PtgElfRadical",f:LT},11:{n:"PtgElfRadicalS",f:MT},13:{n:"PtgElfColS",f:MT},15:{n:"PtgElfColSV",f:MT},16:{n:"PtgElfRadicalLel",f:FT},25:{n:"PtgList",f:function(e){e.l+=2;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),a=e.read_shift(2),i=e.read_shift(2);return{ixti:t,coltype:3&r,rt:UT[r>>2&31],idx:n,c:a,C:i}}},29:{n:"PtgSxName",f:function(e){return e.l+=2,[e.read_shift(4)]}},255:{}},jT={0:{n:"PtgAttrNoop",f:function(e){return e.l+=4,[0,0]}},1:{n:"PtgAttrSemi",f:function(e,t,r){var n=255&e[e.l+1]?1:0;return e.l+=r&&2==r.biff?3:4,[n]}},2:{n:"PtgAttrIf",f:function(e,t,r){var n=255&e[e.l+1]?1:0;return e.l+=2,[n,e.read_shift(r&&2==r.biff?1:2)]}},4:{n:"PtgAttrChoose",f:function(e,t,r){e.l+=2;for(var n=e.read_shift(r&&2==r.biff?1:2),a=[],i=0;i<=n;++i)a.push(e.read_shift(r&&2==r.biff?1:2));return a}},8:{n:"PtgAttrGoto",f:function(e,t,r){var n=255&e[e.l+1]?1:0;return e.l+=2,[n,e.read_shift(r&&2==r.biff?1:2)]}},16:{n:"PtgAttrSum",f:function(e,t,r){e.l+=r&&2==r.biff?3:4}},32:{n:"PtgAttrBaxcel",f:NT},33:{n:"PtgAttrBaxcel",f:NT},64:{n:"PtgAttrSpace",f:function(e){return e.read_shift(2),OT(e)}},65:{n:"PtgAttrSpaceSemi",f:function(e){return e.read_shift(2),OT(e)}},128:{n:"PtgAttrIfError",f:function(e){var t=255&e[e.l+1]?1:0;return e.l+=2,[t,e.read_shift(2)]}},255:{}};function HT(e,t,r,n){if(n.biff<8)return cb(e,t);for(var a=e.l+t,i=[],s=0;s!==r.length;++s)switch(r[s][0]){case"PtgArray":r[s][1]=DT(e,0,n),i.push(r[s][1]);break;case"PtgMemArea":r[s][2]=PT(e,r[s][1],n),i.push(r[s][2]);break;case"PtgExp":n&&12==n.biff&&(r[s][1][1]=e.read_shift(4),i.push(r[s][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[s][0]}return 0!==(t=a-e.l)&&i.push(cb(e,t)),i}function $T(e,t,r){for(var n,a,i=e.l+t,s=[];i!=e.l;)t=i-e.l,a=e[e.l],n=VT[a]||VT[BT[a]],24!==a&&25!==a||(n=(24===a?zT:jT)[e[e.l+1]]),n&&n.f?s.push([n.n,n.f(e,t,r)]):cb(e,t);return s}function WT(e){for(var t=[],r=0;r<e.length;++r){for(var n=e[r],a=[],i=0;i<n.length;++i){var s=n[i];if(s)if(2===s[0])a.push('"'+s[1].replace(/"/g,'""')+'"');else a.push(s[1]);else a.push("")}t.push(a.join(","))}return t.join(";")}var GT={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function KT(e,t,r){if(!e)return"SH33TJSERR0";if(r.biff>8&&(!e.XTI||!e.XTI[t]))return e.SheetNames[t];if(!e.XTI)return"SH33TJSERR6";var n=e.XTI[t];if(r.biff<8)return t>1e4&&(t-=65536),t<0&&(t=-t),0==t?"":e.XTI[t-1];if(!n)return"SH33TJSERR1";var a="";if(r.biff>8)switch(e[n[0]][0]){case 357:return a=-1==n[1]?"#REF":e.SheetNames[n[1]],n[1]==n[2]?a:a+":"+e.SheetNames[n[2]];case 358:return null!=r.SID?e.SheetNames[r.SID]:"SH33TJSSAME"+e[n[0]][0];default:return"SH33TJSSRC"+e[n[0]][0]}switch(e[n[0]][0][0]){case 1025:return a=-1==n[1]?"#REF":e.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?a:a+":"+e.SheetNames[n[2]];case 14849:return e[n[0]].slice(1).map((function(e){return e.Name})).join(";;");default:return e[n[0]][0][3]?(a=-1==n[1]?"#REF":e[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?a:a+":"+e[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function qT(e,t,r){var n=KT(e,t,r);return"#REF"==n?n:function(e,t){if(!e&&!(t&&t.biff<=5&&t.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}(n,r)}function XT(e,t,r,n,a){var i,s,o,l,c=a&&a.biff||8,u={s:{c:0,r:0},e:{c:0,r:0}},h=[],f=0,d=0,p="";if(!e[0]||!e[0][0])return"";for(var m=-1,g="",v=0,y=e[0].length;v<y;++v){var b=e[0][v];switch(b[0]){case"PtgUminus":h.push("-"+h.pop());break;case"PtgUplus":h.push("+"+h.pop());break;case"PtgPercent":h.push(h.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(i=h.pop(),s=h.pop(),m>=0){switch(e[0][m][1][0]){case 0:g=Ov(" ",e[0][m][1][1]);break;case 1:g=Ov("\r",e[0][m][1][1]);break;default:if(g="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][m][1][0])}s+=g,m=-1}h.push(s+GT[b[0]]+i);break;case"PtgIsect":i=h.pop(),s=h.pop(),h.push(s+" "+i);break;case"PtgUnion":i=h.pop(),s=h.pop(),h.push(s+","+i);break;case"PtgRange":i=h.pop(),s=h.pop(),h.push(s+":"+i);break;case"PtgAttrChoose":case"PtgAttrGoto":case"PtgAttrIf":case"PtgAttrIfError":case"PtgAttrBaxcel":case"PtgAttrSemi":case"PtgMemArea":case"PtgTbl":case"PtgMemErr":case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":case"PtgMemFunc":case"PtgMemNoMem":break;case"PtgRef":o=db(b[1][1],u,a),h.push(mb(o,c));break;case"PtgRefN":o=r?db(b[1][1],r,a):b[1][1],h.push(mb(o,c));break;case"PtgRef3d":f=b[1][1],o=db(b[1][2],u,a);p=qT(n,f,a);h.push(p+"!"+mb(o,c));break;case"PtgFunc":case"PtgFuncVar":var w=b[1][0],E=b[1][1];w||(w=0);var T=0==(w&=127)?[]:h.slice(-w);h.length-=w,"User"===E&&(E=T.shift()),h.push(E+"("+T.join(",")+")");break;case"PtgBool":h.push(b[1]?"TRUE":"FALSE");break;case"PtgInt":case"PtgErr":h.push(b[1]);break;case"PtgNum":h.push(String(b[1]));break;case"PtgStr":h.push('"'+b[1].replace(/"/g,'""')+'"');break;case"PtgAreaN":l=pb(b[1][1],r?{s:r}:u,a),h.push(gb(l,a));break;case"PtgArea":l=pb(b[1][1],u,a),h.push(gb(l,a));break;case"PtgArea3d":f=b[1][1],l=b[1][2],p=qT(n,f,a),h.push(p+"!"+gb(l,a));break;case"PtgAttrSum":h.push("SUM("+h.pop()+")");break;case"PtgName":d=b[1][2];var _=(n.names||[])[d-1]||(n[0]||[])[d],S=_?_.Name:"SH33TJSNAME"+String(d);S&&"_xlfn."==S.slice(0,6)&&!a.xlfn&&(S=S.slice(6)),h.push(S);break;case"PtgNameX":var k,C=b[1][1];if(d=b[1][2],!(a.biff<=5)){var I="";if(14849==((n[C]||[])[0]||[])[0]||(1025==((n[C]||[])[0]||[])[0]?n[C][d]&&n[C][d].itab>0&&(I=n.SheetNames[n[C][d].itab-1]+"!"):I=n.SheetNames[d-1]+"!"),n[C]&&n[C][d])I+=n[C][d].Name;else if(n[0]&&n[0][d])I+=n[0][d].Name;else{var A=(KT(n,C,a)||"").split(";;");A[d-1]?I=A[d-1]:I+="SH33TJSERRX"}h.push(I);break}C<0&&(C=-C),n[C]&&(k=n[C][d]),k||(k={Name:"SH33TJSERRY"}),h.push(k.Name);break;case"PtgParen":var R="(",N=")";if(m>=0){switch(g="",e[0][m][1][0]){case 2:R=Ov(" ",e[0][m][1][1])+R;break;case 3:R=Ov("\r",e[0][m][1][1])+R;break;case 4:N=Ov(" ",e[0][m][1][1])+N;break;case 5:N=Ov("\r",e[0][m][1][1])+N;break;default:if(a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][m][1][0])}m=-1}h.push(R+h.pop()+N);break;case"PtgRefErr":case"PtgRefErr3d":case"PtgAreaErr":case"PtgAreaErr3d":h.push("#REF!");break;case"PtgExp":o={c:b[1][1],r:b[1][0]};var O={c:r.c,r:r.r};if(n.sharedf[Tb(o)]){var x=n.sharedf[Tb(o)];h.push(XT(x,u,O,n,a))}else{var P=!1;for(i=0;i!=n.arrayf.length;++i)if(s=n.arrayf[i],!(o.c<s[0].s.c||o.c>s[0].e.c)&&!(o.r<s[0].s.r||o.r>s[0].e.r)){h.push(XT(s[1],u,O,n,a)),P=!0;break}P||h.push(b[1])}break;case"PtgArray":h.push("{"+WT(b[1])+"}");break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":m=v;break;case"PtgMissArg":h.push("");break;case"PtgList":h.push("Table"+b[1].idx+"[#"+b[1].rt+"]");break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");default:throw new Error("Unrecognized Formula Token: "+String(b))}if(3!=a.biff&&m>=0&&-1==["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"].indexOf(e[0][v][0])){var D=!0;switch((b=e[0][m])[1][0]){case 4:D=!1;case 0:g=Ov(" ",b[1][1]);break;case 5:D=!1;case 1:g=Ov("\r",b[1][1]);break;default:if(g="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+b[1][0])}h.push((D?g:"")+h.pop()+(D?"":g)),m=-1}}if(h.length>1&&a.WTF)throw new Error("bad formula stack");return h[0]}function YT(e,t,r){var n,a=e.l+t,i=2==r.biff?1:2,s=e.read_shift(i);if(65535==s)return[[],cb(e,t-2)];var o=$T(e,s,r);return t!==s+i&&(n=HT(e,t-s-i,o,r)),e.l=a,[o,n]}function QT(e,t,r){var n,a=e.l+t,i=e.read_shift(2),s=$T(e,i,r);return 65535==i?[[],cb(e,t-2)]:(t!==i+2&&(n=HT(e,a-i-2,s,r)),[s,n])}function JT(e,t,r){var n=e.l+t,a=Vw(e);2==r.biff&&++e.l;var i=function(e){var t;if(65535!==Qy(e,e.l+6))return[$b(e),"n"];switch(e[e.l]){case 0:return e.l+=8,["String","s"];case 1:return t=1===e[e.l+2],e.l+=8,[t,"b"];case 2:return t=e[e.l+2],e.l+=8,[t,"e"];case 3:return e.l+=8,["","s"]}return[]}(e),s=e.read_shift(1);2!=r.biff&&(e.read_shift(1),r.biff>=5&&e.read_shift(4));var o=function(e,t,r){var n,a=e.l+t,i=2==r.biff?1:2,s=e.read_shift(i);if(65535==s)return[[],cb(e,t-2)];var o=$T(e,s,r);return t!==s+i&&(n=HT(e,t-s-i,o,r)),e.l=a,[o,n]}(e,n-e.l,r);return{cell:a,val:i[0],formula:o,shared:s>>3&1,tt:i[1]}}function ZT(e,t,r){var n=e.read_shift(4),a=$T(e,n,r),i=e.read_shift(4);return[a,i>0?HT(e,i,a,r):null]}var e_=ZT,t_=ZT,r_=ZT,n_=ZT,a_={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},i_={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},s_={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function o_(e){return"of:"==e.slice(0,3)&&(e=e.slice(3)),61==e.charCodeAt(0)&&61==(e=e.slice(1)).charCodeAt(0)&&(e=e.slice(1)),(e=(e=(e=e.replace(/COM\.MICROSOFT\./g,"")).replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,(function(e,t){return t.replace(/\./g,"")}))).replace(/\[.(#[A-Z]*[?!])\]/g,"$1")).replace(/[;~]/g,",").replace(/\|/g,";")}function l_(e){var t=e.split(":");return[t[0].split(".")[0],t[0].split(".")[1]+(t.length>1?":"+(t[1].split(".")[1]||t[1].split(".")[0]):"")]}var c_={},u_={};function h_(e,t){if(e){var r=[.7,.7,.75,.75,.3,.3];"xlml"==t&&(r=[1,1,1,1,.5,.5]),null==e.left&&(e.left=r[0]),null==e.right&&(e.right=r[1]),null==e.top&&(e.top=r[2]),null==e.bottom&&(e.bottom=r[3]),null==e.header&&(e.header=r[4]),null==e.footer&&(e.footer=r[5])}}function f_(e,t,r,n,a,i){try{n.cellNF&&(e.z=Ng[t])}catch(Ok){if(n.WTF)throw Ok}if("z"!==e.t||n.cellStyles){if("d"===e.t&&"string"===typeof e.v&&(e.v=Av(e.v)),(!n||!1!==n.cellText)&&"z"!==e.t)try{if(null==Ng[t]&&cv(hv[t]||"General",t),"e"===e.t)e.w=e.w||ew[e.v];else if(0===t)if("n"===e.t)(0|e.v)===e.v?e.w=e.v.toString(10):e.w=Bg(e.v);else if("d"===e.t){var s=bv(e.v);e.w=(0|s)===s?s.toString(10):Bg(s)}else{if(void 0===e.v)return"";e.w=zg(e.v,u_)}else"d"===e.t?e.w=lv(t,bv(e.v),u_):e.w=lv(t,e.v,u_)}catch(Ok){if(n.WTF)throw Ok}if(n.cellStyles&&null!=r)try{e.s=i.Fills[r],e.s.fgColor&&e.s.fgColor.theme&&!e.s.fgColor.rgb&&(e.s.fgColor.rgb=zE(a.themeElements.clrScheme[e.s.fgColor.theme].rgb,e.s.fgColor.tint||0),n.WTF&&(e.s.fgColor.raw_rgb=a.themeElements.clrScheme[e.s.fgColor.theme].rgb)),e.s.bgColor&&e.s.bgColor.theme&&(e.s.bgColor.rgb=zE(a.themeElements.clrScheme[e.s.bgColor.theme].rgb,e.s.bgColor.tint||0),n.WTF&&(e.s.bgColor.raw_rgb=a.themeElements.clrScheme[e.s.bgColor.theme].rgb))}catch(Ok){if(n.WTF&&i.Fills)throw Ok}}}var d_=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,p_=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,m_=/<(?:\w:)?hyperlink [^>]*>/gm,g_=/"(\w*:\w*)"/,v_=/<(?:\w:)?col\b[^>]*[\/]?>/g,y_=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,b_=/<(?:\w:)?pageMargins[^>]*\/>/g,w_=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,E_=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,T_=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function __(e,t,r,n,a,i,s){if(!e)return e;n||(n={"!id":{}});var o=t.dense?[]:{},l={s:{r:2e6,c:2e6},e:{r:0,c:0}},c="",u="",h=e.match(p_);h?(c=e.slice(0,h.index),u=e.slice(h.index+h[0].length)):c=u=e;var f=c.match(w_);f?S_(f[0],o,a,r):(f=c.match(E_))&&function(e,t,r,n,a){S_(e.slice(0,e.indexOf(">")),r,n,a)}(f[0],f[1],o,a,r);var d=(c.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(d>0){var p=c.slice(d,d+50).match(g_);p&&function(e,t){var r=kb(t);r.s.r<=r.e.r&&r.s.c<=r.e.c&&r.s.r>=0&&r.s.c>=0&&(e["!ref"]=Sb(r))}(o,p[1])}var m=c.match(T_);m&&m[1]&&function(e,t){t.Views||(t.Views=[{}]);(e.match(k_)||[]).forEach((function(e,r){var n=Zv(e);t.Views[r]||(t.Views[r]={}),+n.zoomScale&&(t.Views[r].zoom=+n.zoomScale),ly(n.rightToLeft)&&(t.Views[r].RTL=!0)}))}(m[1],a);var g=[];if(t.cellStyles){var v=c.match(v_);v&&function(e,t){for(var r=!1,n=0;n!=t.length;++n){var a=Zv(t[n],!0);a.hidden&&(a.hidden=ly(a.hidden));var i=parseInt(a.min,10)-1,s=parseInt(a.max,10)-1;for(a.outlineLevel&&(a.level=+a.outlineLevel||0),delete a.min,delete a.max,a.width=+a.width,!r&&a.width&&(r=!0,KE(a.width)),qE(a);i<=s;)e[i++]=Nv(a)}}(g,v)}h&&C_(h[1],o,t,l,i,s);var y=u.match(y_);y&&(o["!autofilter"]=function(e){var t={ref:(e.match(/ref="([^"]*)"/)||[])[1]};return t}(y[0]));var b=[],w=u.match(d_);if(w)for(d=0;d!=w.length;++d)b[d]=kb(w[d].slice(w[d].indexOf('"')+1));var E=u.match(m_);E&&function(e,t,r){for(var n=Array.isArray(e),a=0;a!=t.length;++a){var i=Zv(dy(t[a]),!0);if(!i.ref)return;var s=((r||{})["!id"]||[])[i.id];s?(i.Target=s.Target,i.location&&(i.Target+="#"+ny(i.location))):(i.Target="#"+ny(i.location),s={Target:i.Target,TargetMode:"Internal"}),i.Rel=s,i.tooltip&&(i.Tooltip=i.tooltip,delete i.tooltip);for(var o=kb(i.ref),l=o.s.r;l<=o.e.r;++l)for(var c=o.s.c;c<=o.e.c;++c){var u=Tb({c:c,r:l});n?(e[l]||(e[l]=[]),e[l][c]||(e[l][c]={t:"z",v:void 0}),e[l][c].l=i):(e[u]||(e[u]={t:"z",v:void 0}),e[u].l=i)}}}(o,E,n);var T=u.match(b_);if(T&&(o["!margins"]=function(e){var t={};return["left","right","top","bottom","header","footer"].forEach((function(r){e[r]&&(t[r]=parseFloat(e[r]))})),t}(Zv(T[0]))),!o["!ref"]&&l.e.c>=l.s.c&&l.e.r>=l.s.r&&(o["!ref"]=Sb(l)),t.sheetRows>0&&o["!ref"]){var _=kb(o["!ref"]);t.sheetRows<=+_.e.r&&(_.e.r=t.sheetRows-1,_.e.r>l.e.r&&(_.e.r=l.e.r),_.e.r<_.s.r&&(_.s.r=_.e.r),_.e.c>l.e.c&&(_.e.c=l.e.c),_.e.c<_.s.c&&(_.s.c=_.e.c),o["!fullref"]=o["!ref"],o["!ref"]=Sb(_))}return g.length>0&&(o["!cols"]=g),b.length>0&&(o["!merges"]=b),o}function S_(e,t,r,n){var a=Zv(e);r.Sheets[n]||(r.Sheets[n]={}),a.codeName&&(r.Sheets[n].CodeName=ny(dy(a.codeName)))}var k_=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;var C_=function(){var e=/<(?:\w+:)?c[ \/>]/,t=/<\/(?:\w+:)?row>/,r=/r=["']([^"']*)["']/,n=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,a=/ref=["']([^"']*)["']/,i=my("v"),s=my("f");return function(o,l,c,u,h,f){for(var d,p,m,g,v,y=0,b="",w=[],E=[],T=0,_=0,S=0,k="",C=0,I=0,A=0,R=0,N=Array.isArray(f.CellXf),O=[],x=[],P=Array.isArray(l),D=[],L={},M=!1,F=!!c.sheetStubs,U=o.split(t),V=0,B=U.length;V!=B;++V){var z=(b=U[V].trim()).length;if(0!==z){var j=0;e:for(y=0;y<z;++y)switch(b[y]){case">":if("/"!=b[y-1]){++y;break e}if(c&&c.cellStyles){if(C=null!=(p=Zv(b.slice(j,y),!0)).r?parseInt(p.r,10):C+1,I=-1,c.sheetRows&&c.sheetRows<C)continue;L={},M=!1,p.ht&&(M=!0,L.hpt=parseFloat(p.ht),L.hpx=QE(L.hpt)),"1"==p.hidden&&(M=!0,L.hidden=!0),null!=p.outlineLevel&&(M=!0,L.level=+p.outlineLevel),M&&(D[C-1]=L)}break;case"<":j=y}if(j>=y)break;if(C=null!=(p=Zv(b.slice(j,y),!0)).r?parseInt(p.r,10):C+1,I=-1,!(c.sheetRows&&c.sheetRows<C)){u.s.r>C-1&&(u.s.r=C-1),u.e.r<C-1&&(u.e.r=C-1),c&&c.cellStyles&&(L={},M=!1,p.ht&&(M=!0,L.hpt=parseFloat(p.ht),L.hpx=QE(L.hpt)),"1"==p.hidden&&(M=!0,L.hidden=!0),null!=p.outlineLevel&&(M=!0,L.level=+p.outlineLevel),M&&(D[C-1]=L)),w=b.slice(y).split(e);for(var H=0;H!=w.length&&"<"==w[H].trim().charAt(0);++H);for(w=w.slice(H),y=0;y!=w.length;++y)if(0!==(b=w[y].trim()).length){if(E=b.match(r),T=y,_=0,S=0,b="<c "+("<"==b.slice(0,1)?">":"")+b,null!=E&&2===E.length){for(T=0,k=E[1],_=0;_!=k.length&&!((S=k.charCodeAt(_)-64)<1||S>26);++_)T=26*T+S;I=--T}else++I;for(_=0;_!=b.length&&62!==b.charCodeAt(_);++_);if(++_,(p=Zv(b.slice(0,_),!0)).r||(p.r=Tb({r:C-1,c:I})),d={t:""},null!=(E=(k=b.slice(_)).match(i))&&""!==E[1]&&(d.v=ny(E[1])),c.cellFormula){if(null!=(E=k.match(s))&&""!==E[1]){if(d.f=ny(dy(E[1])).replace(/\r\n/g,"\n"),c.xlfn||(d.f=_T(d.f)),E[0].indexOf('t="array"')>-1)d.F=(k.match(a)||[])[1],d.F.indexOf(":")>-1&&O.push([kb(d.F),d.F]);else if(E[0].indexOf('t="shared"')>-1){g=Zv(E[0]);var $=ny(dy(E[1]));c.xlfn||($=_T($)),x[parseInt(g.si,10)]=[g,$,p.r]}}else(E=k.match(/<f[^>]*\/>/))&&x[(g=Zv(E[0])).si]&&(d.f=TT(x[g.si][1],x[g.si][2],p.r));var W=Eb(p.r);for(_=0;_<O.length;++_)W.r>=O[_][0].s.r&&W.r<=O[_][0].e.r&&W.c>=O[_][0].s.c&&W.c<=O[_][0].e.c&&(d.F=O[_][1])}if(null==p.t&&void 0===d.v)if(d.f||d.F)d.v=0,d.t="n";else{if(!F)continue;d.t="z"}else d.t=p.t||"n";switch(u.s.c>I&&(u.s.c=I),u.e.c<I&&(u.e.c=I),d.t){case"n":if(""==d.v||null==d.v){if(!F)continue;d.t="z"}else d.v=parseFloat(d.v);break;case"s":if("undefined"==typeof d.v){if(!F)continue;d.t="z"}else m=c_[parseInt(d.v,10)],d.v=m.t,d.r=m.r,c.cellHTML&&(d.h=m.h);break;case"str":d.t="s",d.v=null!=d.v?dy(d.v):"",c.cellHTML&&(d.h=sy(d.v));break;case"inlineStr":E=k.match(n),d.t="s",null!=E&&(m=TE(E[1]))?(d.v=m.t,c.cellHTML&&(d.h=m.h)):d.v="";break;case"b":d.v=ly(d.v);break;case"d":c.cellDates?d.v=Av(d.v,1):(d.v=bv(Av(d.v,1)),d.t="n");break;case"e":c&&!1===c.cellText||(d.w=d.v),d.v=tw[d.v]}if(A=R=0,v=null,N&&void 0!==p.s&&null!=(v=f.CellXf[p.s])&&(null!=v.numFmtId&&(A=v.numFmtId),c.cellStyles&&null!=v.fillId&&(R=v.fillId)),f_(d,A,R,c,h,f),c.cellDates&&N&&"n"==d.t&&av(Ng[A])&&(d.t="d",d.v=_v(d.v)),p.cm&&c.xlmeta){var G=(c.xlmeta.Cell||[])[+p.cm-1];G&&"XLDAPR"==G.type&&(d.D=!0)}if(P){var K=Eb(p.r);l[K.r]||(l[K.r]=[]),l[K.r][K.c]=d}else l[p.r]=d}}}}D.length>0&&(l["!rows"]=D)}}();var I_=Hb;function A_(e){return[Mb(e),$b(e),"n"]}var R_=Hb;var N_=["left","right","top","bottom","header","footer"];function O_(e,t,r,n,a,i){var s=i||{"!type":"chart"};if(!e)return i;var o=0,l=0,c="A",u={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(e.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach((function(e){var t=function(e){var t,r=[],n=e.match(/^<c:numCache>/);(e.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/gm)||[]).forEach((function(e){var t=e.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);t&&(r[+t[1]]=n?+t[2]:t[2])}));var a=ny((e.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(e.match(/<c:f>(.*?)<\/c:f>/gm)||[]).forEach((function(e){t=e.replace(/<.*?>/g,"")})),[r,a,t]}(e);u.s.r=u.s.c=0,u.e.c=o,c=wb(o),t[0].forEach((function(e,r){s[c+yb(r)]={t:"n",v:e,z:t[1]},l=r})),u.e.r<l&&(u.e.r=l),++o})),o>0&&(s["!ref"]=Sb(u)),s}var x_=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],P_=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],D_=[],L_=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function M_(e,t){for(var r=0;r!=e.length;++r)for(var n=e[r],a=0;a!=t.length;++a){var i=t[a];if(null==n[i[0]])n[i[0]]=i[1];else switch(i[2]){case"bool":"string"==typeof n[i[0]]&&(n[i[0]]=ly(n[i[0]]));break;case"int":"string"==typeof n[i[0]]&&(n[i[0]]=parseInt(n[i[0]],10))}}}function F_(e,t){for(var r=0;r!=t.length;++r){var n=t[r];if(null==e[n[0]])e[n[0]]=n[1];else switch(n[2]){case"bool":"string"==typeof e[n[0]]&&(e[n[0]]=ly(e[n[0]]));break;case"int":"string"==typeof e[n[0]]&&(e[n[0]]=parseInt(e[n[0]],10))}}}function U_(e){F_(e.WBProps,x_),F_(e.CalcPr,L_),M_(e.WBView,P_),M_(e.Sheets,D_),u_.date1904=ly(e.WBProps.date1904)}var V_="][*?/\\".split("");function B_(e,t){if(e.length>31){if(t)return!1;throw new Error("Sheet names cannot exceed 31 chars")}var r=!0;return V_.forEach((function(n){if(-1!=e.indexOf(n)){if(!t)throw new Error("Sheet name cannot contain : \\ / ? * [ ]");r=!1}})),r}var z_=/<\w+:workbook/;function j_(e,t){var r={};return e.read_shift(4),r.ArchID=e.read_shift(4),e.l+=t-8,r}function H_(e,t,r){return".bin"===t.slice(-4)?function(e,t){var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},n=[],a=!1;t||(t={}),t.biff=12;var i=[],s=[[]];return s.SheetNames=[],s.XTI=[],bS[16]={n:"BrtFRTArchID$",f:j_},hb(e,(function(e,o,l){switch(l){case 156:s.SheetNames.push(e.name),r.Sheets.push(e);break;case 153:r.WBProps=e;break;case 39:null!=e.Sheet&&(t.SID=e.Sheet),e.Ref=XT(e.Ptg,0,null,s,t),delete t.SID,delete e.Ptg,i.push(e);break;case 1036:case 361:case 2071:case 158:case 143:case 664:case 353:case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:case 16:break;case 357:case 358:case 355:case 667:s[0].length?s.push([l,e]):s[0]=[l,e],s[s.length-1].XTI=[];break;case 362:0===s.length&&(s[0]=[],s[0].XTI=[]),s[s.length-1].XTI=s[s.length-1].XTI.concat(e),s.XTI=s.XTI.concat(e);break;case 35:case 37:n.push(l),a=!0;break;case 36:case 38:n.pop(),a=!1;break;default:if(o.T);else if(!a||t.WTF&&37!=n[n.length-1]&&35!=n[n.length-1])throw new Error("Unexpected record 0x"+l.toString(16))}}),t),U_(r),r.Names=i,r.supbooks=s,r}(e,r):function(e,t){if(!e)throw new Error("Could not find file");var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},n=!1,a="xmlns",i={},s=0;if(e.replace(Yv,(function(o,l){var c=Zv(o);switch(ey(c[0])){case"<?xml":case"</workbook>":case"<fileVersion/>":case"</fileVersion>":case"<fileSharing":case"<fileSharing/>":case"</workbookPr>":case"<workbookProtection":case"<workbookProtection/>":case"<bookViews":case"<bookViews>":case"</bookViews>":case"</workbookView>":case"<sheets":case"<sheets>":case"</sheets>":case"</sheet>":case"<functionGroups":case"<functionGroups/>":case"<functionGroup":case"<externalReferences":case"</externalReferences>":case"<externalReferences>":case"<externalReference":case"<definedNames/>":case"<definedName/>":case"</calcPr>":case"<oleSize":case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":case"<customWorkbookView":case"</customWorkbookView>":case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":case"<pivotCache":case"<smartTagPr":case"<smartTagPr/>":case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":case"<smartTagType":case"<webPublishing":case"<webPublishing/>":case"<fileRecoveryPr":case"<fileRecoveryPr/>":case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":case"<webPublishObject":case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":case"<ArchID":case"<revisionPtr":break;case"<workbook":o.match(z_)&&(a="xmlns"+o.match(/<(\w+):/)[1]),r.xmlns=c[a];break;case"<fileVersion":delete c[0],r.AppVersion=c;break;case"<workbookPr":case"<workbookPr/>":x_.forEach((function(e){if(null!=c[e[0]])switch(e[2]){case"bool":r.WBProps[e[0]]=ly(c[e[0]]);break;case"int":r.WBProps[e[0]]=parseInt(c[e[0]],10);break;default:r.WBProps[e[0]]=c[e[0]]}})),c.codeName&&(r.WBProps.CodeName=dy(c.codeName));break;case"<workbookView":case"<workbookView/>":delete c[0],r.WBView.push(c);break;case"<sheet":switch(c.state){case"hidden":c.Hidden=1;break;case"veryHidden":c.Hidden=2;break;default:c.Hidden=0}delete c.state,c.name=ny(dy(c.name)),delete c[0],r.Sheets.push(c);break;case"<definedNames>":case"<definedNames":case"<ext":case"<AlternateContent":case"<AlternateContent>":n=!0;break;case"</definedNames>":case"</ext>":case"</AlternateContent>":n=!1;break;case"<definedName":(i={}).Name=dy(c.name),c.comment&&(i.Comment=c.comment),c.localSheetId&&(i.Sheet=+c.localSheetId),ly(c.hidden||"0")&&(i.Hidden=!0),s=l+o.length;break;case"</definedName>":i.Ref=ny(dy(e.slice(s,l))),r.Names.push(i);break;case"<calcPr":case"<calcPr/>":delete c[0],r.CalcPr=c;break;default:if(!n&&t.WTF)throw new Error("unrecognized "+c[0]+" in workbook")}return o})),-1===Iy.indexOf(r.xmlns))throw new Error("Unknown Namespace: "+r.xmlns);return U_(r),r}(e,r)}function $_(e,t,r,n,a,i,s,o){return".bin"===t.slice(-4)?function(e,t,r,n,a,i,s){if(!e)return e;var o=t||{};n||(n={"!id":{}});var l,c,u,h,f,d,p,m,g,v,y=o.dense?[]:{},b={s:{r:2e6,c:2e6},e:{r:0,c:0}},w=[],E=!1,T=!1,_=[];o.biff=12,o["!row"]=0;var S=0,k=!1,C=[],I={},A=o.supbooks||a.supbooks||[[]];if(A.sharedf=I,A.arrayf=C,A.SheetNames=a.SheetNames||a.Sheets.map((function(e){return e.name})),!o.supbooks&&(o.supbooks=A,a.Names))for(var R=0;R<a.Names.length;++R)A[0][R+1]=a.Names[R];var N,O,x=[],P=[],D=!1;if(bS[16]={n:"BrtShortReal",f:A_},hb(e,(function(e,t,R){if(!T)switch(R){case 148:l=e;break;case 0:c=e,o.sheetRows&&o.sheetRows<=c.r&&(T=!0),g=yb(f=c.r),o["!row"]=c.r,(e.hidden||e.hpt||null!=e.level)&&(e.hpt&&(e.hpx=QE(e.hpt)),P[e.r]=e);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(u={t:e[2]},e[2]){case"n":u.v=e[1];break;case"s":m=c_[e[1]],u.v=m.t,u.r=m.r;break;case"b":u.v=!!e[1];break;case"e":u.v=e[1],!1!==o.cellText&&(u.w=ew[u.v]);break;case"str":u.t="s",u.v=e[1];break;case"is":u.t="s",u.v=e[1].t}if((h=s.CellXf[e[0].iStyleRef])&&f_(u,h.numFmtId,null,o,i,s),d=-1==e[0].c?d+1:e[0].c,o.dense?(y[f]||(y[f]=[]),y[f][d]=u):y[wb(d)+g]=u,o.cellFormula){for(k=!1,S=0;S<C.length;++S){var L=C[S];c.r>=L[0].s.r&&c.r<=L[0].e.r&&d>=L[0].s.c&&d<=L[0].e.c&&(u.F=Sb(L[0]),k=!0)}!k&&e.length>3&&(u.f=e[3])}if(b.s.r>c.r&&(b.s.r=c.r),b.s.c>d&&(b.s.c=d),b.e.r<c.r&&(b.e.r=c.r),b.e.c<d&&(b.e.c=d),o.cellDates&&h&&"n"==u.t&&av(Ng[h.numFmtId])){var M=Dg(u.v);M&&(u.t="d",u.v=new Date(M.y,M.m-1,M.d,M.H,M.M,M.S,M.u))}N&&("XLDAPR"==N.type&&(u.D=!0),N=void 0),O&&(O=void 0);break;case 1:case 12:if(!o.sheetStubs||E)break;u={t:"z",v:void 0},d=-1==e[0].c?d+1:e[0].c,o.dense?(y[f]||(y[f]=[]),y[f][d]=u):y[wb(d)+g]=u,b.s.r>c.r&&(b.s.r=c.r),b.s.c>d&&(b.s.c=d),b.e.r<c.r&&(b.e.r=c.r),b.e.c<d&&(b.e.c=d),N&&("XLDAPR"==N.type&&(u.D=!0),N=void 0),O&&(O=void 0);break;case 176:_.push(e);break;case 49:N=((o.xlmeta||{}).Cell||[])[e-1];break;case 494:var F=n["!id"][e.relId];for(F?(e.Target=F.Target,e.loc&&(e.Target+="#"+e.loc),e.Rel=F):""==e.relId&&(e.Target="#"+e.loc),f=e.rfx.s.r;f<=e.rfx.e.r;++f)for(d=e.rfx.s.c;d<=e.rfx.e.c;++d)o.dense?(y[f]||(y[f]=[]),y[f][d]||(y[f][d]={t:"z",v:void 0}),y[f][d].l=e):(p=Tb({c:d,r:f}),y[p]||(y[p]={t:"z",v:void 0}),y[p].l=e);break;case 426:if(!o.cellFormula)break;C.push(e),(v=o.dense?y[f][d]:y[wb(d)+g]).f=XT(e[1],0,{r:c.r,c:d},A,o),v.F=Sb(e[0]);break;case 427:if(!o.cellFormula)break;I[Tb(e[0].s)]=e[1],(v=o.dense?y[f][d]:y[wb(d)+g]).f=XT(e[1],0,{r:c.r,c:d},A,o);break;case 60:if(!o.cellStyles)break;for(;e.e>=e.s;)x[e.e--]={width:e.w/256,hidden:!!(1&e.flags),level:e.level},D||(D=!0,KE(e.w/256)),qE(x[e.e+1]);break;case 161:y["!autofilter"]={ref:Sb(e)};break;case 476:y["!margins"]=e;break;case 147:a.Sheets[r]||(a.Sheets[r]={}),e.name&&(a.Sheets[r].CodeName=e.name),(e.above||e.left)&&(y["!outline"]={above:e.above,left:e.left});break;case 137:a.Views||(a.Views=[{}]),a.Views[0]||(a.Views[0]={}),e.RTL&&(a.Views[0].RTL=!0);break;case 485:case 64:case 1053:case 151:case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:E=!0;break;case 36:E=!1;break;case 37:w.push(R),E=!0;break;case 38:w.pop(),E=!1;break;default:if(t.T);else if(!E||o.WTF)throw new Error("Unexpected record 0x"+R.toString(16))}}),o),delete o.supbooks,delete o["!row"],!y["!ref"]&&(b.s.r<2e6||l&&(l.e.r>0||l.e.c>0||l.s.r>0||l.s.c>0))&&(y["!ref"]=Sb(l||b)),o.sheetRows&&y["!ref"]){var L=kb(y["!ref"]);o.sheetRows<=+L.e.r&&(L.e.r=o.sheetRows-1,L.e.r>b.e.r&&(L.e.r=b.e.r),L.e.r<L.s.r&&(L.s.r=L.e.r),L.e.c>b.e.c&&(L.e.c=b.e.c),L.e.c<L.s.c&&(L.s.c=L.e.c),y["!fullref"]=y["!ref"],y["!ref"]=Sb(L))}return _.length>0&&(y["!merges"]=_),x.length>0&&(y["!cols"]=x),P.length>0&&(y["!rows"]=P),y}(e,n,r,a,i,s,o):__(e,n,r,a,i,s,o)}function W_(e,t,r,n,a,i,s,o){return".bin"===t.slice(-4)?function(e,t,r,n,a){if(!e)return e;n||(n={"!id":{}});var i={"!type":"chart","!drawel":null,"!rel":""},s=[],o=!1;return hb(e,(function(e,n,l){switch(l){case 550:i["!rel"]=e;break;case 651:a.Sheets[r]||(a.Sheets[r]={}),e.name&&(a.Sheets[r].CodeName=e.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:o=!0;break;case 36:o=!1;break;case 37:s.push(l);break;case 38:s.pop();break;default:if(n.T>0)s.push(l);else if(n.T<0)s.pop();else if(!o||t.WTF)throw new Error("Unexpected record 0x"+l.toString(16))}}),t),n["!id"][i["!rel"]]&&(i["!drawel"]=n["!id"][i["!rel"]]),i}(e,n,r,a,i):function(e,t,r,n,a){if(!e)return e;n||(n={"!id":{}});var i,s={"!type":"chart","!drawel":null,"!rel":""},o=e.match(w_);return o&&S_(o[0],0,a,r),(i=e.match(/drawing r:id="(.*?)"/))&&(s["!rel"]=i[1]),n["!id"][s["!rel"]]&&(s["!drawel"]=n["!id"][s["!rel"]]),s}(e,0,r,a,i)}function G_(e,t,r,n){return".bin"===t.slice(-4)?function(e,t,r){var n={NumberFmt:[]};for(var a in Ng)n.NumberFmt[a]=Ng[a];n.CellXf=[],n.Fonts=[];var i=[],s=!1;return hb(e,(function(e,a,o){switch(o){case 44:n.NumberFmt[e[0]]=e[1],cv(e[1],e[0]);break;case 43:n.Fonts.push(e),null!=e.color.theme&&t&&t.themeElements&&t.themeElements.clrScheme&&(e.color.rgb=zE(t.themeElements.clrScheme[e.color.theme].rgb,e.color.tint||0));break;case 1025:case 45:case 46:case 48:case 507:case 572:case 475:case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 47:617==i[i.length-1]&&n.CellXf.push(e);break;case 35:s=!0;break;case 36:s=!1;break;case 37:i.push(o),s=!0;break;case 38:i.pop(),s=!1;break;default:if(a.T>0)i.push(o);else if(a.T<0)i.pop();else if(!s||r.WTF&&37!=i[i.length-1])throw new Error("Unexpected record 0x"+o.toString(16))}})),n}(e,r,n):tT(e,r,n)}function K_(e,t,r){return".bin"===t.slice(-4)?function(e,t){var r=[],n=!1;return hb(e,(function(e,a,i){switch(i){case 159:r.Count=e[0],r.Unique=e[1];break;case 19:r.push(e);break;case 160:return!0;case 35:n=!0;break;case 36:n=!1;break;default:if(a.T,!n||t.WTF)throw new Error("Unexpected record 0x"+i.toString(16))}})),r}(e,r):function(e,t){var r=[],n="";if(!e)return r;var a=e.match(_E);if(a){n=a[2].replace(SE,"").split(kE);for(var i=0;i!=n.length;++i){var s=TE(n[i].trim(),t);null!=s&&(r[r.length]=s)}a=Zv(a[1]),r.Count=a.count,r.Unique=a.uniqueCount}return r}(e,r)}function q_(e,t,r){return".bin"===t.slice(-4)?function(e,t){var r=[],n=[],a={},i=!1;return hb(e,(function(e,s,o){switch(o){case 632:n.push(e);break;case 635:a=e;break;case 637:a.t=e.t,a.h=e.h,a.r=e.r;break;case 636:if(a.author=n[a.iauthor],delete a.iauthor,t.sheetRows&&a.rfx&&t.sheetRows<=a.rfx.r)break;a.t||(a.t=""),delete a.rfx,r.push(a);break;case 3072:case 37:case 38:break;case 35:i=!0;break;case 36:i=!1;break;default:if(s.T);else if(!i||t.WTF)throw new Error("Unexpected record 0x"+o.toString(16))}})),r}(e,r):function(e,t){if(e.match(/<(?:\w+:)?comments *\/>/))return[];var r=[],n=[],a=e.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);a&&a[1]&&a[1].split(/<\/\w*:?author>/).forEach((function(e){if(""!==e&&""!==e.trim()){var t=e.match(/<(?:\w+:)?author[^>]*>(.*)/);t&&r.push(t[1])}}));var i=e.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return i&&i[1]&&i[1].split(/<\/\w*:?comment>/).forEach((function(e){if(""!==e&&""!==e.trim()){var a=e.match(/<(?:\w+:)?comment[^>]*>/);if(a){var i=Zv(a[0]),s={author:i.authorId&&r[i.authorId]||"sheetjsghost",ref:i.ref,guid:i.guid},o=Eb(i.ref);if(!(t.sheetRows&&t.sheetRows<=o.r)){var l=e.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),c=!!l&&!!l[1]&&TE(l[1])||{r:"",t:"",h:""};s.r=c.r,"<t></t>"==c.r&&(c.t=c.h=""),s.t=(c.t||"").replace(/\r\n/g,"\n").replace(/\r/g,"\n"),t.cellHTML&&(s.h=c.h),n.push(s)}}}})),n}(e,r)}function X_(e,t,r){return".bin"===t.slice(-4)?function(e){var t=[];return hb(e,(function(e,r,n){if(63===n)t.push(e);else if(!r.T)throw new Error("Unexpected record 0x"+n.toString(16))})),t}(e):function(e){var t=[];if(!e)return t;var r=1;return(e.match(Yv)||[]).forEach((function(e){var n=Zv(e);switch(n[0]){case"<?xml":case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete n[0],n.i?r=n.i:n.i=r,t.push(n)}})),t}(e)}function Y_(e,t,r,n){if(".bin"===r.slice(-4))return function(e,t,r,n){if(!e)return e;var a=n||{},i=!1;hb(e,(function(e,t,r){switch(r){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:i=!0;break;case 36:i=!1;break;default:if(t.T);else if(!i||a.WTF)throw new Error("Unexpected record 0x"+r.toString(16))}}),a)}(e,0,0,n)}function Q_(e,t,r){return".bin"===t.slice(-4)?function(e,t,r){var n={Types:[],Cell:[],Value:[]},a=r||{},i=[],s=!1,o=2;return hb(e,(function(e,t,r){switch(r){case 335:n.Types.push({name:e.name});break;case 51:e.forEach((function(e){1==o?n.Cell.push({type:n.Types[e[0]-1].name,index:e[1]}):0==o&&n.Value.push({type:n.Types[e[0]-1].name,index:e[1]})}));break;case 337:o=e?1:0;break;case 338:o=2;break;case 35:i.push(r),s=!0;break;case 36:i.pop(),s=!1;break;default:if(t.T);else if(!s||a.WTF&&35!=i[i.length-1])throw new Error("Unexpected record 0x"+r.toString(16))}})),n}(e,0,r):function(e,t,r){var n={Types:[],Cell:[],Value:[]};if(!e)return n;var a,i=!1,s=2;return e.replace(Yv,(function(e){var t=Zv(e);switch(ey(t[0])){case"<?xml":case"<metadata":case"</metadata>":case"<metadataTypes":case"</metadataTypes>":case"</metadataType>":case"</futureMetadata>":case"<bk>":case"</bk>":case"</rc>":case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<metadataType":n.Types.push({name:t.name});break;case"<futureMetadata":for(var o=0;o<n.Types.length;++o)n.Types[o].name==t.name&&(a=n.Types[o]);break;case"<rc":1==s?n.Cell.push({type:n.Types[t.t-1].name,index:+t.v}):0==s&&n.Value.push({type:n.Types[t.t-1].name,index:+t.v});break;case"<cellMetadata":s=1;break;case"</cellMetadata>":case"</valueMetadata>":s=2;break;case"<valueMetadata":s=0;break;case"<ext":i=!0;break;case"</ext>":i=!1;break;case"<rvb":if(!a)break;a.offsets||(a.offsets=[]),a.offsets.push(+t.i);break;default:if(!i&&r.WTF)throw new Error("unrecognized "+t[0]+" in metadata")}return e})),n}(e,0,r)}var J_,Z_=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,eS=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function tS(e,t){var r=e.split(/\s+/),n=[];if(t||(n[0]=r[0]),1===r.length)return n;var a,i,s,o=e.match(Z_);if(o)for(s=0;s!=o.length;++s)-1===(i=(a=o[s].match(eS))[1].indexOf(":"))?n[a[1]]=a[2].slice(1,a[2].length-1):n["xmlns:"===a[1].slice(0,6)?"xmlns"+a[1].slice(6):a[1].slice(i+1)]=a[2].slice(1,a[2].length-1);return n}function rS(e){var t={};if(1===e.split(/\s+/).length)return t;var r,n,a,i=e.match(Z_);if(i)for(a=0;a!=i.length;++a)-1===(n=(r=i[a].match(eS))[1].indexOf(":"))?t[r[1]]=r[2].slice(1,r[2].length-1):t["xmlns:"===r[1].slice(0,6)?"xmlns"+r[1].slice(6):r[1].slice(n+1)]=r[2].slice(1,r[2].length-1);return t}function nS(e,t,r,n){var a=n;switch((r[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":a=ly(n);break;case"i2":case"int":a=parseInt(n,10);break;case"r4":case"float":a=parseFloat(n);break;case"date":case"dateTime.tz":a=Av(n);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+r[0])}e[ny(t)]=a}function aS(e,t,r){if("z"!==e.t){if(!r||!1!==r.cellText)try{"e"===e.t?e.w=e.w||ew[e.v]:"General"===t?"n"===e.t?(0|e.v)===e.v?e.w=e.v.toString(10):e.w=Bg(e.v):e.w=zg(e.v):e.w=function(e,t){var r=J_[e]||ny(e);return"General"===r?zg(t):lv(r,t)}(t||"General",e.v)}catch(Ok){if(r.WTF)throw Ok}try{var n=J_[t]||t||"General";if(r.cellNF&&(e.z=n),r.cellDates&&"n"==e.t&&av(n)){var a=Dg(e.v);a&&(e.t="d",e.v=new Date(a.y,a.m-1,a.d,a.H,a.M,a.S,a.u))}}catch(Ok){if(r.WTF)throw Ok}}}function iS(e,t,r){if(r.cellStyles&&t.Interior){var n=t.Interior;n.Pattern&&(n.patternType=JE[n.Pattern]||n.Pattern)}e[t.ID]=t}function sS(e,t,r,n,a,i,s,o,l,c){var u="General",h=n.StyleID,f={};c=c||{};var d=[],p=0;for(void 0===h&&o&&(h=o.StyleID),void 0===h&&s&&(h=s.StyleID);void 0!==i[h]&&(i[h].nf&&(u=i[h].nf),i[h].Interior&&d.push(i[h].Interior),i[h].Parent);)h=i[h].Parent;switch(r.Type){case"Boolean":n.t="b",n.v=ly(e);break;case"String":n.t="s",n.r=oy(ny(e)),n.v=e.indexOf("<")>-1?ny(t||e).replace(/<.*?>/g,""):n.r;break;case"DateTime":"Z"!=e.slice(-1)&&(e+="Z"),n.v=(Av(e)-new Date(Date.UTC(1899,11,30)))/864e5,n.v!==n.v?n.v=ny(e):n.v<60&&(n.v=n.v-1),u&&"General"!=u||(u="yyyy-mm-dd");case"Number":void 0===n.v&&(n.v=+e),n.t||(n.t="n");break;case"Error":n.t="e",n.v=tw[e],!1!==c.cellText&&(n.w=e);break;default:""==e&&""==t?n.t="z":(n.t="s",n.v=oy(t||e))}if(aS(n,u,c),!1!==c.cellFormula)if(n.Formula){var m=ny(n.Formula);61==m.charCodeAt(0)&&(m=m.slice(1)),n.f=yT(m,a),delete n.Formula,"RC"==n.ArrayRange?n.F=yT("RC:RC",a):n.ArrayRange&&(n.F=yT(n.ArrayRange,a),l.push([kb(n.F),n.F]))}else for(p=0;p<l.length;++p)a.r>=l[p][0].s.r&&a.r<=l[p][0].e.r&&a.c>=l[p][0].s.c&&a.c<=l[p][0].e.c&&(n.F=l[p][1]);c.cellStyles&&(d.forEach((function(e){!f.patternType&&e.patternType&&(f.patternType=e.patternType)})),n.s=f),void 0!==n.StyleID&&(n.ixfe=n.StyleID)}function oS(e){e.t=e.v||"",e.t=e.t.replace(/\r\n/g,"\n").replace(/\r/g,"\n"),e.v=e.w=e.ixfe=void 0}function lS(e,t){var r=t||{};uv();var n=ig(Sy(e));"binary"!=r.type&&"array"!=r.type&&"base64"!=r.type||(n="undefined"!==typeof ag?ag.utils.decode(65001,rg(n)):dy(n));var a,i=n.slice(0,1024).toLowerCase(),s=!1;if((1023&(i=i.replace(/".*?"/g,"")).indexOf(">"))>Math.min(1023&i.indexOf(","),1023&i.indexOf(";"))){var o=Nv(r);return o.type="string",mE.to_workbook(n,o)}if(-1==i.indexOf("<?xml")&&["html","table","head","meta","script","style","div"].forEach((function(e){i.indexOf("<"+e)>=0&&(s=!0)})),s)return function(e,t){var r=e.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!r||0==r.length)throw new Error("Invalid HTML: could not find <table>");if(1==r.length)return Ab(TS(r[0],t),t);var n={SheetNames:[],Sheets:{}};return r.forEach((function(e,r){wk(n,TS(e,t),"Sheet"+(r+1))})),n}(n,r);J_={"General Number":"General","General Date":Ng[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":Ng[15],"Short Date":Ng[14],"Long Time":Ng[19],"Medium Time":Ng[18],"Short Time":Ng[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:Ng[2],Standard:Ng[4],Percent:Ng[10],Scientific:Ng[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var l,c=[];var u,h={},f=[],d=r.dense?[]:{},p="",m={},g={},v=tS('<Data ss:Type="String">'),y=0,b=0,w=0,E={s:{r:2e6,c:2e6},e:{r:0,c:0}},T={},_={},S="",k=0,C=[],I={},A={},R=0,N=[],O=[],x={},P=[],D=!1,L=[],M=[],F={},U=0,V=0,B={Sheets:[],WBProps:{date1904:!1}},z={};ky.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/gm,"");for(var j="";a=ky.exec(n);)switch(a[3]=(j=a[3]).toLowerCase()){case"data":if("data"==j){if("/"===a[1]){if((l=c.pop())[0]!==a[3])throw new Error("Bad state: "+l.join("|"))}else"/"!==a[0].charAt(a[0].length-2)&&c.push([a[3],!0]);break}if(c[c.length-1][1])break;"/"===a[1]?sS(n.slice(y,a.index),S,v,"comment"==c[c.length-1][0]?x:m,{c:b,r:w},T,P[b],g,L,r):(S="",v=tS(a[0]),y=a.index+a[0].length);break;case"cell":if("/"===a[1])if(O.length>0&&(m.c=O),(!r.sheetRows||r.sheetRows>w)&&void 0!==m.v&&(r.dense?(d[w]||(d[w]=[]),d[w][b]=m):d[wb(b)+yb(w)]=m),m.HRef&&(m.l={Target:ny(m.HRef)},m.HRefScreenTip&&(m.l.Tooltip=m.HRefScreenTip),delete m.HRef,delete m.HRefScreenTip),(m.MergeAcross||m.MergeDown)&&(U=b+(0|parseInt(m.MergeAcross,10)),V=w+(0|parseInt(m.MergeDown,10)),C.push({s:{c:b,r:w},e:{c:U,r:V}})),r.sheetStubs)if(m.MergeAcross||m.MergeDown){for(var H=b;H<=U;++H)for(var $=w;$<=V;++$)(H>b||$>w)&&(r.dense?(d[$]||(d[$]=[]),d[$][H]={t:"z"}):d[wb(H)+yb($)]={t:"z"});b=U+1}else++b;else m.MergeAcross?b=U+1:++b;else(m=rS(a[0])).Index&&(b=+m.Index-1),b<E.s.c&&(E.s.c=b),b>E.e.c&&(E.e.c=b),"/>"===a[0].slice(-2)&&++b,O=[];break;case"row":"/"===a[1]||"/>"===a[0].slice(-2)?(w<E.s.r&&(E.s.r=w),w>E.e.r&&(E.e.r=w),"/>"===a[0].slice(-2)&&(g=tS(a[0])).Index&&(w=+g.Index-1),b=0,++w):((g=tS(a[0])).Index&&(w=+g.Index-1),F={},("0"==g.AutoFitHeight||g.Height)&&(F.hpx=parseInt(g.Height,10),F.hpt=YE(F.hpx),M[w]=F),"1"==g.Hidden&&(F.hidden=!0,M[w]=F));break;case"worksheet":if("/"===a[1]){if((l=c.pop())[0]!==a[3])throw new Error("Bad state: "+l.join("|"));f.push(p),E.s.r<=E.e.r&&E.s.c<=E.e.c&&(d["!ref"]=Sb(E),r.sheetRows&&r.sheetRows<=E.e.r&&(d["!fullref"]=d["!ref"],E.e.r=r.sheetRows-1,d["!ref"]=Sb(E))),C.length&&(d["!merges"]=C),P.length>0&&(d["!cols"]=P),M.length>0&&(d["!rows"]=M),h[p]=d}else E={s:{r:2e6,c:2e6},e:{r:0,c:0}},w=b=0,c.push([a[3],!1]),l=tS(a[0]),p=ny(l.Name),d=r.dense?[]:{},C=[],L=[],M=[],z={name:p,Hidden:0},B.Sheets.push(z);break;case"table":if("/"===a[1]){if((l=c.pop())[0]!==a[3])throw new Error("Bad state: "+l.join("|"))}else{if("/>"==a[0].slice(-2))break;c.push([a[3],!1]),P=[],D=!1}break;case"style":"/"===a[1]?iS(T,_,r):_=tS(a[0]);break;case"numberformat":_.nf=ny(tS(a[0]).Format||"General"),J_[_.nf]&&(_.nf=J_[_.nf]);for(var W=0;392!=W&&Ng[W]!=_.nf;++W);if(392==W)for(W=57;392!=W;++W)if(null==Ng[W]){cv(_.nf,W);break}break;case"column":if("table"!==c[c.length-1][0])break;if((u=tS(a[0])).Hidden&&(u.hidden=!0,delete u.Hidden),u.Width&&(u.wpx=parseInt(u.Width,10)),!D&&u.wpx>10){D=!0,jE=6;for(var G=0;G<P.length;++G)P[G]&&qE(P[G])}D&&qE(u),P[u.Index-1||P.length]=u;for(var K=0;K<+u.Span;++K)P[P.length]=Nv(u);break;case"namedrange":if("/"===a[1])break;B.Names||(B.Names=[]);var q=Zv(a[0]),X={Name:q.Name,Ref:yT(q.RefersTo.slice(1),{r:0,c:0})};B.Sheets.length>0&&(X.Sheet=B.Sheets.length-1),B.Names.push(X);break;case"namedcell":case"b":case"i":case"u":case"s":case"em":case"h2":case"h3":case"sub":case"sup":case"span":case"alignment":case"borders":case"border":case"protection":case"paragraphs":case"name":case"pixelsperinch":case"null":break;case"font":if("/>"===a[0].slice(-2))break;"/"===a[1]?S+=n.slice(k,a.index):k=a.index+a[0].length;break;case"interior":if(!r.cellStyles)break;_.Interior=tS(a[0]);break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if("/>"===a[0].slice(-2))break;"/"===a[1]?pw(I,j,n.slice(R,a.index)):R=a.index+a[0].length;break;case"styles":case"workbook":if("/"===a[1]){if((l=c.pop())[0]!==a[3])throw new Error("Bad state: "+l.join("|"))}else c.push([a[3],!1]);break;case"comment":if("/"===a[1]){if((l=c.pop())[0]!==a[3])throw new Error("Bad state: "+l.join("|"));oS(x),O.push(x)}else c.push([a[3],!1]),x={a:(l=tS(a[0])).Author};break;case"autofilter":if("/"===a[1]){if((l=c.pop())[0]!==a[3])throw new Error("Bad state: "+l.join("|"))}else if("/"!==a[0].charAt(a[0].length-2)){var Y=tS(a[0]);d["!autofilter"]={ref:yT(Y.Range).replace(/\$/g,"")},c.push([a[3],!0])}break;case"datavalidation":if("/"===a[1]){if((l=c.pop())[0]!==a[3])throw new Error("Bad state: "+l.join("|"))}else"/"!==a[0].charAt(a[0].length-2)&&c.push([a[3],!0]);break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if("/"===a[1]){if((l=c.pop())[0]!==a[3])throw new Error("Bad state: "+l.join("|"))}else"/"!==a[0].charAt(a[0].length-2)&&c.push([a[3],!0]);break;default:if(0==c.length&&"document"==a[3])return LS(n,r);if(0==c.length&&"uof"==a[3])return LS(n,r);var Q=!0;switch(c[c.length-1][0]){case"officedocumentsettings":switch(a[3]){case"allowpng":case"removepersonalinformation":case"downloadcomponents":case"locationofcomponents":case"colors":case"color":case"index":case"rgb":case"targetscreensize":case"readonlyrecommended":break;default:Q=!1}break;case"componentoptions":switch(a[3]){case"toolbar":case"hideofficelogo":case"spreadsheetautofit":case"label":case"caption":case"maxheight":case"maxwidth":case"nextsheetnumber":break;default:Q=!1}break;case"excelworkbook":switch(a[3]){case"date1904":B.WBProps.date1904=!0;break;case"windowheight":case"windowwidth":case"windowtopx":case"windowtopy":case"tabratio":case"protectstructure":case"protectwindow":case"protectwindows":case"activesheet":case"displayinknotes":case"firstvisiblesheet":case"supbook":case"sheetname":case"sheetindex":case"sheetindexfirst":case"sheetindexlast":case"dll":case"acceptlabelsinformulas":case"donotsavelinkvalues":case"iteration":case"maxiterations":case"maxchange":case"path":case"xct":case"count":case"selectedsheets":case"calculation":case"uncalced":case"startupprompt":case"crn":case"externname":case"formula":case"colfirst":case"collast":case"wantadvise":case"boolean":case"error":case"text":case"ole":case"noautorecover":case"publishobjects":case"donotcalculatebeforesave":case"number":case"refmoder1c1":case"embedsavesmarttags":break;default:Q=!1}break;case"workbookoptions":switch(a[3]){case"owcversion":case"height":case"width":break;default:Q=!1}break;case"worksheetoptions":switch(a[3]){case"visible":if("/>"===a[0].slice(-2));else if("/"===a[1])switch(n.slice(R,a.index)){case"SheetHidden":z.Hidden=1;break;case"SheetVeryHidden":z.Hidden=2}else R=a.index+a[0].length;break;case"header":d["!margins"]||h_(d["!margins"]={},"xlml"),isNaN(+Zv(a[0]).Margin)||(d["!margins"].header=+Zv(a[0]).Margin);break;case"footer":d["!margins"]||h_(d["!margins"]={},"xlml"),isNaN(+Zv(a[0]).Margin)||(d["!margins"].footer=+Zv(a[0]).Margin);break;case"pagemargins":var J=Zv(a[0]);d["!margins"]||h_(d["!margins"]={},"xlml"),isNaN(+J.Top)||(d["!margins"].top=+J.Top),isNaN(+J.Left)||(d["!margins"].left=+J.Left),isNaN(+J.Right)||(d["!margins"].right=+J.Right),isNaN(+J.Bottom)||(d["!margins"].bottom=+J.Bottom);break;case"displayrighttoleft":B.Views||(B.Views=[]),B.Views[0]||(B.Views[0]={}),B.Views[0].RTL=!0;break;case"freezepanes":case"frozennosplit":case"splithorizontal":case"splitvertical":case"donotdisplaygridlines":case"activerow":case"activecol":case"toprowbottompane":case"leftcolumnrightpane":case"unsynced":case"print":case"printerrors":case"panes":case"scale":case"pane":case"number":case"layout":case"pagesetup":case"selected":case"protectobjects":case"enableselection":case"protectscenarios":case"validprinterinfo":case"horizontalresolution":case"verticalresolution":case"numberofcopies":case"activepane":case"toprowvisible":case"leftcolumnvisible":case"fittopage":case"rangeselection":case"papersizeindex":case"pagelayoutzoom":case"pagebreakzoom":case"filteron":case"fitwidth":case"fitheight":case"commentslayout":case"zoom":case"lefttoright":case"gridlines":case"allowsort":case"allowfilter":case"allowinsertrows":case"allowdeleterows":case"allowinsertcols":case"allowdeletecols":case"allowinserthyperlinks":case"allowformatcells":case"allowsizecols":case"allowsizerows":case"tabcolorindex":case"donotdisplayheadings":case"showpagelayoutzoom":case"blackandwhite":case"donotdisplayzeros":case"displaypagebreak":case"rowcolheadings":case"donotdisplayoutline":case"noorientation":case"allowusepivottables":case"zeroheight":case"viewablerange":case"selection":case"protectcontents":break;case"nosummaryrowsbelowdetail":d["!outline"]||(d["!outline"]={}),d["!outline"].above=!0;break;case"nosummarycolumnsrightdetail":d["!outline"]||(d["!outline"]={}),d["!outline"].left=!0;break;default:Q=!1}break;case"pivottable":case"pivotcache":switch(a[3]){case"immediateitemsondrop":case"showpagemultipleitemlabel":case"compactrowindent":case"location":case"pivotfield":case"orientation":case"layoutform":case"layoutsubtotallocation":case"layoutcompactrow":case"position":case"pivotitem":case"datatype":case"datafield":case"sourcename":case"parentfield":case"ptlineitems":case"ptlineitem":case"countofsameitems":case"item":case"itemtype":case"ptsource":case"cacheindex":case"consolidationreference":case"filename":case"reference":case"nocolumngrand":case"norowgrand":case"blanklineafteritems":case"hidden":case"subtotal":case"basefield":case"mapchilditems":case"function":case"refreshonfileopen":case"printsettitles":case"mergelabels":case"defaultversion":case"refreshname":case"refreshdate":case"refreshdatecopy":case"versionlastrefresh":case"versionlastupdate":case"versionupdateablemin":case"versionrefreshablemin":case"calculation":break;default:Q=!1}break;case"pagebreaks":switch(a[3]){case"colbreaks":case"colbreak":case"rowbreaks":case"rowbreak":case"colstart":case"colend":case"rowend":break;default:Q=!1}break;case"autofilter":switch(a[3]){case"autofiltercolumn":case"autofiltercondition":case"autofilterand":case"autofilteror":break;default:Q=!1}break;case"querytable":switch(a[3]){case"id":case"autoformatfont":case"autoformatpattern":case"querysource":case"querytype":case"enableredirections":case"refreshedinxl9":case"urlstring":case"htmltables":case"connection":case"commandtext":case"refreshinfo":case"notitles":case"nextid":case"columninfo":case"overwritecells":case"donotpromptforfile":case"textwizardsettings":case"source":case"number":case"decimal":case"thousandseparator":case"trailingminusnumbers":case"formatsettings":case"fieldtype":case"delimiters":case"tab":case"comma":case"autoformatname":case"versionlastedit":case"versionlastrefresh":break;default:Q=!1}break;case"datavalidation":switch(a[3]){case"range":case"type":case"min":case"max":case"sort":case"descending":case"order":case"casesensitive":case"value":case"errorstyle":case"errormessage":case"errortitle":case"inputmessage":case"inputtitle":case"combohide":case"inputhide":case"condition":case"qualifier":case"useblank":case"value1":case"value2":case"format":case"cellrangelist":break;default:Q=!1}break;case"sorting":case"conditionalformatting":switch(a[3]){case"range":case"type":case"min":case"max":case"sort":case"descending":case"order":case"casesensitive":case"value":case"errorstyle":case"errormessage":case"errortitle":case"cellrangelist":case"inputmessage":case"inputtitle":case"combohide":case"inputhide":case"condition":case"qualifier":case"useblank":case"value1":case"value2":case"format":break;default:Q=!1}break;case"mapinfo":case"schema":case"data":switch(a[3]){case"map":case"entry":case"range":case"xpath":case"field":case"xsdtype":case"filteron":case"aggregate":case"elementtype":case"attributetype":case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":case"row":break;default:Q=!1}break;case"smarttags":break;default:Q=!1}if(Q)break;if(a[3].match(/!\[CDATA/))break;if(!c[c.length-1][1])throw"Unrecognized tag: "+a[3]+"|"+c.join("|");if("customdocumentproperties"===c[c.length-1][0]){if("/>"===a[0].slice(-2))break;"/"===a[1]?nS(A,j,N,n.slice(R,a.index)):(N=a,R=a.index+a[0].length);break}if(r.WTF)throw"Unrecognized tag: "+a[3]+"|"+c.join("|")}var Z={};return r.bookSheets||r.bookProps||(Z.Sheets=h),Z.SheetNames=f,Z.Workbook=B,Z.SSF=Nv(Ng),Z.Props=I,Z.Custprops=A,Z}function cS(e,t){switch(rk(t=t||{}),t.type||"base64"){case"base64":return lS(ug(e),t);case"binary":case"buffer":case"file":return lS(e,t);case"array":return lS(gg(e),t)}}function uS(e){var t={},r=e.content;if(r.l=28,t.AnsiUserType=r.read_shift(0,"lpstr-ansi"),t.AnsiClipboardFormat=function(e){return Wb(e,1)}(r),r.length-r.l<=4)return t;var n=r.read_shift(4);return 0==n||n>40?t:(r.l-=4,t.Reserved1=r.read_shift(0,"lpstr-ansi"),r.length-r.l<=4||1907505652!==(n=r.read_shift(4))?t:(t.UnicodeClipboardFormat=function(e){return Wb(e,2)}(r),0==(n=r.read_shift(4))||n>40?t:(r.l-=4,void(t.Reserved2=r.read_shift(0,"lpwstr")))))}var hS=[60,1084,2066,2165,2175];function fS(e,t,r,n,a){var i=n,s=[],o=r.slice(r.l,r.l+i);if(a&&a.enc&&a.enc.insitu&&o.length>0)switch(e){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:case 133:break;default:a.enc.insitu(o)}s.push(o),r.l+=i;for(var l=Qy(r,r.l),c=wS[l],u=0;null!=c&&hS.indexOf(l)>-1;)i=Qy(r,r.l+2),u=r.l+4,2066==l?u+=4:2165!=l&&2175!=l||(u+=12),o=r.slice(u,r.l+4+i),s.push(o),r.l+=4+i,c=wS[l=Qy(r,r.l)];var h=yg(s);lb(h,0);var f=0;h.lens=[];for(var d=0;d<s.length;++d)h.lens.push(f),f+=s[d].length;if(h.length<n)throw"XLS Record 0x"+e.toString(16)+" Truncated: "+h.length+" < "+n;return t.f(h,h.length,a)}function dS(e,t,r){if("z"!==e.t&&e.XF){var n=0;try{n=e.z||e.XF.numFmtId||0,t.cellNF&&(e.z=Ng[n])}catch(Ok){if(t.WTF)throw Ok}if(!t||!1!==t.cellText)try{"e"===e.t?e.w=e.w||ew[e.v]:0===n||"General"==n?"n"===e.t?(0|e.v)===e.v?e.w=e.v.toString(10):e.w=Bg(e.v):e.w=zg(e.v):e.w=lv(n,e.v,{date1904:!!r,dateNF:t&&t.dateNF})}catch(Ok){if(t.WTF)throw Ok}if(t.cellDates&&n&&"n"==e.t&&av(Ng[n]||String(n))){var a=Dg(e.v);a&&(e.t="d",e.v=new Date(a.y,a.m-1,a.d,a.H,a.M,a.S,a.u))}}}function pS(e,t,r){return{v:e,ixfe:t,t:r}}function mS(e,t){var r={opts:{}},n={};var a,i,s,o,l,c,u,h,f=t.dense?[]:{},d={},p={},m=null,g=[],v="",y={},b="",w={},E=[],T=[],_=[],S={Sheets:[],WBProps:{date1904:!1},Views:[{}]},k={},C=function(e){return e<8?Zb[e]:e<64&&_[e-8]||Zb[e]},I=function(e,t,r){if(!(F>1)&&!(r.sheetRows&&e.r>=r.sheetRows)){if(r.cellStyles&&t.XF&&t.XF.data&&function(e,t,r){var n,a=t.XF.data;a&&a.patternType&&r&&r.cellStyles&&(t.s={},t.s.patternType=a.patternType,(n=BE(C(a.icvFore)))&&(t.s.fgColor={rgb:n}),(n=BE(C(a.icvBack)))&&(t.s.bgColor={rgb:n}))}(0,t,r),delete t.ixfe,delete t.XF,a=e,b=Tb(e),p&&p.s&&p.e||(p={s:{r:0,c:0},e:{r:0,c:0}}),e.r<p.s.r&&(p.s.r=e.r),e.c<p.s.c&&(p.s.c=e.c),e.r+1>p.e.r&&(p.e.r=e.r+1),e.c+1>p.e.c&&(p.e.c=e.c+1),r.cellFormula&&t.f)for(var n=0;n<E.length;++n)if(!(E[n][0].s.c>e.c||E[n][0].s.r>e.r)&&!(E[n][0].e.c<e.c||E[n][0].e.r<e.r)){t.F=Sb(E[n][0]),E[n][0].s.c==e.c&&E[n][0].s.r==e.r||delete t.f,t.f&&(t.f=""+XT(E[n][1],0,e,D,A));break}r.dense?(f[e.r]||(f[e.r]=[]),f[e.r][e.c]=t):f[b]=t}},A={enc:!1,sbcch:0,snames:[],sharedf:w,arrayf:E,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!t&&!!t.cellStyles,WTF:!!t&&!!t.wtf};t.password&&(A.password=t.password);var R=[],N=[],O=[],x=[],P=!1,D=[];D.SheetNames=A.snames,D.sharedf=A.sharedf,D.arrayf=A.arrayf,D.names=[],D.XTI=[];var L,M=0,F=0,U=0,V=[],B=[];A.codepage=1200,eg(1200);for(var z=!1;e.l<e.length-1;){var j=e.l,H=e.read_shift(2);if(0===H&&10===M)break;var $=e.l===e.length?0:e.read_shift(2),W=wS[H];if(W&&W.f){if(t.bookSheets&&133===M&&133!==H)break;if(M=H,2===W.r||12==W.r){var G=e.read_shift(2);if($-=2,!A.enc&&G!==H&&((255&G)<<8|G>>8)!==H)throw new Error("rt mismatch: "+G+"!="+H);12==W.r&&(e.l+=10,$-=10)}var K={};if(K=10===H?W.f(e,$,A):fS(H,W,e,$,A),0==F&&-1===[9,521,1033,2057].indexOf(M))continue;switch(H){case 34:r.opts.Date1904=S.WBProps.date1904=K;break;case 134:r.opts.WriteProtect=!0;break;case 47:if(A.enc||(e.l=0),A.enc=K,!t.password)throw new Error("File is password-protected");if(null==K.valid)throw new Error("Encryption scheme unsupported");if(!K.valid)throw new Error("Password is incorrect");break;case 92:A.lastuser=K;break;case 66:var q=Number(K);switch(q){case 21010:q=1200;break;case 32768:q=1e4;break;case 32769:q=1252}eg(A.codepage=q),z=!0;break;case 317:A.rrtabid=K;break;case 25:A.winlocked=K;break;case 439:r.opts.RefreshAll=K;break;case 12:r.opts.CalcCount=K;break;case 16:r.opts.CalcDelta=K;break;case 17:r.opts.CalcIter=K;break;case 13:r.opts.CalcMode=K;break;case 14:r.opts.CalcPrecision=K;break;case 95:r.opts.CalcSaveRecalc=K;break;case 15:A.CalcRefMode=K;break;case 2211:r.opts.FullCalc=K;break;case 129:K.fDialog&&(f["!type"]="dialog"),K.fBelow||((f["!outline"]||(f["!outline"]={})).above=!0),K.fRight||((f["!outline"]||(f["!outline"]={})).left=!0);break;case 224:T.push(K);break;case 430:D.push([K]),D[D.length-1].XTI=[];break;case 35:case 547:D[D.length-1].push(K);break;case 24:case 536:L={Name:K.Name,Ref:XT(K.rgce,0,null,D,A)},K.itab>0&&(L.Sheet=K.itab-1),D.names.push(L),D[0]||(D[0]=[],D[0].XTI=[]),D[D.length-1].push(K),"_xlnm._FilterDatabase"==K.Name&&K.itab>0&&K.rgce&&K.rgce[0]&&K.rgce[0][0]&&"PtgArea3d"==K.rgce[0][0][0]&&(B[K.itab-1]={ref:Sb(K.rgce[0][0][1][2])});break;case 22:A.ExternCount=K;break;case 23:0==D.length&&(D[0]=[],D[0].XTI=[]),D[D.length-1].XTI=D[D.length-1].XTI.concat(K),D.XTI=D.XTI.concat(K);break;case 2196:if(A.biff<8)break;null!=L&&(L.Comment=K[1]);break;case 18:f["!protect"]=K;break;case 19:0!==K&&A.WTF&&console.error("Password verifier: "+K);break;case 133:d[K.pos]=K,A.snames.push(K.name);break;case 10:if(--F)break;if(p.e){if(p.e.r>0&&p.e.c>0){if(p.e.r--,p.e.c--,f["!ref"]=Sb(p),t.sheetRows&&t.sheetRows<=p.e.r){var X=p.e.r;p.e.r=t.sheetRows-1,f["!fullref"]=f["!ref"],f["!ref"]=Sb(p),p.e.r=X}p.e.r++,p.e.c++}R.length>0&&(f["!merges"]=R),N.length>0&&(f["!objects"]=N),O.length>0&&(f["!cols"]=O),x.length>0&&(f["!rows"]=x),S.Sheets.push(k)}""===v?y=f:n[v]=f,f=t.dense?[]:{};break;case 9:case 521:case 1033:case 2057:if(8===A.biff&&(A.biff={9:2,521:3,1033:4}[H]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[K.BIFFVer]||8),A.biffguess=0==K.BIFFVer,0==K.BIFFVer&&4096==K.dt&&(A.biff=5,z=!0,eg(A.codepage=28591)),8==A.biff&&0==K.BIFFVer&&16==K.dt&&(A.biff=2),F++)break;if(f=t.dense?[]:{},A.biff<8&&!z&&(z=!0,eg(A.codepage=t.codepage||1252)),A.biff<5||0==K.BIFFVer&&4096==K.dt){""===v&&(v="Sheet1"),p={s:{r:0,c:0},e:{r:0,c:0}};var Y={pos:e.l-$,name:v};d[Y.pos]=Y,A.snames.push(v)}else v=(d[j]||{name:""}).name;32==K.dt&&(f["!type"]="chart"),64==K.dt&&(f["!type"]="macro"),R=[],N=[],A.arrayf=E=[],O=[],x=[],P=!1,k={Hidden:(d[j]||{hs:0}).hs,name:v};break;case 515:case 3:case 2:"chart"==f["!type"]&&(t.dense?(f[K.r]||[])[K.c]:f[Tb({c:K.c,r:K.r})])&&++K.c,c={ixfe:K.ixfe,XF:T[K.ixfe]||{},v:K.val,t:"n"},U>0&&(c.z=V[c.ixfe>>8&63]),dS(c,t,r.opts.Date1904),I({c:K.c,r:K.r},c,t);break;case 5:case 517:c={ixfe:K.ixfe,XF:T[K.ixfe],v:K.val,t:K.t},U>0&&(c.z=V[c.ixfe>>8&63]),dS(c,t,r.opts.Date1904),I({c:K.c,r:K.r},c,t);break;case 638:c={ixfe:K.ixfe,XF:T[K.ixfe],v:K.rknum,t:"n"},U>0&&(c.z=V[c.ixfe>>8&63]),dS(c,t,r.opts.Date1904),I({c:K.c,r:K.r},c,t);break;case 189:for(var Q=K.c;Q<=K.C;++Q){var J=K.rkrec[Q-K.c][0];c={ixfe:J,XF:T[J],v:K.rkrec[Q-K.c][1],t:"n"},U>0&&(c.z=V[c.ixfe>>8&63]),dS(c,t,r.opts.Date1904),I({c:Q,r:K.r},c,t)}break;case 6:case 518:case 1030:if("String"==K.val){m=K;break}if((c=pS(K.val,K.cell.ixfe,K.tt)).XF=T[c.ixfe],t.cellFormula){var Z=K.formula;if(Z&&Z[0]&&Z[0][0]&&"PtgExp"==Z[0][0][0]){var ee=Z[0][0][1][0],te=Z[0][0][1][1],re=Tb({r:ee,c:te});w[re]?c.f=""+XT(K.formula,0,K.cell,D,A):c.F=((t.dense?(f[ee]||[])[te]:f[re])||{}).F}else c.f=""+XT(K.formula,0,K.cell,D,A)}U>0&&(c.z=V[c.ixfe>>8&63]),dS(c,t,r.opts.Date1904),I(K.cell,c,t),m=K;break;case 7:case 519:if(!m)throw new Error("String record expects Formula");m.val=K,(c=pS(K,m.cell.ixfe,"s")).XF=T[c.ixfe],t.cellFormula&&(c.f=""+XT(m.formula,0,m.cell,D,A)),U>0&&(c.z=V[c.ixfe>>8&63]),dS(c,t,r.opts.Date1904),I(m.cell,c,t),m=null;break;case 33:case 545:E.push(K);var ne=Tb(K[0].s);if(i=t.dense?(f[K[0].s.r]||[])[K[0].s.c]:f[ne],t.cellFormula&&i){if(!m)break;if(!ne||!i)break;i.f=""+XT(K[1],0,K[0],D,A),i.F=Sb(K[0])}break;case 1212:if(!t.cellFormula)break;if(b){if(!m)break;w[Tb(m.cell)]=K[0],((i=t.dense?(f[m.cell.r]||[])[m.cell.c]:f[Tb(m.cell)])||{}).f=""+XT(K[0],0,a,D,A)}break;case 253:c=pS(g[K.isst].t,K.ixfe,"s"),g[K.isst].h&&(c.h=g[K.isst].h),c.XF=T[c.ixfe],U>0&&(c.z=V[c.ixfe>>8&63]),dS(c,t,r.opts.Date1904),I({c:K.c,r:K.r},c,t);break;case 513:t.sheetStubs&&(c={ixfe:K.ixfe,XF:T[K.ixfe],t:"z"},U>0&&(c.z=V[c.ixfe>>8&63]),dS(c,t,r.opts.Date1904),I({c:K.c,r:K.r},c,t));break;case 190:if(t.sheetStubs)for(var ae=K.c;ae<=K.C;++ae){var ie=K.ixfe[ae-K.c];c={ixfe:ie,XF:T[ie],t:"z"},U>0&&(c.z=V[c.ixfe>>8&63]),dS(c,t,r.opts.Date1904),I({c:ae,r:K.r},c,t)}break;case 214:case 516:case 4:(c=pS(K.val,K.ixfe,"s")).XF=T[c.ixfe],U>0&&(c.z=V[c.ixfe>>8&63]),dS(c,t,r.opts.Date1904),I({c:K.c,r:K.r},c,t);break;case 0:case 512:1===F&&(p=K);break;case 252:g=K;break;case 1054:if(4==A.biff){V[U++]=K[1];for(var se=0;se<U+163&&Ng[se]!=K[1];++se);se>=163&&cv(K[1],U+163)}else cv(K[1],K[0]);break;case 30:V[U++]=K;for(var oe=0;oe<U+163&&Ng[oe]!=K;++oe);oe>=163&&cv(K,U+163);break;case 229:R=R.concat(K);break;case 93:N[K.cmo[0]]=A.lastobj=K;break;case 438:A.lastobj.TxO=K;break;case 127:A.lastobj.ImData=K;break;case 440:for(l=K[0].s.r;l<=K[0].e.r;++l)for(o=K[0].s.c;o<=K[0].e.c;++o)(i=t.dense?(f[l]||[])[o]:f[Tb({c:o,r:l})])&&(i.l=K[1]);break;case 2048:for(l=K[0].s.r;l<=K[0].e.r;++l)for(o=K[0].s.c;o<=K[0].e.c;++o)(i=t.dense?(f[l]||[])[o]:f[Tb({c:o,r:l})])&&i.l&&(i.l.Tooltip=K[1]);break;case 28:if(A.biff<=5&&A.biff>=2)break;i=t.dense?(f[K[0].r]||[])[K[0].c]:f[Tb(K[0])];var le=N[K[2]];i||(t.dense?(f[K[0].r]||(f[K[0].r]=[]),i=f[K[0].r][K[0].c]={t:"z"}):i=f[Tb(K[0])]={t:"z"},p.e.r=Math.max(p.e.r,K[0].r),p.s.r=Math.min(p.s.r,K[0].r),p.e.c=Math.max(p.e.c,K[0].c),p.s.c=Math.min(p.s.c,K[0].c)),i.c||(i.c=[]),s={a:K[1],t:le.TxO.t},i.c.push(s);break;case 2173:T[K.ixfe],K.ext.forEach((function(e){e[0]}));break;case 125:if(!A.cellStyles)break;for(;K.e>=K.s;)O[K.e--]={width:K.w/256,level:K.level||0,hidden:!!(1&K.flags)},P||(P=!0,KE(K.w/256)),qE(O[K.e+1]);break;case 520:var ce={};null!=K.level&&(x[K.r]=ce,ce.level=K.level),K.hidden&&(x[K.r]=ce,ce.hidden=!0),K.hpt&&(x[K.r]=ce,ce.hpt=K.hpt,ce.hpx=QE(K.hpt));break;case 38:case 39:case 40:case 41:f["!margins"]||h_(f["!margins"]={}),f["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[H]]=K;break;case 161:f["!margins"]||h_(f["!margins"]={}),f["!margins"].header=K.header,f["!margins"].footer=K.footer;break;case 574:K.RTL&&(S.Views[0].RTL=!0);break;case 146:_=K;break;case 2198:h=K;break;case 140:u=K;break;case 442:v?k.CodeName=K||k.name:S.WBProps.CodeName=K||"ThisWorkbook"}}else W||console.error("Missing Info for XLS Record 0x"+H.toString(16)),e.l+=$}return r.SheetNames=gv(d).sort((function(e,t){return Number(e)-Number(t)})).map((function(e){return d[e].name})),t.bookSheets||(r.Sheets=n),!r.SheetNames.length&&y["!ref"]?(r.SheetNames.push("Sheet1"),r.Sheets&&(r.Sheets.Sheet1=y)):r.Preamble=y,r.Sheets&&B.forEach((function(e,t){r.Sheets[r.SheetNames[t]]["!autofilter"]=e})),r.Strings=g,r.SSF=Nv(Ng),A.enc&&(r.Encryption=A.enc),h&&(r.Themes=h),r.Metadata={},void 0!==u&&(r.Metadata.Country=u),D.names.length>0&&(S.Names=D.names),r.Workbook=S,r}var gS="e0859ff2f94f6810ab9108002b27b3d9",vS="02d5cdd59c2e1b10939708002b2cf9ae";function yS(e,t){var r,n,a,i;if(t||(t={}),rk(t),tg(),t.codepage&&Zm(t.codepage),e.FullPaths){if(pv.find(e,"/encryption"))throw new Error("File is password-protected");r=pv.find(e,"!CompObj"),n=pv.find(e,"/Workbook")||pv.find(e,"/Book")}else{switch(t.type){case"base64":e=mg(ug(e));break;case"binary":e=mg(e);break;case"buffer":break;case"array":Array.isArray(e)||(e=Array.prototype.slice.call(e))}lb(e,0),n={content:e}}if(r&&uS(r),t.bookProps&&!t.bookSheets)a={};else{var s=hg?"buffer":"array";if(n&&n.content)a=mS(n.content,t);else if((i=pv.find(e,"PerfectOffice_MAIN"))&&i.content)a=gE.to_workbook(i.content,(t.type=s,t));else{if(!(i=pv.find(e,"NativeContent_MAIN"))||!i.content)throw(i=pv.find(e,"MN0"))&&i.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");a=gE.to_workbook(i.content,(t.type=s,t))}t.bookVBA&&e.FullPaths&&pv.find(e,"/_VBA_PROJECT_CUR/VBA/dir")&&(a.vbaraw=function(e){var t=pv.utils.cfb_new({root:"R"});return e.FullPaths.forEach((function(r,n){if("/"!==r.slice(-1)&&r.match(/_VBA_PROJECT_CUR/)){var a=r.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");pv.utils.cfb_add(t,a,e.FileIndex[n].content)}})),pv.write(t)}(e))}var o={};return e.FullPaths&&function(e,t,r){var n=pv.find(e,"/!DocumentSummaryInformation");if(n&&n.size>0)try{var a=kw(n,qb,vS);for(var i in a)t[i]=a[i]}catch(Ok){if(r.WTF)throw Ok}var s=pv.find(e,"/!SummaryInformation");if(s&&s.size>0)try{var o=kw(s,Xb,gS);for(var l in o)null==t[l]&&(t[l]=o[l])}catch(Ok){if(r.WTF)throw Ok}t.HeadingPairs&&t.TitlesOfParts&&(uw(t.HeadingPairs,t.TitlesOfParts,t,r),delete t.HeadingPairs,delete t.TitlesOfParts)}(e,o,t),a.Props=a.Custprops=o,t.bookFiles&&(a.cfb=e),a}var bS={0:{f:function(e,t){var r={},n=e.l+t;r.r=e.read_shift(4),e.l+=4;var a=e.read_shift(2);e.l+=1;var i=e.read_shift(1);return e.l=n,7&i&&(r.level=7&i),16&i&&(r.hidden=!0),32&i&&(r.hpt=a/20),r}},1:{f:function(e){return[Lb(e)]}},2:{f:function(e){return[Lb(e),zb(e),"n"]}},3:{f:function(e){return[Lb(e),e.read_shift(1),"e"]}},4:{f:function(e){return[Lb(e),e.read_shift(1),"b"]}},5:{f:function(e){return[Lb(e),$b(e),"n"]}},6:{f:function(e){return[Lb(e),Ob(e),"str"]}},7:{f:function(e){return[Lb(e),e.read_shift(4),"s"]}},8:{f:function(e,t,r){var n=e.l+t,a=Lb(e);a.r=r["!row"];var i=[a,Ob(e),"str"];if(r.cellFormula){e.l+=2;var s=t_(e,n-e.l,r);i[3]=XT(s,0,a,r.supbooks,r)}else e.l=n;return i}},9:{f:function(e,t,r){var n=e.l+t,a=Lb(e);a.r=r["!row"];var i=[a,$b(e),"n"];if(r.cellFormula){e.l+=2;var s=t_(e,n-e.l,r);i[3]=XT(s,0,a,r.supbooks,r)}else e.l=n;return i}},10:{f:function(e,t,r){var n=e.l+t,a=Lb(e);a.r=r["!row"];var i=[a,e.read_shift(1),"b"];if(r.cellFormula){e.l+=2;var s=t_(e,n-e.l,r);i[3]=XT(s,0,a,r.supbooks,r)}else e.l=n;return i}},11:{f:function(e,t,r){var n=e.l+t,a=Lb(e);a.r=r["!row"];var i=[a,e.read_shift(1),"e"];if(r.cellFormula){e.l+=2;var s=t_(e,n-e.l,r);i[3]=XT(s,0,a,r.supbooks,r)}else e.l=n;return i}},12:{f:function(e){return[Mb(e)]}},13:{f:function(e){return[Mb(e),zb(e),"n"]}},14:{f:function(e){return[Mb(e),e.read_shift(1),"e"]}},15:{f:function(e){return[Mb(e),e.read_shift(1),"b"]}},16:{f:A_},17:{f:function(e){return[Mb(e),Ob(e),"str"]}},18:{f:function(e){return[Mb(e),e.read_shift(4),"s"]}},19:{f:Pb},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:function(e,t,r){var n=e.l+t;e.l+=4,e.l+=1;var a=e.read_shift(4),i=Vb(e),s=r_(e,0,r),o=Ub(e);e.l=n;var l={Name:i,Ptg:s};return a<268435455&&(l.Sheet=a),o&&(l.Comment=o),l}},40:{},42:{},43:{f:function(e,t,r){var n={};n.sz=e.read_shift(2)/20;var a=function(e){var t=e.read_shift(1);return e.l++,{fBold:1&t,fItalic:2&t,fUnderline:4&t,fStrikeout:8&t,fOutline:16&t,fShadow:32&t,fCondense:64&t,fExtend:128&t}}(e);switch(a.fItalic&&(n.italic=1),a.fCondense&&(n.condense=1),a.fExtend&&(n.extend=1),a.fShadow&&(n.shadow=1),a.fOutline&&(n.outline=1),a.fStrikeout&&(n.strike=1),700===e.read_shift(2)&&(n.bold=1),e.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript"}var i=e.read_shift(1);0!=i&&(n.underline=i);var s=e.read_shift(1);s>0&&(n.family=s);var o=e.read_shift(1);switch(o>0&&(n.charset=o),e.l++,n.color=function(e){var t={},r=e.read_shift(1)>>>1,n=e.read_shift(1),a=e.read_shift(2,"i"),i=e.read_shift(1),s=e.read_shift(1),o=e.read_shift(1);switch(e.l++,r){case 0:t.auto=1;break;case 1:t.index=n;var l=Zb[n];l&&(t.rgb=BE(l));break;case 2:t.rgb=BE([i,s,o]);break;case 3:t.theme=n}return 0!=a&&(t.tint=a>0?a/32767:a/32768),t}(e),e.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor"}return n.name=Ob(e),n}},44:{f:function(e,t){return[e.read_shift(2),Ob(e)]}},45:{f:rT},46:{f:nT},47:{f:function(e,t){var r=e.l+t,n=e.read_shift(2),a=e.read_shift(2);return e.l=r,{ixfe:n,numFmtId:a}}},48:{},49:{f:function(e){return e.read_shift(4,"i")}},50:{},51:{f:function(e){for(var t=[],r=e.read_shift(4);r-- >0;)t.push([e.read_shift(4),e.read_shift(4)]);return t}},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:sE},62:{f:function(e){return[Lb(e),Pb(e),"is"]}},63:{f:function(e){var t={};t.i=e.read_shift(4);var r={};r.r=e.read_shift(4),r.c=e.read_shift(4),t.r=Tb(r);var n=e.read_shift(1);return 2&n&&(t.l="1"),8&n&&(t.a="1"),t}},64:{f:function(){}},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:cb,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:function(e){var t=e.read_shift(2);return e.l+=28,{RTL:32&t}}},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:function(e,t){var r={},n=e[e.l];return++e.l,r.above=!(64&n),r.left=!(128&n),e.l+=18,r.name=Fb(e,t-19),r}},148:{f:I_,p:16},151:{f:function(){}},152:{},153:{f:function(e,t){var r={},n=e.read_shift(4);r.defaultThemeVersion=e.read_shift(4);var a=t>8?Ob(e):"";return a.length>0&&(r.CodeName=a),r.autoCompressPictures=!!(65536&n),r.backupFile=!!(64&n),r.checkCompatibility=!!(4096&n),r.date1904=!!(1&n),r.filterPrivacy=!!(8&n),r.hidePivotFieldList=!!(1024&n),r.promptedSolutions=!!(16&n),r.publishItems=!!(2048&n),r.refreshAllConnections=!!(262144&n),r.saveExternalLinkValues=!!(128&n),r.showBorderUnselectedTables=!!(4&n),r.showInkAnnotation=!!(32&n),r.showObjects=["all","placeholders","none"][n>>13&3],r.showPivotChartFilter=!!(32768&n),r.updateLinks=["userSet","never","always"][n>>8&3],r}},154:{},155:{},156:{f:function(e,t){var r={};return r.Hidden=e.read_shift(4),r.iTabID=e.read_shift(4),r.strRelID=Bb(e,t-8),r.name=Ob(e),r}},157:{},158:{},159:{T:1,f:function(e){return[e.read_shift(4),e.read_shift(4)]}},160:{T:-1},161:{T:1,f:Hb},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:R_},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:function(e,t){return{flags:e.read_shift(4),version:e.read_shift(4),name:Ob(e)}}},336:{T:-1},337:{f:function(e){return e.l+=4,0!=e.read_shift(4)},T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:Bb},357:{},358:{},359:{},360:{T:1},361:{},362:{f:nE},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:function(e,t,r){var n=e.l+t,a=jb(e),i=e.read_shift(1),s=[a];if(s[2]=i,r.cellFormula){var o=e_(e,n-e.l,r);s[1]=o}else e.l=n;return s}},427:{f:function(e,t,r){var n=e.l+t,a=[Hb(e,16)];if(r.cellFormula){var i=n_(e,n-e.l,r);a[1]=i,e.l=n}else e.l=n;return a}},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:function(e){var t={};return N_.forEach((function(r){t[r]=$b(e)})),t}},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:function(){}},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:function(e,t){var r=e.l+t,n=Hb(e,16),a=Ub(e),i=Ob(e),s=Ob(e),o=Ob(e);e.l=r;var l={rfx:n,relId:a,loc:i,display:o};return s&&(l.Tooltip=s),l}},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:Bb},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:vT},633:{T:1},634:{T:-1},635:{T:1,f:function(e){var t={};t.iauthor=e.read_shift(4);var r=Hb(e,16);return t.rfx=r.s,t.ref=Tb(r.s),e.l+=16,t}},636:{T:-1},637:{f:Db},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:function(e,t){return e.l+=10,{name:Ob(e)}}},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:function(){}},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},wS={6:{f:JT},10:{f:Cw},12:{f:Aw},13:{f:Aw},14:{f:Iw},15:{f:Iw},16:{f:$b},17:{f:Iw},18:{f:Iw},19:{f:Aw},20:{f:Zw},21:{f:Zw},23:{f:nE},24:{f:rE},25:{f:Iw},26:{},27:{},28:{f:function(e,t,r){return function(e,t,r){if(!(r.biff<8)){var n=e.read_shift(2),a=e.read_shift(2),i=e.read_shift(2),s=e.read_shift(2),o=Dw(e,0,r);return r.biff<8&&e.read_shift(1),[{r:n,c:a},o,s,i]}}(e,0,r)}},29:{},34:{f:Iw},35:{f:eE},38:{f:$b},39:{f:$b},40:{f:$b},41:{f:$b},42:{f:Iw},43:{f:Iw},47:{f:function(e,t,r){var n={Type:r.biff>=8?e.read_shift(2):0};return n.Type?UE(e,t-2,n):function(e,t,r,n){var a={key:Aw(e),verificationBytes:Aw(e)};r.password&&(a.verifier=LE(r.password)),n.valid=a.verificationBytes===a.verifier,n.valid&&(n.insitu=FE(r.password))}(e,r.biff,r,n),n}},49:{f:function(e,t,r){var n={dyHeight:e.read_shift(2),fl:e.read_shift(2)};switch(r&&r.biff||8){case 2:break;case 3:case 4:e.l+=2;break;default:e.l+=10}return n.name=Nw(e,0,r),n}},51:{f:Aw},60:{},61:{f:function(e){return{Pos:[e.read_shift(2),e.read_shift(2)],Dim:[e.read_shift(2),e.read_shift(2)],Flags:e.read_shift(2),CurTab:e.read_shift(2),FirstTab:e.read_shift(2),Selected:e.read_shift(2),TabRatio:e.read_shift(2)}}},64:{f:Iw},65:{f:function(){}},66:{f:Aw},77:{},80:{},81:{},82:{},85:{f:Aw},89:{},90:{},91:{},92:{f:function(e,t,r){if(r.enc)return e.l+=t,"";var n=e.l,a=Dw(e,0,r);return e.read_shift(t+n-e.l),a}},93:{f:function(e,t,r){if(r&&r.biff<8)return function(e,t,r){e.l+=4;var n=e.read_shift(2),a=e.read_shift(2),i=e.read_shift(2);e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=6,t-=36;var s=[];return s.push((iE[n]||cb)(e,t,r)),{cmo:[a,n,i],ft:s}}(e,t,r);var n=Ww(e),a=function(e,t){for(var r=e.l+t,n=[];e.l<r;){var a=e.read_shift(2);e.l-=2;try{n.push(Kw[a](e,r-e.l))}catch(Ok){return e.l=r,n}}return e.l!=r&&(e.l=r),n}(e,t-22,n[1]);return{cmo:n,ft:a}}},94:{},95:{f:Iw},96:{},97:{},99:{f:Iw},125:{f:sE},128:{f:function(e){e.l+=4;var t=[e.read_shift(2),e.read_shift(2)];if(0!==t[0]&&t[0]--,0!==t[1]&&t[1]--,t[0]>7||t[1]>7)throw new Error("Bad Gutters: "+t.join("|"));return t}},129:{f:function(e,t,r){var n=r&&8==r.biff||2==t?e.read_shift(2):(e.l+=t,0);return{fDialog:16&n,fBelow:64&n,fRight:128&n}}},130:{f:Aw},131:{f:Iw},132:{f:Iw},133:{f:function(e,t,r){var n=e.read_shift(4),a=3&e.read_shift(1),i=e.read_shift(1);switch(i){case 0:i="Worksheet";break;case 1:i="Macrosheet";break;case 2:i="Chartsheet";break;case 6:i="VBAModule"}var s=Nw(e,0,r);return 0===s.length&&(s="Sheet1"),{pos:n,hs:a,dt:i,name:s}}},134:{},140:{f:function(e){var t,r=[0,0];return t=e.read_shift(2),r[0]=Yb[t]||t,t=e.read_shift(2),r[1]=Yb[t]||t,r}},141:{f:Aw},144:{},146:{f:function(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(Uw(e));return r}},151:{},152:{},153:{},154:{},155:{},156:{f:Aw},157:{},158:{},160:{f:lE},161:{f:function(e,t){var r={};return t<32||(e.l+=16,r.header=$b(e),r.footer=$b(e),e.l+=2),r}},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:function(e,t){for(var r=e.l+t-2,n=e.read_shift(2),a=e.read_shift(2),i=[];e.l<r;)i.push(zw(e));if(e.l!==r)throw new Error("MulRK read error");var s=e.read_shift(2);if(i.length!=s-a+1)throw new Error("MulRK length mismatch");return{r:n,c:a,C:s,rkrec:i}}},190:{f:function(e,t){for(var r=e.l+t-2,n=e.read_shift(2),a=e.read_shift(2),i=[];e.l<r;)i.push(e.read_shift(2));if(e.l!==r)throw new Error("MulBlank read error");var s=e.read_shift(2);if(i.length!=s-a+1)throw new Error("MulBlank length mismatch");return{r:n,c:a,C:s,ixfe:i}}},193:{f:Cw},197:{},198:{},199:{},200:{},201:{},202:{f:Iw},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:Aw},220:{},221:{f:Iw},222:{},224:{f:function(e,t,r){var n={};return n.ifnt=e.read_shift(2),n.numFmtId=e.read_shift(2),n.flags=e.read_shift(2),n.fStyle=n.flags>>2&1,n.data=function(e,t,r,n){var a={},i=e.read_shift(4),s=e.read_shift(4),o=e.read_shift(4),l=e.read_shift(2);return a.patternType=Qb[o>>26],n.cellStyles?(a.alc=7&i,a.fWrap=i>>3&1,a.alcV=i>>4&7,a.fJustLast=i>>7&1,a.trot=i>>8&255,a.cIndent=i>>16&15,a.fShrinkToFit=i>>20&1,a.iReadOrder=i>>22&2,a.fAtrNum=i>>26&1,a.fAtrFnt=i>>27&1,a.fAtrAlc=i>>28&1,a.fAtrBdr=i>>29&1,a.fAtrPat=i>>30&1,a.fAtrProt=i>>31&1,a.dgLeft=15&s,a.dgRight=s>>4&15,a.dgTop=s>>8&15,a.dgBottom=s>>12&15,a.icvLeft=s>>16&127,a.icvRight=s>>23&127,a.grbitDiag=s>>30&3,a.icvTop=127&o,a.icvBottom=o>>7&127,a.icvDiag=o>>14&127,a.dgDiag=o>>21&15,a.icvFore=127&l,a.icvBack=l>>7&127,a.fsxButton=l>>14&1,a):a}(e,0,n.fStyle,r),n}},225:{f:function(e,t){return 0===t||e.read_shift(2),1200}},226:{f:Cw},227:{},229:{f:function(e,t){for(var r=[],n=e.read_shift(2);n--;)r.push(jw(e));return r}},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:function(e,t){for(var r=e.l+t,n=e.read_shift(4),a=e.read_shift(4),i=[],s=0;s!=a&&e.l<r;++s)i.push(Ow(e));return i.Count=n,i.Unique=a,i}},253:{f:function(e){var t=Vw(e);return t.isst=e.read_shift(4),t}},255:{f:function(e,t){var r={};return r.dsst=e.read_shift(2),e.l+=t-2,r}},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:Rw},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:Iw},353:{f:Cw},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:function(e,t,r){var n=e.l+t,a=e.read_shift(2),i=e.read_shift(2);if(r.sbcch=i,1025==i||14849==i)return[i,a];if(i<1||i>255)throw new Error("Unexpected SupBook type: "+i);for(var s=xw(e,i),o=[];n>e.l;)o.push(Pw(e));return[i,a,s,o]}},431:{f:Iw},432:{},433:{},434:{},437:{},438:{f:function(e,t,r){var n=e.l,a="";try{e.l+=4;var i=(r.lastobj||{cmo:[0,0]}).cmo[1];-1==[0,5,7,11,12,14].indexOf(i)?e.l+=6:function(e){var t=e.read_shift(1);e.l++;var r=e.read_shift(2);return e.l+=2,[t,r]}(e);var s=e.read_shift(2);e.read_shift(2),Aw(e);var o=e.read_shift(2);e.l+=o;for(var l=1;l<e.lens.length-1;++l){if(e.l-n!=e.lens[l])throw new Error("TxO: bad continue record");var c=e[e.l];if((a+=xw(e,e.lens[l+1]-e.lens[l]-1)).length>=(c?s:2*s))break}if(a.length!==s&&a.length!==2*s)throw new Error("cchText: "+s+" != "+a.length);return e.l=n+t,{t:a}}catch(Ok){return e.l=n+t,{t:a}}}},439:{f:Iw},440:{f:function(e,t){var r=jw(e);e.l+=16;var n=function(e,t){var r=e.l+t,n=e.read_shift(4);if(2!==n)throw new Error("Unrecognized streamVersion: "+n);var a=e.read_shift(2);e.l+=2;var i,s,o,l,c,u,h="";16&a&&(i=Mw(e,e.l)),128&a&&(s=Mw(e,e.l)),257===(257&a)&&(o=Mw(e,e.l)),1===(257&a)&&(l=Lw(e,e.l)),8&a&&(h=Mw(e,e.l)),32&a&&(c=e.read_shift(16)),64&a&&(u=mw(e)),e.l=r;var f=s||o||l||"";f&&h&&(f+="#"+h),f||(f="#"+h),2&a&&"/"==f.charAt(0)&&"/"!=f.charAt(1)&&(f="file://"+f);var d={Target:f};return c&&(d.guid=c),u&&(d.time=u),i&&(d.Tooltip=i),d}(e,t-24);return[r,n]}},441:{},442:{f:Pw},443:{},444:{f:Aw},445:{},446:{},448:{f:Cw},449:{f:function(e){return e.read_shift(2),e.read_shift(4)},r:2},450:{f:Cw},512:{f:Qw},513:{f:oE},515:{f:function(e,t,r){r.biffguess&&2==r.biff&&(r.biff=5);var n=Vw(e),a=$b(e);return n.val=a,n}},516:{f:function(e,t,r){r.biffguess&&2==r.biff&&(r.biff=5),e.l;var n=Vw(e);2==r.biff&&e.l++;var a=Pw(e,e.l,r);return n.val=a,n}},517:{f:Jw},519:{f:cE},520:{f:function(e){var t={};t.r=e.read_shift(2),t.c=e.read_shift(2),t.cnt=e.read_shift(2)-t.c;var r=e.read_shift(2);e.l+=4;var n=e.read_shift(1);return e.l+=3,7&n&&(t.level=7&n),32&n&&(t.hidden=!0),64&n&&(t.hpt=r/20),t}},523:{},545:{f:aE},549:{f:Xw},566:{},574:{f:function(e,t,r){return r&&r.biff>=2&&r.biff<5?{}:{RTL:64&e.read_shift(2)}}},638:{f:function(e){var t=e.read_shift(2),r=e.read_shift(2),n=zw(e);return{r:t,c:r,ixfe:n[0],rknum:n[1]}}},659:{},1048:{},1054:{f:function(e,t,r){return[e.read_shift(2),Dw(e,0,r)]}},1084:{},1212:{f:function(e,t,r){var n=Hw(e);e.l++;var a=e.read_shift(1);return[QT(e,t-=8,r),a,n]}},2048:{f:function(e,t){e.read_shift(2);var r=jw(e),n=e.read_shift((t-10)/2,"dbcs-cont");return[r,n=n.replace(bg,"")]}},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:qw},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:Cw},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:function(e){e.l+=2;var t={cxfs:0,crc:0};return t.cxfs=e.read_shift(2),t.crc=e.read_shift(4),t},r:12},2173:{f:function(e,t){e.l,e.l+=2;var r=e.read_shift(2);e.l+=2;for(var n=e.read_shift(2),a=[];n-- >0;)a.push(mT(e,e.l));return{ixfe:r,ext:a}},r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:Iw,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:function(e,t,r){if(!(r.biff<8)){var n=e.read_shift(2),a=e.read_shift(2);return[xw(e,n,r),xw(e,a,r)]}e.l+=t},r:12},2197:{},2198:{f:function(e,t,r){var n=e.l+t;if(124226!==e.read_shift(4))if(r.cellStyles){var a,i=e.slice(e.l);e.l=n;try{a=Wv(i,{type:"array"})}catch(Ok){return}var s=zv(a,"theme/theme/theme1.xml",!0);if(s)return fT(s,r)}else e.l=n},r:12},2199:{},2200:{},2201:{},2202:{f:function(e){return[0!==e.read_shift(4),0!==e.read_shift(4),e.read_shift(4)]},r:12},2203:{f:Cw},2204:{},2205:{},2206:{},2207:{},2211:{f:function(e){var t=function(e){var t=e.read_shift(2),r=e.read_shift(2);return e.l+=8,{type:t,flags:r}}(e);if(2211!=t.type)throw new Error("Invalid Future Record "+t.type);return 0!==e.read_shift(4)}},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:Aw},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:function(e,t,r){var n={area:!1};if(5!=r.biff)return e.l+=t,n;var a=e.read_shift(1);return e.l+=3,16&a&&(n.area=!0),n}},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:function(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(Uw(e));return r}},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:Qw},1:{},2:{f:function(e){var t=Vw(e);++e.l;var r=e.read_shift(2);return t.t="n",t.val=r,t}},3:{f:function(e){var t=Vw(e);++e.l;var r=$b(e);return t.t="n",t.val=r,t}},4:{f:function(e,t,r){r.biffguess&&5==r.biff&&(r.biff=2);var n=Vw(e);++e.l;var a=Dw(e,0,r);return n.t="str",n.val=a,n}},5:{f:Jw},7:{f:function(e){var t=e.read_shift(1);return 0===t?(e.l++,""):e.read_shift(t,"sbcs-cont")}},8:{},9:{f:qw},11:{},22:{f:Aw},30:{f:Yw},31:{},32:{},33:{f:aE},36:{},37:{f:Xw},50:{f:function(e,t){e.l+=6,e.l+=2,e.l+=1,e.l+=3,e.l+=1,e.l+=t-13}},62:{},52:{},67:{},68:{f:Aw},69:{},86:{},126:{},127:{f:function(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),a={fmt:t,env:r,len:n,data:e.slice(e.l,e.l+n)};return e.l+=n,a}},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:function(e,t,r){var n=e.l+t,a=Vw(e),i=e.read_shift(2),s=xw(e,i,r);return e.l=n,a.t="str",a.val=s,a}},223:{},234:{},354:{},421:{},518:{f:JT},521:{f:qw},536:{f:rE},547:{f:eE},561:{},579:{},1030:{f:JT},1033:{f:qw},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function ES(e,t,r,n){var a=t;if(!isNaN(a)){var i=n||(r||[]).length||0,s=e.next(4);s.write_shift(2,a),s.write_shift(2,i),i>0&&qy(r)&&e.push(r)}}function TS(e,t){var r=t||{};var n=r.dense?[]:{},a=(e=e.replace(/<!--.*?-->/g,"")).match(/<table/i);if(!a)throw new Error("Invalid HTML: could not find <table>");var i=e.match(/<\/table/i),s=a.index,o=i&&i.index||e.length,l=Lv(e.slice(s,o),/(:?<tr[^>]*>)/i,"<tr>"),c=-1,u=0,h=0,f=0,d={s:{r:1e7,c:1e7},e:{r:0,c:0}},p=[];for(s=0;s<l.length;++s){var m=l[s].trim(),g=m.slice(0,3).toLowerCase();if("<tr"!=g){if("<td"==g||"<th"==g){var v=m.split(/<\/t[dh]>/i);for(o=0;o<v.length;++o){var y=v[o].trim();if(y.match(/<t[dh]/i)){for(var b=y,w=0;"<"==b.charAt(0)&&(w=b.indexOf(">"))>-1;)b=b.slice(w+1);for(var E=0;E<p.length;++E){var T=p[E];T.s.c==u&&T.s.r<c&&c<=T.e.r&&(u=T.e.c+1,E=-1)}var _=Zv(y.slice(0,y.indexOf(">")));f=_.colspan?+_.colspan:1,((h=+_.rowspan)>1||f>1)&&p.push({s:{r:c,c:u},e:{r:c+(h||1)-1,c:u+f-1}});var S=_.t||_["data-t"]||"";if(b.length)if(b=gy(b),d.s.r>c&&(d.s.r=c),d.e.r<c&&(d.e.r=c),d.s.c>u&&(d.s.c=u),d.e.c<u&&(d.e.c=u),b.length){var k={t:"s",v:b};r.raw||!b.trim().length||"s"==S||("TRUE"===b?k={t:"b",v:!0}:"FALSE"===b?k={t:"b",v:!1}:isNaN(xv(b))?isNaN(Dv(b).getDate())||(k={t:"d",v:Av(b)},r.cellDates||(k={t:"n",v:bv(k.v)}),k.z=r.dateNF||Ng[14]):k={t:"n",v:xv(b)}),r.dense?(n[c]||(n[c]=[]),n[c][u]=k):n[Tb({r:c,c:u})]=k,u+=f}else u+=f;else u+=f}}}}else{if(++c,r.sheetRows&&r.sheetRows<=c){--c;break}u=0}}return n["!ref"]=Sb(d),p.length&&(n["!merges"]=p),n}function _S(e,t,r,n){for(var a=e["!merges"]||[],i=[],s=t.s.c;s<=t.e.c;++s){for(var o=0,l=0,c=0;c<a.length;++c)if(!(a[c].s.r>r||a[c].s.c>s)&&!(a[c].e.r<r||a[c].e.c<s)){if(a[c].s.r<r||a[c].s.c<s){o=-1;break}o=a[c].e.r-a[c].s.r+1,l=a[c].e.c-a[c].s.c+1;break}if(!(o<0)){var u=Tb({r:r,c:s}),h=n.dense?(e[r]||[])[s]:e[u],f=h&&null!=h.v&&(h.h||sy(h.w||(Ib(h),h.w)||""))||"",d={};o>1&&(d.rowspan=o),l>1&&(d.colspan=l),n.editable?f='<span contenteditable="true">'+f+"</span>":h&&(d["data-t"]=h&&h.t||"z",null!=h.v&&(d["data-v"]=h.v),null!=h.z&&(d["data-z"]=h.z),h.l&&"#"!=(h.l.Target||"#").charAt(0)&&(f='<a href="'+h.l.Target+'">'+f+"</a>")),d.id=(n.id||"sjs")+"-"+u,i.push(_y("td",f,d))}}return"<tr>"+i.join("")+"</tr>"}var SS='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',kS="</body></html>";function CS(e,t,r){return[].join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function IS(e,t){var r=t||{},n=null!=r.header?r.header:SS,a=null!=r.footer?r.footer:kS,i=[n],s=_b(e["!ref"]);r.dense=Array.isArray(e),i.push(CS(0,0,r));for(var o=s.s.r;o<=s.e.r;++o)i.push(_S(e,s,o,r));return i.push("</table>"+a),i.join("")}function AS(e,t,r){var n=r||{};var a=0,i=0;if(null!=n.origin)if("number"==typeof n.origin)a=n.origin;else{var s="string"==typeof n.origin?Eb(n.origin):n.origin;a=s.r,i=s.c}var o=t.getElementsByTagName("tr"),l=Math.min(n.sheetRows||1e7,o.length),c={s:{r:0,c:0},e:{r:a,c:i}};if(e["!ref"]){var u=_b(e["!ref"]);c.s.r=Math.min(c.s.r,u.s.r),c.s.c=Math.min(c.s.c,u.s.c),c.e.r=Math.max(c.e.r,u.e.r),c.e.c=Math.max(c.e.c,u.e.c),-1==a&&(c.e.r=a=u.e.r+1)}var h=[],f=0,d=e["!rows"]||(e["!rows"]=[]),p=0,m=0,g=0,v=0,y=0,b=0;for(e["!cols"]||(e["!cols"]=[]);p<o.length&&m<l;++p){var w=o[p];if(NS(w)){if(n.display)continue;d[m]={hidden:!0}}var E=w.children;for(g=v=0;g<E.length;++g){var T=E[g];if(!n.display||!NS(T)){var _=T.hasAttribute("data-v")?T.getAttribute("data-v"):T.hasAttribute("v")?T.getAttribute("v"):gy(T.innerHTML),S=T.getAttribute("data-z")||T.getAttribute("z");for(f=0;f<h.length;++f){var k=h[f];k.s.c==v+i&&k.s.r<m+a&&m+a<=k.e.r&&(v=k.e.c+1-i,f=-1)}b=+T.getAttribute("colspan")||1,((y=+T.getAttribute("rowspan")||1)>1||b>1)&&h.push({s:{r:m+a,c:v+i},e:{r:m+a+(y||1)-1,c:v+i+(b||1)-1}});var C={t:"s",v:_},I=T.getAttribute("data-t")||T.getAttribute("t")||"";null!=_&&(0==_.length?C.t=I||"z":n.raw||0==_.trim().length||"s"==I||("TRUE"===_?C={t:"b",v:!0}:"FALSE"===_?C={t:"b",v:!1}:isNaN(xv(_))?isNaN(Dv(_).getDate())||(C={t:"d",v:Av(_)},n.cellDates||(C={t:"n",v:bv(C.v)}),C.z=n.dateNF||Ng[14]):C={t:"n",v:xv(_)})),void 0===C.z&&null!=S&&(C.z=S);var A="",R=T.getElementsByTagName("A");if(R&&R.length)for(var N=0;N<R.length&&(!R[N].hasAttribute("href")||"#"==(A=R[N].getAttribute("href")).charAt(0));++N);A&&"#"!=A.charAt(0)&&(C.l={Target:A}),n.dense?(e[m+a]||(e[m+a]=[]),e[m+a][v+i]=C):e[Tb({c:v+i,r:m+a})]=C,c.e.c<v+i&&(c.e.c=v+i),v+=b}}++m}return h.length&&(e["!merges"]=(e["!merges"]||[]).concat(h)),c.e.r=Math.max(c.e.r,m-1+a),e["!ref"]=Sb(c),m>=l&&(e["!fullref"]=Sb((c.e.r=o.length-p+m-1+a,c))),e}function RS(e,t){return AS((t||{}).dense?[]:{},e,t)}function NS(e){var t="",r=function(e){return e.ownerDocument.defaultView&&"function"===typeof e.ownerDocument.defaultView.getComputedStyle?e.ownerDocument.defaultView.getComputedStyle:"function"===typeof getComputedStyle?getComputedStyle:null}(e);return r&&(t=r(e).getPropertyValue("display")),t||(t=e.style&&e.style.display),"none"===t}function OS(e){var t=e.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,(function(e,t){return Array(parseInt(t,10)+1).join(" ")})).replace(/<text:tab[^>]*\/>/g,"\t").replace(/<text:line-break\/>/g,"\n");return[ny(t.replace(/<[^>]*>/g,""))]}var xS={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function PS(e,t){var r=t||{};var n,a,i,s,o,l,c=Sy(e),u=[],h={name:""},f="",d=0,p={},m=[],g=r.dense?[]:{},v={value:""},y="",b=0,w=[],E=-1,T=-1,_={s:{r:1e6,c:1e7},e:{r:0,c:0}},S=0,k={},C=[],I={},A=[],R=1,N=1,O=[],x={Names:[]},P={},D=["",""],L=[],M={},F="",U=0,V=!1,B=!1,z=0;for(ky.lastIndex=0,c=c.replace(/<!--([\s\S]*?)-->/gm,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");o=ky.exec(c);)switch(o[3]=o[3].replace(/_.*$/,"")){case"table":case"\u5de5\u4f5c\u8868":"/"===o[1]?(_.e.c>=_.s.c&&_.e.r>=_.s.r?g["!ref"]=Sb(_):g["!ref"]="A1:A1",r.sheetRows>0&&r.sheetRows<=_.e.r&&(g["!fullref"]=g["!ref"],_.e.r=r.sheetRows-1,g["!ref"]=Sb(_)),C.length&&(g["!merges"]=C),A.length&&(g["!rows"]=A),i.name=i["\u540d\u79f0"]||i.name,"undefined"!==typeof JSON&&JSON.stringify(i),m.push(i.name),p[i.name]=g,B=!1):"/"!==o[0].charAt(o[0].length-2)&&(i=Zv(o[0],!1),E=T=-1,_.s.r=_.s.c=1e7,_.e.r=_.e.c=0,g=r.dense?[]:{},C=[],A=[],B=!0);break;case"table-row-group":"/"===o[1]?--S:++S;break;case"table-row":case"\u884c":if("/"===o[1]){E+=R,R=1;break}if((s=Zv(o[0],!1))["\u884c\u53f7"]?E=s["\u884c\u53f7"]-1:-1==E&&(E=0),(R=+s["number-rows-repeated"]||1)<10)for(z=0;z<R;++z)S>0&&(A[E+z]={level:S});T=-1;break;case"covered-table-cell":"/"!==o[1]&&++T,r.sheetStubs&&(r.dense?(g[E]||(g[E]=[]),g[E][T]={t:"z"}):g[Tb({r:E,c:T})]={t:"z"}),y="",w=[];break;case"table-cell":case"\u6570\u636e":if("/"===o[0].charAt(o[0].length-2))++T,v=Zv(o[0],!1),N=parseInt(v["number-columns-repeated"]||"1",10),l={t:"z",v:null},v.formula&&0!=r.cellFormula&&(l.f=o_(ny(v.formula))),"string"==(v["\u6570\u636e\u7c7b\u578b"]||v["value-type"])&&(l.t="s",l.v=ny(v["string-value"]||""),r.dense?(g[E]||(g[E]=[]),g[E][T]=l):g[Tb({r:E,c:T})]=l),T+=N-1;else if("/"!==o[1]){y="",b=0,w=[],N=1;var j=R?E+R-1:E;if(++T>_.e.c&&(_.e.c=T),T<_.s.c&&(_.s.c=T),E<_.s.r&&(_.s.r=E),j>_.e.r&&(_.e.r=j),L=[],M={},l={t:(v=Zv(o[0],!1))["\u6570\u636e\u7c7b\u578b"]||v["value-type"],v:null},r.cellFormula)if(v.formula&&(v.formula=ny(v.formula)),v["number-matrix-columns-spanned"]&&v["number-matrix-rows-spanned"]&&(I={s:{r:E,c:T},e:{r:E+(parseInt(v["number-matrix-rows-spanned"],10)||0)-1,c:T+(parseInt(v["number-matrix-columns-spanned"],10)||0)-1}},l.F=Sb(I),O.push([I,l.F])),v.formula)l.f=o_(v.formula);else for(z=0;z<O.length;++z)E>=O[z][0].s.r&&E<=O[z][0].e.r&&T>=O[z][0].s.c&&T<=O[z][0].e.c&&(l.F=O[z][1]);switch((v["number-columns-spanned"]||v["number-rows-spanned"])&&(I={s:{r:E,c:T},e:{r:E+(parseInt(v["number-rows-spanned"],10)||0)-1,c:T+(parseInt(v["number-columns-spanned"],10)||0)-1}},C.push(I)),v["number-columns-repeated"]&&(N=parseInt(v["number-columns-repeated"],10)),l.t){case"boolean":l.t="b",l.v=ly(v["boolean-value"]);break;case"float":case"percentage":case"currency":l.t="n",l.v=parseFloat(v.value);break;case"date":l.t="d",l.v=Av(v["date-value"]),r.cellDates||(l.t="n",l.v=bv(l.v)),l.z="m/d/yy";break;case"time":l.t="n",l.v=Sv(v["time-value"])/86400,r.cellDates&&(l.t="d",l.v=_v(l.v)),l.z="HH:MM:SS";break;case"number":l.t="n",l.v=parseFloat(v["\u6570\u636e\u6570\u503c"]);break;default:if("string"!==l.t&&"text"!==l.t&&l.t)throw new Error("Unsupported value type "+l.t);l.t="s",null!=v["string-value"]&&(y=ny(v["string-value"]),w=[])}}else{if(V=!1,"s"===l.t&&(l.v=y||"",w.length&&(l.R=w),V=0==b),P.Target&&(l.l=P),L.length>0&&(l.c=L,L=[]),y&&!1!==r.cellText&&(l.w=y),V&&(l.t="z",delete l.v),(!V||r.sheetStubs)&&!(r.sheetRows&&r.sheetRows<=E))for(var H=0;H<R;++H){if(N=parseInt(v["number-columns-repeated"]||"1",10),r.dense)for(g[E+H]||(g[E+H]=[]),g[E+H][T]=0==H?l:Nv(l);--N>0;)g[E+H][T+N]=Nv(l);else for(g[Tb({r:E+H,c:T})]=l;--N>0;)g[Tb({r:E+H,c:T+N})]=Nv(l);_.e.c<=T&&(_.e.c=T)}T+=(N=parseInt(v["number-columns-repeated"]||"1",10))-1,N=0,l={},y="",w=[]}P={};break;case"document":case"document-content":case"\u7535\u5b50\u8868\u683c\u6587\u6863":case"spreadsheet":case"\u4e3b\u4f53":case"scripts":case"styles":case"font-face-decls":case"master-styles":if("/"===o[1]){if((n=u.pop())[0]!==o[3])throw"Bad state: "+n}else"/"!==o[0].charAt(o[0].length-2)&&u.push([o[3],!0]);break;case"annotation":if("/"===o[1]){if((n=u.pop())[0]!==o[3])throw"Bad state: "+n;M.t=y,w.length&&(M.R=w),M.a=F,L.push(M)}else"/"!==o[0].charAt(o[0].length-2)&&u.push([o[3],!1]);F="",U=0,y="",b=0,w=[];break;case"creator":"/"===o[1]?F=c.slice(U,o.index):U=o.index+o[0].length;break;case"meta":case"\u5143\u6570\u636e":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if("/"===o[1]){if((n=u.pop())[0]!==o[3])throw"Bad state: "+n}else"/"!==o[0].charAt(o[0].length-2)&&u.push([o[3],!1]);y="",b=0,w=[];break;case"scientific-number":case"currency-symbol":case"currency-style":case"script":case"libraries":case"automatic-styles":case"default-style":case"page-layout":case"style":case"map":case"font-face":case"paragraph-properties":case"table-properties":case"table-column-properties":case"table-row-properties":case"table-cell-properties":case"fraction":case"boolean-style":case"boolean":case"text-style":case"text-content":case"text-properties":case"embedded-text":case"body":case"\u7535\u5b50\u8868\u683c":case"forms":case"table-column":case"table-header-rows":case"table-rows":case"table-column-group":case"table-header-columns":case"table-columns":case"null-date":case"graphic-properties":case"calculation-settings":case"named-expressions":case"label-range":case"label-ranges":case"named-expression":case"sort":case"sort-by":case"sort-groups":case"tab":case"line-break":case"span":case"s":case"date":case"object":case"title":case"\u6807\u9898":case"desc":case"binary-data":case"table-source":case"scenario":case"iteration":case"content-validations":case"content-validation":case"help-message":case"error-message":case"database-ranges":case"filter":case"filter-and":case"filter-or":case"filter-condition":case"list-level-style-bullet":case"list-level-style-number":case"list-level-properties":case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":case"event-listener":case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":case"config-item":case"page-number":case"page-count":case"time":case"cell-range-source":case"detective":case"operation":case"highlighted-range":case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":case"rect":case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":case"properties":case"property":case"table-protection":case"data-pilot-grand-total":case"office-document-common-attrs":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if("/"===o[1]){if(k[h.name]=f,(n=u.pop())[0]!==o[3])throw"Bad state: "+n}else"/"!==o[0].charAt(o[0].length-2)&&(f="",h=Zv(o[0],!1),u.push([o[3],!0]));break;case"number":case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(u[u.length-1][0]){case"time-style":case"date-style":a=Zv(o[0],!1),f+=xS[o[3]]["long"===a.style?1:0]}break;case"text":if("/>"===o[0].slice(-2))break;if("/"===o[1])switch(u[u.length-1][0]){case"number-style":case"date-style":case"time-style":f+=c.slice(d,o.index)}else d=o.index+o[0].length;break;case"named-range":D=l_((a=Zv(o[0],!1))["cell-range-address"]);var $={Name:a.name,Ref:D[0]+"!"+D[1]};B&&($.Sheet=m.length),x.Names.push($);break;case"p":case"\u6587\u672c\u4e32":if(["master-styles"].indexOf(u[u.length-1][0])>-1)break;if("/"!==o[1]||v&&v["string-value"])Zv(o[0],!1),b=o.index+o[0].length;else{var W=OS(c.slice(b,o.index));y=(y.length>0?y+"\n":"")+W[0]}break;case"database-range":if("/"===o[1])break;try{p[(D=l_(Zv(o[0])["target-range-address"]))[0]]["!autofilter"]={ref:D[1]}}catch(Ok){}break;case"a":if("/"!==o[1]){if(!(P=Zv(o[0],!1)).href)break;P.Target=ny(P.href),delete P.href,"#"==P.Target.charAt(0)&&P.Target.indexOf(".")>-1?(D=l_(P.Target.slice(1)),P.Target="#"+D[0]+"!"+D[1]):P.Target.match(/^\.\.[\\\/]/)&&(P.Target=P.Target.slice(3))}break;default:switch(o[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case"\u8868:":case"\u5b57:":break;default:if(r.WTF)throw new Error(o)}}var G={Sheets:p,SheetNames:m,Workbook:x};return r.bookSheets&&delete G.Sheets,G}function DS(e,t){t=t||{},Uv(e,"META-INF/manifest.xml")&&function(e,t){for(var r,n,a=Sy(e);r=ky.exec(a);)switch(r[3]){case"manifest":break;case"file-entry":if("/"==(n=Zv(r[0],!1)).path&&"application/vnd.oasis.opendocument.spreadsheet"!==n.type)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(t&&t.WTF)throw r}}(Bv(e,"META-INF/manifest.xml"),t);var r=zv(e,"content.xml");if(!r)throw new Error("Missing content.xml in ODS / UOF file");var n=PS(dy(r),t);return Uv(e,"meta.xml")&&(n.Props=lw(Bv(e,"meta.xml"))),n}function LS(e,t){return PS(e,t)}function MS(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function FS(e){return"undefined"!=typeof TextDecoder?(new TextDecoder).decode(e):dy(gg(e))}function US(e){var t=e.reduce((function(e,t){return e+t.length}),0),r=new Uint8Array(t),n=0;return e.forEach((function(e){r.set(e,n),n+=e.length})),r}function VS(e){return 16843009*((e=(858993459&(e-=e>>1&1431655765))+(e>>2&858993459))+(e>>4)&252645135)>>>24}function BS(e,t){var r=t?t[0]:0,n=127&e[r];e:if(e[r++]>=128){if(n|=(127&e[r])<<7,e[r++]<128)break e;if(n|=(127&e[r])<<14,e[r++]<128)break e;if(n|=(127&e[r])<<21,e[r++]<128)break e;if(n+=(127&e[r])*Math.pow(2,28),++r,e[r++]<128)break e;if(n+=(127&e[r])*Math.pow(2,35),++r,e[r++]<128)break e;if(n+=(127&e[r])*Math.pow(2,42),++r,e[r++]<128)break e}return t&&(t[0]=r),n}function zS(e){var t=0,r=127&e[t];e:if(e[t++]>=128){if(r|=(127&e[t])<<7,e[t++]<128)break e;if(r|=(127&e[t])<<14,e[t++]<128)break e;if(r|=(127&e[t])<<21,e[t++]<128)break e;r|=(127&e[t])<<28}return r}function jS(e){for(var t=[],r=[0];r[0]<e.length;){var n,a=r[0],i=BS(e,r),s=7&i,o=0;if(0==(i=Math.floor(i/8)))break;switch(s){case 0:for(var l=r[0];e[r[0]++]>=128;);n=e.slice(l,r[0]);break;case 5:o=4,n=e.slice(r[0],r[0]+o),r[0]+=o;break;case 1:o=8,n=e.slice(r[0],r[0]+o),r[0]+=o;break;case 2:o=BS(e,r),n=e.slice(r[0],r[0]+o),r[0]+=o;break;default:throw new Error("PB Type ".concat(s," for Field ").concat(i," at offset ").concat(a))}var c={data:n,type:s};null==t[i]?t[i]=[c]:t[i].push(c)}return t}function HS(e,t){return(null==e?void 0:e.map((function(e){return t(e.data)})))||[]}function $S(e){for(var t,r=[],n=[0];n[0]<e.length;){var a=BS(e,n),i=jS(e.slice(n[0],n[0]+a));n[0]+=a;var s={id:zS(i[1][0].data),messages:[]};i[2].forEach((function(t){var r=jS(t.data),a=zS(r[3][0].data);s.messages.push({meta:r,data:e.slice(n[0],n[0]+a)}),n[0]+=a})),(null==(t=i[3])?void 0:t[0])&&(s.merge=zS(i[3][0].data)>>>0>0),r.push(s)}return r}function WS(e,t){if(0!=e)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var r=[0],n=BS(t,r),a=[];r[0]<t.length;){var i=3&t[r[0]];if(0!=i){var s=0,o=0;if(1==i?(o=4+(t[r[0]]>>2&7),s=(224&t[r[0]++])<<3,s|=t[r[0]++]):(o=1+(t[r[0]++]>>2),2==i?(s=t[r[0]]|t[r[0]+1]<<8,r[0]+=2):(s=(t[r[0]]|t[r[0]+1]<<8|t[r[0]+2]<<16|t[r[0]+3]<<24)>>>0,r[0]+=4)),a=[US(a)],0==s)throw new Error("Invalid offset 0");if(s>a[0].length)throw new Error("Invalid offset beyond length");if(o>=s)for(a.push(a[0].slice(-s)),o-=s;o>=a[a.length-1].length;)a.push(a[a.length-1]),o-=a[a.length-1].length;a.push(a[0].slice(-s,-s+o))}else{var l=t[r[0]++]>>2;if(l<60)++l;else{var c=l-59;l=t[r[0]],c>1&&(l|=t[r[0]+1]<<8),c>2&&(l|=t[r[0]+2]<<16),c>3&&(l|=t[r[0]+3]<<24),l>>>=0,l++,r[0]+=c}a.push(t.slice(r[0],r[0]+l)),r[0]+=l}}var u=US(a);if(u.length!=n)throw new Error("Unexpected length: ".concat(u.length," != ").concat(n));return u}function GS(e){for(var t=[],r=0;r<e.length;){var n=e[r++],a=e[r]|e[r+1]<<8|e[r+2]<<16;r+=3,t.push(WS(n,e.slice(r,r+a))),r+=a}if(r!==e.length)throw new Error("data is not a valid framed stream!");return US(t)}function KS(e,t,r){var n,a=MS(e),i=a.getUint32(8,!0),s=12,o=-1,l=-1,c=NaN,u=NaN,h=new Date(2001,0,1);switch(1&i&&(c=function(e,t){for(var r=(127&e[t+15])<<7|e[t+14]>>1,n=1&e[t+14],a=t+13;a>=t;--a)n=256*n+e[a];return(128&e[t+15]?-n:n)*Math.pow(10,r-6176)}(e,s),s+=16),2&i&&(u=a.getFloat64(s,!0),s+=8),4&i&&(h.setTime(h.getTime()+1e3*a.getFloat64(s,!0)),s+=8),8&i&&(l=a.getUint32(s,!0),s+=4),16&i&&(o=a.getUint32(s,!0),s+=4),e[1]){case 0:break;case 2:case 10:n={t:"n",v:c};break;case 3:n={t:"s",v:t[l]};break;case 5:n={t:"d",v:h};break;case 6:n={t:"b",v:u>0};break;case 7:n={t:"n",v:u/86400};break;case 8:n={t:"e",v:0};break;case 9:if(!(o>-1))throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(31&i," : ").concat(e.slice(0,4)));n={t:"s",v:r[o]};break;default:throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(31&i," : ").concat(e.slice(0,4)))}return n}function qS(e,t,r){switch(e[0]){case 0:case 1:case 2:case 3:return function(e,t,r,n){var a,i=MS(e),s=i.getUint32(4,!0),o=(n>1?12:8)+4*VS(s&(n>1?3470:398)),l=-1,c=-1,u=NaN,h=new Date(2001,0,1);switch(512&s&&(l=i.getUint32(o,!0),o+=4),o+=4*VS(s&(n>1?12288:4096)),16&s&&(c=i.getUint32(o,!0),o+=4),32&s&&(u=i.getFloat64(o,!0),o+=8),64&s&&(h.setTime(h.getTime()+1e3*i.getFloat64(o,!0)),o+=8),e[2]){case 0:break;case 2:a={t:"n",v:u};break;case 3:a={t:"s",v:t[c]};break;case 5:a={t:"d",v:h};break;case 6:a={t:"b",v:u>0};break;case 7:a={t:"n",v:u/86400};break;case 8:a={t:"e",v:0};break;case 9:if(l>-1)a={t:"s",v:r[l]};else if(c>-1)a={t:"s",v:t[c]};else{if(isNaN(u))throw new Error("Unsupported cell type ".concat(e.slice(0,4)));a={t:"n",v:u}}break;default:throw new Error("Unsupported cell type ".concat(e.slice(0,4)))}return a}(e,t,r,e[0]);case 5:return KS(e,t,r);default:throw new Error("Unsupported payload version ".concat(e[0]))}}function XS(e){return BS(jS(e)[1][0].data)}function YS(e,t){var r=jS(t.data),n=zS(r[1][0].data),a=r[3],i=[];return(a||[]).forEach((function(t){var r=jS(t.data),a=zS(r[1][0].data)>>>0;switch(n){case 1:i[a]=FS(r[3][0].data);break;case 8:var s=jS(e[XS(r[9][0].data)][0].data),o=e[XS(s[1][0].data)][0],l=zS(o.meta[1][0].data);if(2001!=l)throw new Error("2000 unexpected reference to ".concat(l));var c=jS(o.data);i[a]=c[3].map((function(e){return FS(e.data)})).join("")}})),i}function QS(e,t){var r,n=jS(t.data),a=(null==(r=null==n?void 0:n[7])?void 0:r[0])?zS(n[7][0].data)>>>0>0?1:0:-1,i=HS(n[5],(function(e){return function(e,t){var r,n,a,i,s,o,l,c,u,h,f,d,p,m,g,v,y=jS(e),b=zS(y[1][0].data)>>>0,w=zS(y[2][0].data)>>>0,E=(null==(n=null==(r=y[8])?void 0:r[0])?void 0:n.data)&&zS(y[8][0].data)>0||!1;if((null==(i=null==(a=y[7])?void 0:a[0])?void 0:i.data)&&0!=t)g=null==(o=null==(s=y[7])?void 0:s[0])?void 0:o.data,v=null==(c=null==(l=y[6])?void 0:l[0])?void 0:c.data;else{if(!(null==(h=null==(u=y[4])?void 0:u[0])?void 0:h.data)||1==t)throw"NUMBERS Tile missing ".concat(t," cell storage");g=null==(d=null==(f=y[4])?void 0:f[0])?void 0:d.data,v=null==(m=null==(p=y[3])?void 0:p[0])?void 0:m.data}for(var T=E?4:1,_=MS(g),S=[],k=0;k<g.length/2;++k){var C=_.getUint16(2*k,!0);C<65535&&S.push([k,C])}if(S.length!=w)throw"Expected ".concat(w," cells, found ").concat(S.length);var I=[];for(k=0;k<S.length-1;++k)I[S[k][0]]=v.subarray(S[k][1]*T,S[k+1][1]*T);return S.length>=1&&(I[S[S.length-1][0]]=v.subarray(S[S.length-1][1]*T)),{R:b,cells:I}}(e,a)}));return{nrows:zS(n[4][0].data)>>>0,data:i.reduce((function(e,t){return e[t.R]||(e[t.R]=[]),t.cells.forEach((function(r,n){if(e[t.R][n])throw new Error("Duplicate cell r=".concat(t.R," c=").concat(n));e[t.R][n]=r})),e}),[])}}function JS(e,t){var r={"!ref":"A1"},n=e[XS(jS(t.data)[2][0].data)],a=zS(n[0].meta[1][0].data);if(6001!=a)throw new Error("6000 unexpected reference to ".concat(a));return function(e,t,r){var n,a=jS(t.data),i={s:{r:0,c:0},e:{r:0,c:0}};if(i.e.r=(zS(a[6][0].data)>>>0)-1,i.e.r<0)throw new Error("Invalid row varint ".concat(a[6][0].data));if(i.e.c=(zS(a[7][0].data)>>>0)-1,i.e.c<0)throw new Error("Invalid col varint ".concat(a[7][0].data));r["!ref"]=Sb(i);var s=jS(a[4][0].data),o=YS(e,e[XS(s[4][0].data)][0]),l=(null==(n=s[17])?void 0:n[0])?YS(e,e[XS(s[17][0].data)][0]):[],c=jS(s[3][0].data),u=0;c[1].forEach((function(t){var n=jS(t.data),a=e[XS(n[2][0].data)][0],i=zS(a.meta[1][0].data);if(6002!=i)throw new Error("6001 unexpected reference to ".concat(i));var s=QS(0,a);s.data.forEach((function(e,t){e.forEach((function(e,n){var a=Tb({r:u+t,c:n}),i=qS(e,o,l);i&&(r[a]=i)}))})),u+=s.nrows}))}(e,n[0],r),r}function ZS(e,t){var r={SheetNames:[],Sheets:{}};if(HS(jS(t.data)[1],XS).forEach((function(t){e[t].forEach((function(t){if(2==zS(t.meta[1][0].data)){var n=function(e,t){var r,n=jS(t.data),a={name:(null==(r=n[1])?void 0:r[0])?FS(n[1][0].data):"",sheets:[]};return HS(n[2],XS).forEach((function(t){e[t].forEach((function(t){6e3==zS(t.meta[1][0].data)&&a.sheets.push(JS(e,t))}))})),a}(e,t);n.sheets.forEach((function(e,t){wk(r,e,0==t?n.name:n.name+"_"+t,!0)}))}}))})),0==r.SheetNames.length)throw new Error("Empty NUMBERS file");return r}function ek(e){var t,r,n,a,i={},s=[];if(e.FullPaths.forEach((function(e){if(e.match(/\.iwpv2/))throw new Error("Unsupported password protection")})),e.FileIndex.forEach((function(e){if(e.name.match(/\.iwa$/)){var t,r;try{t=GS(e.content)}catch(Ok){return console.log("?? "+e.content.length+" "+(Ok.message||Ok))}try{r=$S(t)}catch(Ok){return console.log("## "+(Ok.message||Ok))}r.forEach((function(e){i[e.id]=e.messages,s.push(e.id)}))}})),!s.length)throw new Error("File has no messages");var o=(null==(a=null==(n=null==(r=null==(t=null==i?void 0:i[1])?void 0:t[0])?void 0:r.meta)?void 0:n[1])?void 0:a[0].data)&&1==zS(i[1][0].meta[1][0].data)&&i[1][0];if(o||s.forEach((function(e){i[e].forEach((function(e){if(1==zS(e.meta[1][0].data)>>>0){if(o)throw new Error("Document has multiple roots");o=e}}))})),!o)throw new Error("Cannot find Document root");return ZS(i,o)}function tk(e){return function(t){for(var r=0;r!=e.length;++r){var n=e[r];void 0===t[n[0]]&&(t[n[0]]=n[1]),"n"===n[2]&&(t[n[0]]=Number(t[n[0]]))}}}function rk(e){tk([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(e)}function nk(e,t,r,n,a,i,s,o,l,c,u,h){try{i[n]=iw(zv(e,r,!0),t);var f,d=Bv(e,t);switch(o){case"sheet":f=$_(d,t,a,l,i[n],c,u,h);break;case"chart":if(!(f=W_(d,t,a,l,i[n],c))||!f["!drawel"])break;var p=Gv(f["!drawel"].Target,t),m=aw(p),g=function(e,t){if(!e)return"??";var r=(e.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return t["!id"][r].Target}(zv(e,p,!0),iw(zv(e,m,!0),p)),v=Gv(g,p),y=aw(v);f=O_(zv(e,v,!0),0,0,iw(zv(e,y,!0),v),0,f);break;case"macro":w=t,i[n],w.slice(-4),f={"!type":"macro"};break;case"dialog":f=function(e,t){return t.slice(-4),{"!type":"dialog"}}(0,t,0,0,i[n]);break;default:throw new Error("Unrecognized sheet type "+o)}s[n]=f;var b=[];i&&i[n]&&gv(i[n]).forEach((function(r){var a="";if(i[n][r].Type==nw.CMNT){a=Gv(i[n][r].Target,t);var s=q_(Bv(e,a,!0),a,l);if(!s||!s.length)return;gT(f,s,!1)}i[n][r].Type==nw.TCMNT&&(a=Gv(i[n][r].Target,t),b=b.concat(function(e,t){var r=[],n=!1,a={},i=0;return e.replace(Yv,(function(s,o){var l=Zv(s);switch(ey(l[0])){case"<?xml":case"<ThreadedComments":case"</ThreadedComments>":case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<threadedComment":a={author:l.personId,guid:l.id,ref:l.ref,T:1};break;case"</threadedComment>":null!=a.t&&r.push(a);break;case"<text>":case"<text":i=o+s.length;break;case"</text>":a.t=e.slice(i,o).replace(/\r\n/g,"\n").replace(/\r/g,"\n");break;case"<mentions":case"<mentions>":case"<ext":n=!0;break;case"</mentions>":case"</ext>":n=!1;break;default:if(!n&&t.WTF)throw new Error("unrecognized "+l[0]+" in threaded comments")}return s})),r}(Bv(e,a,!0),l)))})),b&&b.length&&gT(f,b,!0,l.people||[])}catch(Ok){if(l.WTF)throw Ok}var w}function ak(e){return"/"==e.charAt(0)?e.slice(1):e}function ik(e,t){if(uv(),rk(t=t||{}),Uv(e,"META-INF/manifest.xml"))return DS(e,t);if(Uv(e,"objectdata.xml"))return DS(e,t);if(Uv(e,"Index/Document.iwa")){if("undefined"==typeof Uint8Array)throw new Error("NUMBERS file parsing requires Uint8Array support");if(e.FileIndex)return ek(e);var r=pv.utils.cfb_new();return Hv(e).forEach((function(t){$v(r,t,jv(e,t))})),ek(r)}if(!Uv(e,"[Content_Types].xml")){if(Uv(e,"index.xml.gz"))throw new Error("Unsupported NUMBERS 08 file");if(Uv(e,"index.xml"))throw new Error("Unsupported NUMBERS 09 file");throw new Error("Unsupported ZIP file")}var n,a,i=Hv(e),s=function(e){var t={workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""};if(!e||!e.match)return t;var r={};if((e.match(Yv)||[]).forEach((function(e){var n=Zv(e);switch(n[0].replace(Qv,"<")){case"<?xml":break;case"<Types":t.xmlns=n["xmlns"+(n[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":r[n.Extension]=n.ContentType;break;case"<Override":void 0!==t[rw[n.ContentType]]&&t[rw[n.ContentType]].push(n.PartName)}})),t.xmlns!==Cy)throw new Error("Unknown Namespace: "+t.xmlns);return t.calcchain=t.calcchains.length>0?t.calcchains[0]:"",t.sst=t.strs.length>0?t.strs[0]:"",t.style=t.styles.length>0?t.styles[0]:"",t.defaults=r,delete t.calcchains,t}(zv(e,"[Content_Types].xml")),o=!1;if(0===s.workbooks.length&&Bv(e,a="xl/workbook.xml",!0)&&s.workbooks.push(a),0===s.workbooks.length){if(!Bv(e,a="xl/workbook.bin",!0))throw new Error("Could not find workbook");s.workbooks.push(a),o=!0}"bin"==s.workbooks[0].slice(-3)&&(o=!0);var l={},c={};if(!t.bookSheets&&!t.bookProps){if(c_=[],s.sst)try{c_=K_(Bv(e,ak(s.sst)),s.sst,t)}catch(Ok){if(t.WTF)throw Ok}t.cellStyles&&s.themes.length&&(l=function(e,t,r){return fT(e,r)}(zv(e,s.themes[0].replace(/^\//,""),!0)||"",s.themes[0],t)),s.style&&(c=G_(Bv(e,ak(s.style)),s.style,l,t))}s.links.map((function(r){try{iw(zv(e,aw(ak(r))),r);return Y_(Bv(e,ak(r)),0,r,t)}catch(Ok){}}));var u=H_(Bv(e,ak(s.workbooks[0])),s.workbooks[0],t),h={},f="";s.coreprops.length&&((f=Bv(e,ak(s.coreprops[0]),!0))&&(h=lw(f)),0!==s.extprops.length&&(f=Bv(e,ak(s.extprops[0]),!0))&&function(e,t,r){var n={};t||(t={}),e=dy(e),cw.forEach((function(r){var a=(e.match(my(r[0]))||[])[1];switch(r[2]){case"string":a&&(t[r[1]]=ny(a));break;case"bool":t[r[1]]="true"===a;break;case"raw":var i=e.match(new RegExp("<"+r[0]+"[^>]*>([\\s\\S]*?)</"+r[0]+">"));i&&i.length>0&&(n[r[1]]=i[1])}})),n.HeadingPairs&&n.TitlesOfParts&&uw(n.HeadingPairs,n.TitlesOfParts,t,r)}(f,h,t));var d={};t.bookSheets&&!t.bookProps||0!==s.custprops.length&&(f=zv(e,ak(s.custprops[0]),!0))&&(d=function(e,t){var r={},n="",a=e.match(hw);if(a)for(var i=0;i!=a.length;++i){var s=a[i],o=Zv(s);switch(o[0]){case"<?xml":case"<Properties":break;case"<property":n=ny(o.name);break;case"</property>":n=null;break;default:if(0===s.indexOf("<vt:")){var l=s.split(">"),c=l[0].slice(4),u=l[1];switch(c){case"lpstr":case"bstr":case"lpwstr":case"cy":case"error":r[n]=ny(u);break;case"bool":r[n]=ly(u);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":r[n]=parseInt(u,10);break;case"r4":case"r8":case"decimal":r[n]=parseFloat(u);break;case"filetime":case"date":r[n]=Av(u);break;default:if("/"==c.slice(-1))break;t.WTF&&"undefined"!==typeof console&&console.warn("Unexpected",s,c,l)}}else if("</"===s.slice(0,2));else if(t.WTF)throw new Error(s)}}return r}(f,t));var p={};if((t.bookSheets||t.bookProps)&&(u.Sheets?n=u.Sheets.map((function(e){return e.name})):h.Worksheets&&h.SheetNames.length>0&&(n=h.SheetNames),t.bookProps&&(p.Props=h,p.Custprops=d),t.bookSheets&&"undefined"!==typeof n&&(p.SheetNames=n),t.bookSheets?p.SheetNames:t.bookProps))return p;n={};var m={};t.bookDeps&&s.calcchain&&(m=X_(Bv(e,ak(s.calcchain)),s.calcchain));var g,v,y=0,b={},w=u.Sheets;h.Worksheets=w.length,h.SheetNames=[];for(var E=0;E!=w.length;++E)h.SheetNames[E]=w[E].name;var T=o?"bin":"xml",_=s.workbooks[0].lastIndexOf("/"),S=(s.workbooks[0].slice(0,_+1)+"_rels/"+s.workbooks[0].slice(_+1)+".rels").replace(/^\//,"");Uv(e,S)||(S="xl/_rels/workbook."+T+".rels");var k=iw(zv(e,S,!0),S.replace(/_rels.*/,"s5s"));(s.metadata||[]).length>=1&&(t.xlmeta=Q_(Bv(e,ak(s.metadata[0])),s.metadata[0],t)),(s.people||[]).length>=1&&(t.people=function(e,t){var r=[],n=!1;return e.replace(Yv,(function(e){var a=Zv(e);switch(ey(a[0])){case"<?xml":case"<personList":case"</personList>":case"</person>":case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<person":r.push({name:a.displayname,id:a.id});break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&t.WTF)throw new Error("unrecognized "+a[0]+" in threaded comments")}return e})),r}(Bv(e,ak(s.people[0])),t)),k&&(k=function(e,t){if(!e)return 0;try{e=t.map((function(t){return t.id||(t.id=t.strRelID),[t.name,e["!id"][t.id].Target,(r=e["!id"][t.id].Type,nw.WS.indexOf(r)>-1?"sheet":nw.CS&&r==nw.CS?"chart":nw.DS&&r==nw.DS?"dialog":nw.MS&&r==nw.MS?"macro":r&&r.length?r:"sheet")];var r}))}catch(Ok){return null}return e&&0!==e.length?e:null}(k,u.Sheets));var C=Bv(e,"xl/worksheets/sheet.xml",!0)?1:0;e:for(y=0;y!=h.Worksheets;++y){var I="sheet";if(k&&k[y]?(g="xl/"+k[y][1].replace(/[\/]?xl\//,""),Uv(e,g)||(g=k[y][1]),Uv(e,g)||(g=S.replace(/_rels\/.*$/,"")+k[y][1]),I=k[y][2]):g=(g="xl/worksheets/sheet"+(y+1-C)+"."+T).replace(/sheet0\./,"sheet."),v=g.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),t&&null!=t.sheets)switch(typeof t.sheets){case"number":if(y!=t.sheets)continue e;break;case"string":if(h.SheetNames[y].toLowerCase()!=t.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(t.sheets)){for(var A=!1,R=0;R!=t.sheets.length;++R)"number"==typeof t.sheets[R]&&t.sheets[R]==y&&(A=1),"string"==typeof t.sheets[R]&&t.sheets[R].toLowerCase()==h.SheetNames[y].toLowerCase()&&(A=1);if(!A)continue e}}nk(e,g,v,h.SheetNames[y],y,b,n,I,t,u,l,c)}return p={Directory:s,Workbook:u,Props:h,Custprops:d,Deps:m,Sheets:n,SheetNames:h.SheetNames,Strings:c_,Styles:c,Themes:l,SSF:Nv(Ng)},t&&t.bookFiles&&(e.files?(p.keys=i,p.files=e.files):(p.keys=[],p.files={},e.FullPaths.forEach((function(t,r){t=t.replace(/^Root Entry[\/]/,""),p.keys.push(t),p.files[t]=e.FileIndex[r]})))),t&&t.bookVBA&&(s.vba.length>0?p.vbaraw=Bv(e,ak(s.vba[0]),!0):s.defaults&&"application/vnd.ms-office.vbaProject"===s.defaults.bin&&(p.vbaraw=Bv(e,"xl/vbaProject.bin",!0))),p}function sk(e,t){var r=t||{},n="Workbook",a=pv.find(e,n);try{if(n="/!DataSpaces/Version",!(a=pv.find(e,n))||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(function(e){var t={};t.id=e.read_shift(0,"lpp4"),t.R=IE(e,4),t.U=IE(e,4),t.W=IE(e,4)}(a.content),n="/!DataSpaces/DataSpaceMap",!(a=pv.find(e,n))||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);var i=function(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(AE(e));return t}(a.content);if(1!==i.length||1!==i[0].comps.length||0!==i[0].comps[0].t||"StrongEncryptionDataSpace"!==i[0].name||"EncryptedPackage"!==i[0].comps[0].v)throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",!(a=pv.find(e,n))||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);var s=function(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(e.read_shift(0,"lpp4"));return t}(a.content);if(1!=s.length||"StrongEncryptionTransform"!=s[0])throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",!(a=pv.find(e,n))||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);RE(a.content)}catch(Ok){}if(n="/EncryptionInfo",!(a=pv.find(e,n))||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);var o=function(e){var t=IE(e);switch(t.Minor){case 2:return[t.Minor,xE(e)];case 3:return[t.Minor,PE()];case 4:return[t.Minor,DE(e)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+t.Minor)}(a.content);if(n="/EncryptedPackage",!(a=pv.find(e,n))||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(4==o[0]&&"undefined"!==typeof decrypt_agile)return decrypt_agile(o[1],a.content,r.password||"",r);if(2==o[0]&&"undefined"!==typeof decrypt_std76)return decrypt_std76(o[1],a.content,r.password||"",r);throw new Error("File is password-protected")}function ok(e,t){var r="";switch((t||{}).type||"base64"){case"buffer":case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":r=ug(e.slice(0,12));break;case"binary":r=e;break;default:throw new Error("Unrecognized type "+(t&&t.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function lk(e,t){var r=0;e:for(;r<e.length;)switch(e.charCodeAt(r)){case 10:case 13:case 32:++r;break;case 60:return cS(e.slice(r),t);default:break e}return mE.to_workbook(e,t)}function ck(e,t,r,n){return n?(r.type="string",mE.to_workbook(e,r)):mE.to_workbook(t,r)}function uk(e,t){tg();var r=t||{};if("undefined"!==typeof ArrayBuffer&&e instanceof ArrayBuffer)return uk(new Uint8Array(e),((r=Nv(r)).type="array",r));"undefined"!==typeof Uint8Array&&e instanceof Uint8Array&&!r.type&&(r.type="undefined"!==typeof Deno?"buffer":"array");var n,a=e,i=!1;if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),u_={},r.dateNF&&(u_.dateNF=r.dateNF),r.type||(r.type=hg&&Buffer.isBuffer(e)?"buffer":"base64"),"file"==r.type&&(r.type=hg?"buffer":"binary",a=function(e){if("undefined"!==typeof mv)return mv.readFileSync(e);if("undefined"!==typeof Deno)return Deno.readFileSync(e);if("undefined"!==typeof $&&"undefined"!==typeof File&&"undefined"!==typeof Folder)try{var t=File(e);t.open("r"),t.encoding="binary";var r=t.read();return t.close(),r}catch(Ok){if(!Ok.message||!Ok.message.match(/onstruct/))throw Ok}throw new Error("Cannot access file "+e)}(e),"undefined"===typeof Uint8Array||hg||(r.type="array")),"string"==r.type&&(i=!0,r.type="binary",r.codepage=65001,a=function(e){return e.match(/[^\x00-\x7F]/)?py(e):e}(e)),"array"==r.type&&"undefined"!==typeof Uint8Array&&e instanceof Uint8Array&&"undefined"!==typeof ArrayBuffer){var s=new ArrayBuffer(3),o=new Uint8Array(s);if(o.foo="bar",!o.foo)return(r=Nv(r)).type="array",uk(vg(a),r)}switch((n=ok(a,r))[0]){case 208:if(207===n[1]&&17===n[2]&&224===n[3]&&161===n[4]&&177===n[5]&&26===n[6]&&225===n[7])return function(e,t){return pv.find(e,"EncryptedPackage")?sk(e,t):yS(e,t)}(pv.read(a,r),r);break;case 9:if(n[1]<=8)return yS(a,r);break;case 60:return cS(a,r);case 73:if(73===n[1]&&42===n[2]&&0===n[3])throw new Error("TIFF Image File is not a spreadsheet");if(68===n[1])return function(e,t){var r=t||{},n=!!r.WTF;r.WTF=!0;try{var a=fE.to_workbook(e,r);return r.WTF=n,a}catch(Ok){if(r.WTF=n,!Ok.message.match(/SYLK bad record ID/)&&n)throw Ok;return mE.to_workbook(e,t)}}(a,r);break;case 84:if(65===n[1]&&66===n[2]&&76===n[3])return dE.to_workbook(a,r);break;case 80:return 75===n[1]&&n[2]<9&&n[3]<9?function(e,t){var r=e,n=t||{};return n.type||(n.type=hg&&Buffer.isBuffer(e)?"buffer":"base64"),ik(Wv(r,n),n)}(a,r):ck(e,a,r,i);case 239:return 60===n[3]?cS(a,r):ck(e,a,r,i);case 255:if(254===n[1])return function(e,t){var r=e;return"base64"==t.type&&(r=ug(r)),r=ag.utils.decode(1200,r.slice(2),"str"),t.type="binary",lk(r,t)}(a,r);if(0===n[1]&&2===n[2]&&0===n[3])return gE.to_workbook(a,r);break;case 0:if(0===n[1]){if(n[2]>=2&&0===n[3])return gE.to_workbook(a,r);if(0===n[2]&&(8===n[3]||9===n[3]))return gE.to_workbook(a,r)}break;case 3:case 131:case 139:case 140:return hE.to_workbook(a,r);case 123:if(92===n[1]&&114===n[2]&&116===n[3])return VE.to_workbook(a,r);break;case 10:case 13:case 32:return function(e,t){var r="",n=ok(e,t);switch(t.type){case"base64":r=ug(e);break;case"binary":r=e;break;case"buffer":r=e.toString("binary");break;case"array":r=Rv(e);break;default:throw new Error("Unrecognized type "+t.type)}return 239==n[0]&&187==n[1]&&191==n[2]&&(r=dy(r)),t.type="binary",lk(r,t)}(a,r);case 137:if(80===n[1]&&78===n[2]&&71===n[3])throw new Error("PNG Image File is not a spreadsheet")}return uE.indexOf(n[0])>-1&&n[2]<=12&&n[3]<=31?hE.to_workbook(a,r):ck(e,a,r,i)}function hk(e,t,r,n,a,i,s,o){var l=yb(r),c=o.defval,u=o.raw||!Object.prototype.hasOwnProperty.call(o,"raw"),h=!0,f=1===a?[]:{};if(1!==a)if(Object.defineProperty)try{Object.defineProperty(f,"__rowNum__",{value:r,enumerable:!1})}catch(Ok){f.__rowNum__=r}else f.__rowNum__=r;if(!s||e[r])for(var d=t.s.c;d<=t.e.c;++d){var p=s?e[r][d]:e[n[d]+l];if(void 0!==p&&void 0!==p.t){var m=p.v;switch(p.t){case"z":if(null==m)break;continue;case"e":m=0==m?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+p.t)}if(null!=i[d]){if(null==m)if("e"==p.t&&null===m)f[i[d]]=null;else if(void 0!==c)f[i[d]]=c;else{if(!u||null!==m)continue;f[i[d]]=null}else f[i[d]]=u&&("n"!==p.t||"n"===p.t&&!1!==o.rawNumbers)?m:Ib(p,m,o);null!=m&&(h=!1)}}else{if(void 0===c)continue;null!=i[d]&&(f[i[d]]=c)}}return{row:f,isempty:h}}function fk(e,t){if(null==e||null==e["!ref"])return[];var r={t:"n",v:0},n=0,a=1,i=[],s=0,o="",l={s:{r:0,c:0},e:{r:0,c:0}},c=t||{},u=null!=c.range?c.range:e["!ref"];switch(1===c.header?n=1:"A"===c.header?n=2:Array.isArray(c.header)?n=3:null==c.header&&(n=0),typeof u){case"string":l=kb(u);break;case"number":(l=kb(e["!ref"])).s.r=u;break;default:l=u}n>0&&(a=0);var h=yb(l.s.r),f=[],d=[],p=0,m=0,g=Array.isArray(e),v=l.s.r,y=0,b={};g&&!e[v]&&(e[v]=[]);var w=c.skipHidden&&e["!cols"]||[],E=c.skipHidden&&e["!rows"]||[];for(y=l.s.c;y<=l.e.c;++y)if(!(w[y]||{}).hidden)switch(f[y]=wb(y),r=g?e[v][y]:e[f[y]+h],n){case 1:i[y]=y-l.s.c;break;case 2:i[y]=f[y];break;case 3:i[y]=c.header[y-l.s.c];break;default:if(null==r&&(r={w:"__EMPTY",t:"s"}),o=s=Ib(r,null,c),m=b[s]||0){do{o=s+"_"+m++}while(b[o]);b[s]=m,b[o]=1}else b[s]=1;i[y]=o}for(v=l.s.r+a;v<=l.e.r;++v)if(!(E[v]||{}).hidden){var T=hk(e,l,v,f,n,i,g,c);(!1===T.isempty||(1===n?!1!==c.blankrows:c.blankrows))&&(d[p++]=T.row)}return d.length=p,d}var dk=/"/g;function pk(e,t,r,n,a,i,s,o){for(var l=!0,c=[],u="",h=yb(r),f=t.s.c;f<=t.e.c;++f)if(n[f]){var d=o.dense?(e[r]||[])[f]:e[n[f]+h];if(null==d)u="";else if(null!=d.v){l=!1,u=""+(o.rawNumbers&&"n"==d.t?d.v:Ib(d,null,o));for(var p=0,m=0;p!==u.length;++p)if((m=u.charCodeAt(p))===a||m===i||34===m||o.forceQuotes){u='"'+u.replace(dk,'""')+'"';break}"ID"==u&&(u='"ID"')}else null==d.f||d.F?u="":(l=!1,(u="="+d.f).indexOf(",")>=0&&(u='"'+u.replace(dk,'""')+'"'));c.push(u)}return!1===o.blankrows&&l?null:c.join(s)}function mk(e,t){var r=[],n=null==t?{}:t;if(null==e||null==e["!ref"])return"";var a=kb(e["!ref"]),i=void 0!==n.FS?n.FS:",",s=i.charCodeAt(0),o=void 0!==n.RS?n.RS:"\n",l=o.charCodeAt(0),c=new RegExp(("|"==i?"\\|":i)+"+$"),u="",h=[];n.dense=Array.isArray(e);for(var f=n.skipHidden&&e["!cols"]||[],d=n.skipHidden&&e["!rows"]||[],p=a.s.c;p<=a.e.c;++p)(f[p]||{}).hidden||(h[p]=wb(p));for(var m=0,g=a.s.r;g<=a.e.r;++g)(d[g]||{}).hidden||null!=(u=pk(e,a,g,h,s,l,i,n))&&(n.strip&&(u=u.replace(c,"")),(u||!1!==n.blankrows)&&r.push((m++?o:"")+u));return delete n.dense,r.join("")}function gk(e,t){t||(t={}),t.FS="\t",t.RS="\n";var r=mk(e,t);if("undefined"==typeof ag||"string"==t.type)return r;var n=ag.utils.encode(1200,r,"str");return String.fromCharCode(255)+String.fromCharCode(254)+n}function vk(e,t,r){var n,a=r||{},i=+!a.skipHeader,s=e||{},o=0,l=0;if(s&&null!=a.origin)if("number"==typeof a.origin)o=a.origin;else{var c="string"==typeof a.origin?Eb(a.origin):a.origin;o=c.r,l=c.c}var u={s:{c:0,r:0},e:{c:l,r:o+t.length-1+i}};if(s["!ref"]){var h=kb(s["!ref"]);u.e.c=Math.max(u.e.c,h.e.c),u.e.r=Math.max(u.e.r,h.e.r),-1==o&&(o=h.e.r+1,u.e.r=o+t.length-1+i)}else-1==o&&(o=0,u.e.r=t.length-1+i);var f=a.header||[],d=0;t.forEach((function(e,t){gv(e).forEach((function(r){-1==(d=f.indexOf(r))&&(f[d=f.length]=r);var c=e[r],u="z",h="",p=Tb({c:l+d,r:o+t+i});n=yk(s,p),!c||"object"!==typeof c||c instanceof Date?("number"==typeof c?u="n":"boolean"==typeof c?u="b":"string"==typeof c?u="s":c instanceof Date?(u="d",a.cellDates||(u="n",c=bv(c)),h=a.dateNF||Ng[14]):null===c&&a.nullError&&(u="e",c=0),n?(n.t=u,n.v=c,delete n.w,delete n.R,h&&(n.z=h)):s[p]=n={t:u,v:c},h&&(n.z=h)):s[p]=c}))})),u.e.c=Math.max(u.e.c,l+f.length-1);var p=yb(o);if(i)for(d=0;d<f.length;++d)s[wb(d+l)+p]={t:"s",v:f[d]};return s["!ref"]=Sb(u),s}function yk(e,t,r){if("string"==typeof t){if(Array.isArray(e)){var n=Eb(t);return e[n.r]||(e[n.r]=[]),e[n.r][n.c]||(e[n.r][n.c]={t:"z"})}return e[t]||(e[t]={t:"z"})}return yk(e,Tb("number"!=typeof t?t:{r:t,c:r||0}))}function bk(){return{SheetNames:[],Sheets:{}}}function wk(e,t,r,n){var a=1;if(!r)for(;a<=65535&&-1!=e.SheetNames.indexOf(r="Sheet"+a);++a,r=void 0);if(!r||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&e.SheetNames.indexOf(r)>=0){var i=r.match(/(^.*?)(\d+)$/);a=i&&+i[2]||0;var s=i&&i[1]||r;for(++a;a<=65535&&-1!=e.SheetNames.indexOf(r=s+a);++a);}if(B_(r),e.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return e.SheetNames.push(r),e.Sheets[r]=t,r}function Ek(e,t,r){return t?(e.l={Target:t},r&&(e.l.Tooltip=r)):delete e.l,e}var Tk={encode_col:wb,encode_row:yb,encode_cell:Tb,encode_range:Sb,decode_col:bb,decode_row:vb,split_cell:function(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")},decode_cell:Eb,decode_range:_b,format_cell:Ib,sheet_add_aoa:Rb,sheet_add_json:vk,sheet_add_dom:AS,aoa_to_sheet:Nb,json_to_sheet:function(e,t){return vk(null,e,t)},table_to_sheet:RS,table_to_book:function(e,t){return Ab(RS(e,t),t)},sheet_to_csv:mk,sheet_to_txt:gk,sheet_to_json:fk,sheet_to_html:IS,sheet_to_formulae:function(e){var t,r="",n="";if(null==e||null==e["!ref"])return[];var a,i=kb(e["!ref"]),s="",o=[],l=[],c=Array.isArray(e);for(a=i.s.c;a<=i.e.c;++a)o[a]=wb(a);for(var u=i.s.r;u<=i.e.r;++u)for(s=yb(u),a=i.s.c;a<=i.e.c;++a)if(r=o[a]+s,n="",void 0!==(t=c?(e[u]||[])[a]:e[r])){if(null!=t.F){if(r=t.F,!t.f)continue;n=t.f,-1==r.indexOf(":")&&(r=r+":"+r)}if(null!=t.f)n=t.f;else{if("z"==t.t)continue;if("n"==t.t&&null!=t.v)n=""+t.v;else if("b"==t.t)n=t.v?"TRUE":"FALSE";else if(void 0!==t.w)n="'"+t.w;else{if(void 0===t.v)continue;n="s"==t.t?"'"+t.v:""+t.v}}l[l.length]=r+"="+n}return l},sheet_to_row_object_array:fk,sheet_get_cell:yk,book_new:bk,book_append_sheet:wk,book_set_sheet_visibility:function(e,t,r){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var n=function(e,t){if("number"==typeof t){if(t>=0&&e.SheetNames.length>t)return t;throw new Error("Cannot find sheet # "+t)}if("string"==typeof t){var r=e.SheetNames.indexOf(t);if(r>-1)return r;throw new Error("Cannot find sheet name |"+t+"|")}throw new Error("Cannot find sheet |"+t+"|")}(e,t);switch(e.Workbook.Sheets[n]||(e.Workbook.Sheets[n]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}e.Workbook.Sheets[n].Hidden=r},cell_set_number_format:function(e,t){return e.z=t,e},cell_set_hyperlink:Ek,cell_set_internal_link:function(e,t,r){return Ek(e,"#"+t,r)},cell_add_comment:function(e,t,r){e.c||(e.c=[]),e.c.push({t:t,a:r||"SheetJS"})},sheet_set_array_formula:function(e,t,r,n){for(var a="string"!=typeof t?t:kb(t),i="string"==typeof t?t:Sb(t),s=a.s.r;s<=a.e.r;++s)for(var o=a.s.c;o<=a.e.c;++o){var l=yk(e,s,o);l.t="n",l.F=i,delete l.v,s==a.s.r&&o==a.s.c&&(l.f=r,n&&(l.D=!0))}return e},consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};qm.version;const _k=e=>e?e.toString().toLowerCase().trim().replace(/\s+/g," "):"",Sk=e=>e?e.toString().replace(/\./g,"").trim():"",kk=async e=>{try{console.log("Buscando nombre:",e);const t=_k(e);console.log("Nombre normalizado:",t);const r=await(async()=>{try{console.log("Obteniendo todas las empresas");let e=hh(Bm,"empresas"),t=await ff(e);return t.empty&&(console.log("No hay resultados en 'empresas', intentando en 'convenios_empresas'"),e=hh(Bm,"convenios_empresas"),t=await ff(e)),console.log(`Encontrados ${t.docs.length} resultados`),t.docs.map((e=>({id:e.id,...e.data()})))}catch(e){throw console.error("Error al obtener datos:",e),e}})();console.log(`Total de empresas para filtrar: ${r.length}`);const n=r.filter((e=>{const r=_k(e.nombre_empresa);return console.log(`Comparando: "${r}" contiene "${t}"?`),r.includes(t)}));return console.log(`Resultados filtrados: ${n.length}`),n}catch(t){throw console.error("Error al buscar empresa por nombre:",t),t}},Ck=async e=>{try{console.log("Procesando archivo Excel");const r=uk(e),n=r.Sheets[r.SheetNames[0]],a=Tk.sheet_to_json(n);if(console.log(`Filas le\xeddas del Excel: ${a.length}`),0===a.length)throw new Error("El archivo est\xe1 vac\xedo o no contiene datos v\xe1lidos");const i=a[0];console.log("Primera fila del Excel:",i);const s=Object.keys(i).find((e=>e.toLowerCase().includes("rut")||"rut_empresa"===e.toLowerCase())),o=Object.keys(i).find((e=>e.toLowerCase().includes("nombre")||"nombre_empresa"===e.toLowerCase())),l=Object.keys(i).find((e=>e.toLowerCase().includes("tipo")||"tipo_de_convenio"===e.toLowerCase()));if(!s||!o||!l)throw new Error("El archivo no tiene las columnas requeridas. Debe contener campos para RUT, Nombre y Tipo de Convenio.");console.log(`Columnas identificadas: RUT=${s}, Nombre=${o}, Tipo=${l}`);const c=hh(Bm,"convenios_empresas"),u=await ff(c),h=new Set;u.docs.forEach((e=>{const t=e.data();t.rut_empresa&&h.add(Sk(t.rut_empresa))})),console.log(`Encontrados ${h.size} RUTs existentes en la base de datos`);const f=(gh(t=rh(t=Bm,mh)),new pf(t,(e=>df(t,e))));let d=0,p=0;for(const e of a){const t=Sk(e[s]);if(!t||!e[o]){console.warn("Fila ignorada por datos incompletos:",e);continue}if(h.has(t)){console.log(`RUT duplicado ignorado: ${t}`),p++;continue}const r={rut_empresa:t,nombre_empresa:_k(e[o]),tipo_de_convenio:_k(e[l])};console.log("Procesando empresa nueva:",r);const n=fh(hh(Bm,"convenios_empresas"));f.set(n,r),d++}return console.log(`Preparados ${d} registros nuevos para subir (${p} duplicados ignorados)`),d>0?(await f.commit(),console.log("Batch completado exitosamente")):console.log("No hay nuevos registros para guardar"),{success:!0,count:d,duplicates:p}}catch(r){throw console.error("Error al procesar archivo:",r),r}var t};const Ik=function(e){let{onResultsFound:t}=e;const[r,n]=(0,a.useState)(""),[i,s]=(0,a.useState)("rut"),[o,l]=(0,a.useState)(!1),[c,u]=(0,a.useState)(null);return(0,jm.jsxs)("div",{className:"search-form",children:[(0,jm.jsx)("h3",{children:"Buscar Empresa"}),c&&(0,jm.jsx)("div",{className:"error-message",children:c}),(0,jm.jsxs)("form",{onSubmit:async e=>{if(e.preventDefault(),r.trim()){l(!0),u(null);try{let n;n="rut"===i?await(async t=>{try{console.log("Buscando RUT:",t);const r=Sk(t);console.log("RUT normalizado:",r);let n=[];try{const e=Yh(hh(Bm,"empresas"),Jh("rut_empresa","==",r)),t=await ff(e);console.log(`Encontrados ${t.docs.length} resultados en 'empresas'`),t.docs.length>0&&(n=t.docs.map((e=>({id:e.id,...e.data()}))))}catch(e){console.log("Error al buscar en 'empresas':",e)}if(0===n.length)try{const e=Yh(hh(Bm,"convenios_empresas"),Jh("rut_empresa","==",r)),t=await ff(e);console.log(`Encontrados ${t.docs.length} resultados en 'convenios_empresas'`),n=t.docs.map((e=>({id:e.id,...e.data()})))}catch(e){console.log("Error al buscar en 'convenios_empresas':",e)}return n}catch(c){throw console.error("Error al buscar empresa:",c),c}})(r):await kk(r),t(n)}catch(n){u(`Error en la b\xfasqueda: ${n.message}`),t([])}finally{l(!1)}}else u("Ingrese un criterio de b\xfasqueda")},children:[(0,jm.jsxs)("div",{className:"search-options",children:[(0,jm.jsxs)("label",{children:[(0,jm.jsx)("input",{type:"radio",name:"searchType",value:"rut",checked:"rut"===i,onChange:()=>s("rut")}),"Buscar por RUT"]}),(0,jm.jsxs)("label",{children:[(0,jm.jsx)("input",{type:"radio",name:"searchType",value:"nombre",checked:"nombre"===i,onChange:()=>s("nombre")}),"Buscar por Nombre"]})]}),(0,jm.jsxs)("div",{className:"search-input",children:[(0,jm.jsx)("input",{type:"text",value:r,onChange:e=>n(e.target.value),placeholder:"rut"===i?"Ingrese RUT a buscar":"Ingrese nombre a buscar"}),(0,jm.jsx)("button",{type:"submit",disabled:o,children:o?"Buscando...":"Buscar"})]})]})]})};const Ak=function(){const[e,t]=(0,a.useState)(null),[r,n]=(0,a.useState)(!1),[i,s]=(0,a.useState)(null),[o,l]=(0,a.useState)(null);return(0,jm.jsxs)("div",{className:"file-uploader",children:[(0,jm.jsx)("h3",{children:"Cargar Datos desde Excel"}),(0,jm.jsxs)("div",{className:"upload-container",children:[(0,jm.jsx)("input",{type:"file",accept:".xlsx, .xls",onChange:e=>{const r=e.target.files[0];t(r),s(null),l(null)},disabled:r}),(0,jm.jsx)("button",{onClick:async()=>{if(e){n(!0),l(null);try{const t=new FileReader;t.onload=async e=>{try{const t=e.target.result,r=await Ck(t);s(`Se importaron ${r.count} registros exitosamente. ${r.duplicates} registros duplicados fueron ignorados.`)}catch(t){l(`Error al procesar el archivo: ${t.message}`)}finally{n(!1)}},t.onerror=()=>{l("Error al leer el archivo"),n(!1)},t.readAsArrayBuffer(e)}catch(t){l(`Error: ${t.message}`),n(!1)}}else l("Por favor seleccione un archivo")},disabled:!e||r,children:r?"Procesando...":"Cargar Datos"})]}),o&&(0,jm.jsx)("div",{className:"error-message",children:o}),i&&(0,jm.jsx)("div",{className:"success-message",children:i}),(0,jm.jsxs)("div",{className:"instructions",children:[(0,jm.jsx)("p",{children:(0,jm.jsx)("strong",{children:"Instrucciones:"})}),(0,jm.jsx)("p",{children:"El archivo Excel debe contener las siguientes columnas:"}),(0,jm.jsxs)("ul",{children:[(0,jm.jsx)("li",{children:"Rut_Empresa"}),(0,jm.jsx)("li",{children:"Nombre_Empresa"}),(0,jm.jsx)("li",{children:"Tipo_de_Convenio"})]})]})]})};const Rk=function(){const{user:e,logout:t}=Wm(),[r,n]=(0,a.useState)([]),[i,s]=(0,a.useState)(!1);return(0,jm.jsxs)("div",{className:"home-container",children:[(0,jm.jsxs)("header",{className:"app-header",children:[(0,jm.jsx)("div",{className:"logo-container",children:(0,jm.jsx)("h1",{children:"Sistema de Consulta de Convenios"})}),(0,jm.jsxs)("div",{className:"user-info",children:[(0,jm.jsxs)("span",{children:["Usuario: ",e.email]}),(0,jm.jsx)("button",{onClick:async()=>{try{await t()}catch(e){console.error("Error al cerrar sesi\xf3n:",e)}},className:"logout-btn",children:"Cerrar Sesi\xf3n"})]})]}),(0,jm.jsxs)("main",{children:[(0,jm.jsx)("div",{className:"main-actions",children:(0,jm.jsx)("button",{onClick:()=>s(!i),className:"toggle-uploader-btn",children:i?"Ocultar Carga":"Mostrar Carga de Datos"})}),i&&(0,jm.jsx)("section",{className:"upload-section",children:(0,jm.jsx)(Ak,{})}),(0,jm.jsx)("section",{className:"search-section",children:(0,jm.jsx)(Ik,{onResultsFound:e=>{n(e)}})}),(0,jm.jsxs)("section",{className:"results-section",children:[(0,jm.jsxs)("h3",{children:["Resultados (",r.length,")"]}),r.length>0?(0,jm.jsxs)("table",{className:"results-table",children:[(0,jm.jsx)("thead",{children:(0,jm.jsxs)("tr",{children:[(0,jm.jsx)("th",{children:"RUT"}),(0,jm.jsx)("th",{children:"Empresa"}),(0,jm.jsx)("th",{children:"Tipo de Convenio"})]})}),(0,jm.jsx)("tbody",{children:r.map((e=>(0,jm.jsxs)("tr",{children:[(0,jm.jsx)("td",{children:e.rut_empresa}),(0,jm.jsx)("td",{children:e.nombre_empresa}),(0,jm.jsx)("td",{children:e.tipo_de_convenio})]},e.id)))})]}):(0,jm.jsx)("p",{className:"no-results",children:"No se encontraron resultados"})]})]})]})};const Nk=function(){return(0,jm.jsx)($m,{children:(0,jm.jsx)(_e,{children:(0,jm.jsxs)(we,{children:[(0,jm.jsx)(ye,{path:"/login",element:(0,jm.jsx)(Km,{})}),(0,jm.jsx)(ye,{path:"/",element:(0,jm.jsx)(Gm,{children:(0,jm.jsx)(Rk,{})})}),(0,jm.jsx)(ye,{path:"*",element:(0,jm.jsx)(ve,{to:"/"})})]})})})};(0,s.H)(document.getElementById("root")).render((0,jm.jsx)(a.StrictMode,{children:(0,jm.jsx)(Nk,{})}))})();
//# sourceMappingURL=main.b96a99de.js.map